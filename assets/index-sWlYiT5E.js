var e=Object.create,t=Object.defineProperty,n=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,i=Object.getPrototypeOf,a=Object.prototype.hasOwnProperty,o=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),s=e=>{let n={};for(var r in e)t(n,r,{get:e[r],enumerable:!0});return n},c=(e,i,o,s)=>{if(i&&typeof i==`object`||typeof i==`function`)for(var c=r(i),l=0,u=c.length,d;l<u;l++)d=c[l],!a.call(e,d)&&d!==o&&t(e,d,{get:(e=>i[e]).bind(null,d),enumerable:!(s=n(i,d))||s.enumerable});return e},l=(n,r,a)=>(a=n==null?{}:e(i(n)),c(r||!n||!n.__esModule?t(a,`default`,{value:n,enumerable:!0}):a,n)),u=(e=>typeof require<`u`?require:typeof Proxy<`u`?new Proxy(e,{get:(e,t)=>(typeof require<`u`?require:e)[t]}):e)(function(e){if(typeof require<`u`)return require.apply(this,arguments);throw Error('Calling `require` for "'+e+"\" in an environment that doesn't expose the `require` function.")});(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();var d=o((e=>{var t=Symbol.for(`react.transitional.element`),n=Symbol.for(`react.portal`),r=Symbol.for(`react.fragment`),i=Symbol.for(`react.strict_mode`),a=Symbol.for(`react.profiler`),o=Symbol.for(`react.consumer`),s=Symbol.for(`react.context`),c=Symbol.for(`react.forward_ref`),l=Symbol.for(`react.suspense`),u=Symbol.for(`react.memo`),d=Symbol.for(`react.lazy`),f=Symbol.for(`react.activity`),p=Symbol.iterator;function m(e){return typeof e!=`object`||!e?null:(e=p&&e[p]||e[`@@iterator`],typeof e==`function`?e:null)}var h={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,_={};function v(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||h}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if(typeof e!=`object`&&typeof e!=`function`&&e!=null)throw Error(`takes an object of state variables to update or a function which returns an object of state variables.`);this.updater.enqueueSetState(this,e,t,`setState`)},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,`forceUpdate`)};function y(){}y.prototype=v.prototype;function b(e,t,n){this.props=e,this.context=t,this.refs=_,this.updater=n||h}var x=b.prototype=new y;x.constructor=b,g(x,v.prototype),x.isPureReactComponent=!0;var S=Array.isArray;function C(){}var w={H:null,A:null,T:null,S:null},T=Object.prototype.hasOwnProperty;function E(e,n,r){var i=r.ref;return{$$typeof:t,type:e,key:n,ref:i===void 0?null:i,props:r}}function D(e,t){return E(e.type,t,e.props)}function O(e){return typeof e==`object`&&!!e&&e.$$typeof===t}function k(e){var t={"=":`=0`,":":`=2`};return`$`+e.replace(/[=:]/g,function(e){return t[e]})}var A=/\/+/g;function j(e,t){return typeof e==`object`&&e&&e.key!=null?k(``+e.key):t.toString(36)}function M(e){switch(e.status){case`fulfilled`:return e.value;case`rejected`:throw e.reason;default:switch(typeof e.status==`string`?e.then(C,C):(e.status=`pending`,e.then(function(t){e.status===`pending`&&(e.status=`fulfilled`,e.value=t)},function(t){e.status===`pending`&&(e.status=`rejected`,e.reason=t)})),e.status){case`fulfilled`:return e.value;case`rejected`:throw e.reason}}throw e}function N(e,r,i,a,o){var s=typeof e;(s===`undefined`||s===`boolean`)&&(e=null);var c=!1;if(e===null)c=!0;else switch(s){case`bigint`:case`string`:case`number`:c=!0;break;case`object`:switch(e.$$typeof){case t:case n:c=!0;break;case d:return c=e._init,N(c(e._payload),r,i,a,o)}}if(c)return o=o(e),c=a===``?`.`+j(e,0):a,S(o)?(i=``,c!=null&&(i=c.replace(A,`$&/`)+`/`),N(o,r,i,``,function(e){return e})):o!=null&&(O(o)&&(o=D(o,i+(o.key==null||e&&e.key===o.key?``:(``+o.key).replace(A,`$&/`)+`/`)+c)),r.push(o)),1;c=0;var l=a===``?`.`:a+`:`;if(S(e))for(var u=0;u<e.length;u++)a=e[u],s=l+j(a,u),c+=N(a,r,i,s,o);else if(u=m(e),typeof u==`function`)for(e=u.call(e),u=0;!(a=e.next()).done;)a=a.value,s=l+j(a,u++),c+=N(a,r,i,s,o);else if(s===`object`){if(typeof e.then==`function`)return N(M(e),r,i,a,o);throw r=String(e),Error(`Objects are not valid as a React child (found: `+(r===`[object Object]`?`object with keys {`+Object.keys(e).join(`, `)+`}`:r)+`). If you meant to render a collection of children, use an array instead.`)}return c}function P(e,t,n){if(e==null)return e;var r=[],i=0;return N(e,r,``,``,function(e){return t.call(n,e,i++)}),r}function F(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(t){(e._status===0||e._status===-1)&&(e._status=1,e._result=t)},function(t){(e._status===0||e._status===-1)&&(e._status=2,e._result=t)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var I=typeof reportError==`function`?reportError:function(e){if(typeof window==`object`&&typeof window.ErrorEvent==`function`){var t=new window.ErrorEvent(`error`,{bubbles:!0,cancelable:!0,message:typeof e==`object`&&e&&typeof e.message==`string`?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process==`object`&&typeof process.emit==`function`){process.emit(`uncaughtException`,e);return}console.error(e)},L={map:P,forEach:function(e,t,n){P(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return P(e,function(){t++}),t},toArray:function(e){return P(e,function(e){return e})||[]},only:function(e){if(!O(e))throw Error(`React.Children.only expected to receive a single React element child.`);return e}};e.Activity=f,e.Children=L,e.Component=v,e.Fragment=r,e.Profiler=a,e.PureComponent=b,e.StrictMode=i,e.Suspense=l,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=w,e.__COMPILER_RUNTIME={__proto__:null,c:function(e){return w.H.useMemoCache(e)}},e.cache=function(e){return function(){return e.apply(null,arguments)}},e.cacheSignal=function(){return null},e.cloneElement=function(e,t,n){if(e==null)throw Error(`The argument must be a React element, but you passed `+e+`.`);var r=g({},e.props),i=e.key;if(t!=null)for(a in t.key!==void 0&&(i=``+t.key),t)!T.call(t,a)||a===`key`||a===`__self`||a===`__source`||a===`ref`&&t.ref===void 0||(r[a]=t[a]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var o=Array(a),s=0;s<a;s++)o[s]=arguments[s+2];r.children=o}return E(e.type,i,r)},e.createContext=function(e){return e={$$typeof:s,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},e.Provider=e,e.Consumer={$$typeof:o,_context:e},e},e.createElement=function(e,t,n){var r,i={},a=null;if(t!=null)for(r in t.key!==void 0&&(a=``+t.key),t)T.call(t,r)&&r!==`key`&&r!==`__self`&&r!==`__source`&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var s=Array(o),c=0;c<o;c++)s[c]=arguments[c+2];i.children=s}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return E(e,a,i)},e.createRef=function(){return{current:null}},e.forwardRef=function(e){return{$$typeof:c,render:e}},e.isValidElement=O,e.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:F}},e.memo=function(e,t){return{$$typeof:u,type:e,compare:t===void 0?null:t}},e.startTransition=function(e){var t=w.T,n={};w.T=n;try{var r=e(),i=w.S;i!==null&&i(n,r),typeof r==`object`&&r&&typeof r.then==`function`&&r.then(C,I)}catch(e){I(e)}finally{t!==null&&n.types!==null&&(t.types=n.types),w.T=t}},e.unstable_useCacheRefresh=function(){return w.H.useCacheRefresh()},e.use=function(e){return w.H.use(e)},e.useActionState=function(e,t,n){return w.H.useActionState(e,t,n)},e.useCallback=function(e,t){return w.H.useCallback(e,t)},e.useContext=function(e){return w.H.useContext(e)},e.useDebugValue=function(){},e.useDeferredValue=function(e,t){return w.H.useDeferredValue(e,t)},e.useEffect=function(e,t){return w.H.useEffect(e,t)},e.useEffectEvent=function(e){return w.H.useEffectEvent(e)},e.useId=function(){return w.H.useId()},e.useImperativeHandle=function(e,t,n){return w.H.useImperativeHandle(e,t,n)},e.useInsertionEffect=function(e,t){return w.H.useInsertionEffect(e,t)},e.useLayoutEffect=function(e,t){return w.H.useLayoutEffect(e,t)},e.useMemo=function(e,t){return w.H.useMemo(e,t)},e.useOptimistic=function(e,t){return w.H.useOptimistic(e,t)},e.useReducer=function(e,t,n){return w.H.useReducer(e,t,n)},e.useRef=function(e){return w.H.useRef(e)},e.useState=function(e){return w.H.useState(e)},e.useSyncExternalStore=function(e,t,n){return w.H.useSyncExternalStore(e,t,n)},e.useTransition=function(){return w.H.useTransition()},e.version=`19.2.0`})),f=o(((e,t)=>{t.exports=d()})),p=o((e=>{function t(e,t){var n=e.length;e.push(t);a:for(;0<n;){var r=n-1>>>1,a=e[r];if(0<i(a,t))e[r]=t,e[n]=a,n=r;else break a}}function n(e){return e.length===0?null:e[0]}function r(e){if(e.length===0)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;a:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,c=e[s],l=s+1,u=e[l];if(0>i(c,n))l<a&&0>i(u,c)?(e[r]=u,e[l]=n,r=l):(e[r]=c,e[s]=n,r=s);else if(l<a&&0>i(u,n))e[r]=u,e[l]=n,r=l;else break a}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return n===0?e.id-t.id:n}if(e.unstable_now=void 0,typeof performance==`object`&&typeof performance.now==`function`){var a=performance;e.unstable_now=function(){return a.now()}}else{var o=Date,s=o.now();e.unstable_now=function(){return o.now()-s}}var c=[],l=[],u=1,d=null,f=3,p=!1,m=!1,h=!1,g=!1,_=typeof setTimeout==`function`?setTimeout:null,v=typeof clearTimeout==`function`?clearTimeout:null,y=typeof setImmediate<`u`?setImmediate:null;function b(e){for(var i=n(l);i!==null;){if(i.callback===null)r(l);else if(i.startTime<=e)r(l),i.sortIndex=i.expirationTime,t(c,i);else break;i=n(l)}}function x(e){if(h=!1,b(e),!m)if(n(c)!==null)m=!0,S||(S=!0,O());else{var t=n(l);t!==null&&j(x,t.startTime-e)}}var S=!1,C=-1,w=5,T=-1;function E(){return g?!0:!(e.unstable_now()-T<w)}function D(){if(g=!1,S){var t=e.unstable_now();T=t;var i=!0;try{a:{m=!1,h&&(h=!1,v(C),C=-1),p=!0;var a=f;try{b:{for(b(t),d=n(c);d!==null&&!(d.expirationTime>t&&E());){var o=d.callback;if(typeof o==`function`){d.callback=null,f=d.priorityLevel;var s=o(d.expirationTime<=t);if(t=e.unstable_now(),typeof s==`function`){d.callback=s,b(t),i=!0;break b}d===n(c)&&r(c),b(t)}else r(c);d=n(c)}if(d!==null)i=!0;else{var u=n(l);u!==null&&j(x,u.startTime-t),i=!1}}break a}finally{d=null,f=a,p=!1}i=void 0}}finally{i?O():S=!1}}}var O;if(typeof y==`function`)O=function(){y(D)};else if(typeof MessageChannel<`u`){var k=new MessageChannel,A=k.port2;k.port1.onmessage=D,O=function(){A.postMessage(null)}}else O=function(){_(D,0)};function j(t,n){C=_(function(){t(e.unstable_now())},n)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error(`forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported`):w=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},e.unstable_scheduleCallback=function(r,i,a){var o=e.unstable_now();switch(typeof a==`object`&&a?(a=a.delay,a=typeof a==`number`&&0<a?o+a:o):a=o,r){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return s=a+s,r={id:u++,callback:i,priorityLevel:r,startTime:a,expirationTime:s,sortIndex:-1},a>o?(r.sortIndex=a,t(l,r),n(c)===null&&r===n(l)&&(h?(v(C),C=-1):h=!0,j(x,a-o))):(r.sortIndex=s,t(c,r),m||p||(m=!0,S||(S=!0,O()))),r},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}})),m=o(((e,t)=>{t.exports=p()})),h=o((e=>{var t=f();function n(e){var t=`https://react.dev/errors/`+e;if(1<arguments.length){t+=`?args[]=`+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+=`&args[]=`+encodeURIComponent(arguments[n])}return`Minified React error #`+e+`; visit `+t+` for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`}function r(){}var i={d:{f:r,r:function(){throw Error(n(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for(`react.portal`);function o(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:r==null?null:``+r,children:e,containerInfo:t,implementation:n}}var s=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(e,t){if(e===`font`)return``;if(typeof t==`string`)return t===`use-credentials`?t:``}e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,e.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)throw Error(n(299));return o(e,t,null,r)},e.flushSync=function(e){var t=s.T,n=i.p;try{if(s.T=null,i.p=2,e)return e()}finally{s.T=t,i.p=n,i.d.f()}},e.preconnect=function(e,t){typeof e==`string`&&(t?(t=t.crossOrigin,t=typeof t==`string`?t===`use-credentials`?t:``:void 0):t=null,i.d.C(e,t))},e.prefetchDNS=function(e){typeof e==`string`&&i.d.D(e)},e.preinit=function(e,t){if(typeof e==`string`&&t&&typeof t.as==`string`){var n=t.as,r=c(n,t.crossOrigin),a=typeof t.integrity==`string`?t.integrity:void 0,o=typeof t.fetchPriority==`string`?t.fetchPriority:void 0;n===`style`?i.d.S(e,typeof t.precedence==`string`?t.precedence:void 0,{crossOrigin:r,integrity:a,fetchPriority:o}):n===`script`&&i.d.X(e,{crossOrigin:r,integrity:a,fetchPriority:o,nonce:typeof t.nonce==`string`?t.nonce:void 0})}},e.preinitModule=function(e,t){if(typeof e==`string`)if(typeof t==`object`&&t){if(t.as==null||t.as===`script`){var n=c(t.as,t.crossOrigin);i.d.M(e,{crossOrigin:n,integrity:typeof t.integrity==`string`?t.integrity:void 0,nonce:typeof t.nonce==`string`?t.nonce:void 0})}}else t??i.d.M(e)},e.preload=function(e,t){if(typeof e==`string`&&typeof t==`object`&&t&&typeof t.as==`string`){var n=t.as,r=c(n,t.crossOrigin);i.d.L(e,n,{crossOrigin:r,integrity:typeof t.integrity==`string`?t.integrity:void 0,nonce:typeof t.nonce==`string`?t.nonce:void 0,type:typeof t.type==`string`?t.type:void 0,fetchPriority:typeof t.fetchPriority==`string`?t.fetchPriority:void 0,referrerPolicy:typeof t.referrerPolicy==`string`?t.referrerPolicy:void 0,imageSrcSet:typeof t.imageSrcSet==`string`?t.imageSrcSet:void 0,imageSizes:typeof t.imageSizes==`string`?t.imageSizes:void 0,media:typeof t.media==`string`?t.media:void 0})}},e.preloadModule=function(e,t){if(typeof e==`string`)if(t){var n=c(t.as,t.crossOrigin);i.d.m(e,{as:typeof t.as==`string`&&t.as!==`script`?t.as:void 0,crossOrigin:n,integrity:typeof t.integrity==`string`?t.integrity:void 0})}else i.d.m(e)},e.requestFormReset=function(e){i.d.r(e)},e.unstable_batchedUpdates=function(e,t){return e(t)},e.useFormState=function(e,t,n){return s.H.useFormState(e,t,n)},e.useFormStatus=function(){return s.H.useHostTransitionStatus()},e.version=`19.2.0`})),g=o(((e,t)=>{function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>`u`||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=`function`))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}n(),t.exports=h()})),_=o((e=>{var t=m(),n=f(),r=g();function i(e){var t=`https://react.dev/errors/`+e;if(1<arguments.length){t+=`?args[]=`+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+=`&args[]=`+encodeURIComponent(arguments[n])}return`Minified React error #`+e+`; visit `+t+` for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`}function a(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function o(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function s(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function c(e){if(e.tag===31){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function l(e){if(o(e)!==e)throw Error(i(188))}function u(e){var t=e.alternate;if(!t){if(t=o(e),t===null)throw Error(i(188));return t===e?e:null}for(var n=e,r=t;;){var a=n.return;if(a===null)break;var s=a.alternate;if(s===null){if(r=a.return,r!==null){n=r;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===n)return l(a),e;if(s===r)return l(a),t;s=s.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=s;else{for(var c=!1,u=a.child;u;){if(u===n){c=!0,n=a,r=s;break}if(u===r){c=!0,r=a,n=s;break}u=u.sibling}if(!c){for(u=s.child;u;){if(u===n){c=!0,n=s,r=a;break}if(u===r){c=!0,r=s,n=a;break}u=u.sibling}if(!c)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(n.tag!==3)throw Error(i(188));return n.stateNode.current===n?e:t}function d(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=d(e),t!==null)return t;e=e.sibling}return null}var p=Object.assign,h=Symbol.for(`react.element`),_=Symbol.for(`react.transitional.element`),v=Symbol.for(`react.portal`),y=Symbol.for(`react.fragment`),b=Symbol.for(`react.strict_mode`),x=Symbol.for(`react.profiler`),S=Symbol.for(`react.consumer`),C=Symbol.for(`react.context`),w=Symbol.for(`react.forward_ref`),T=Symbol.for(`react.suspense`),E=Symbol.for(`react.suspense_list`),D=Symbol.for(`react.memo`),O=Symbol.for(`react.lazy`),k=Symbol.for(`react.activity`),A=Symbol.for(`react.memo_cache_sentinel`),j=Symbol.iterator;function M(e){return typeof e!=`object`||!e?null:(e=j&&e[j]||e[`@@iterator`],typeof e==`function`?e:null)}var N=Symbol.for(`react.client.reference`);function P(e){if(e==null)return null;if(typeof e==`function`)return e.$$typeof===N?null:e.displayName||e.name||null;if(typeof e==`string`)return e;switch(e){case y:return`Fragment`;case x:return`Profiler`;case b:return`StrictMode`;case T:return`Suspense`;case E:return`SuspenseList`;case k:return`Activity`}if(typeof e==`object`)switch(e.$$typeof){case v:return`Portal`;case C:return e.displayName||`Context`;case S:return(e._context.displayName||`Context`)+`.Consumer`;case w:var t=e.render;return e=e.displayName,e||=(e=t.displayName||t.name||``,e===``?`ForwardRef`:`ForwardRef(`+e+`)`),e;case D:return t=e.displayName||null,t===null?P(e.type)||`Memo`:t;case O:t=e._payload,e=e._init;try{return P(e(t))}catch{}}return null}var F=Array.isArray,I=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,R={pending:!1,data:null,method:null,action:null},ee=[],te=-1;function ne(e){return{current:e}}function re(e){0>te||(e.current=ee[te],ee[te]=null,te--)}function ie(e,t){te++,ee[te]=e.current,e.current=t}var ae=ne(null),oe=ne(null),z=ne(null),se=ne(null);function ce(e,t){switch(ie(z,t),ie(oe,e),ie(ae,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?nf(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=nf(t),e=rf(t,e);else switch(e){case`svg`:e=1;break;case`math`:e=2;break;default:e=0}}re(ae),ie(ae,e)}function B(){re(ae),re(oe),re(z)}function le(e){e.memoizedState!==null&&ie(se,e);var t=ae.current,n=rf(t,e.type);t!==n&&(ie(oe,e),ie(ae,n))}function ue(e){oe.current===e&&(re(ae),re(oe)),se.current===e&&(re(se),mp._currentValue=R)}var de,fe;function V(e){if(de===void 0)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);de=t&&t[1]||``,fe=-1<e.stack.indexOf(`
    at`)?` (<anonymous>)`:-1<e.stack.indexOf(`@`)?`@unknown:0:0`:``}return`
`+de+e+fe}var H=!1;function U(e,t){if(!e||H)return``;H=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var r={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,`props`,{set:function(){throw Error()}}),typeof Reflect==`object`&&Reflect.construct){try{Reflect.construct(n,[])}catch(e){var r=e}Reflect.construct(e,[],n)}else{try{n.call()}catch(e){r=e}e.call(n.prototype)}}else{try{throw Error()}catch(e){r=e}(n=e())&&typeof n.catch==`function`&&n.catch(function(){})}}catch(e){if(e&&r&&typeof e.stack==`string`)return[e.stack,r.stack]}return[null,null]}};r.DetermineComponentFrameRoot.displayName=`DetermineComponentFrameRoot`;var i=Object.getOwnPropertyDescriptor(r.DetermineComponentFrameRoot,`name`);i&&i.configurable&&Object.defineProperty(r.DetermineComponentFrameRoot,`name`,{value:`DetermineComponentFrameRoot`});var a=r.DetermineComponentFrameRoot(),o=a[0],s=a[1];if(o&&s){var c=o.split(`
`),l=s.split(`
`);for(i=r=0;r<c.length&&!c[r].includes(`DetermineComponentFrameRoot`);)r++;for(;i<l.length&&!l[i].includes(`DetermineComponentFrameRoot`);)i++;if(r===c.length||i===l.length)for(r=c.length-1,i=l.length-1;1<=r&&0<=i&&c[r]!==l[i];)i--;for(;1<=r&&0<=i;r--,i--)if(c[r]!==l[i]){if(r!==1||i!==1)do if(r--,i--,0>i||c[r]!==l[i]){var u=`
`+c[r].replace(` at new `,` at `);return e.displayName&&u.includes(`<anonymous>`)&&(u=u.replace(`<anonymous>`,e.displayName)),u}while(1<=r&&0<=i);break}}}finally{H=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:``)?V(n):``}function pe(e,t){switch(e.tag){case 26:case 27:case 5:return V(e.type);case 16:return V(`Lazy`);case 13:return e.child!==t&&t!==null?V(`Suspense Fallback`):V(`Suspense`);case 19:return V(`SuspenseList`);case 0:case 15:return U(e.type,!1);case 11:return U(e.type.render,!1);case 1:return U(e.type,!0);case 31:return V(`Activity`);default:return``}}function me(e){try{var t=``,n=null;do t+=pe(e,n),n=e,e=e.return;while(e);return t}catch(e){return`
Error generating stack: `+e.message+`
`+e.stack}}var W=Object.prototype.hasOwnProperty,he=t.unstable_scheduleCallback,G=t.unstable_cancelCallback,K=t.unstable_shouldYield,ge=t.unstable_requestPaint,_e=t.unstable_now,q=t.unstable_getCurrentPriorityLevel,ve=t.unstable_ImmediatePriority,ye=t.unstable_UserBlockingPriority,be=t.unstable_NormalPriority,xe=t.unstable_LowPriority,Se=t.unstable_IdlePriority,J=t.log,Ce=t.unstable_setDisableYieldValue,we=null,Te=null;function Y(e){if(typeof J==`function`&&Ce(e),Te&&typeof Te.setStrictMode==`function`)try{Te.setStrictMode(we,e)}catch{}}var Ee=Math.clz32?Math.clz32:ke,De=Math.log,Oe=Math.LN2;function ke(e){return e>>>=0,e===0?32:31-(De(e)/Oe|0)|0}var Ae=256,je=262144,Me=4194304;function Ne(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return e&261888;case 262144:case 524288:case 1048576:case 2097152:return e&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Pe(e,t,n){var r=e.pendingLanes;if(r===0)return 0;var i=0,a=e.suspendedLanes,o=e.pingedLanes;e=e.warmLanes;var s=r&134217727;return s===0?(s=r&~a,s===0?o===0?n||(n=r&~e,n!==0&&(i=Ne(n))):i=Ne(o):i=Ne(s)):(r=s&~a,r===0?(o&=s,o===0?n||(n=s&~e,n!==0&&(i=Ne(n))):i=Ne(o)):i=Ne(r)),i===0?0:t!==0&&t!==i&&(t&a)===0&&(a=i&-i,n=t&-t,a>=n||a===32&&n&4194048)?t:i}function Fe(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function Ie(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Le(){var e=Me;return Me<<=1,!(Me&62914560)&&(Me=4194304),e}function Re(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ze(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Be(e,t,n,r,i,a){var o=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=o&~n;0<n;){var u=31-Ee(n),d=1<<u;s[u]=0,c[u]=-1;var f=l[u];if(f!==null)for(l[u]=null,u=0;u<f.length;u++){var p=f[u];p!==null&&(p.lane&=-536870913)}n&=~d}r!==0&&Ve(e,r,0),a!==0&&i===0&&e.tag!==0&&(e.suspendedLanes|=a&~(o&~t))}function Ve(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var r=31-Ee(t);e.entangledLanes|=t,e.entanglements[r]=e.entanglements[r]|1073741824|n&261930}function He(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Ee(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}function Ue(e,t){var n=t&-t;return n=n&42?1:We(n),(n&(e.suspendedLanes|t))===0?n:0}function We(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function Ge(e){return e&=-e,2<e?8<e?e&134217727?32:268435456:8:2}function Ke(){var e=L.p;return e===0?(e=window.event,e===void 0?32:Ap(e.type)):e}function qe(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var Je=Math.random().toString(36).slice(2),Ye=`__reactFiber$`+Je,Xe=`__reactProps$`+Je,Ze=`__reactContainer$`+Je,Qe=`__reactEvents$`+Je,$e=`__reactListeners$`+Je,et=`__reactHandles$`+Je,tt=`__reactResources$`+Je,nt=`__reactMarker$`+Je;function rt(e){delete e[Ye],delete e[Xe],delete e[Qe],delete e[$e],delete e[et]}function it(e){var t=e[Ye];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ze]||n[Ye]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Df(e);e!==null;){if(n=e[Ye])return n;e=Df(e)}return t}e=n,n=e.parentNode}return null}function at(e){if(e=e[Ye]||e[Ze]){var t=e.tag;if(t===5||t===6||t===13||t===31||t===26||t===27||t===3)return e}return null}function ot(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(i(33))}function st(e){var t=e[tt];return t||=e[tt]={hoistableStyles:new Map,hoistableScripts:new Map},t}function ct(e){e[nt]=!0}var lt=new Set,ut={};function dt(e,t){ft(e,t),ft(e+`Capture`,t)}function ft(e,t){for(ut[e]=t,e=0;e<t.length;e++)lt.add(t[e])}var pt=RegExp(`^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$`),mt={},ht={};function gt(e){return W.call(ht,e)?!0:W.call(mt,e)?!1:pt.test(e)?ht[e]=!0:(mt[e]=!0,!1)}function _t(e,t,n){if(gt(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case`undefined`:case`function`:case`symbol`:e.removeAttribute(t);return;case`boolean`:var r=t.toLowerCase().slice(0,5);if(r!==`data-`&&r!==`aria-`){e.removeAttribute(t);return}}e.setAttribute(t,``+n)}}function vt(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case`undefined`:case`function`:case`symbol`:case`boolean`:e.removeAttribute(t);return}e.setAttribute(t,``+n)}}function yt(e,t,n,r){if(r===null)e.removeAttribute(n);else{switch(typeof r){case`undefined`:case`function`:case`symbol`:case`boolean`:e.removeAttribute(n);return}e.setAttributeNS(t,n,``+r)}}function bt(e){switch(typeof e){case`bigint`:case`boolean`:case`number`:case`string`:case`undefined`:return e;case`object`:return e;default:return``}}function xt(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()===`input`&&(t===`checkbox`||t===`radio`)}function St(e,t,n){var r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&r!==void 0&&typeof r.get==`function`&&typeof r.set==`function`){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=``+e,a.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=``+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ct(e){if(!e._valueTracker){var t=xt(e)?`checked`:`value`;e._valueTracker=St(e,t,``+e[t])}}function wt(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r=``;return e&&(r=xt(e)?e.checked?`true`:`false`:e.value),e=r,e===n?!1:(t.setValue(e),!0)}function Tt(e){if(e||=typeof document<`u`?document:void 0,e===void 0)return null;try{return e.activeElement||e.body}catch{return e.body}}var Et=/[\n"\\]/g;function Dt(e){return e.replace(Et,function(e){return`\\`+e.charCodeAt(0).toString(16)+` `})}function Ot(e,t,n,r,i,a,o,s){e.name=``,o!=null&&typeof o!=`function`&&typeof o!=`symbol`&&typeof o!=`boolean`?e.type=o:e.removeAttribute(`type`),t==null?o!==`submit`&&o!==`reset`||e.removeAttribute(`value`):o===`number`?(t===0&&e.value===``||e.value!=t)&&(e.value=``+bt(t)):e.value!==``+bt(t)&&(e.value=``+bt(t)),t==null?n==null?r!=null&&e.removeAttribute(`value`):At(e,o,bt(n)):At(e,o,bt(t)),i==null&&a!=null&&(e.defaultChecked=!!a),i!=null&&(e.checked=i&&typeof i!=`function`&&typeof i!=`symbol`),s!=null&&typeof s!=`function`&&typeof s!=`symbol`&&typeof s!=`boolean`?e.name=``+bt(s):e.removeAttribute(`name`)}function kt(e,t,n,r,i,a,o,s){if(a!=null&&typeof a!=`function`&&typeof a!=`symbol`&&typeof a!=`boolean`&&(e.type=a),t!=null||n!=null){if(!(a!==`submit`&&a!==`reset`||t!=null)){Ct(e);return}n=n==null?``:``+bt(n),t=t==null?n:``+bt(t),s||t===e.value||(e.value=t),e.defaultValue=t}r??=i,r=typeof r!=`function`&&typeof r!=`symbol`&&!!r,e.checked=s?e.checked:!!r,e.defaultChecked=!!r,o!=null&&typeof o!=`function`&&typeof o!=`symbol`&&typeof o!=`boolean`&&(e.name=o),Ct(e)}function At(e,t,n){t===`number`&&Tt(e.ownerDocument)===e||e.defaultValue===``+n||(e.defaultValue=``+n)}function jt(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t[`$`+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty(`$`+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=``+bt(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Mt(e,t,n){if(t!=null&&(t=``+bt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n==null?``:``+bt(n)}function Nt(e,t,n,r){if(t==null){if(r!=null){if(n!=null)throw Error(i(92));if(F(r)){if(1<r.length)throw Error(i(93));r=r[0]}n=r}n??=``,t=n}n=bt(t),e.defaultValue=n,r=e.textContent,r===n&&r!==``&&r!==null&&(e.value=r),Ct(e)}function Pt(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Ft=new Set(`animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp`.split(` `));function It(e,t,n){var r=t.indexOf(`--`)===0;n==null||typeof n==`boolean`||n===``?r?e.setProperty(t,``):t===`float`?e.cssFloat=``:e[t]=``:r?e.setProperty(t,n):typeof n!=`number`||n===0||Ft.has(t)?t===`float`?e.cssFloat=n:e[t]=(``+n).trim():e[t]=n+`px`}function Lt(e,t,n){if(t!=null&&typeof t!=`object`)throw Error(i(62));if(e=e.style,n!=null){for(var r in n)!n.hasOwnProperty(r)||t!=null&&t.hasOwnProperty(r)||(r.indexOf(`--`)===0?e.setProperty(r,``):r===`float`?e.cssFloat=``:e[r]=``);for(var a in t)r=t[a],t.hasOwnProperty(a)&&n[a]!==r&&It(e,a,r)}else for(var o in t)t.hasOwnProperty(o)&&It(e,o,t[o])}function Rt(e){if(e.indexOf(`-`)===-1)return!1;switch(e){case`annotation-xml`:case`color-profile`:case`font-face`:case`font-face-src`:case`font-face-uri`:case`font-face-format`:case`font-face-name`:case`missing-glyph`:return!1;default:return!0}}var zt=new Map([[`acceptCharset`,`accept-charset`],[`htmlFor`,`for`],[`httpEquiv`,`http-equiv`],[`crossOrigin`,`crossorigin`],[`accentHeight`,`accent-height`],[`alignmentBaseline`,`alignment-baseline`],[`arabicForm`,`arabic-form`],[`baselineShift`,`baseline-shift`],[`capHeight`,`cap-height`],[`clipPath`,`clip-path`],[`clipRule`,`clip-rule`],[`colorInterpolation`,`color-interpolation`],[`colorInterpolationFilters`,`color-interpolation-filters`],[`colorProfile`,`color-profile`],[`colorRendering`,`color-rendering`],[`dominantBaseline`,`dominant-baseline`],[`enableBackground`,`enable-background`],[`fillOpacity`,`fill-opacity`],[`fillRule`,`fill-rule`],[`floodColor`,`flood-color`],[`floodOpacity`,`flood-opacity`],[`fontFamily`,`font-family`],[`fontSize`,`font-size`],[`fontSizeAdjust`,`font-size-adjust`],[`fontStretch`,`font-stretch`],[`fontStyle`,`font-style`],[`fontVariant`,`font-variant`],[`fontWeight`,`font-weight`],[`glyphName`,`glyph-name`],[`glyphOrientationHorizontal`,`glyph-orientation-horizontal`],[`glyphOrientationVertical`,`glyph-orientation-vertical`],[`horizAdvX`,`horiz-adv-x`],[`horizOriginX`,`horiz-origin-x`],[`imageRendering`,`image-rendering`],[`letterSpacing`,`letter-spacing`],[`lightingColor`,`lighting-color`],[`markerEnd`,`marker-end`],[`markerMid`,`marker-mid`],[`markerStart`,`marker-start`],[`overlinePosition`,`overline-position`],[`overlineThickness`,`overline-thickness`],[`paintOrder`,`paint-order`],[`panose-1`,`panose-1`],[`pointerEvents`,`pointer-events`],[`renderingIntent`,`rendering-intent`],[`shapeRendering`,`shape-rendering`],[`stopColor`,`stop-color`],[`stopOpacity`,`stop-opacity`],[`strikethroughPosition`,`strikethrough-position`],[`strikethroughThickness`,`strikethrough-thickness`],[`strokeDasharray`,`stroke-dasharray`],[`strokeDashoffset`,`stroke-dashoffset`],[`strokeLinecap`,`stroke-linecap`],[`strokeLinejoin`,`stroke-linejoin`],[`strokeMiterlimit`,`stroke-miterlimit`],[`strokeOpacity`,`stroke-opacity`],[`strokeWidth`,`stroke-width`],[`textAnchor`,`text-anchor`],[`textDecoration`,`text-decoration`],[`textRendering`,`text-rendering`],[`transformOrigin`,`transform-origin`],[`underlinePosition`,`underline-position`],[`underlineThickness`,`underline-thickness`],[`unicodeBidi`,`unicode-bidi`],[`unicodeRange`,`unicode-range`],[`unitsPerEm`,`units-per-em`],[`vAlphabetic`,`v-alphabetic`],[`vHanging`,`v-hanging`],[`vIdeographic`,`v-ideographic`],[`vMathematical`,`v-mathematical`],[`vectorEffect`,`vector-effect`],[`vertAdvY`,`vert-adv-y`],[`vertOriginX`,`vert-origin-x`],[`vertOriginY`,`vert-origin-y`],[`wordSpacing`,`word-spacing`],[`writingMode`,`writing-mode`],[`xmlnsXlink`,`xmlns:xlink`],[`xHeight`,`x-height`]]),Bt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Vt(e){return Bt.test(``+e)?`javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')`:e}function Ht(){}var Ut=null;function Wt(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gt=null,Kt=null;function qt(e){var t=at(e);if(t&&(e=t.stateNode)){var n=e[Xe]||null;a:switch(e=t.stateNode,t.type){case`input`:if(Ot(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type===`radio`&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll(`input[name="`+Dt(``+t)+`"][type="radio"]`),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=r[Xe]||null;if(!a)throw Error(i(90));Ot(r,a.value,a.defaultValue,a.defaultValue,a.checked,a.defaultChecked,a.type,a.name)}}for(t=0;t<n.length;t++)r=n[t],r.form===e.form&&wt(r)}break a;case`textarea`:Mt(e,n.value,n.defaultValue);break a;case`select`:t=n.value,t!=null&&jt(e,!!n.multiple,t,!1)}}}var Jt=!1;function Yt(e,t,n){if(Jt)return e(t,n);Jt=!0;try{return e(t)}finally{if(Jt=!1,(Gt!==null||Kt!==null)&&(Au(),Gt&&(t=Gt,e=Kt,Kt=Gt=null,qt(t),e)))for(t=0;t<e.length;t++)qt(e[t])}}function Xt(e,t){var n=e.stateNode;if(n===null)return null;var r=n[Xe]||null;if(r===null)return null;n=r[t];a:switch(t){case`onClick`:case`onClickCapture`:case`onDoubleClick`:case`onDoubleClickCapture`:case`onMouseDown`:case`onMouseDownCapture`:case`onMouseMove`:case`onMouseMoveCapture`:case`onMouseUp`:case`onMouseUpCapture`:case`onMouseEnter`:(r=!r.disabled)||(e=e.type,r=!(e===`button`||e===`input`||e===`select`||e===`textarea`)),e=!r;break a;default:e=!1}if(e)return null;if(n&&typeof n!=`function`)throw Error(i(231,t,typeof n));return n}var Zt=!(typeof window>`u`||window.document===void 0||window.document.createElement===void 0),Qt=!1;if(Zt)try{var $t={};Object.defineProperty($t,`passive`,{get:function(){Qt=!0}}),window.addEventListener(`test`,$t,$t),window.removeEventListener(`test`,$t,$t)}catch{Qt=!1}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t=tn,n=t.length,r,i=`value`in en?en.value:en.textContent,a=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[a-r];r++);return nn=i.slice(e,1<r?1-r:void 0)}function an(e){var t=e.keyCode;return`charCode`in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function on(){return!0}function sn(){return!1}function cn(e){function t(t,n,r,i,a){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=a,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented==null?!1===i.returnValue:i.defaultPrevented)?on:sn,this.isPropagationStopped=sn,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():typeof e.returnValue!=`unknown`&&(e.returnValue=!1),this.isDefaultPrevented=on)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():typeof e.cancelBubble!=`unknown`&&(e.cancelBubble=!0),this.isPropagationStopped=on)},persist:function(){},isPersistent:on}),t}var ln={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=cn(ln),dn=p({},ln,{view:0,detail:0}),fn=cn(dn),pn,mn,hn,gn=p({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Mn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return`movementX`in e?e.movementX:(e!==hn&&(hn&&e.type===`mousemove`?(pn=e.screenX-hn.screenX,mn=e.screenY-hn.screenY):mn=pn=0,hn=e),pn)},movementY:function(e){return`movementY`in e?e.movementY:mn}}),_n=cn(gn),vn=p({},gn,{dataTransfer:0}),yn=cn(vn),bn=p({},dn,{relatedTarget:0}),xn=cn(bn),Sn=p({},ln,{animationName:0,elapsedTime:0,pseudoElement:0}),Cn=cn(Sn),wn=p({},ln,{clipboardData:function(e){return`clipboardData`in e?e.clipboardData:window.clipboardData}}),Tn=cn(wn),En=p({},ln,{data:0}),Dn=cn(En),On={Esc:`Escape`,Spacebar:` `,Left:`ArrowLeft`,Up:`ArrowUp`,Right:`ArrowRight`,Down:`ArrowDown`,Del:`Delete`,Win:`OS`,Menu:`ContextMenu`,Apps:`ContextMenu`,Scroll:`ScrollLock`,MozPrintableKey:`Unidentified`},kn={8:`Backspace`,9:`Tab`,12:`Clear`,13:`Enter`,16:`Shift`,17:`Control`,18:`Alt`,19:`Pause`,20:`CapsLock`,27:`Escape`,32:` `,33:`PageUp`,34:`PageDown`,35:`End`,36:`Home`,37:`ArrowLeft`,38:`ArrowUp`,39:`ArrowRight`,40:`ArrowDown`,45:`Insert`,46:`Delete`,112:`F1`,113:`F2`,114:`F3`,115:`F4`,116:`F5`,117:`F6`,118:`F7`,119:`F8`,120:`F9`,121:`F10`,122:`F11`,123:`F12`,144:`NumLock`,145:`ScrollLock`,224:`Meta`},An={Alt:`altKey`,Control:`ctrlKey`,Meta:`metaKey`,Shift:`shiftKey`};function jn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=An[e])?!!t[e]:!1}function Mn(){return jn}var Nn=p({},dn,{key:function(e){if(e.key){var t=On[e.key]||e.key;if(t!==`Unidentified`)return t}return e.type===`keypress`?(e=an(e),e===13?`Enter`:String.fromCharCode(e)):e.type===`keydown`||e.type===`keyup`?kn[e.keyCode]||`Unidentified`:``},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Mn,charCode:function(e){return e.type===`keypress`?an(e):0},keyCode:function(e){return e.type===`keydown`||e.type===`keyup`?e.keyCode:0},which:function(e){return e.type===`keypress`?an(e):e.type===`keydown`||e.type===`keyup`?e.keyCode:0}}),Pn=cn(Nn),Fn=p({},gn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),In=cn(Fn),Ln=p({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Mn}),Rn=cn(Ln),zn=p({},ln,{propertyName:0,elapsedTime:0,pseudoElement:0}),Bn=cn(zn),Vn=p({},gn,{deltaX:function(e){return`deltaX`in e?e.deltaX:`wheelDeltaX`in e?-e.wheelDeltaX:0},deltaY:function(e){return`deltaY`in e?e.deltaY:`wheelDeltaY`in e?-e.wheelDeltaY:`wheelDelta`in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Hn=cn(Vn),X=p({},ln,{newState:0,oldState:0}),Un=cn(X),Wn=[9,13,27,32],Gn=Zt&&`CompositionEvent`in window,Kn=null;Zt&&`documentMode`in document&&(Kn=document.documentMode);var qn=Zt&&`TextEvent`in window&&!Kn,Jn=Zt&&(!Gn||Kn&&8<Kn&&11>=Kn),Yn=` `,Xn=!1;function Zn(e,t){switch(e){case`keyup`:return Wn.indexOf(t.keyCode)!==-1;case`keydown`:return t.keyCode!==229;case`keypress`:case`mousedown`:case`focusout`:return!0;default:return!1}}function Qn(e){return e=e.detail,typeof e==`object`&&`data`in e?e.data:null}var $n=!1;function er(e,t){switch(e){case`compositionend`:return Qn(t);case`keypress`:return t.which===32?(Xn=!0,Yn):null;case`textInput`:return e=t.data,e===Yn&&Xn?null:e;default:return null}}function tr(e,t){if($n)return e===`compositionend`||!Gn&&Zn(e,t)?(e=rn(),nn=tn=en=null,$n=!1,e):null;switch(e){case`paste`:return null;case`keypress`:if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case`compositionend`:return Jn&&t.locale!==`ko`?null:t.data;default:return null}}var nr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t===`input`?!!nr[e.type]:t===`textarea`}function ir(e,t,n,r){Gt?Kt?Kt.push(r):Kt=[r]:Gt=r,t=Bd(t,`onChange`),0<t.length&&(n=new un(`onChange`,`change`,null,n,r),e.push({event:n,listeners:t}))}var ar=null,or=null;function sr(e){Md(e,0)}function cr(e){var t=ot(e);if(wt(t))return e}function lr(e,t){if(e===`change`)return t}var ur=!1;if(Zt){var dr;if(Zt){var fr=`oninput`in document;if(!fr){var pr=document.createElement(`div`);pr.setAttribute(`oninput`,`return;`),fr=typeof pr.oninput==`function`}dr=fr}else dr=!1;ur=dr&&(!document.documentMode||9<document.documentMode)}function mr(){ar&&(ar.detachEvent(`onpropertychange`,hr),or=ar=null)}function hr(e){if(e.propertyName===`value`&&cr(or)){var t=[];ir(t,or,e,Wt(e)),Yt(sr,t)}}function gr(e,t,n){e===`focusin`?(mr(),ar=t,or=n,ar.attachEvent(`onpropertychange`,hr)):e===`focusout`&&mr()}function _r(e){if(e===`selectionchange`||e===`keyup`||e===`keydown`)return cr(or)}function vr(e,t){if(e===`click`)return cr(t)}function yr(e,t){if(e===`input`||e===`change`)return cr(t)}function br(e,t){return e===t&&(e!==0||1/e==1/t)||e!==e&&t!==t}var xr=typeof Object.is==`function`?Object.is:br;function Sr(e,t){if(xr(e,t))return!0;if(typeof e!=`object`||!e||typeof t!=`object`||!t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!W.call(t,i)||!xr(e[i],t[i]))return!1}return!0}function Cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function wr(e,t){var n=Cr(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}a:{for(;n;){if(n.nextSibling){n=n.nextSibling;break a}n=n.parentNode}n=void 0}n=Cr(n)}}function Tr(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Tr(e,t.parentNode):`contains`in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Er(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Tt(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href==`string`}catch{n=!1}if(n)e=t.contentWindow;else break;t=Tt(e.document)}return t}function Dr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t===`input`&&(e.type===`text`||e.type===`search`||e.type===`tel`||e.type===`url`||e.type===`password`)||t===`textarea`||e.contentEditable===`true`)}var Or=Zt&&`documentMode`in document&&11>=document.documentMode,kr=null,Ar=null,jr=null,Mr=!1;function Nr(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Mr||kr==null||kr!==Tt(r)||(r=kr,`selectionStart`in r&&Dr(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),jr&&Sr(jr,r)||(jr=r,r=Bd(Ar,`onSelect`),0<r.length&&(t=new un(`onSelect`,`select`,null,t,n),e.push({event:t,listeners:r}),t.target=kr)))}function Pr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n[`Webkit`+e]=`webkit`+t,n[`Moz`+e]=`moz`+t,n}var Fr={animationend:Pr(`Animation`,`AnimationEnd`),animationiteration:Pr(`Animation`,`AnimationIteration`),animationstart:Pr(`Animation`,`AnimationStart`),transitionrun:Pr(`Transition`,`TransitionRun`),transitionstart:Pr(`Transition`,`TransitionStart`),transitioncancel:Pr(`Transition`,`TransitionCancel`),transitionend:Pr(`Transition`,`TransitionEnd`)},Ir={},Lr={};Zt&&(Lr=document.createElement(`div`).style,`AnimationEvent`in window||(delete Fr.animationend.animation,delete Fr.animationiteration.animation,delete Fr.animationstart.animation),`TransitionEvent`in window||delete Fr.transitionend.transition);function Rr(e){if(Ir[e])return Ir[e];if(!Fr[e])return e;var t=Fr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Lr)return Ir[e]=t[n];return e}var Z=Rr(`animationend`),zr=Rr(`animationiteration`),Br=Rr(`animationstart`),Vr=Rr(`transitionrun`),Hr=Rr(`transitionstart`),Ur=Rr(`transitioncancel`),Wr=Rr(`transitionend`),Gr=new Map,Kr=`abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel`.split(` `);Kr.push(`scrollEnd`);function qr(e,t){Gr.set(e,t),dt(t,[e])}var Jr=typeof reportError==`function`?reportError:function(e){if(typeof window==`object`&&typeof window.ErrorEvent==`function`){var t=new window.ErrorEvent(`error`,{bubbles:!0,cancelable:!0,message:typeof e==`object`&&e&&typeof e.message==`string`?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process==`object`&&typeof process.emit==`function`){process.emit(`uncaughtException`,e);return}console.error(e)},Yr=[],Xr=0,Zr=0;function Qr(){for(var e=Xr,t=Zr=Xr=0;t<e;){var n=Yr[t];Yr[t++]=null;var r=Yr[t];Yr[t++]=null;var i=Yr[t];Yr[t++]=null;var a=Yr[t];if(Yr[t++]=null,r!==null&&i!==null){var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}a!==0&&ni(n,i,a)}}function $r(e,t,n,r){Yr[Xr++]=e,Yr[Xr++]=t,Yr[Xr++]=n,Yr[Xr++]=r,Zr|=r,e.lanes|=r,e=e.alternate,e!==null&&(e.lanes|=r)}function ei(e,t,n,r){return $r(e,t,n,r),ri(e)}function ti(e,t){return $r(e,null,null,t),ri(e)}function ni(e,t,n){e.lanes|=n;var r=e.alternate;r!==null&&(r.lanes|=n);for(var i=!1,a=e.return;a!==null;)a.childLanes|=n,r=a.alternate,r!==null&&(r.childLanes|=n),a.tag===22&&(e=a.stateNode,e===null||e._visibility&1||(i=!0)),e=a,a=a.return;return e.tag===3?(a=e.stateNode,i&&t!==null&&(i=31-Ee(n),e=a.hiddenUpdates,r=e[i],r===null?e[i]=[t]:r.push(t),t.lane=n|536870912),a):null}function ri(e){if(50<xu)throw xu=0,Su=null,Error(i(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var ii={};function ai(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function oi(e,t,n,r){return new ai(e,t,n,r)}function si(e){return e=e.prototype,!(!e||!e.isReactComponent)}function ci(e,t){var n=e.alternate;return n===null?(n=oi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function li(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function ui(e,t,n,r,a,o){var s=0;if(r=e,typeof e==`function`)si(e)&&(s=1);else if(typeof e==`string`)s=ap(e,n,ae.current)?26:e===`html`||e===`head`||e===`body`?27:5;else a:switch(e){case k:return e=oi(31,n,t,a),e.elementType=k,e.lanes=o,e;case y:return di(n.children,a,o,t);case b:s=8,a|=24;break;case x:return e=oi(12,n,t,a|2),e.elementType=x,e.lanes=o,e;case T:return e=oi(13,n,t,a),e.elementType=T,e.lanes=o,e;case E:return e=oi(19,n,t,a),e.elementType=E,e.lanes=o,e;default:if(typeof e==`object`&&e)switch(e.$$typeof){case C:s=10;break a;case S:s=9;break a;case w:s=11;break a;case D:s=14;break a;case O:s=16,r=null;break a}s=29,n=Error(i(130,e===null?`null`:typeof e,``)),r=null}return t=oi(s,n,t,a),t.elementType=e,t.type=r,t.lanes=o,t}function di(e,t,n,r){return e=oi(7,e,r,t),e.lanes=n,e}function fi(e,t,n){return e=oi(6,e,null,t),e.lanes=n,e}function pi(e){var t=oi(18,null,null,0);return t.stateNode=e,t}function mi(e,t,n){return t=oi(4,e.children===null?[]:e.children,e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var hi=new WeakMap;function gi(e,t){if(typeof e==`object`&&e){var n=hi.get(e);return n===void 0?(t={value:e,source:t,stack:me(t)},hi.set(e,t),t):n}return{value:e,source:t,stack:me(t)}}var _i=[],vi=0,yi=null,bi=0,xi=[],Si=0,Ci=null,wi=1,Ti=``;function Ei(e,t){_i[vi++]=bi,_i[vi++]=yi,yi=e,bi=t}function Di(e,t,n){xi[Si++]=wi,xi[Si++]=Ti,xi[Si++]=Ci,Ci=e;var r=wi;e=Ti;var i=32-Ee(r)-1;r&=~(1<<i),n+=1;var a=32-Ee(t)+i;if(30<a){var o=i-i%5;a=(r&(1<<o)-1).toString(32),r>>=o,i-=o,wi=1<<32-Ee(t)+i|n<<i|r,Ti=a+e}else wi=1<<a|n<<i|r,Ti=e}function Oi(e){e.return!==null&&(Ei(e,1),Di(e,1,0))}function ki(e){for(;e===yi;)yi=_i[--vi],_i[vi]=null,bi=_i[--vi],_i[vi]=null;for(;e===Ci;)Ci=xi[--Si],xi[Si]=null,Ti=xi[--Si],xi[Si]=null,wi=xi[--Si],xi[Si]=null}function Ai(e,t){xi[Si++]=wi,xi[Si++]=Ti,xi[Si++]=Ci,wi=t.id,Ti=t.overflow,Ci=e}var ji=null,Mi=null,Ni=!1,Pi=null,Fi=!1,Ii=Error(i(519));function Li(e){var t=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?`text`:`HTML`,``));throw Ui(gi(t,e)),Ii}function Ri(e){var t=e.stateNode,n=e.type,r=e.memoizedProps;switch(t[Ye]=e,t[Xe]=r,n){case`dialog`:Nd(`cancel`,t),Nd(`close`,t);break;case`iframe`:case`object`:case`embed`:Nd(`load`,t);break;case`video`:case`audio`:for(n=0;n<Ad.length;n++)Nd(Ad[n],t);break;case`source`:Nd(`error`,t);break;case`img`:case`image`:case`link`:Nd(`error`,t),Nd(`load`,t);break;case`details`:Nd(`toggle`,t);break;case`input`:Nd(`invalid`,t),kt(t,r.value,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name,!0);break;case`select`:Nd(`invalid`,t);break;case`textarea`:Nd(`invalid`,t),Nt(t,r.value,r.defaultValue,r.children)}n=r.children,typeof n!=`string`&&typeof n!=`number`&&typeof n!=`bigint`||t.textContent===``+n||!0===r.suppressHydrationWarning||Kd(t.textContent,n)?(r.popover!=null&&(Nd(`beforetoggle`,t),Nd(`toggle`,t)),r.onScroll!=null&&Nd(`scroll`,t),r.onScrollEnd!=null&&Nd(`scrollend`,t),r.onClick!=null&&(t.onclick=Ht),t=!0):t=!1,t||Li(e,!0)}function zi(e){for(ji=e.return;ji;)switch(ji.tag){case 5:case 31:case 13:Fi=!1;return;case 27:case 3:Fi=!0;return;default:ji=ji.return}}function Bi(e){if(e!==ji)return!1;if(!Ni)return zi(e),Ni=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!==`form`&&n!==`button`)||af(e.type,e.memoizedProps)),n=!n),n&&Mi&&Li(e),zi(e),t===13){if(e=e.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(317));Mi=Ef(e)}else if(t===31){if(e=e.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(317));Mi=Ef(e)}else t===27?(t=Mi,mf(e.type)?(e=Tf,Tf=null,Mi=e):Mi=t):Mi=ji?wf(e.stateNode.nextSibling):null;return!0}function Vi(){Mi=ji=null,Ni=!1}function Hi(){var e=Pi;return e!==null&&(cu===null?cu=e:cu.push.apply(cu,e),Pi=null),e}function Ui(e){Pi===null?Pi=[e]:Pi.push(e)}var Wi=ne(null),Gi=null,Ki=null;function qi(e,t,n){ie(Wi,t._currentValue),t._currentValue=n}function Ji(e){e._currentValue=Wi.current,re(Wi)}function Yi(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)===t?r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t):(e.childLanes|=t,r!==null&&(r.childLanes|=t)),e===n)break;e=e.return}}function Xi(e,t,n,r){var a=e.child;for(a!==null&&(a.return=e);a!==null;){var o=a.dependencies;if(o!==null){var s=a.child;o=o.firstContext;a:for(;o!==null;){var c=o;o=a;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,c=o.alternate,c!==null&&(c.lanes|=n),Yi(o.return,n,e),r||(s=null);break a}o=c.next}}else if(a.tag===18){if(s=a.return,s===null)throw Error(i(341));s.lanes|=n,o=s.alternate,o!==null&&(o.lanes|=n),Yi(s,n,e),s=null}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===e){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}}function Zi(e,t,n,r){e=null;for(var a=t,o=!1;a!==null;){if(!o){if(a.flags&524288)o=!0;else if(a.flags&262144)break}if(a.tag===10){var s=a.alternate;if(s===null)throw Error(i(387));if(s=s.memoizedProps,s!==null){var c=a.type;xr(a.pendingProps.value,s.value)||(e===null?e=[c]:e.push(c))}}else if(a===se.current){if(s=a.alternate,s===null)throw Error(i(387));s.memoizedState.memoizedState!==a.memoizedState.memoizedState&&(e===null?e=[mp]:e.push(mp))}a=a.return}e!==null&&Xi(t,e,n,r),t.flags|=262144}function Qi(e){for(e=e.firstContext;e!==null;){if(!xr(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function $i(e){Gi=e,Ki=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function ea(e){return na(Gi,e)}function ta(e,t){return Gi===null&&$i(e),na(e,t)}function na(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Ki===null){if(e===null)throw Error(i(308));Ki=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Ki=Ki.next=t;return n}var ra=typeof AbortController<`u`?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},ia=t.unstable_scheduleCallback,aa=t.unstable_NormalPriority,oa={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sa(){return{controller:new ra,data:new Map,refCount:0}}function ca(e){e.refCount--,e.refCount===0&&ia(aa,function(){e.controller.abort()})}var la=null,ua=0,da=0,fa=null;function pa(e,t){if(la===null){var n=la=[];ua=0,da=Sd(),fa={status:`pending`,value:void 0,then:function(e){n.push(e)}}}return ua++,t.then(ma,ma),t}function ma(){if(--ua===0&&la!==null){fa!==null&&(fa.status=`fulfilled`);var e=la;la=null,da=0,fa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function ha(e,t){var n=[],r={status:`pending`,value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){r.status=`fulfilled`,r.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(r.status=`rejected`,r.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),r}var ga=I.S;I.S=function(e,t){du=_e(),typeof t==`object`&&t&&typeof t.then==`function`&&pa(e,t),ga!==null&&ga(e,t)};var _a=ne(null);function va(){var e=_a.current;return e===null?Kl.pooledCache:e}function ya(e,t){t===null?ie(_a,_a.current):ie(_a,t.pool)}function ba(){var e=va();return e===null?null:{parent:oa._currentValue,pool:e}}var xa=Error(i(460)),Sa=Error(i(474)),Ca=Error(i(542)),wa={then:function(){}};function Ta(e){return e=e.status,e===`fulfilled`||e===`rejected`}function Ea(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Ht,Ht),t=n),t.status){case`fulfilled`:return t.value;case`rejected`:throw e=t.reason,Aa(e),e;default:if(typeof t.status==`string`)t.then(Ht,Ht);else{if(e=Kl,e!==null&&100<e.shellSuspendCounter)throw Error(i(482));e=t,e.status=`pending`,e.then(function(e){if(t.status===`pending`){var n=t;n.status=`fulfilled`,n.value=e}},function(e){if(t.status===`pending`){var n=t;n.status=`rejected`,n.reason=e}})}switch(t.status){case`fulfilled`:return t.value;case`rejected`:throw e=t.reason,Aa(e),e}throw Oa=t,xa}}function Da(e){try{var t=e._init;return t(e._payload)}catch(e){throw typeof e==`object`&&e&&typeof e.then==`function`?(Oa=e,xa):e}}var Oa=null;function ka(){if(Oa===null)throw Error(i(459));var e=Oa;return Oa=null,e}function Aa(e){if(e===xa||e===Ca)throw Error(i(483))}var ja=null,Ma=0;function Na(e){var t=Ma;return Ma+=1,ja===null&&(ja=[]),Ea(ja,e,t)}function Pa(e,t){t=t.props.ref,e.ref=t===void 0?null:t}function Fa(e,t){throw t.$$typeof===h?Error(i(525)):(e=Object.prototype.toString.call(t),Error(i(31,e===`[object Object]`?`object with keys {`+Object.keys(t).join(`, `)+`}`:e)))}function Ia(e){function t(t,n){if(e){var r=t.deletions;r===null?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;r!==null;)t(n,r),r=r.sibling;return null}function r(e){for(var t=new Map;e!==null;)e.key===null?t.set(e.index,e):t.set(e.key,e),e=e.sibling;return t}function a(e,t){return e=ci(e,t),e.index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?(r=t.alternate,r===null?(t.flags|=67108866,n):(r=r.index,r<n?(t.flags|=67108866,n):r)):(t.flags|=1048576,n)}function s(t){return e&&t.alternate===null&&(t.flags|=67108866),t}function c(e,t,n,r){return t===null||t.tag!==6?(t=fi(n,e.mode,r),t.return=e,t):(t=a(t,n),t.return=e,t)}function l(e,t,n,r){var i=n.type;return i===y?d(e,t,n.props.children,r,n.key):t!==null&&(t.elementType===i||typeof i==`object`&&i&&i.$$typeof===O&&Da(i)===t.type)?(t=a(t,n.props),Pa(t,n),t.return=e,t):(t=ui(n.type,n.key,n.props,null,e.mode,r),Pa(t,n),t.return=e,t)}function u(e,t,n,r){return t===null||t.tag!==4||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?(t=mi(n,e.mode,r),t.return=e,t):(t=a(t,n.children||[]),t.return=e,t)}function d(e,t,n,r,i){return t===null||t.tag!==7?(t=di(n,e.mode,r,i),t.return=e,t):(t=a(t,n),t.return=e,t)}function f(e,t,n){if(typeof t==`string`&&t!==``||typeof t==`number`||typeof t==`bigint`)return t=fi(``+t,e.mode,n),t.return=e,t;if(typeof t==`object`&&t){switch(t.$$typeof){case _:return n=ui(t.type,t.key,t.props,null,e.mode,n),Pa(n,t),n.return=e,n;case v:return t=mi(t,e.mode,n),t.return=e,t;case O:return t=Da(t),f(e,t,n)}if(F(t)||M(t))return t=di(t,e.mode,n,null),t.return=e,t;if(typeof t.then==`function`)return f(e,Na(t),n);if(t.$$typeof===C)return f(e,ta(e,t),n);Fa(e,t)}return null}function p(e,t,n,r){var i=t===null?null:t.key;if(typeof n==`string`&&n!==``||typeof n==`number`||typeof n==`bigint`)return i===null?c(e,t,``+n,r):null;if(typeof n==`object`&&n){switch(n.$$typeof){case _:return n.key===i?l(e,t,n,r):null;case v:return n.key===i?u(e,t,n,r):null;case O:return n=Da(n),p(e,t,n,r)}if(F(n)||M(n))return i===null?d(e,t,n,r,null):null;if(typeof n.then==`function`)return p(e,t,Na(n),r);if(n.$$typeof===C)return p(e,t,ta(e,n),r);Fa(e,n)}return null}function m(e,t,n,r,i){if(typeof r==`string`&&r!==``||typeof r==`number`||typeof r==`bigint`)return e=e.get(n)||null,c(t,e,``+r,i);if(typeof r==`object`&&r){switch(r.$$typeof){case _:return e=e.get(r.key===null?n:r.key)||null,l(t,e,r,i);case v:return e=e.get(r.key===null?n:r.key)||null,u(t,e,r,i);case O:return r=Da(r),m(e,t,n,r,i)}if(F(r)||M(r))return e=e.get(n)||null,d(t,e,r,i,null);if(typeof r.then==`function`)return m(e,t,n,Na(r),i);if(r.$$typeof===C)return m(e,t,n,ta(t,r),i);Fa(t,r)}return null}function h(i,a,s,c){for(var l=null,u=null,d=a,h=a=0,g=null;d!==null&&h<s.length;h++){d.index>h?(g=d,d=null):g=d.sibling;var _=p(i,d,s[h],c);if(_===null){d===null&&(d=g);break}e&&d&&_.alternate===null&&t(i,d),a=o(_,a,h),u===null?l=_:u.sibling=_,u=_,d=g}if(h===s.length)return n(i,d),Ni&&Ei(i,h),l;if(d===null){for(;h<s.length;h++)d=f(i,s[h],c),d!==null&&(a=o(d,a,h),u===null?l=d:u.sibling=d,u=d);return Ni&&Ei(i,h),l}for(d=r(d);h<s.length;h++)g=m(d,i,h,s[h],c),g!==null&&(e&&g.alternate!==null&&d.delete(g.key===null?h:g.key),a=o(g,a,h),u===null?l=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(i,e)}),Ni&&Ei(i,h),l}function g(a,s,c,l){if(c==null)throw Error(i(151));for(var u=null,d=null,h=s,g=s=0,_=null,v=c.next();h!==null&&!v.done;g++,v=c.next()){h.index>g?(_=h,h=null):_=h.sibling;var y=p(a,h,v.value,l);if(y===null){h===null&&(h=_);break}e&&h&&y.alternate===null&&t(a,h),s=o(y,s,g),d===null?u=y:d.sibling=y,d=y,h=_}if(v.done)return n(a,h),Ni&&Ei(a,g),u;if(h===null){for(;!v.done;g++,v=c.next())v=f(a,v.value,l),v!==null&&(s=o(v,s,g),d===null?u=v:d.sibling=v,d=v);return Ni&&Ei(a,g),u}for(h=r(h);!v.done;g++,v=c.next())v=m(h,a,g,v.value,l),v!==null&&(e&&v.alternate!==null&&h.delete(v.key===null?g:v.key),s=o(v,s,g),d===null?u=v:d.sibling=v,d=v);return e&&h.forEach(function(e){return t(a,e)}),Ni&&Ei(a,g),u}function b(e,r,o,c){if(typeof o==`object`&&o&&o.type===y&&o.key===null&&(o=o.props.children),typeof o==`object`&&o){switch(o.$$typeof){case _:a:{for(var l=o.key;r!==null;){if(r.key===l){if(l=o.type,l===y){if(r.tag===7){n(e,r.sibling),c=a(r,o.props.children),c.return=e,e=c;break a}}else if(r.elementType===l||typeof l==`object`&&l&&l.$$typeof===O&&Da(l)===r.type){n(e,r.sibling),c=a(r,o.props),Pa(c,o),c.return=e,e=c;break a}n(e,r);break}else t(e,r);r=r.sibling}o.type===y?(c=di(o.props.children,e.mode,c,o.key),c.return=e,e=c):(c=ui(o.type,o.key,o.props,null,e.mode,c),Pa(c,o),c.return=e,e=c)}return s(e);case v:a:{for(l=o.key;r!==null;){if(r.key===l)if(r.tag===4&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),c=a(r,o.children||[]),c.return=e,e=c;break a}else{n(e,r);break}else t(e,r);r=r.sibling}c=mi(o,e.mode,c),c.return=e,e=c}return s(e);case O:return o=Da(o),b(e,r,o,c)}if(F(o))return h(e,r,o,c);if(M(o)){if(l=M(o),typeof l!=`function`)throw Error(i(150));return o=l.call(o),g(e,r,o,c)}if(typeof o.then==`function`)return b(e,r,Na(o),c);if(o.$$typeof===C)return b(e,r,ta(e,o),c);Fa(e,o)}return typeof o==`string`&&o!==``||typeof o==`number`||typeof o==`bigint`?(o=``+o,r!==null&&r.tag===6?(n(e,r.sibling),c=a(r,o),c.return=e,e=c):(n(e,r),c=fi(o,e.mode,c),c.return=e,e=c),s(e)):n(e,r)}return function(e,t,n,r){try{Ma=0;var i=b(e,t,n,r);return ja=null,i}catch(t){if(t===xa||t===Ca)throw t;var a=oi(29,t,null,e.mode);return a.lanes=r,a.return=e,a}}}var La=Ia(!0),Ra=Ia(!1),za=!1;function Ba(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Va(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Ha(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Ua(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Gl&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,t=ri(e),ni(e,null,n),t}return $r(e,r,t,n),ri(e)}function Wa(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,n&4194048)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,He(e,n)}}function Ga(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var o={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};a===null?i=a=o:a=a.next=o,n=n.next}while(n!==null);a===null?i=a=t:a=a.next=t}else i=a=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:r.shared,callbacks:r.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Ka=!1;function qa(){if(Ka){var e=fa;if(e!==null)throw e}}function Ja(e,t,n,r){Ka=!1;var i=e.updateQueue;za=!1;var a=i.firstBaseUpdate,o=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var c=s,l=c.next;c.next=null,o===null?a=l:o.next=l,o=c;var u=e.alternate;u!==null&&(u=u.updateQueue,s=u.lastBaseUpdate,s!==o&&(s===null?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(a!==null){var d=i.baseState;o=0,u=l=c=null,s=a;do{var f=s.lane&-536870913,m=f!==s.lane;if(m?(Jl&f)===f:(r&f)===f){f!==0&&f===da&&(Ka=!0),u!==null&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});a:{var h=e,g=s;f=t;var _=n;switch(g.tag){case 1:if(h=g.payload,typeof h==`function`){d=h.call(_,d,f);break a}d=h;break a;case 3:h.flags=h.flags&-65537|128;case 0:if(h=g.payload,f=typeof h==`function`?h.call(_,d,f):h,f==null)break a;d=p({},d,f);break a;case 2:za=!0}}f=s.callback,f!==null&&(e.flags|=64,m&&(e.flags|=8192),m=i.callbacks,m===null?i.callbacks=[f]:m.push(f))}else m={lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},u===null?(l=u=m,c=d):u=u.next=m,o|=f;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;m=s,s=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(1);u===null&&(c=d),i.baseState=c,i.firstBaseUpdate=l,i.lastBaseUpdate=u,a===null&&(i.shared.lanes=0),nu|=o,e.lanes=o,e.memoizedState=d}}function Ya(e,t){if(typeof e!=`function`)throw Error(i(191,e));e.call(t)}function Xa(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Ya(n[e],t)}var Za=ne(null),Qa=ne(0);function $a(e,t){e=eu,ie(Qa,e),ie(Za,t),eu=e|t.baseLanes}function eo(){ie(Qa,eu),ie(Za,Za.current)}function to(){eu=Qa.current,re(Za),re(Qa)}var no=ne(null),ro=null;function io(e){var t=e.alternate;ie(lo,lo.current&1),ie(no,e),ro===null&&(t===null||Za.current!==null||t.memoizedState!==null)&&(ro=e)}function ao(e){ie(lo,lo.current),ie(no,e),ro===null&&(ro=e)}function oo(e){e.tag===22?(ie(lo,lo.current),ie(no,e),ro===null&&(ro=e)):so(e)}function so(){ie(lo,lo.current),ie(no,no.current)}function co(e){re(no),ro===e&&(ro=null),re(lo)}var lo=ne(0);function uo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||xf(n)||Sf(n)))return t}else if(t.tag===19&&(t.memoizedProps.revealOrder===`forwards`||t.memoizedProps.revealOrder===`backwards`||t.memoizedProps.revealOrder===`unstable_legacy-backwards`||t.memoizedProps.revealOrder===`together`)){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var fo=0,po=null,mo=null,ho=null,go=!1,_o=!1,vo=!1,yo=0,bo=0,xo=null,So=0;function Co(){throw Error(i(321))}function wo(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!xr(e[n],t[n]))return!1;return!0}function To(e,t,n,r,i,a){return fo=a,po=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,I.H=e===null||e.memoizedState===null?Ws:Gs,vo=!1,a=n(r,i),vo=!1,_o&&(a=Do(t,n,r,i)),Eo(e),a}function Eo(e){I.H=Us;var t=mo!==null&&mo.next!==null;if(fo=0,ho=mo=po=null,go=!1,bo=0,xo=null,t)throw Error(i(300));e===null||sc||(e=e.dependencies,e!==null&&Qi(e)&&(sc=!0))}function Do(e,t,n,r){po=e;var a=0;do{if(_o&&(xo=null),bo=0,_o=!1,25<=a)throw Error(i(301));if(a+=1,ho=mo=null,e.updateQueue!=null){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,o.memoCache!=null&&(o.memoCache.index=0)}I.H=Ks,o=t(n,r)}while(_o);return o}function Oo(){var e=I.H,t=e.useState()[0];return t=typeof t.then==`function`?Fo(t):t,e=e.useState()[0],(mo===null?null:mo.memoizedState)!==e&&(po.flags|=1024),t}function ko(){var e=yo!==0;return yo=0,e}function Ao(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function jo(e){if(go){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}go=!1}fo=0,ho=mo=po=null,_o=!1,bo=yo=0,xo=null}function Mo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ho===null?po.memoizedState=ho=e:ho=ho.next=e,ho}function No(){if(mo===null){var e=po.alternate;e=e===null?null:e.memoizedState}else e=mo.next;var t=ho===null?po.memoizedState:ho.next;if(t!==null)ho=t,mo=e;else{if(e===null)throw po.alternate===null?Error(i(467)):Error(i(310));mo=e,e={memoizedState:mo.memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},ho===null?po.memoizedState=ho=e:ho=ho.next=e}return ho}function Po(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Fo(e){var t=bo;return bo+=1,xo===null&&(xo=[]),e=Ea(xo,e,t),t=po,(ho===null?t.memoizedState:ho.next)===null&&(t=t.alternate,I.H=t===null||t.memoizedState===null?Ws:Gs),e}function Io(e){if(typeof e==`object`&&e){if(typeof e.then==`function`)return Fo(e);if(e.$$typeof===C)return ea(e)}throw Error(i(438,String(e)))}function Lo(e){var t=null,n=po.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var r=po.alternate;r!==null&&(r=r.updateQueue,r!==null&&(r=r.memoCache,r!=null&&(t={data:r.data.map(function(e){return e.slice()}),index:0})))}if(t??={data:[],index:0},n===null&&(n=Po(),po.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),r=0;r<e;r++)n[r]=A;return t.index++,n}function Ro(e,t){return typeof t==`function`?t(e):t}function zo(e){var t=No();return Bo(t,mo,e)}function Bo(e,t,n){var r=e.queue;if(r===null)throw Error(i(311));r.lastRenderedReducer=n;var a=e.baseQueue,o=r.pending;if(o!==null){if(a!==null){var s=a.next;a.next=o.next,o.next=s}t.baseQueue=a=o,r.pending=null}if(o=e.baseState,a===null)e.memoizedState=o;else{t=a.next;var c=s=null,l=null,u=t,d=!1;do{var f=u.lane&-536870913;if(f===u.lane?(fo&f)===f:(Jl&f)===f){var p=u.revertLane;if(p===0)l!==null&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),f===da&&(d=!0);else if((fo&p)===p){u=u.next,p===da&&(d=!0);continue}else f={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(c=l=f,s=o):l=l.next=f,po.lanes|=p,nu|=p;f=u.action,vo&&n(o,f),o=u.hasEagerState?u.eagerState:n(o,f)}else p={lane:f,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},l===null?(c=l=p,s=o):l=l.next=p,po.lanes|=f,nu|=f;u=u.next}while(u!==null&&u!==t);if(l===null?s=o:l.next=c,!xr(o,e.memoizedState)&&(sc=!0,d&&(n=fa,n!==null)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,r.lastRenderedState=o}return a===null&&(r.lanes=0),[e.memoizedState,r.dispatch]}function Vo(e){var t=No(),n=t.queue;if(n===null)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(a!==null){n.pending=null;var s=a=a.next;do o=e(o,s.action),s=s.next;while(s!==a);xr(o,t.memoizedState)||(sc=!0),t.memoizedState=o,t.baseQueue===null&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ho(e,t,n){var r=po,a=No(),o=Ni;if(o){if(n===void 0)throw Error(i(407));n=n()}else n=t();var s=!xr((mo||a).memoizedState,n);if(s&&(a.memoizedState=n,sc=!0),a=a.queue,hs(Go.bind(null,r,a,e),[e]),a.getSnapshot!==t||s||ho!==null&&ho.memoizedState.tag&1){if(r.flags|=2048,us(9,{destroy:void 0},Wo.bind(null,r,a,n,t),null),Kl===null)throw Error(i(349));o||fo&127||Uo(r,t,n)}return n}function Uo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=po.updateQueue,t===null?(t=Po(),po.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Wo(e,t,n,r){t.value=n,t.getSnapshot=r,Ko(t)&&qo(e)}function Go(e,t,n){return n(function(){Ko(t)&&qo(e)})}function Ko(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!xr(e,n)}catch{return!0}}function qo(e){var t=ti(e,2);t!==null&&Tu(t,e,2)}function Jo(e){var t=Mo();if(typeof e==`function`){var n=e;if(e=n(),vo){Y(!0);try{n()}finally{Y(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:e},t}function Yo(e,t,n,r){return e.baseState=n,Bo(e,mo,typeof r==`function`?r:Ro)}function Xo(e,t,n,r,a){if(Bs(e))throw Error(i(485));if(e=t.action,e!==null){var o={payload:a,action:e,next:null,isTransition:!0,status:`pending`,value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};I.T===null?o.isTransition=!1:n(!0),r(o),n=t.pending,n===null?(o.next=t.pending=o,Zo(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Zo(e,t){var n=t.action,r=t.payload,i=e.state;if(t.isTransition){var a=I.T,o={};I.T=o;try{var s=n(i,r),c=I.S;c!==null&&c(o,s),Qo(e,t,s)}catch(n){es(e,t,n)}finally{a!==null&&o.types!==null&&(a.types=o.types),I.T=a}}else try{a=n(i,r),Qo(e,t,a)}catch(n){es(e,t,n)}}function Qo(e,t,n){typeof n==`object`&&n&&typeof n.then==`function`?n.then(function(n){$o(e,t,n)},function(n){return es(e,t,n)}):$o(e,t,n)}function $o(e,t,n){t.status=`fulfilled`,t.value=n,ts(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Zo(e,n)))}function es(e,t,n){var r=e.pending;if(e.pending=null,r!==null){r=r.next;do t.status=`rejected`,t.reason=n,ts(t),t=t.next;while(t!==r)}e.action=null}function ts(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function ns(e,t){return t}function rs(e,t){if(Ni){var n=Kl.formState;if(n!==null){a:{var r=po;if(Ni){if(Mi){b:{for(var i=Mi,a=Fi;i.nodeType!==8;){if(!a){i=null;break b}if(i=wf(i.nextSibling),i===null){i=null;break b}}a=i.data,i=a===`F!`||a===`F`?i:null}if(i){Mi=wf(i.nextSibling),r=i.data===`F!`;break a}}Li(r)}r=!1}r&&(t=n[0])}}return n=Mo(),n.memoizedState=n.baseState=t,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ns,lastRenderedState:t},n.queue=r,n=Ls.bind(null,po,r),r.dispatch=n,r=Jo(!1),a=zs.bind(null,po,!1,r.queue),r=Mo(),i={state:t,dispatch:null,action:e,pending:null},r.queue=i,n=Xo.bind(null,po,i,a,n),i.dispatch=n,r.memoizedState=e,[t,n,!1]}function os(e){var t=No();return ss(t,mo,e)}function ss(e,t,n){if(t=Bo(e,t,ns)[0],e=zo(Ro)[0],typeof t==`object`&&t&&typeof t.then==`function`)try{var r=Fo(t)}catch(e){throw e===xa?Ca:e}else r=t;t=No();var i=t.queue,a=i.dispatch;return n!==t.memoizedState&&(po.flags|=2048,us(9,{destroy:void 0},cs.bind(null,i,n),null)),[r,a,e]}function cs(e,t){e.action=t}function ls(e){var t=No(),n=mo;if(n!==null)return ss(t,n,e);No(),t=t.memoizedState,n=No();var r=n.queue.dispatch;return n.memoizedState=e,[t,r,!1]}function us(e,t,n,r){return e={tag:e,create:n,deps:r,inst:t,next:null},t=po.updateQueue,t===null&&(t=Po(),po.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ds(){return No().memoizedState}function fs(e,t,n,r){var i=Mo();po.flags|=e,i.memoizedState=us(1|t,{destroy:void 0},n,r===void 0?null:r)}function ps(e,t,n,r){var i=No();r=r===void 0?null:r;var a=i.memoizedState.inst;mo!==null&&r!==null&&wo(r,mo.memoizedState.deps)?i.memoizedState=us(t,a,n,r):(po.flags|=e,i.memoizedState=us(1|t,a,n,r))}function ms(e,t){fs(8390656,8,e,t)}function hs(e,t){ps(2048,8,e,t)}function gs(e){po.flags|=4;var t=po.updateQueue;if(t===null)t=Po(),po.updateQueue=t,t.events=[e];else{var n=t.events;n===null?t.events=[e]:n.push(e)}}function _s(e){var t=No().memoizedState;return gs({ref:t,nextImpl:e}),function(){if(Gl&2)throw Error(i(440));return t.impl.apply(void 0,arguments)}}function vs(e,t){return ps(4,2,e,t)}function ys(e,t){return ps(4,4,e,t)}function bs(e,t){if(typeof t==`function`){e=e();var n=t(e);return function(){typeof n==`function`?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function xs(e,t,n){n=n==null?null:n.concat([e]),ps(4,4,bs.bind(null,t,e),n)}function Ss(){}function Cs(e,t){var n=No();t=t===void 0?null:t;var r=n.memoizedState;return t!==null&&wo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function ws(e,t){var n=No();t=t===void 0?null:t;var r=n.memoizedState;if(t!==null&&wo(t,r[1]))return r[0];if(r=e(),vo){Y(!0);try{e()}finally{Y(!1)}}return n.memoizedState=[r,t],r}function Ts(e,t,n){return n===void 0||fo&1073741824&&!(Jl&261930)?e.memoizedState=t:(e.memoizedState=n,e=wu(),po.lanes|=e,nu|=e,n)}function Es(e,t,n,r){return xr(n,t)?n:Za.current===null?!(fo&42)||fo&1073741824&&!(Jl&261930)?(sc=!0,e.memoizedState=n):(e=wu(),po.lanes|=e,nu|=e,t):(e=Ts(e,n,r),xr(e,t)||(sc=!0),e)}function Ds(e,t,n,r,i){var a=L.p;L.p=a!==0&&8>a?a:8;var o=I.T,s={};I.T=s,zs(e,!1,t,n);try{var c=i(),l=I.S;if(l!==null&&l(s,c),typeof c==`object`&&c&&typeof c.then==`function`){var u=ha(c,r);Rs(e,t,u,Cu(e))}else Rs(e,t,r,Cu(e))}catch(n){Rs(e,t,{then:function(){},status:`rejected`,reason:n},Cu())}finally{L.p=a,o!==null&&s.types!==null&&(o.types=s.types),I.T=o}}function Os(){}function ks(e,t,n,r){if(e.tag!==5)throw Error(i(476));var a=As(e).queue;Ds(e,a,t,R,n===null?Os:function(){return js(e),n(r)})}function As(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:R,baseState:R,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:R},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ro,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function js(e){var t=As(e);t.next===null&&(t=e.alternate.memoizedState),Rs(e,t.next.queue,{},Cu())}function Ms(){return ea(mp)}function Ns(){return No().memoizedState}function Ps(){return No().memoizedState}function Fs(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Cu();e=Ha(n);var r=Ua(t,e,n);r!==null&&(Tu(r,t,n),Wa(r,t,n)),t={cache:sa()},e.payload=t;return}t=t.return}}function Is(e,t,n){var r=Cu();n={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},Bs(e)?Vs(t,n):(n=ei(e,t,n,r),n!==null&&(Tu(n,e,r),Hs(n,t,r)))}function Ls(e,t,n){var r=Cu();Rs(e,t,n,r)}function Rs(e,t,n,r){var i={lane:r,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(Bs(e))Vs(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var o=t.lastRenderedState,s=a(o,n);if(i.hasEagerState=!0,i.eagerState=s,xr(s,o))return $r(e,t,i,0),Kl===null&&Qr(),!1}catch{}if(n=ei(e,t,i,r),n!==null)return Tu(n,e,r),Hs(n,t,r),!0}return!1}function zs(e,t,n,r){if(r={lane:2,revertLane:Sd(),gesture:null,action:r,hasEagerState:!1,eagerState:null,next:null},Bs(e)){if(t)throw Error(i(479))}else t=ei(e,n,r,2),t!==null&&Tu(t,e,2)}function Bs(e){var t=e.alternate;return e===po||t!==null&&t===po}function Vs(e,t){_o=go=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Hs(e,t,n){if(n&4194048){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,He(e,n)}}var Us={readContext:ea,use:Io,useCallback:Co,useContext:Co,useEffect:Co,useImperativeHandle:Co,useLayoutEffect:Co,useInsertionEffect:Co,useMemo:Co,useReducer:Co,useRef:Co,useState:Co,useDebugValue:Co,useDeferredValue:Co,useTransition:Co,useSyncExternalStore:Co,useId:Co,useHostTransitionStatus:Co,useFormState:Co,useActionState:Co,useOptimistic:Co,useMemoCache:Co,useCacheRefresh:Co};Us.useEffectEvent=Co;var Ws={readContext:ea,use:Io,useCallback:function(e,t){return Mo().memoizedState=[e,t===void 0?null:t],e},useContext:ea,useEffect:ms,useImperativeHandle:function(e,t,n){n=n==null?null:n.concat([e]),fs(4194308,4,bs.bind(null,t,e),n)},useLayoutEffect:function(e,t){return fs(4194308,4,e,t)},useInsertionEffect:function(e,t){fs(4,2,e,t)},useMemo:function(e,t){var n=Mo();t=t===void 0?null:t;var r=e();if(vo){Y(!0);try{e()}finally{Y(!1)}}return n.memoizedState=[r,t],r},useReducer:function(e,t,n){var r=Mo();if(n!==void 0){var i=n(t);if(vo){Y(!0);try{n(t)}finally{Y(!1)}}}else i=t;return r.memoizedState=r.baseState=i,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:i},r.queue=e,e=e.dispatch=Is.bind(null,po,e),[r.memoizedState,e]},useRef:function(e){var t=Mo();return e={current:e},t.memoizedState=e},useState:function(e){e=Jo(e);var t=e.queue,n=Ls.bind(null,po,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Ss,useDeferredValue:function(e,t){var n=Mo();return Ts(n,e,t)},useTransition:function(){var e=Jo(!1);return e=Ds.bind(null,po,e.queue,!0,!1),Mo().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var r=po,a=Mo();if(Ni){if(n===void 0)throw Error(i(407));n=n()}else{if(n=t(),Kl===null)throw Error(i(349));Jl&127||Uo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,ms(Go.bind(null,r,o,e),[e]),r.flags|=2048,us(9,{destroy:void 0},Wo.bind(null,r,o,n,t),null),n},useId:function(){var e=Mo(),t=Kl.identifierPrefix;if(Ni){var n=Ti,r=wi;n=(r&~(1<<32-Ee(r)-1)).toString(32)+n,t=`_`+t+`R_`+n,n=yo++,0<n&&(t+=`H`+n.toString(32)),t+=`_`}else n=So++,t=`_`+t+`r_`+n.toString(32)+`_`;return e.memoizedState=t},useHostTransitionStatus:Ms,useFormState:rs,useActionState:rs,useOptimistic:function(e){var t=Mo();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=zs.bind(null,po,!0,n),n.dispatch=t,[e,t]},useMemoCache:Lo,useCacheRefresh:function(){return Mo().memoizedState=Fs.bind(null,po)},useEffectEvent:function(e){var t=Mo(),n={impl:e};return t.memoizedState=n,function(){if(Gl&2)throw Error(i(440));return n.impl.apply(void 0,arguments)}}},Gs={readContext:ea,use:Io,useCallback:Cs,useContext:ea,useEffect:hs,useImperativeHandle:xs,useInsertionEffect:vs,useLayoutEffect:ys,useMemo:ws,useReducer:zo,useRef:ds,useState:function(){return zo(Ro)},useDebugValue:Ss,useDeferredValue:function(e,t){var n=No();return Es(n,mo.memoizedState,e,t)},useTransition:function(){var e=zo(Ro)[0],t=No().memoizedState;return[typeof e==`boolean`?e:Fo(e),t]},useSyncExternalStore:Ho,useId:Ns,useHostTransitionStatus:Ms,useFormState:os,useActionState:os,useOptimistic:function(e,t){var n=No();return Yo(n,mo,e,t)},useMemoCache:Lo,useCacheRefresh:Ps};Gs.useEffectEvent=_s;var Ks={readContext:ea,use:Io,useCallback:Cs,useContext:ea,useEffect:hs,useImperativeHandle:xs,useInsertionEffect:vs,useLayoutEffect:ys,useMemo:ws,useReducer:Vo,useRef:ds,useState:function(){return Vo(Ro)},useDebugValue:Ss,useDeferredValue:function(e,t){var n=No();return mo===null?Ts(n,e,t):Es(n,mo.memoizedState,e,t)},useTransition:function(){var e=Vo(Ro)[0],t=No().memoizedState;return[typeof e==`boolean`?e:Fo(e),t]},useSyncExternalStore:Ho,useId:Ns,useHostTransitionStatus:Ms,useFormState:ls,useActionState:ls,useOptimistic:function(e,t){var n=No();return mo===null?(n.baseState=e,[e,n.queue.dispatch]):Yo(n,mo,e,t)},useMemoCache:Lo,useCacheRefresh:Ps};Ks.useEffectEvent=_s;function qs(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:p({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Js={enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Cu(),i=Ha(r);i.payload=t,n!=null&&(i.callback=n),t=Ua(e,i,r),t!==null&&(Tu(t,e,r),Wa(t,e,r))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Cu(),i=Ha(r);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Ua(e,i,r),t!==null&&(Tu(t,e,r),Wa(t,e,r))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Cu(),r=Ha(n);r.tag=2,t!=null&&(r.callback=t),t=Ua(e,r,n),t!==null&&(Tu(t,e,n),Wa(t,e,n))}};function Ys(e,t,n,r,i,a,o){return e=e.stateNode,typeof e.shouldComponentUpdate==`function`?e.shouldComponentUpdate(r,a,o):t.prototype&&t.prototype.isPureReactComponent?!Sr(n,r)||!Sr(i,a):!0}function Xs(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps==`function`&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps==`function`&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Js.enqueueReplaceState(t,t.state,null)}function Zs(e,t){var n=t;if(`ref`in t)for(var r in n={},t)r!==`ref`&&(n[r]=t[r]);if(e=e.defaultProps)for(var i in n===t&&(n=p({},n)),e)n[i]===void 0&&(n[i]=e[i]);return n}function Qs(e){Jr(e)}function $s(e){console.error(e)}function ec(e){Jr(e)}function tc(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(e){setTimeout(function(){throw e})}}function nc(e,t,n){try{var r=e.onCaughtError;r(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(e){setTimeout(function(){throw e})}}function rc(e,t,n){return n=Ha(n),n.tag=3,n.payload={element:null},n.callback=function(){tc(e,t)},n}function Q(e){return e=Ha(e),e.tag=3,e}function ic(e,t,n,r){var i=n.type.getDerivedStateFromError;if(typeof i==`function`){var a=r.value;e.payload=function(){return i(a)},e.callback=function(){nc(t,n,r)}}var o=n.stateNode;o!==null&&typeof o.componentDidCatch==`function`&&(e.callback=function(){nc(t,n,r),typeof i!=`function`&&($===null?$=new Set([this]):$.add(this));var e=r.stack;this.componentDidCatch(r.value,{componentStack:e===null?``:e})})}function ac(e,t,n,r,a){if(n.flags|=32768,typeof r==`object`&&r&&typeof r.then==`function`){if(t=n.alternate,t!==null&&Zi(t,n,a,!0),n=no.current,n!==null){switch(n.tag){case 31:case 13:return ro===null?Lu():n.alternate===null&&tu===0&&(tu=3),n.flags&=-257,n.flags|=65536,n.lanes=a,r===wa?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([r]):t.add(r),nd(e,r,a)),!1;case 22:return n.flags|=65536,r===wa?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([r])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([r]):n.add(r)),nd(e,r,a)),!1}throw Error(i(435,n.tag))}return nd(e,r,a),Lu(),!1}if(Ni)return t=no.current,t===null?(r!==Ii&&(t=Error(i(423),{cause:r}),Ui(gi(t,n))),e=e.current.alternate,e.flags|=65536,a&=-a,e.lanes|=a,r=gi(r,n),a=rc(e.stateNode,r,a),Ga(e,a),tu!==4&&(tu=2)):(!(t.flags&65536)&&(t.flags|=256),t.flags|=65536,t.lanes=a,r!==Ii&&(e=Error(i(422),{cause:r}),Ui(gi(e,n)))),!1;var o=Error(i(520),{cause:r});if(o=gi(o,n),su===null?su=[o]:su.push(o),tu!==4&&(tu=2),t===null)return!0;r=gi(r,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=a&-a,n.lanes|=e,e=rc(n.stateNode,r,e),Ga(n,e),!1;case 1:if(t=n.type,o=n.stateNode,!(n.flags&128)&&(typeof t.getDerivedStateFromError==`function`||o!==null&&typeof o.componentDidCatch==`function`&&($===null||!$.has(o))))return n.flags|=65536,a&=-a,n.lanes|=a,a=Q(a),ic(a,e,n,r),Ga(n,a),!1}n=n.return}while(n!==null);return!1}var oc=Error(i(461)),sc=!1;function cc(e,t,n,r){t.child=e===null?Ra(t,null,n,r):La(t,e.child,n,r)}function lc(e,t,n,r,i){n=n.render;var a=t.ref;if(`ref`in r){var o={};for(var s in r)s!==`ref`&&(o[s]=r[s])}else o=r;return $i(t),r=To(e,t,n,o,a,i),s=ko(),e!==null&&!sc?(Ao(e,t,i),Nc(e,t,i)):(Ni&&s&&Oi(t),t.flags|=1,cc(e,t,r,i),t.child)}function uc(e,t,n,r,i){if(e===null){var a=n.type;return typeof a==`function`&&!si(a)&&a.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=a,dc(e,t,a,r,i)):(e=ui(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!Pc(e,i)){var o=a.memoizedProps;if(n=n.compare,n=n===null?Sr:n,n(o,r)&&e.ref===t.ref)return Nc(e,t,i)}return t.flags|=1,e=ci(a,r),e.ref=t.ref,e.return=t,t.child=e}function dc(e,t,n,r,i){if(e!==null){var a=e.memoizedProps;if(Sr(a,r)&&e.ref===t.ref)if(sc=!1,t.pendingProps=r=a,Pc(e,i))e.flags&131072&&(sc=!0);else return t.lanes=e.lanes,Nc(e,t,i)}return yc(e,t,n,r,i)}function fc(e,t,n,r){var i=r.children,a=e===null?null:e.memoizedState;if(e===null&&t.stateNode===null&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),r.mode===`hidden`){if(t.flags&128){if(a=a===null?n:a.baseLanes|n,e!==null){for(r=t.child=e.child,i=0;r!==null;)i=i|r.lanes|r.childLanes,r=r.sibling;r=i&~a}else r=0,t.child=null;return mc(e,t,a,n,r)}if(n&536870912)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ya(t,a===null?null:a.cachePool),a===null?eo():$a(t,a),oo(t);else return r=t.lanes=536870912,mc(e,t,a===null?n:a.baseLanes|n,n,r)}else a===null?(e!==null&&ya(t,null),eo(),so(t)):(ya(t,a.cachePool),$a(t,a),so(t),t.memoizedState=null);return cc(e,t,i,n),t.child}function pc(e,t){return e!==null&&e.tag===22||t.stateNode!==null||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function mc(e,t,n,r,i){var a=va();return a=a===null?null:{parent:oa._currentValue,pool:a},t.memoizedState={baseLanes:n,cachePool:a},e!==null&&ya(t,null),eo(),oo(t),e!==null&&Zi(e,t,r,!0),t.childLanes=i,null}function hc(e,t){return t=Oc({mode:t.mode,children:t.children},e.mode),t.ref=e.ref,e.child=t,t.return=e,t}function gc(e,t,n){return La(t,e.child,null,n),e=hc(t,t.pendingProps),e.flags|=2,co(t),t.memoizedState=null,e}function _c(e,t,n){var r=t.pendingProps,a=(t.flags&128)!=0;if(t.flags&=-129,e===null){if(Ni){if(r.mode===`hidden`)return e=hc(t,r),t.lanes=536870912,pc(null,e);if(ao(t),(e=Mi)?(e=bf(e,Fi),e=e!==null&&e.data===`&`?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ci===null?null:{id:wi,overflow:Ti},retryLane:536870912,hydrationErrors:null},n=pi(e),n.return=t,t.child=n,ji=t,Mi=null)):e=null,e===null)throw Li(t);return t.lanes=536870912,null}return hc(t,r)}var o=e.memoizedState;if(o!==null){var s=o.dehydrated;if(ao(t),a)if(t.flags&256)t.flags&=-257,t=gc(e,t,n);else if(t.memoizedState!==null)t.child=e.child,t.flags|=128,t=null;else throw Error(i(558));else if(sc||Zi(e,t,n,!1),a=(n&e.childLanes)!==0,sc||a){if(r=Kl,r!==null&&(s=Ue(r,n),s!==0&&s!==o.retryLane))throw o.retryLane=s,ti(e,s),Tu(r,e,s),oc;Lu(),t=gc(e,t,n)}else e=o.treeContext,Mi=wf(s.nextSibling),ji=t,Ni=!0,Pi=null,Fi=!1,e!==null&&Ai(t,e),t=hc(t,r),t.flags|=4096;return t}return e=ci(e.child,{mode:r.mode,children:r.children}),e.ref=t.ref,t.child=e,e.return=t,e}function vc(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!=`function`&&typeof n!=`object`)throw Error(i(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function yc(e,t,n,r,i){return $i(t),n=To(e,t,n,r,void 0,i),r=ko(),e!==null&&!sc?(Ao(e,t,i),Nc(e,t,i)):(Ni&&r&&Oi(t),t.flags|=1,cc(e,t,n,i),t.child)}function bc(e,t,n,r,i,a){return $i(t),t.updateQueue=null,n=Do(t,r,n,i),Eo(e),r=ko(),e!==null&&!sc?(Ao(e,t,a),Nc(e,t,a)):(Ni&&r&&Oi(t),t.flags|=1,cc(e,t,n,a),t.child)}function xc(e,t,n,r,i){if($i(t),t.stateNode===null){var a=ii,o=n.contextType;typeof o==`object`&&o&&(a=ea(o)),a=new n(r,a),t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Js,t.stateNode=a,a._reactInternals=t,a=t.stateNode,a.props=r,a.state=t.memoizedState,a.refs={},Ba(t),o=n.contextType,a.context=typeof o==`object`&&o?ea(o):ii,a.state=t.memoizedState,o=n.getDerivedStateFromProps,typeof o==`function`&&(qs(t,n,o,r),a.state=t.memoizedState),typeof n.getDerivedStateFromProps==`function`||typeof a.getSnapshotBeforeUpdate==`function`||typeof a.UNSAFE_componentWillMount!=`function`&&typeof a.componentWillMount!=`function`||(o=a.state,typeof a.componentWillMount==`function`&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==`function`&&a.UNSAFE_componentWillMount(),o!==a.state&&Js.enqueueReplaceState(a,a.state,null),Ja(t,r,a,i),qa(),a.state=t.memoizedState),typeof a.componentDidMount==`function`&&(t.flags|=4194308),r=!0}else if(e===null){a=t.stateNode;var s=t.memoizedProps,c=Zs(n,s);a.props=c;var l=a.context,u=n.contextType;o=ii,typeof u==`object`&&u&&(o=ea(u));var d=n.getDerivedStateFromProps;u=typeof d==`function`||typeof a.getSnapshotBeforeUpdate==`function`,s=t.pendingProps!==s,u||typeof a.UNSAFE_componentWillReceiveProps!=`function`&&typeof a.componentWillReceiveProps!=`function`||(s||l!==o)&&Xs(t,a,r,o),za=!1;var f=t.memoizedState;a.state=f,Ja(t,r,a,i),qa(),l=t.memoizedState,s||f!==l||za?(typeof d==`function`&&(qs(t,n,d,r),l=t.memoizedState),(c=za||Ys(t,n,c,r,f,l,o))?(u||typeof a.UNSAFE_componentWillMount!=`function`&&typeof a.componentWillMount!=`function`||(typeof a.componentWillMount==`function`&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount==`function`&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount==`function`&&(t.flags|=4194308)):(typeof a.componentDidMount==`function`&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=o,r=c):(typeof a.componentDidMount==`function`&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Va(e,t),o=t.memoizedProps,u=Zs(n,o),a.props=u,d=t.pendingProps,f=a.context,l=n.contextType,c=ii,typeof l==`object`&&l&&(c=ea(l)),s=n.getDerivedStateFromProps,(l=typeof s==`function`||typeof a.getSnapshotBeforeUpdate==`function`)||typeof a.UNSAFE_componentWillReceiveProps!=`function`&&typeof a.componentWillReceiveProps!=`function`||(o!==d||f!==c)&&Xs(t,a,r,c),za=!1,f=t.memoizedState,a.state=f,Ja(t,r,a,i),qa();var p=t.memoizedState;o!==d||f!==p||za||e!==null&&e.dependencies!==null&&Qi(e.dependencies)?(typeof s==`function`&&(qs(t,n,s,r),p=t.memoizedState),(u=za||Ys(t,n,u,r,f,p,c)||e!==null&&e.dependencies!==null&&Qi(e.dependencies))?(l||typeof a.UNSAFE_componentWillUpdate!=`function`&&typeof a.componentWillUpdate!=`function`||(typeof a.componentWillUpdate==`function`&&a.componentWillUpdate(r,p,c),typeof a.UNSAFE_componentWillUpdate==`function`&&a.UNSAFE_componentWillUpdate(r,p,c)),typeof a.componentDidUpdate==`function`&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate==`function`&&(t.flags|=1024)):(typeof a.componentDidUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=c,r=u):(typeof a.componentDidUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!=`function`||o===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return a=r,vc(e,t),r=(t.flags&128)!=0,a||r?(a=t.stateNode,n=r&&typeof n.getDerivedStateFromError!=`function`?null:a.render(),t.flags|=1,e!==null&&r?(t.child=La(t,e.child,null,i),t.child=La(t,null,n,i)):cc(e,t,n,i),t.memoizedState=a.state,e=t.child):e=Nc(e,t,i),e}function Sc(e,t,n,r){return Vi(),t.flags|=256,cc(e,t,n,r),t.child}var Cc={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function wc(e){return{baseLanes:e,cachePool:ba()}}function Tc(e,t,n){return e=e===null?0:e.childLanes&~n,t&&(e|=au),e}function Ec(e,t,n){var r=t.pendingProps,a=!1,o=(t.flags&128)!=0,s;if((s=o)||(s=e!==null&&e.memoizedState===null?!1:(lo.current&2)!=0),s&&(a=!0,t.flags&=-129),s=(t.flags&32)!=0,t.flags&=-33,e===null){if(Ni){if(a?io(t):so(t),(e=Mi)?(e=bf(e,Fi),e=e!==null&&e.data!==`&`?e:null,e!==null&&(t.memoizedState={dehydrated:e,treeContext:Ci===null?null:{id:wi,overflow:Ti},retryLane:536870912,hydrationErrors:null},n=pi(e),n.return=t,t.child=n,ji=t,Mi=null)):e=null,e===null)throw Li(t);return Sf(e)?t.lanes=32:t.lanes=536870912,null}var c=r.children;return r=r.fallback,a?(so(t),a=t.mode,c=Oc({mode:`hidden`,children:c},a),r=di(r,a,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,r=t.child,r.memoizedState=wc(n),r.childLanes=Tc(e,s,n),t.memoizedState=Cc,pc(null,r)):(io(t),Dc(t,c))}var l=e.memoizedState;if(l!==null&&(c=l.dehydrated,c!==null)){if(o)t.flags&256?(io(t),t.flags&=-257,t=kc(e,t,n)):t.memoizedState===null?(so(t),c=r.fallback,a=t.mode,r=Oc({mode:`visible`,children:r.children},a),c=di(c,a,n,null),c.flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,La(t,e.child,null,n),r=t.child,r.memoizedState=wc(n),r.childLanes=Tc(e,s,n),t.memoizedState=Cc,t=pc(null,r)):(so(t),t.child=e.child,t.flags|=128,t=null);else if(io(t),Sf(c)){if(s=c.nextSibling&&c.nextSibling.dataset,s)var u=s.dgst;s=u,r=Error(i(419)),r.stack=``,r.digest=s,Ui({value:r,source:null,stack:null}),t=kc(e,t,n)}else if(sc||Zi(e,t,n,!1),s=(n&e.childLanes)!==0,sc||s){if(s=Kl,s!==null&&(r=Ue(s,n),r!==0&&r!==l.retryLane))throw l.retryLane=r,ti(e,r),Tu(s,e,r),oc;xf(c)||Lu(),t=kc(e,t,n)}else xf(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,Mi=wf(c.nextSibling),ji=t,Ni=!0,Pi=null,Fi=!1,e!==null&&Ai(t,e),t=Dc(t,r.children),t.flags|=4096);return t}return a?(so(t),c=r.fallback,a=t.mode,l=e.child,u=l.sibling,r=ci(l,{mode:`hidden`,children:r.children}),r.subtreeFlags=l.subtreeFlags&65011712,u===null?(c=di(c,a,n,null),c.flags|=2):c=ci(u,c),c.return=t,r.return=t,r.sibling=c,t.child=r,pc(null,r),r=t.child,c=e.child.memoizedState,c===null?c=wc(n):(a=c.cachePool,a===null?a=ba():(l=oa._currentValue,a=a.parent===l?a:{parent:l,pool:l}),c={baseLanes:c.baseLanes|n,cachePool:a}),r.memoizedState=c,r.childLanes=Tc(e,s,n),t.memoizedState=Cc,pc(e.child,r)):(io(t),n=e.child,e=n.sibling,n=ci(n,{mode:`visible`,children:r.children}),n.return=t,n.sibling=null,e!==null&&(s=t.deletions,s===null?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n)}function Dc(e,t){return t=Oc({mode:`visible`,children:t},e.mode),t.return=e,e.child=t}function Oc(e,t){return e=oi(22,e,null,t),e.lanes=0,e}function kc(e,t,n){return La(t,e.child,null,n),e=Dc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Ac(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Yi(e.return,t,n)}function jc(e,t,n,r,i,a){var o=e.memoizedState;o===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,treeForkCount:a}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i,o.treeForkCount=a)}function Mc(e,t,n){var r=t.pendingProps,i=r.revealOrder,a=r.tail;r=r.children;var o=lo.current,s=(o&2)!=0;if(s?(o=o&1|2,t.flags|=128):o&=1,ie(lo,o),cc(e,t,r,n),r=Ni?bi:0,!s&&e!==null&&e.flags&128)a:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Ac(e,n,t);else if(e.tag===19)Ac(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break a;for(;e.sibling===null;){if(e.return===null||e.return===t)break a;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(i){case`forwards`:for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&uo(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),jc(t,!1,i,n,a,r);break;case`backwards`:case`unstable_legacy-backwards`:for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&uo(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}jc(t,!0,n,null,a,r);break;case`together`:jc(t,!1,null,null,void 0,r);break;default:t.memoizedState=null}return t.child}function Nc(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),nu|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Zi(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(i(153));if(t.child!==null){for(e=t.child,n=ci(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=ci(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Pc(e,t){return(e.lanes&t)===0?(e=e.dependencies,!!(e!==null&&Qi(e))):!0}function Fc(e,t,n){switch(t.tag){case 3:ce(t,t.stateNode.containerInfo),qi(t,oa,e.memoizedState.cache),Vi();break;case 27:case 5:le(t);break;case 4:ce(t,t.stateNode.containerInfo);break;case 10:qi(t,t.type,t.memoizedProps.value);break;case 31:if(t.memoizedState!==null)return t.flags|=128,ao(t),null;break;case 13:var r=t.memoizedState;if(r!==null)return r.dehydrated===null?(n&t.child.childLanes)===0?(io(t),e=Nc(e,t,n),e===null?null:e.sibling):Ec(e,t,n):(io(t),t.flags|=128,null);io(t);break;case 19:var i=(e.flags&128)!=0;if(r=(n&t.childLanes)!==0,r||=(Zi(e,t,n,!1),(n&t.childLanes)!==0),i){if(r)return Mc(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),ie(lo,lo.current),r)break;return null;case 22:return t.lanes=0,fc(e,t,n,t.pendingProps);case 24:qi(t,oa,e.memoizedState.cache)}return Nc(e,t,n)}function Ic(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)sc=!0;else{if(!Pc(e,n)&&!(t.flags&128))return sc=!1,Fc(e,t,n);sc=!!(e.flags&131072)}else sc=!1,Ni&&t.flags&1048576&&Di(t,bi,t.index);switch(t.lanes=0,t.tag){case 16:a:{var r=t.pendingProps;if(e=Da(t.elementType),t.type=e,typeof e==`function`)si(e)?(r=Zs(e,r),t.tag=1,t=xc(null,t,e,r,n)):(t.tag=0,t=yc(null,t,e,r,n));else{if(e!=null){var a=e.$$typeof;if(a===w){t.tag=11,t=lc(null,t,e,r,n);break a}else if(a===D){t.tag=14,t=uc(null,t,e,r,n);break a}}throw t=P(e)||e,Error(i(306,t,``))}}return t;case 0:return yc(e,t,t.type,t.pendingProps,n);case 1:return r=t.type,a=Zs(r,t.pendingProps),xc(e,t,r,a,n);case 3:a:{if(ce(t,t.stateNode.containerInfo),e===null)throw Error(i(387));r=t.pendingProps;var o=t.memoizedState;a=o.element,Va(e,t),Ja(t,r,null,n);var s=t.memoizedState;if(r=s.cache,qi(t,oa,r),r!==o.cache&&Xi(t,[oa],n,!0),qa(),r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,t.flags&256){t=Sc(e,t,r,n);break a}else if(r!==a){a=gi(Error(i(424)),t),Ui(a),t=Sc(e,t,r,n);break a}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName===`HTML`?e.ownerDocument.body:e}for(Mi=wf(e.firstChild),ji=t,Ni=!0,Pi=null,Fi=!0,n=Ra(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Vi(),r===a){t=Nc(e,t,n);break a}cc(e,t,r,n)}t=t.child}return t;case 26:return vc(e,t),e===null?(n=Gf(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ni||(n=t.type,e=t.pendingProps,r=tf(z.current).createElement(n),r[Ye]=t,r[Xe]=e,Yd(r,n,e),ct(r),t.stateNode=r):t.memoizedState=Gf(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return le(t),e===null&&Ni&&(r=t.stateNode=Of(t.type,t.pendingProps,z.current),ji=t,Fi=!0,a=Mi,mf(t.type)?(Tf=a,Mi=wf(r.firstChild)):Mi=a),cc(e,t,t.pendingProps.children,n),vc(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ni&&((a=r=Mi)&&(r=vf(r,t.type,t.pendingProps,Fi),r===null?a=!1:(t.stateNode=r,ji=t,Mi=wf(r.firstChild),Fi=!1,a=!0)),a||Li(t)),le(t),a=t.type,o=t.pendingProps,s=e===null?null:e.memoizedProps,r=o.children,af(a,o)?r=null:s!==null&&af(a,s)&&(t.flags|=32),t.memoizedState!==null&&(a=To(e,t,Oo,null,null,n),mp._currentValue=a),vc(e,t),cc(e,t,r,n),t.child;case 6:return e===null&&Ni&&((e=n=Mi)&&(n=yf(n,t.pendingProps,Fi),n===null?e=!1:(t.stateNode=n,ji=t,Mi=null,e=!0)),e||Li(t)),null;case 13:return Ec(e,t,n);case 4:return ce(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=La(t,null,r,n):cc(e,t,r,n),t.child;case 11:return lc(e,t,t.type,t.pendingProps,n);case 7:return cc(e,t,t.pendingProps,n),t.child;case 8:return cc(e,t,t.pendingProps.children,n),t.child;case 12:return cc(e,t,t.pendingProps.children,n),t.child;case 10:return r=t.pendingProps,qi(t,t.type,r.value),cc(e,t,r.children,n),t.child;case 9:return a=t.type._context,r=t.pendingProps.children,$i(t),a=ea(a),r=r(a),t.flags|=1,cc(e,t,r,n),t.child;case 14:return uc(e,t,t.type,t.pendingProps,n);case 15:return dc(e,t,t.type,t.pendingProps,n);case 19:return Mc(e,t,n);case 31:return _c(e,t,n);case 22:return fc(e,t,n,t.pendingProps);case 24:return $i(t),r=ea(oa),e===null?(a=va(),a===null&&(a=Kl,o=sa(),a.pooledCache=o,o.refCount++,o!==null&&(a.pooledCacheLanes|=n),a=o),t.memoizedState={parent:r,cache:a},Ba(t),qi(t,oa,a)):((e.lanes&n)!==0&&(Va(e,t),Ja(t,null,null,n),qa()),a=e.memoizedState,o=t.memoizedState,a.parent===r?(r=o.cache,qi(t,oa,r),r!==a.cache&&Xi(t,[oa],n,!0)):(a={parent:r,cache:r},t.memoizedState=a,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=a),qi(t,oa,r))),cc(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(i(156,t.tag))}function Lc(e){e.flags|=4}function Rc(e,t,n,r,i){if((t=(e.mode&32)!=0)&&(t=!1),t){if(e.flags|=16777216,(i&335544128)===i)if(e.stateNode.complete)e.flags|=8192;else if(Pu())e.flags|=8192;else throw Oa=wa,Sa}else e.flags&=-16777217}function zc(e,t){if(t.type!==`stylesheet`||t.state.loading&4)e.flags&=-16777217;else if(e.flags|=16777216,!op(t))if(Pu())e.flags|=8192;else throw Oa=wa,Sa}function Bc(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag===22?536870912:Le(),e.lanes|=t,ou|=t)}function Vc(e,t){if(!Ni)switch(e.tailMode){case`hidden`:t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case`collapsed`:n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Hc(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&65011712,r|=i.flags&65011712,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Uc(e,t,n){var r=t.pendingProps;switch(ki(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hc(t),null;case 1:return Hc(t),null;case 3:return n=t.stateNode,r=null,e!==null&&(r=e.memoizedState.cache),t.memoizedState.cache!==r&&(t.flags|=2048),Ji(oa),B(),n.pendingContext&&=(n.context=n.pendingContext,null),(e===null||e.child===null)&&(Bi(t)?Lc(t):e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Hi())),Hc(t),null;case 26:var a=t.type,o=t.memoizedState;return e===null?(Lc(t),o===null?(Hc(t),Rc(t,a,null,r,n)):(Hc(t),zc(t,o))):o?o===e.memoizedState?(Hc(t),t.flags&=-16777217):(Lc(t),Hc(t),zc(t,o)):(e=e.memoizedProps,e!==r&&Lc(t),Hc(t),Rc(t,a,e,r,n)),null;case 27:if(ue(t),n=z.current,a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Lc(t);else{if(!r){if(t.stateNode===null)throw Error(i(166));return Hc(t),null}e=ae.current,Bi(t)?Ri(t,e):(e=Of(a,r,n),t.stateNode=e,Lc(t))}return Hc(t),null;case 5:if(ue(t),a=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==r&&Lc(t);else{if(!r){if(t.stateNode===null)throw Error(i(166));return Hc(t),null}if(o=ae.current,Bi(t))Ri(t,o);else{var s=tf(z.current);switch(o){case 1:o=s.createElementNS(`http://www.w3.org/2000/svg`,a);break;case 2:o=s.createElementNS(`http://www.w3.org/1998/Math/MathML`,a);break;default:switch(a){case`svg`:o=s.createElementNS(`http://www.w3.org/2000/svg`,a);break;case`math`:o=s.createElementNS(`http://www.w3.org/1998/Math/MathML`,a);break;case`script`:o=s.createElement(`div`),o.innerHTML=`<script><\/script>`,o=o.removeChild(o.firstChild);break;case`select`:o=typeof r.is==`string`?s.createElement(`select`,{is:r.is}):s.createElement(`select`),r.multiple?o.multiple=!0:r.size&&(o.size=r.size);break;default:o=typeof r.is==`string`?s.createElement(a,{is:r.is}):s.createElement(a)}}o[Ye]=t,o[Xe]=r;a:for(s=t.child;s!==null;){if(s.tag===5||s.tag===6)o.appendChild(s.stateNode);else if(s.tag!==4&&s.tag!==27&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break a;for(;s.sibling===null;){if(s.return===null||s.return===t)break a;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;a:switch(Yd(o,a,r),a){case`button`:case`input`:case`select`:case`textarea`:r=!!r.autoFocus;break a;case`img`:r=!0;break a;default:r=!1}r&&Lc(t)}}return Hc(t),Rc(t,t.type,e===null?null:e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==r&&Lc(t);else{if(typeof r!=`string`&&t.stateNode===null)throw Error(i(166));if(e=z.current,Bi(t)){if(e=t.stateNode,n=t.memoizedProps,r=null,a=ji,a!==null)switch(a.tag){case 27:case 5:r=a.memoizedProps}e[Ye]=t,e=!!(e.nodeValue===n||r!==null&&!0===r.suppressHydrationWarning||Kd(e.nodeValue,n)),e||Li(t,!0)}else e=tf(e).createTextNode(r),e[Ye]=t,t.stateNode=e}return Hc(t),null;case 31:if(n=t.memoizedState,e===null||e.memoizedState!==null){if(r=Bi(t),n!==null){if(e===null){if(!r)throw Error(i(318));if(e=t.memoizedState,e=e===null?null:e.dehydrated,!e)throw Error(i(557));e[Ye]=t}else Vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Hc(t),e=!1}else n=Hi(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return t.flags&256?(co(t),t):(co(t),null);if(t.flags&128)throw Error(i(558))}return Hc(t),null;case 13:if(r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(a=Bi(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(i(318));if(a=t.memoizedState,a=a===null?null:a.dehydrated,!a)throw Error(i(317));a[Ye]=t}else Vi(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Hc(t),a=!1}else a=Hi(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=a),a=!0;if(!a)return t.flags&256?(co(t),t):(co(t),null)}return co(t),t.flags&128?(t.lanes=n,t):(n=r!==null,e=e!==null&&e.memoizedState!==null,n&&(r=t.child,a=null,r.alternate!==null&&r.alternate.memoizedState!==null&&r.alternate.memoizedState.cachePool!==null&&(a=r.alternate.memoizedState.cachePool.pool),o=null,r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),o!==a&&(r.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),Bc(t,t.updateQueue),Hc(t),null);case 4:return B(),e===null&&Id(t.stateNode.containerInfo),Hc(t),null;case 10:return Ji(t.type),Hc(t),null;case 19:if(re(lo),r=t.memoizedState,r===null)return Hc(t),null;if(a=(t.flags&128)!=0,o=r.rendering,o===null)if(a)Vc(r,!1);else{if(tu!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=uo(e),o!==null){for(t.flags|=128,Vc(r,!1),e=o.updateQueue,t.updateQueue=e,Bc(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)li(n,e),n=n.sibling;return ie(lo,lo.current&1|2),Ni&&Ei(t,r.treeForkCount),t.child}e=e.sibling}r.tail!==null&&_e()>fu&&(t.flags|=128,a=!0,Vc(r,!1),t.lanes=4194304)}else{if(!a)if(e=uo(o),e!==null){if(t.flags|=128,a=!0,e=e.updateQueue,t.updateQueue=e,Bc(t,e),Vc(r,!0),r.tail===null&&r.tailMode===`hidden`&&!o.alternate&&!Ni)return Hc(t),null}else 2*_e()-r.renderingStartTime>fu&&n!==536870912&&(t.flags|=128,a=!0,Vc(r,!1),t.lanes=4194304);r.isBackwards?(o.sibling=t.child,t.child=o):(e=r.last,e===null?t.child=o:e.sibling=o,r.last=o)}return r.tail===null?(Hc(t),null):(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=_e(),e.sibling=null,n=lo.current,ie(lo,a?n&1|2:n&1),Ni&&Ei(t,r.treeForkCount),e);case 22:case 23:return co(t),to(),r=t.memoizedState!==null,e===null?r&&(t.flags|=8192):e.memoizedState!==null!==r&&(t.flags|=8192),r?n&536870912&&!(t.flags&128)&&(Hc(t),t.subtreeFlags&6&&(t.flags|=8192)):Hc(t),n=t.updateQueue,n!==null&&Bc(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),r=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(r=t.memoizedState.cachePool.pool),r!==n&&(t.flags|=2048),e!==null&&re(_a),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Ji(oa),Hc(t),null;case 25:return null;case 30:return null}throw Error(i(156,t.tag))}function Wc(e,t){switch(ki(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Ji(oa),B(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return ue(t),null;case 31:if(t.memoizedState!==null){if(co(t),t.alternate===null)throw Error(i(340));Vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 13:if(co(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(i(340));Vi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return re(lo),null;case 4:return B(),null;case 10:return Ji(t.type),null;case 22:case 23:return co(t),to(),e!==null&&re(_a),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Ji(oa),null;case 25:return null;default:return null}}function Gc(e,t){switch(ki(t),t.tag){case 3:Ji(oa),B();break;case 26:case 27:case 5:ue(t);break;case 4:B();break;case 31:t.memoizedState!==null&&co(t);break;case 13:co(t);break;case 19:re(lo);break;case 10:Ji(t.type);break;case 22:case 23:co(t),to(),e!==null&&re(_a);break;case 24:Ji(oa)}}function Kc(e,t){try{var n=t.updateQueue,r=n===null?null:n.lastEffect;if(r!==null){var i=r.next;n=i;do{if((n.tag&e)===e){r=void 0;var a=n.create,o=n.inst;r=a(),o.destroy=r}n=n.next}while(n!==i)}}catch(e){td(t,t.return,e)}}function qc(e,t,n){try{var r=t.updateQueue,i=r===null?null:r.lastEffect;if(i!==null){var a=i.next;r=a;do{if((r.tag&e)===e){var o=r.inst,s=o.destroy;if(s!==void 0){o.destroy=void 0,i=t;var c=n,l=s;try{l()}catch(e){td(i,c,e)}}}r=r.next}while(r!==a)}}catch(e){td(t,t.return,e)}}function Jc(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Xa(t,n)}catch(t){td(e,e.return,t)}}}function Yc(e,t,n){n.props=Zs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(n){td(e,t,n)}}function Xc(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var r=e.stateNode;break;case 30:r=e.stateNode;break;default:r=e.stateNode}typeof n==`function`?e.refCleanup=n(r):n.current=r}}catch(n){td(e,t,n)}}function Zc(e,t){var n=e.ref,r=e.refCleanup;if(n!==null)if(typeof r==`function`)try{r()}catch(n){td(e,t,n)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n==`function`)try{n(null)}catch(n){td(e,t,n)}else n.current=null}function Qc(e){var t=e.type,n=e.memoizedProps,r=e.stateNode;try{a:switch(t){case`button`:case`input`:case`select`:case`textarea`:n.autoFocus&&r.focus();break a;case`img`:n.src?r.src=n.src:n.srcSet&&(r.srcset=n.srcSet)}}catch(t){td(e,e.return,t)}}function $c(e,t,n){try{var r=e.stateNode;Xd(r,e.type,n,t),r[Xe]=t}catch(t){td(e,e.return,t)}}function el(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&mf(e.type)||e.tag===4}function tl(e){a:for(;;){for(;e.sibling===null;){if(e.return===null||el(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&mf(e.type)||e.flags&2||e.child===null||e.tag===4)continue a;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function nl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName===`HTML`?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName===`HTML`?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=Ht));else if(r!==4&&(r===27&&mf(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(nl(e,t,n),e=e.sibling;e!==null;)nl(e,t,n),e=e.sibling}function rl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(r===27&&mf(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(rl(e,t,n),e=e.sibling;e!==null;)rl(e,t,n),e=e.sibling}function il(e){var t=e.stateNode,n=e.memoizedProps;try{for(var r=e.type,i=t.attributes;i.length;)t.removeAttributeNode(i[0]);Yd(t,r,n),t[Ye]=e,t[Xe]=n}catch(t){td(e,e.return,t)}}var al=!1,ol=!1,sl=!1,cl=typeof WeakSet==`function`?WeakSet:Set,ll=null;function ul(e,t){if(e=e.containerInfo,$d=Cp,e=Er(e),Dr(e)){if(`selectionStart`in e)var n={start:e.selectionStart,end:e.selectionEnd};else a:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break a}var s=0,c=-1,l=-1,u=0,d=0,f=e,p=null;b:for(;;){for(var m;f!==n||a!==0&&f.nodeType!==3||(c=s+a),f!==o||r!==0&&f.nodeType!==3||(l=s+r),f.nodeType===3&&(s+=f.nodeValue.length),(m=f.firstChild)!==null;)p=f,f=m;for(;;){if(f===e)break b;if(p===n&&++u===a&&(c=s),p===o&&++d===r&&(l=s),(m=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=m}n=c===-1||l===-1?null:{start:c,end:l}}else n=null}n||={start:0,end:0}}else n=null;for(ef={focusedElem:e,selectionRange:n},Cp=!1,ll=t;ll!==null;)if(t=ll,e=t.child,t.subtreeFlags&1028&&e!==null)e.return=t,ll=e;else for(;ll!==null;){switch(t=ll,o=t.alternate,e=t.flags,t.tag){case 0:if(e&4&&(e=t.updateQueue,e=e===null?null:e.events,e!==null))for(n=0;n<e.length;n++)a=e[n],a.ref.impl=a.nextImpl;break;case 11:case 15:break;case 1:if(e&1024&&o!==null){e=void 0,n=t,a=o.memoizedProps,o=o.memoizedState,r=n.stateNode;try{var h=Zs(n.type,a);e=r.getSnapshotBeforeUpdate(h,o),r.__reactInternalSnapshotBeforeUpdate=e}catch(e){td(n,n.return,e)}}break;case 3:if(e&1024){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)_f(e);else if(n===1)switch(e.nodeName){case`HEAD`:case`HTML`:case`BODY`:_f(e);break;default:e.textContent=``}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(e&1024)throw Error(i(163))}if(e=t.sibling,e!==null){e.return=t.return,ll=e;break}ll=t.return}}function dl(e,t,n){var r=n.flags;switch(n.tag){case 0:case 11:case 15:El(e,n),r&4&&Kc(5,n);break;case 1:if(El(e,n),r&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(e){td(n,n.return,e)}else{var i=Zs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(i,t,e.__reactInternalSnapshotBeforeUpdate)}catch(e){td(n,n.return,e)}}r&64&&Jc(n),r&512&&Xc(n,n.return);break;case 3:if(El(e,n),r&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Xa(e,t)}catch(e){td(n,n.return,e)}}break;case 27:t===null&&r&4&&il(n);case 26:case 5:El(e,n),t===null&&r&4&&Qc(n),r&512&&Xc(n,n.return);break;case 12:El(e,n);break;case 31:El(e,n),r&4&&_l(e,n);break;case 13:El(e,n),r&4&&vl(e,n),r&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=ad.bind(null,n),Cf(e,n))));break;case 22:if(r=n.memoizedState!==null||al,!r){t=t!==null&&t.memoizedState!==null||ol,i=al;var a=ol;al=r,(ol=t)&&!a?Ol(e,n,(n.subtreeFlags&8772)!=0):El(e,n),al=i,ol=a}break;case 30:break;default:El(e,n)}}function fl(e){var t=e.alternate;t!==null&&(e.alternate=null,fl(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&rt(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var pl=null,ml=!1;function hl(e,t,n){for(n=n.child;n!==null;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(Te&&typeof Te.onCommitFiberUnmount==`function`)try{Te.onCommitFiberUnmount(we,n)}catch{}switch(n.tag){case 26:ol||Zc(n,t),hl(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ol||Zc(n,t);var r=pl,i=ml;mf(n.type)&&(pl=n.stateNode,ml=!1),hl(e,t,n),kf(n.stateNode),pl=r,ml=i;break;case 5:ol||Zc(n,t);case 6:if(r=pl,i=ml,pl=null,hl(e,t,n),pl=r,ml=i,pl!==null)if(ml)try{(pl.nodeType===9?pl.body:pl.nodeName===`HTML`?pl.ownerDocument.body:pl).removeChild(n.stateNode)}catch(e){td(n,t,e)}else try{pl.removeChild(n.stateNode)}catch(e){td(n,t,e)}break;case 18:pl!==null&&(ml?(e=pl,hf(e.nodeType===9?e.body:e.nodeName===`HTML`?e.ownerDocument.body:e,n.stateNode),Yp(e)):hf(pl,n.stateNode));break;case 4:r=pl,i=ml,pl=n.stateNode.containerInfo,ml=!0,hl(e,t,n),pl=r,ml=i;break;case 0:case 11:case 14:case 15:qc(2,n,t),ol||qc(4,n,t),hl(e,t,n);break;case 1:ol||(Zc(n,t),r=n.stateNode,typeof r.componentWillUnmount==`function`&&Yc(n,t,r)),hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:ol=(r=ol)||n.memoizedState!==null,hl(e,t,n),ol=r;break;default:hl(e,t,n)}}function _l(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null))){e=e.dehydrated;try{Yp(e)}catch(e){td(t,t.return,e)}}}function vl(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Yp(e)}catch(e){td(t,t.return,e)}}function yl(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new cl),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new cl),t;default:throw Error(i(435,e.tag))}}function bl(e,t){var n=yl(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var r=od.bind(null,e,t);t.then(r,r)}})}function xl(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var a=n[r],o=e,s=t,c=s;a:for(;c!==null;){switch(c.tag){case 27:if(mf(c.type)){pl=c.stateNode,ml=!1;break a}break;case 5:pl=c.stateNode,ml=!1;break a;case 3:case 4:pl=c.stateNode.containerInfo,ml=!0;break a}c=c.return}if(pl===null)throw Error(i(160));gl(o,s,a),pl=null,ml=!1,o=a.alternate,o!==null&&(o.return=null),a.return=null}if(t.subtreeFlags&13886)for(t=t.child;t!==null;)Cl(t,e),t=t.sibling}var Sl=null;function Cl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:xl(t,e),wl(e),r&4&&(qc(3,e,e.return),Kc(3,e),qc(5,e,e.return));break;case 1:xl(t,e),wl(e),r&512&&(ol||n===null||Zc(n,n.return)),r&64&&al&&(e=e.updateQueue,e!==null&&(r=e.callbacks,r!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?r:n.concat(r))));break;case 26:var a=Sl;if(xl(t,e),wl(e),r&512&&(ol||n===null||Zc(n,n.return)),r&4){var o=n===null?null:n.memoizedState;if(r=e.memoizedState,n===null)if(r===null)if(e.stateNode===null){a:{r=e.type,n=e.memoizedProps,a=a.ownerDocument||a;b:switch(r){case`title`:o=a.getElementsByTagName(`title`)[0],(!o||o[nt]||o[Ye]||o.namespaceURI===`http://www.w3.org/2000/svg`||o.hasAttribute(`itemprop`))&&(o=a.createElement(r),a.head.insertBefore(o,a.querySelector(`head > title`))),Yd(o,r,n),o[Ye]=e,ct(o),r=o;break a;case`link`:var s=rp(`link`,`href`,a).get(r+(n.href||``));if(s){for(var c=0;c<s.length;c++)if(o=s[c],o.getAttribute(`href`)===(n.href==null||n.href===``?null:n.href)&&o.getAttribute(`rel`)===(n.rel==null?null:n.rel)&&o.getAttribute(`title`)===(n.title==null?null:n.title)&&o.getAttribute(`crossorigin`)===(n.crossOrigin==null?null:n.crossOrigin)){s.splice(c,1);break b}}o=a.createElement(r),Yd(o,r,n),a.head.appendChild(o);break;case`meta`:if(s=rp(`meta`,`content`,a).get(r+(n.content||``))){for(c=0;c<s.length;c++)if(o=s[c],o.getAttribute(`content`)===(n.content==null?null:``+n.content)&&o.getAttribute(`name`)===(n.name==null?null:n.name)&&o.getAttribute(`property`)===(n.property==null?null:n.property)&&o.getAttribute(`http-equiv`)===(n.httpEquiv==null?null:n.httpEquiv)&&o.getAttribute(`charset`)===(n.charSet==null?null:n.charSet)){s.splice(c,1);break b}}o=a.createElement(r),Yd(o,r,n),a.head.appendChild(o);break;default:throw Error(i(468,r))}o[Ye]=e,ct(o),r=o}e.stateNode=r}else ip(a,e.type,e.stateNode);else e.stateNode=Qf(a,r,e.memoizedProps);else o===r?r===null&&e.stateNode!==null&&$c(e,e.memoizedProps,n.memoizedProps):(o===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):o.count--,r===null?ip(a,e.type,e.stateNode):Qf(a,r,e.memoizedProps))}break;case 27:xl(t,e),wl(e),r&512&&(ol||n===null||Zc(n,n.return)),n!==null&&r&4&&$c(e,e.memoizedProps,n.memoizedProps);break;case 5:if(xl(t,e),wl(e),r&512&&(ol||n===null||Zc(n,n.return)),e.flags&32){a=e.stateNode;try{Pt(a,``)}catch(t){td(e,e.return,t)}}r&4&&e.stateNode!=null&&(a=e.memoizedProps,$c(e,a,n===null?a:n.memoizedProps)),r&1024&&(sl=!0);break;case 6:if(xl(t,e),wl(e),r&4){if(e.stateNode===null)throw Error(i(162));r=e.memoizedProps,n=e.stateNode;try{n.nodeValue=r}catch(t){td(e,e.return,t)}}break;case 3:if(np=null,a=Sl,Sl=Mf(t.containerInfo),xl(t,e),Sl=a,wl(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Yp(t.containerInfo)}catch(t){td(e,e.return,t)}sl&&(sl=!1,Tl(e));break;case 4:r=Sl,Sl=Mf(e.stateNode.containerInfo),xl(t,e),wl(e),Sl=r;break;case 12:xl(t,e),wl(e);break;case 31:xl(t,e),wl(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,bl(e,r)));break;case 13:xl(t,e),wl(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(uu=_e()),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,bl(e,r)));break;case 22:a=e.memoizedState!==null;var l=n!==null&&n.memoizedState!==null,u=al,d=ol;if(al=u||a,ol=d||l,xl(t,e),ol=d,al=u,wl(e),r&8192)a:for(t=e.stateNode,t._visibility=a?t._visibility&-2:t._visibility|1,a&&(n===null||l||al||ol||Dl(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){l=n=t;try{if(o=l.stateNode,a)s=o.style,typeof s.setProperty==`function`?s.setProperty(`display`,`none`,`important`):s.display=`none`;else{c=l.stateNode;var f=l.memoizedProps.style,p=f!=null&&f.hasOwnProperty(`display`)?f.display:null;c.style.display=p==null||typeof p==`boolean`?``:(``+p).trim()}}catch(e){td(l,l.return,e)}}}else if(t.tag===6){if(n===null){l=t;try{l.stateNode.nodeValue=a?``:l.memoizedProps}catch(e){td(l,l.return,e)}}}else if(t.tag===18){if(n===null){l=t;try{var m=l.stateNode;a?gf(m,!0):gf(l.stateNode,!1)}catch(e){td(l,l.return,e)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break a;for(;t.sibling===null;){if(t.return===null||t.return===e)break a;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}r&4&&(r=e.updateQueue,r!==null&&(n=r.retryQueue,n!==null&&(r.retryQueue=null,bl(e,n))));break;case 19:xl(t,e),wl(e),r&4&&(r=e.updateQueue,r!==null&&(e.updateQueue=null,bl(e,r)));break;case 30:break;case 21:break;default:xl(t,e),wl(e)}}function wl(e){var t=e.flags;if(t&2){try{for(var n,r=e.return;r!==null;){if(el(r)){n=r;break}r=r.return}if(n==null)throw Error(i(160));switch(n.tag){case 27:var a=n.stateNode,o=tl(e);rl(e,o,a);break;case 5:var s=n.stateNode;n.flags&32&&(Pt(s,``),n.flags&=-33);var c=tl(e);rl(e,c,s);break;case 3:case 4:var l=n.stateNode.containerInfo,u=tl(e);nl(e,u,l);break;default:throw Error(i(161))}}catch(t){td(e,e.return,t)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Tl(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Tl(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function El(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)dl(e,t.alternate,t),t=t.sibling}function Dl(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:qc(4,t,t.return),Dl(t);break;case 1:Zc(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount==`function`&&Yc(t,t.return,n),Dl(t);break;case 27:kf(t.stateNode);case 26:case 5:Zc(t,t.return),Dl(t);break;case 22:t.memoizedState===null&&Dl(t);break;case 30:Dl(t);break;default:Dl(t)}e=e.sibling}}function Ol(e,t,n){for(n&&=(t.subtreeFlags&8772)!=0,t=t.child;t!==null;){var r=t.alternate,i=e,a=t,o=a.flags;switch(a.tag){case 0:case 11:case 15:Ol(i,a,n),Kc(4,a);break;case 1:if(Ol(i,a,n),r=a,i=r.stateNode,typeof i.componentDidMount==`function`)try{i.componentDidMount()}catch(e){td(r,r.return,e)}if(r=a,i=r.updateQueue,i!==null){var s=r.stateNode;try{var c=i.shared.hiddenCallbacks;if(c!==null)for(i.shared.hiddenCallbacks=null,i=0;i<c.length;i++)Ya(c[i],s)}catch(e){td(r,r.return,e)}}n&&o&64&&Jc(a),Xc(a,a.return);break;case 27:il(a);case 26:case 5:Ol(i,a,n),n&&r===null&&o&4&&Qc(a),Xc(a,a.return);break;case 12:Ol(i,a,n);break;case 31:Ol(i,a,n),n&&o&4&&_l(i,a);break;case 13:Ol(i,a,n),n&&o&4&&vl(i,a);break;case 22:a.memoizedState===null&&Ol(i,a,n),Xc(a,a.return);break;case 30:break;default:Ol(i,a,n)}t=t.sibling}}function kl(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&ca(n))}function Al(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ca(e))}function jl(e,t,n,r){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Ml(e,t,n,r),t=t.sibling}function Ml(e,t,n,r){var i=t.flags;switch(t.tag){case 0:case 11:case 15:jl(e,t,n,r),i&2048&&Kc(9,t);break;case 1:jl(e,t,n,r);break;case 3:jl(e,t,n,r),i&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ca(e)));break;case 12:if(i&2048){jl(e,t,n,r),e=t.stateNode;try{var a=t.memoizedProps,o=a.id,s=a.onPostCommit;typeof s==`function`&&s(o,t.alternate===null?`mount`:`update`,e.passiveEffectDuration,-0)}catch(e){td(t,t.return,e)}}else jl(e,t,n,r);break;case 31:jl(e,t,n,r);break;case 13:jl(e,t,n,r);break;case 23:break;case 22:a=t.stateNode,o=t.alternate,t.memoizedState===null?a._visibility&2?jl(e,t,n,r):(a._visibility|=2,Nl(e,t,n,r,(t.subtreeFlags&10256)!=0||!1)):a._visibility&2?jl(e,t,n,r):Pl(e,t),i&2048&&kl(o,t);break;case 24:jl(e,t,n,r),i&2048&&Al(t.alternate,t);break;default:jl(e,t,n,r)}}function Nl(e,t,n,r,i){for(i&&=(t.subtreeFlags&10256)!=0||!1,t=t.child;t!==null;){var a=e,o=t,s=n,c=r,l=o.flags;switch(o.tag){case 0:case 11:case 15:Nl(a,o,s,c,i),Kc(8,o);break;case 23:break;case 22:var u=o.stateNode;o.memoizedState===null?(u._visibility|=2,Nl(a,o,s,c,i)):u._visibility&2?Nl(a,o,s,c,i):Pl(a,o),i&&l&2048&&kl(o.alternate,o);break;case 24:Nl(a,o,s,c,i),i&&l&2048&&Al(o.alternate,o);break;default:Nl(a,o,s,c,i)}t=t.sibling}}function Pl(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,r=t,i=r.flags;switch(r.tag){case 22:Pl(n,r),i&2048&&kl(r.alternate,r);break;case 24:Pl(n,r),i&2048&&Al(r.alternate,r);break;default:Pl(n,r)}t=t.sibling}}var Fl=8192;function Il(e,t,n){if(e.subtreeFlags&Fl)for(e=e.child;e!==null;)Ll(e,t,n),e=e.sibling}function Ll(e,t,n){switch(e.tag){case 26:Il(e,t,n),e.flags&Fl&&e.memoizedState!==null&&sp(n,Sl,e.memoizedState,e.memoizedProps);break;case 5:Il(e,t,n);break;case 3:case 4:var r=Sl;Sl=Mf(e.stateNode.containerInfo),Il(e,t,n),Sl=r;break;case 22:e.memoizedState===null&&(r=e.alternate,r!==null&&r.memoizedState!==null?(r=Fl,Fl=16777216,Il(e,t,n),Fl=r):Il(e,t,n));break;default:Il(e,t,n)}}function Rl(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function zl(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];ll=r,Hl(r,e)}Rl(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Bl(e),e=e.sibling}function Bl(e){switch(e.tag){case 0:case 11:case 15:zl(e),e.flags&2048&&qc(9,e,e.return);break;case 3:zl(e);break;case 12:zl(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Vl(e)):zl(e);break;default:zl(e)}}function Vl(e){var t=e.deletions;if(e.flags&16){if(t!==null)for(var n=0;n<t.length;n++){var r=t[n];ll=r,Hl(r,e)}Rl(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:qc(8,t,t.return),Vl(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Vl(t));break;default:Vl(t)}e=e.sibling}}function Hl(e,t){for(;ll!==null;){var n=ll;switch(n.tag){case 0:case 11:case 15:qc(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var r=n.memoizedState.cachePool.pool;r!=null&&r.refCount++}break;case 24:ca(n.memoizedState.cache)}if(r=n.child,r!==null)r.return=n,ll=r;else a:for(n=e;ll!==null;){r=ll;var i=r.sibling,a=r.return;if(fl(r),r===n){ll=null;break a}if(i!==null){i.return=a,ll=i;break a}ll=a}}}var Ul={getCacheForType:function(e){var t=ea(oa),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return ea(oa).controller.signal}},Wl=typeof WeakMap==`function`?WeakMap:Map,Gl=0,Kl=null,ql=null,Jl=0,Yl=0,Xl=null,Zl=!1,Ql=!1,$l=!1,eu=0,tu=0,nu=0,ru=0,iu=0,au=0,ou=0,su=null,cu=null,lu=!1,uu=0,du=0,fu=1/0,pu=null,$=null,mu=0,hu=null,gu=null,_u=0,vu=0,yu=null,bu=null,xu=0,Su=null;function Cu(){return Gl&2&&Jl!==0?Jl&-Jl:I.T===null?Ke():Sd()}function wu(){if(au===0)if(!(Jl&536870912)||Ni){var e=je;je<<=1,!(je&3932160)&&(je=262144),au=e}else au=536870912;return e=no.current,e!==null&&(e.flags|=32),au}function Tu(e,t,n){(e===Kl&&(Yl===2||Yl===9)||e.cancelPendingCommit!==null)&&(Mu(e,0),ku(e,Jl,au,!1)),ze(e,n),(!(Gl&2)||e!==Kl)&&(e===Kl&&(!(Gl&2)&&(ru|=n),tu===4&&ku(e,Jl,au,!1)),md(e))}function Eu(e,t,n){if(Gl&6)throw Error(i(327));var r=!n&&(t&127)==0&&(t&e.expiredLanes)===0||Fe(e,t),a=r?Bu(e,t):Ru(e,t,!0),o=r;do{if(a===0){Ql&&!r&&ku(e,t,0,!1);break}else{if(n=e.current.alternate,o&&!Ou(n)){a=Ru(e,t,!1),o=!1;continue}if(a===2){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=e.pendingLanes&-536870913,s=s===0?s&536870912?536870912:0:s;if(s!==0){t=s;a:{var c=e;a=su;var l=c.current.memoizedState.isDehydrated;if(l&&(Mu(c,s).flags|=256),s=Ru(c,s,!1),s!==2){if($l&&!l){c.errorRecoveryDisabledLanes|=o,ru|=o,a=4;break a}o=cu,cu=a,o!==null&&(cu===null?cu=o:cu.push.apply(cu,o))}a=s}if(o=!1,a!==2)continue}}if(a===1){Mu(e,0),ku(e,t,0,!0);break}a:{switch(r=e,o=a,o){case 0:case 1:throw Error(i(345));case 4:if((t&4194048)!==t)break;case 6:ku(r,t,au,!Zl);break a;case 2:cu=null;break;case 3:case 5:break;default:throw Error(i(329))}if((t&62914560)===t&&(a=uu+300-_e(),10<a)){if(ku(r,t,au,!Zl),Pe(r,0,!0)!==0)break a;_u=t,r.timeoutHandle=lf(Du.bind(null,r,n,cu,pu,lu,t,au,ru,ou,Zl,o,`Throttled`,-0,0),a);break a}Du(r,n,cu,pu,lu,t,au,ru,ou,Zl,o,null,-0,0)}}break}while(1);md(e)}function Du(e,t,n,r,i,a,o,s,c,l,u,d,f,p){if(e.timeoutHandle=-1,d=t.subtreeFlags,d&8192||(d&16785408)==16785408){d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ht},Ll(t,a,d);var m=(a&62914560)===a?uu-_e():(a&4194048)===a?du-_e():0;if(m=lp(d,m),m!==null){_u=a,e.cancelPendingCommit=m(qu.bind(null,e,t,a,n,r,i,o,s,c,u,d,null,f,p)),ku(e,a,o,!l);return}}qu(e,t,a,n,r,i,o,s,c)}function Ou(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var r=0;r<n.length;r++){var i=n[r],a=i.getSnapshot;i=i.value;try{if(!xr(a(),i))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ku(e,t,n,r){t&=~iu,t&=~ru,e.suspendedLanes|=t,e.pingedLanes&=~t,r&&(e.warmLanes|=t),r=e.expirationTimes;for(var i=t;0<i;){var a=31-Ee(i),o=1<<a;r[a]=-1,i&=~o}n!==0&&Ve(e,n,t)}function Au(){return Gl&6?!0:(hd(0,!1),!1)}function ju(){if(ql!==null){if(Yl===0)var e=ql.return;else e=ql,Ki=Gi=null,jo(e),ja=null,Ma=0,e=ql;for(;e!==null;)Gc(e.alternate,e),e=e.return;ql=null}}function Mu(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,uf(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),_u=0,ju(),Kl=e,ql=n=ci(e.current,null),Jl=t,Yl=0,Xl=null,Zl=!1,Ql=Fe(e,t),$l=!1,ou=au=iu=ru=nu=tu=0,cu=su=null,lu=!1,t&8&&(t|=t&32);var r=e.entangledLanes;if(r!==0)for(e=e.entanglements,r&=t;0<r;){var i=31-Ee(r),a=1<<i;t|=e[i],r&=~a}return eu=t,Qr(),n}function Nu(e,t){po=null,I.H=Us,t===xa||t===Ca?(t=ka(),Yl=3):t===Sa?(t=ka(),Yl=4):Yl=t===oc?8:typeof t==`object`&&t&&typeof t.then==`function`?6:1,Xl=t,ql===null&&(tu=1,tc(e,gi(t,e.current)))}function Pu(){var e=no.current;return e===null?!0:(Jl&4194048)===Jl?ro===null:(Jl&62914560)===Jl||Jl&536870912?e===ro:!1}function Fu(){var e=I.H;return I.H=Us,e===null?Us:e}function Iu(){var e=I.A;return I.A=Ul,e}function Lu(){tu=4,Zl||(Jl&4194048)!==Jl&&no.current!==null||(Ql=!0),!(nu&134217727)&&!(ru&134217727)||Kl===null||ku(Kl,Jl,au,!1)}function Ru(e,t,n){var r=Gl;Gl|=2;var i=Fu(),a=Iu();(Kl!==e||Jl!==t)&&(pu=null,Mu(e,t)),t=!1;var o=tu;a:do try{if(Yl!==0&&ql!==null){var s=ql,c=Xl;switch(Yl){case 8:ju(),o=6;break a;case 3:case 2:case 9:case 6:no.current===null&&(t=!0);var l=Yl;if(Yl=0,Xl=null,Wu(e,s,c,l),n&&Ql){o=0;break a}break;default:l=Yl,Yl=0,Xl=null,Wu(e,s,c,l)}}zu(),o=tu;break}catch(t){Nu(e,t)}while(1);return t&&e.shellSuspendCounter++,Ki=Gi=null,Gl=r,I.H=i,I.A=a,ql===null&&(Kl=null,Jl=0,Qr()),o}function zu(){for(;ql!==null;)Hu(ql)}function Bu(e,t){var n=Gl;Gl|=2;var r=Fu(),a=Iu();Kl!==e||Jl!==t?(pu=null,fu=_e()+500,Mu(e,t)):Ql=Fe(e,t);a:do try{if(Yl!==0&&ql!==null){t=ql;var o=Xl;b:switch(Yl){case 1:Yl=0,Xl=null,Wu(e,t,o,1);break;case 2:case 9:if(Ta(o)){Yl=0,Xl=null,Uu(t);break}t=function(){Yl!==2&&Yl!==9||Kl!==e||(Yl=7),md(e)},o.then(t,t);break a;case 3:Yl=7;break a;case 4:Yl=5;break a;case 7:Ta(o)?(Yl=0,Xl=null,Uu(t)):(Yl=0,Xl=null,Wu(e,t,o,7));break;case 5:var s=null;switch(ql.tag){case 26:s=ql.memoizedState;case 5:case 27:var c=ql;if(s?op(s):c.stateNode.complete){Yl=0,Xl=null;var l=c.sibling;if(l!==null)ql=l;else{var u=c.return;u===null?ql=null:(ql=u,Gu(u))}break b}}Yl=0,Xl=null,Wu(e,t,o,5);break;case 6:Yl=0,Xl=null,Wu(e,t,o,6);break;case 8:ju(),tu=6;break a;default:throw Error(i(462))}}Vu();break}catch(t){Nu(e,t)}while(1);return Ki=Gi=null,I.H=r,I.A=a,Gl=n,ql===null?(Kl=null,Jl=0,Qr(),tu):0}function Vu(){for(;ql!==null&&!K();)Hu(ql)}function Hu(e){var t=Ic(e.alternate,e,eu);e.memoizedProps=e.pendingProps,t===null?Gu(e):ql=t}function Uu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=bc(n,t,t.pendingProps,t.type,void 0,Jl);break;case 11:t=bc(n,t,t.pendingProps,t.type.render,t.ref,Jl);break;case 5:jo(t);default:Gc(n,t),t=ql=li(t,eu),t=Ic(n,t,eu)}e.memoizedProps=e.pendingProps,t===null?Gu(e):ql=t}function Wu(e,t,n,r){Ki=Gi=null,jo(t),ja=null,Ma=0;var i=t.return;try{if(ac(e,i,t,n,Jl)){tu=1,tc(e,gi(n,e.current)),ql=null;return}}catch(t){if(i!==null)throw ql=i,t;tu=1,tc(e,gi(n,e.current)),ql=null;return}t.flags&32768?(Ni||r===1?e=!0:Ql||Jl&536870912?e=!1:(Zl=e=!0,(r===2||r===9||r===3||r===6)&&(r=no.current,r!==null&&r.tag===13&&(r.flags|=16384))),Ku(t,e)):Gu(t)}function Gu(e){var t=e;do{if(t.flags&32768){Ku(t,Zl);return}e=t.return;var n=Uc(t.alternate,t,eu);if(n!==null){ql=n;return}if(t=t.sibling,t!==null){ql=t;return}ql=t=e}while(t!==null);tu===0&&(tu=5)}function Ku(e,t){do{var n=Wc(e.alternate,e);if(n!==null){n.flags&=32767,ql=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){ql=e;return}ql=e=n}while(e!==null);tu=6,ql=null}function qu(e,t,n,r,a,o,s,c,l){e.cancelPendingCommit=null;do Qu();while(mu!==0);if(Gl&6)throw Error(i(327));if(t!==null){if(t===e.current)throw Error(i(177));if(o=t.lanes|t.childLanes,o|=Zr,Be(e,n,o,s,c,l),e===Kl&&(ql=Kl=null,Jl=0),gu=t,hu=e,_u=n,vu=o,yu=a,bu=r,t.subtreeFlags&10256||t.flags&10256?(e.callbackNode=null,e.callbackPriority=0,sd(be,function(){return $u(),null})):(e.callbackNode=null,e.callbackPriority=0),r=(t.flags&13878)!=0,t.subtreeFlags&13878||r){r=I.T,I.T=null,a=L.p,L.p=2,s=Gl,Gl|=4;try{ul(e,t,n)}finally{Gl=s,L.p=a,I.T=r}}mu=1,Ju(),Yu(),Xu()}}function Ju(){if(mu===1){mu=0;var e=hu,t=gu,n=(t.flags&13878)!=0;if(t.subtreeFlags&13878||n){n=I.T,I.T=null;var r=L.p;L.p=2;var i=Gl;Gl|=4;try{Cl(t,e);var a=ef,o=Er(e.containerInfo),s=a.focusedElem,c=a.selectionRange;if(o!==s&&s&&s.ownerDocument&&Tr(s.ownerDocument.documentElement,s)){if(c!==null&&Dr(s)){var l=c.start,u=c.end;if(u===void 0&&(u=l),`selectionStart`in s)s.selectionStart=l,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,f=d&&d.defaultView||window;if(f.getSelection){var p=f.getSelection(),m=s.textContent.length,h=Math.min(c.start,m),g=c.end===void 0?h:Math.min(c.end,m);!p.extend&&h>g&&(o=g,g=h,h=o);var _=wr(s,h),v=wr(s,g);if(_&&v&&(p.rangeCount!==1||p.anchorNode!==_.node||p.anchorOffset!==_.offset||p.focusNode!==v.node||p.focusOffset!==v.offset)){var y=d.createRange();y.setStart(_.node,_.offset),p.removeAllRanges(),h>g?(p.addRange(y),p.extend(v.node,v.offset)):(y.setEnd(v.node,v.offset),p.addRange(y))}}}}for(d=[],p=s;p=p.parentNode;)p.nodeType===1&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for(typeof s.focus==`function`&&s.focus(),s=0;s<d.length;s++){var b=d[s];b.element.scrollLeft=b.left,b.element.scrollTop=b.top}}Cp=!!$d,ef=$d=null}finally{Gl=i,L.p=r,I.T=n}}e.current=t,mu=2}}function Yu(){if(mu===2){mu=0;var e=hu,t=gu,n=(t.flags&8772)!=0;if(t.subtreeFlags&8772||n){n=I.T,I.T=null;var r=L.p;L.p=2;var i=Gl;Gl|=4;try{dl(e,t.alternate,t)}finally{Gl=i,L.p=r,I.T=n}}mu=3}}function Xu(){if(mu===4||mu===3){mu=0,ge();var e=hu,t=gu,n=_u,r=bu;t.subtreeFlags&10256||t.flags&10256?mu=5:(mu=0,gu=hu=null,Zu(e,e.pendingLanes));var i=e.pendingLanes;if(i===0&&($=null),Ge(n),t=t.stateNode,Te&&typeof Te.onCommitFiberRoot==`function`)try{Te.onCommitFiberRoot(we,t,void 0,(t.current.flags&128)==128)}catch{}if(r!==null){t=I.T,i=L.p,L.p=2,I.T=null;try{for(var a=e.onRecoverableError,o=0;o<r.length;o++){var s=r[o];a(s.value,{componentStack:s.stack})}}finally{I.T=t,L.p=i}}_u&3&&Qu(),md(e),i=e.pendingLanes,n&261930&&i&42?e===Su?xu++:(xu=0,Su=e):xu=0,hd(0,!1)}}function Zu(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ca(t)))}function Qu(){return Ju(),Yu(),Xu(),$u()}function $u(){if(mu!==5)return!1;var e=hu,t=vu;vu=0;var n=Ge(_u),r=I.T,a=L.p;try{L.p=32>n?32:n,I.T=null,n=yu,yu=null;var o=hu,s=_u;if(mu=0,gu=hu=null,_u=0,Gl&6)throw Error(i(331));var c=Gl;if(Gl|=4,Bl(o.current),Ml(o,o.current,s,n),Gl=c,hd(0,!1),Te&&typeof Te.onPostCommitFiberRoot==`function`)try{Te.onPostCommitFiberRoot(we,o)}catch{}return!0}finally{L.p=a,I.T=r,Zu(e,t)}}function ed(e,t,n){t=gi(n,t),t=rc(e.stateNode,t,2),e=Ua(e,t,2),e!==null&&(ze(e,2),md(e))}function td(e,t,n){if(e.tag===3)ed(e,e,n);else for(;t!==null;){if(t.tag===3){ed(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError==`function`||typeof r.componentDidCatch==`function`&&($===null||!$.has(r))){e=gi(n,e),n=Q(2),r=Ua(t,n,2),r!==null&&(ic(n,r,t,e),ze(r,2),md(r));break}}t=t.return}}function nd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Wl;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||($l=!0,i.add(n),e=rd.bind(null,e,t,n),t.then(e,e))}function rd(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Kl===e&&(Jl&n)===n&&(tu===4||tu===3&&(Jl&62914560)===Jl&&300>_e()-uu?!(Gl&2)&&Mu(e,0):iu|=n,ou===Jl&&(ou=0)),md(e)}function id(e,t){t===0&&(t=Le()),e=ti(e,t),e!==null&&(ze(e,t),md(e))}function ad(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),id(e,n)}function od(e,t){var n=0;switch(e.tag){case 31:case 13:var r=e.stateNode,a=e.memoizedState;a!==null&&(n=a.retryLane);break;case 19:r=e.stateNode;break;case 22:r=e.stateNode._retryCache;break;default:throw Error(i(314))}r!==null&&r.delete(t),id(e,n)}function sd(e,t){return he(e,t)}var cd=null,ld=null,ud=!1,dd=!1,fd=!1,pd=0;function md(e){e!==ld&&e.next===null&&(ld===null?cd=ld=e:ld=ld.next=e),dd=!0,ud||(ud=!0,xd())}function hd(e,t){if(!fd&&dd){fd=!0;do for(var n=!1,r=cd;r!==null;){if(!t)if(e!==0){var i=r.pendingLanes;if(i===0)var a=0;else{var o=r.suspendedLanes,s=r.pingedLanes;a=(1<<31-Ee(42|e)+1)-1,a&=i&~(o&~s),a=a&201326741?a&201326741|1:a?a|2:0}a!==0&&(n=!0,bd(r,a))}else a=Jl,a=Pe(r,r===Kl?a:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),!(a&3)||Fe(r,a)||(n=!0,bd(r,a));r=r.next}while(n);fd=!1}}function gd(){_d()}function _d(){dd=ud=!1;var e=0;pd!==0&&cf()&&(e=pd);for(var t=_e(),n=null,r=cd;r!==null;){var i=r.next,a=vd(r,t);a===0?(r.next=null,n===null?cd=i:n.next=i,i===null&&(ld=n)):(n=r,(e!==0||a&3)&&(dd=!0)),r=i}mu!==0&&mu!==5||hd(e,!1),pd!==0&&(pd=0)}function vd(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes&-62914561;0<a;){var o=31-Ee(a),s=1<<o,c=i[o];c===-1?((s&n)===0||(s&r)!==0)&&(i[o]=Ie(s,t)):c<=t&&(e.expiredLanes|=s),a&=~s}if(t=Kl,n=Jl,n=Pe(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r=e.callbackNode,n===0||e===t&&(Yl===2||Yl===9)||e.cancelPendingCommit!==null)return r!==null&&r!==null&&G(r),e.callbackNode=null,e.callbackPriority=0;if(!(n&3)||Fe(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(r!==null&&G(r),Ge(n)){case 2:case 8:n=ye;break;case 32:n=be;break;case 268435456:n=Se;break;default:n=be}return r=yd.bind(null,e),n=he(n,r),e.callbackPriority=t,e.callbackNode=n,t}return r!==null&&r!==null&&G(r),e.callbackPriority=2,e.callbackNode=null,2}function yd(e,t){if(mu!==0&&mu!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Qu()&&e.callbackNode!==n)return null;var r=Jl;return r=Pe(e,e===Kl?r:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),r===0?null:(Eu(e,r,t),vd(e,_e()),e.callbackNode!=null&&e.callbackNode===n?yd.bind(null,e):null)}function bd(e,t){if(Qu())return null;Eu(e,t,!0)}function xd(){ff(function(){Gl&6?he(ve,gd):_d()})}function Sd(){if(pd===0){var e=da;e===0&&(e=Ae,Ae<<=1,!(Ae&261888)&&(Ae=256)),pd=e}return pd}function Cd(e){return e==null||typeof e==`symbol`||typeof e==`boolean`?null:typeof e==`function`?e:Vt(``+e)}function wd(e,t){var n=t.ownerDocument.createElement(`input`);return n.name=t.name,n.value=t.value,e.id&&n.setAttribute(`form`,e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Td(e,t,n,r,i){if(t===`submit`&&n&&n.stateNode===i){var a=Cd((i[Xe]||null).action),o=r.submitter;o&&(t=(t=o[Xe]||null)?Cd(t.formAction):o.getAttribute(`formAction`),t!==null&&(a=t,o=null));var s=new un(`action`,`action`,null,r,i);e.push({event:s,listeners:[{instance:null,listener:function(){if(r.defaultPrevented){if(pd!==0){var e=o?wd(i,o):new FormData(i);ks(n,{pending:!0,data:e,method:i.method,action:a},null,e)}}else typeof a==`function`&&(s.preventDefault(),e=o?wd(i,o):new FormData(i),ks(n,{pending:!0,data:e,method:i.method,action:a},a,e))},currentTarget:i}]})}}for(var Ed=0;Ed<Kr.length;Ed++){var Dd=Kr[Ed],Od=Dd.toLowerCase(),kd=Dd[0].toUpperCase()+Dd.slice(1);qr(Od,`on`+kd)}qr(Z,`onAnimationEnd`),qr(zr,`onAnimationIteration`),qr(Br,`onAnimationStart`),qr(`dblclick`,`onDoubleClick`),qr(`focusin`,`onFocus`),qr(`focusout`,`onBlur`),qr(Vr,`onTransitionRun`),qr(Hr,`onTransitionStart`),qr(Ur,`onTransitionCancel`),qr(Wr,`onTransitionEnd`),ft(`onMouseEnter`,[`mouseout`,`mouseover`]),ft(`onMouseLeave`,[`mouseout`,`mouseover`]),ft(`onPointerEnter`,[`pointerout`,`pointerover`]),ft(`onPointerLeave`,[`pointerout`,`pointerover`]),dt(`onChange`,`change click focusin focusout input keydown keyup selectionchange`.split(` `)),dt(`onSelect`,`focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange`.split(` `)),dt(`onBeforeInput`,[`compositionend`,`keypress`,`textInput`,`paste`]),dt(`onCompositionEnd`,`compositionend focusout keydown keypress keyup mousedown`.split(` `)),dt(`onCompositionStart`,`compositionstart focusout keydown keypress keyup mousedown`.split(` `)),dt(`onCompositionUpdate`,`compositionupdate focusout keydown keypress keyup mousedown`.split(` `));var Ad=`abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting`.split(` `),jd=new Set(`beforetoggle cancel close invalid load scroll scrollend toggle`.split(` `).concat(Ad));function Md(e,t){t=(t&4)!=0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;a:{var a=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==a&&i.isPropagationStopped())break a;a=s,i.currentTarget=l;try{a(i)}catch(e){Jr(e)}i.currentTarget=null,a=c}else for(o=0;o<r.length;o++){if(s=r[o],c=s.instance,l=s.currentTarget,s=s.listener,c!==a&&i.isPropagationStopped())break a;a=s,i.currentTarget=l;try{a(i)}catch(e){Jr(e)}i.currentTarget=null,a=c}}}}function Nd(e,t){var n=t[Qe];n===void 0&&(n=t[Qe]=new Set);var r=e+`__bubble`;n.has(r)||(Ld(t,e,2,!1),n.add(r))}function Pd(e,t,n){var r=0;t&&(r|=4),Ld(n,e,r,t)}var Fd=`_reactListening`+Math.random().toString(36).slice(2);function Id(e){if(!e[Fd]){e[Fd]=!0,lt.forEach(function(t){t!==`selectionchange`&&(jd.has(t)||Pd(t,!1,e),Pd(t,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Fd]||(t[Fd]=!0,Pd(`selectionchange`,!1,t))}}function Ld(e,t,n,r){switch(Ap(t)){case 2:var i=wp;break;case 8:i=Tp;break;default:i=Ep}n=i.bind(null,t,n,e),i=void 0,!Qt||t!==`touchstart`&&t!==`touchmove`&&t!==`wheel`||(i=!0),r?i===void 0?e.addEventListener(t,n,!0):e.addEventListener(t,n,{capture:!0,passive:i}):i===void 0?e.addEventListener(t,n,!1):e.addEventListener(t,n,{passive:i})}function Rd(e,t,n,r,i){var a=r;if(!(t&1)&&!(t&2)&&r!==null)a:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var c=r.stateNode.containerInfo;if(c===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&s.stateNode.containerInfo===i)return;s=s.return}for(;c!==null;){if(s=it(c),s===null)return;if(l=s.tag,l===5||l===6||l===26||l===27){r=a=s;continue a}c=c.parentNode}}r=r.return}Yt(function(){var r=a,i=Wt(n),s=[];a:{var c=Gr.get(e);if(c!==void 0){var l=un,u=e;switch(e){case`keypress`:if(an(n)===0)break a;case`keydown`:case`keyup`:l=Pn;break;case`focusin`:u=`focus`,l=xn;break;case`focusout`:u=`blur`,l=xn;break;case`beforeblur`:case`afterblur`:l=xn;break;case`click`:if(n.button===2)break a;case`auxclick`:case`dblclick`:case`mousedown`:case`mousemove`:case`mouseup`:case`mouseout`:case`mouseover`:case`contextmenu`:l=_n;break;case`drag`:case`dragend`:case`dragenter`:case`dragexit`:case`dragleave`:case`dragover`:case`dragstart`:case`drop`:l=yn;break;case`touchcancel`:case`touchend`:case`touchmove`:case`touchstart`:l=Rn;break;case Z:case zr:case Br:l=Cn;break;case Wr:l=Bn;break;case`scroll`:case`scrollend`:l=fn;break;case`wheel`:l=Hn;break;case`copy`:case`cut`:case`paste`:l=Tn;break;case`gotpointercapture`:case`lostpointercapture`:case`pointercancel`:case`pointerdown`:case`pointermove`:case`pointerout`:case`pointerover`:case`pointerup`:l=In;break;case`toggle`:case`beforetoggle`:l=Un}var d=(t&4)!=0,f=!d&&(e===`scroll`||e===`scrollend`),p=d?c===null?null:c+`Capture`:c;d=[];for(var m=r,h;m!==null;){var g=m;if(h=g.stateNode,g=g.tag,g!==5&&g!==26&&g!==27||h===null||p===null||(g=Xt(m,p),g!=null&&d.push(zd(m,g,h))),f)break;m=m.return}0<d.length&&(c=new l(c,u,null,n,i),s.push({event:c,listeners:d}))}}if(!(t&7)){a:{if(c=e===`mouseover`||e===`pointerover`,l=e===`mouseout`||e===`pointerout`,c&&n!==Ut&&(u=n.relatedTarget||n.fromElement)&&(it(u)||u[Ze]))break a;if((l||c)&&(c=i.window===i?i:(c=i.ownerDocument)?c.defaultView||c.parentWindow:window,l?(u=n.relatedTarget||n.toElement,l=r,u=u?it(u):null,u!==null&&(f=o(u),d=u.tag,u!==f||d!==5&&d!==27&&d!==6)&&(u=null)):(l=null,u=r),l!==u)){if(d=_n,g=`onMouseLeave`,p=`onMouseEnter`,m=`mouse`,(e===`pointerout`||e===`pointerover`)&&(d=In,g=`onPointerLeave`,p=`onPointerEnter`,m=`pointer`),f=l==null?c:ot(l),h=u==null?c:ot(u),c=new d(g,m+`leave`,l,n,i),c.target=f,c.relatedTarget=h,g=null,it(i)===r&&(d=new d(p,m+`enter`,u,n,i),d.target=h,d.relatedTarget=f,g=d),f=g,l&&u)b:{for(d=Vd,p=l,m=u,h=0,g=p;g;g=d(g))h++;g=0;for(var _=m;_;_=d(_))g++;for(;0<h-g;)p=d(p),h--;for(;0<g-h;)m=d(m),g--;for(;h--;){if(p===m||m!==null&&p===m.alternate){d=p;break b}p=d(p),m=d(m)}d=null}else d=null;l!==null&&Hd(s,c,l,d,!1),u!==null&&f!==null&&Hd(s,f,u,d,!0)}}a:{if(c=r?ot(r):window,l=c.nodeName&&c.nodeName.toLowerCase(),l===`select`||l===`input`&&c.type===`file`)var v=lr;else if(rr(c))if(ur)v=yr;else{v=_r;var y=gr}else l=c.nodeName,!l||l.toLowerCase()!==`input`||c.type!==`checkbox`&&c.type!==`radio`?r&&Rt(r.elementType)&&(v=lr):v=vr;if(v&&=v(e,r)){ir(s,v,n,i);break a}y&&y(e,c,r),e===`focusout`&&r&&c.type===`number`&&r.memoizedProps.value!=null&&At(c,`number`,c.value)}switch(y=r?ot(r):window,e){case`focusin`:(rr(y)||y.contentEditable===`true`)&&(kr=y,Ar=r,jr=null);break;case`focusout`:jr=Ar=kr=null;break;case`mousedown`:Mr=!0;break;case`contextmenu`:case`mouseup`:case`dragend`:Mr=!1,Nr(s,n,i);break;case`selectionchange`:if(Or)break;case`keydown`:case`keyup`:Nr(s,n,i)}var b;if(Gn)b:{switch(e){case`compositionstart`:var x=`onCompositionStart`;break b;case`compositionend`:x=`onCompositionEnd`;break b;case`compositionupdate`:x=`onCompositionUpdate`;break b}x=void 0}else $n?Zn(e,n)&&(x=`onCompositionEnd`):e===`keydown`&&n.keyCode===229&&(x=`onCompositionStart`);x&&(Jn&&n.locale!==`ko`&&($n||x!==`onCompositionStart`?x===`onCompositionEnd`&&$n&&(b=rn()):(en=i,tn=`value`in en?en.value:en.textContent,$n=!0)),y=Bd(r,x),0<y.length&&(x=new Dn(x,e,null,n,i),s.push({event:x,listeners:y}),b?x.data=b:(b=Qn(n),b!==null&&(x.data=b)))),(b=qn?er(e,n):tr(e,n))&&(x=Bd(r,`onBeforeInput`),0<x.length&&(y=new Dn(`onBeforeInput`,`beforeinput`,null,n,i),s.push({event:y,listeners:x}),y.data=b)),Td(s,e,r,n,i)}Md(s,t)})}function zd(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Bd(e,t){for(var n=t+`Capture`,r=[];e!==null;){var i=e,a=i.stateNode;if(i=i.tag,i!==5&&i!==26&&i!==27||a===null||(i=Xt(e,n),i!=null&&r.unshift(zd(e,i,a)),i=Xt(e,t),i!=null&&r.push(zd(e,i,a))),e.tag===3)return r;e=e.return}return[]}function Vd(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function Hd(e,t,n,r,i){for(var a=t._reactName,o=[];n!==null&&n!==r;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,c!==null&&c===r)break;s!==5&&s!==26&&s!==27||l===null||(c=l,i?(l=Xt(n,a),l!=null&&o.unshift(zd(n,l,c))):i||(l=Xt(n,a),l!=null&&o.push(zd(n,l,c)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var Ud=/\r\n?/g,Wd=/\u0000|\uFFFD/g;function Gd(e){return(typeof e==`string`?e:``+e).replace(Ud,`
`).replace(Wd,``)}function Kd(e,t){return t=Gd(t),Gd(e)===t}function qd(e,t,n,r,a,o){switch(n){case`children`:typeof r==`string`?t===`body`||t===`textarea`&&r===``||Pt(e,r):(typeof r==`number`||typeof r==`bigint`)&&t!==`body`&&Pt(e,``+r);break;case`className`:vt(e,`class`,r);break;case`tabIndex`:vt(e,`tabindex`,r);break;case`dir`:case`role`:case`viewBox`:case`width`:case`height`:vt(e,n,r);break;case`style`:Lt(e,r,o);break;case`data`:if(t!==`object`){vt(e,`data`,r);break}case`src`:case`href`:if(r===``&&(t!==`a`||n!==`href`)){e.removeAttribute(n);break}if(r==null||typeof r==`function`||typeof r==`symbol`||typeof r==`boolean`){e.removeAttribute(n);break}r=Vt(``+r),e.setAttribute(n,r);break;case`action`:case`formAction`:if(typeof r==`function`){e.setAttribute(n,`javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')`);break}else typeof o==`function`&&(n===`formAction`?(t!==`input`&&qd(e,t,`name`,a.name,a,null),qd(e,t,`formEncType`,a.formEncType,a,null),qd(e,t,`formMethod`,a.formMethod,a,null),qd(e,t,`formTarget`,a.formTarget,a,null)):(qd(e,t,`encType`,a.encType,a,null),qd(e,t,`method`,a.method,a,null),qd(e,t,`target`,a.target,a,null)));if(r==null||typeof r==`symbol`||typeof r==`boolean`){e.removeAttribute(n);break}r=Vt(``+r),e.setAttribute(n,r);break;case`onClick`:r!=null&&(e.onclick=Ht);break;case`onScroll`:r!=null&&Nd(`scroll`,e);break;case`onScrollEnd`:r!=null&&Nd(`scrollend`,e);break;case`dangerouslySetInnerHTML`:if(r!=null){if(typeof r!=`object`||!(`__html`in r))throw Error(i(61));if(n=r.__html,n!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=n}}break;case`multiple`:e.multiple=r&&typeof r!=`function`&&typeof r!=`symbol`;break;case`muted`:e.muted=r&&typeof r!=`function`&&typeof r!=`symbol`;break;case`suppressContentEditableWarning`:case`suppressHydrationWarning`:case`defaultValue`:case`defaultChecked`:case`innerHTML`:case`ref`:break;case`autoFocus`:break;case`xlinkHref`:if(r==null||typeof r==`function`||typeof r==`boolean`||typeof r==`symbol`){e.removeAttribute(`xlink:href`);break}n=Vt(``+r),e.setAttributeNS(`http://www.w3.org/1999/xlink`,`xlink:href`,n);break;case`contentEditable`:case`spellCheck`:case`draggable`:case`value`:case`autoReverse`:case`externalResourcesRequired`:case`focusable`:case`preserveAlpha`:r!=null&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,``+r):e.removeAttribute(n);break;case`inert`:case`allowFullScreen`:case`async`:case`autoPlay`:case`controls`:case`default`:case`defer`:case`disabled`:case`disablePictureInPicture`:case`disableRemotePlayback`:case`formNoValidate`:case`hidden`:case`loop`:case`noModule`:case`noValidate`:case`open`:case`playsInline`:case`readOnly`:case`required`:case`reversed`:case`scoped`:case`seamless`:case`itemScope`:r&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,``):e.removeAttribute(n);break;case`capture`:case`download`:!0===r?e.setAttribute(n,``):!1!==r&&r!=null&&typeof r!=`function`&&typeof r!=`symbol`?e.setAttribute(n,r):e.removeAttribute(n);break;case`cols`:case`rows`:case`size`:case`span`:r!=null&&typeof r!=`function`&&typeof r!=`symbol`&&!isNaN(r)&&1<=r?e.setAttribute(n,r):e.removeAttribute(n);break;case`rowSpan`:case`start`:r==null||typeof r==`function`||typeof r==`symbol`||isNaN(r)?e.removeAttribute(n):e.setAttribute(n,r);break;case`popover`:Nd(`beforetoggle`,e),Nd(`toggle`,e),_t(e,`popover`,r);break;case`xlinkActuate`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:actuate`,r);break;case`xlinkArcrole`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:arcrole`,r);break;case`xlinkRole`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:role`,r);break;case`xlinkShow`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:show`,r);break;case`xlinkTitle`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:title`,r);break;case`xlinkType`:yt(e,`http://www.w3.org/1999/xlink`,`xlink:type`,r);break;case`xmlBase`:yt(e,`http://www.w3.org/XML/1998/namespace`,`xml:base`,r);break;case`xmlLang`:yt(e,`http://www.w3.org/XML/1998/namespace`,`xml:lang`,r);break;case`xmlSpace`:yt(e,`http://www.w3.org/XML/1998/namespace`,`xml:space`,r);break;case`is`:_t(e,`is`,r);break;case`innerText`:case`textContent`:break;default:(!(2<n.length)||n[0]!==`o`&&n[0]!==`O`||n[1]!==`n`&&n[1]!==`N`)&&(n=zt.get(n)||n,_t(e,n,r))}}function Jd(e,t,n,r,a,o){switch(n){case`style`:Lt(e,r,o);break;case`dangerouslySetInnerHTML`:if(r!=null){if(typeof r!=`object`||!(`__html`in r))throw Error(i(61));if(n=r.__html,n!=null){if(a.children!=null)throw Error(i(60));e.innerHTML=n}}break;case`children`:typeof r==`string`?Pt(e,r):(typeof r==`number`||typeof r==`bigint`)&&Pt(e,``+r);break;case`onScroll`:r!=null&&Nd(`scroll`,e);break;case`onScrollEnd`:r!=null&&Nd(`scrollend`,e);break;case`onClick`:r!=null&&(e.onclick=Ht);break;case`suppressContentEditableWarning`:case`suppressHydrationWarning`:case`innerHTML`:case`ref`:break;case`innerText`:case`textContent`:break;default:if(!ut.hasOwnProperty(n))a:{if(n[0]===`o`&&n[1]===`n`&&(a=n.endsWith(`Capture`),t=n.slice(2,a?n.length-7:void 0),o=e[Xe]||null,o=o==null?null:o[n],typeof o==`function`&&e.removeEventListener(t,o,a),typeof r==`function`)){typeof o!=`function`&&o!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,r,a);break a}n in e?e[n]=r:!0===r?e.setAttribute(n,``):_t(e,n,r)}}}function Yd(e,t,n){switch(t){case`div`:case`span`:case`svg`:case`path`:case`a`:case`g`:case`p`:case`li`:break;case`img`:Nd(`error`,e),Nd(`load`,e);var r=!1,a=!1,o;for(o in n)if(n.hasOwnProperty(o)){var s=n[o];if(s!=null)switch(o){case`src`:r=!0;break;case`srcSet`:a=!0;break;case`children`:case`dangerouslySetInnerHTML`:throw Error(i(137,t));default:qd(e,t,o,s,n,null)}}a&&qd(e,t,`srcSet`,n.srcSet,n,null),r&&qd(e,t,`src`,n.src,n,null);return;case`input`:Nd(`invalid`,e);var c=o=s=a=null,l=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(d!=null)switch(r){case`name`:a=d;break;case`type`:s=d;break;case`checked`:l=d;break;case`defaultChecked`:u=d;break;case`value`:o=d;break;case`defaultValue`:c=d;break;case`children`:case`dangerouslySetInnerHTML`:if(d!=null)throw Error(i(137,t));break;default:qd(e,t,r,d,n,null)}}kt(e,o,c,l,u,s,a,!1);return;case`select`:for(a in Nd(`invalid`,e),r=s=o=null,n)if(n.hasOwnProperty(a)&&(c=n[a],c!=null))switch(a){case`value`:o=c;break;case`defaultValue`:s=c;break;case`multiple`:r=c;default:qd(e,t,a,c,n,null)}t=o,n=s,e.multiple=!!r,t==null?n!=null&&jt(e,!!r,n,!0):jt(e,!!r,t,!1);return;case`textarea`:for(s in Nd(`invalid`,e),o=a=r=null,n)if(n.hasOwnProperty(s)&&(c=n[s],c!=null))switch(s){case`value`:r=c;break;case`defaultValue`:a=c;break;case`children`:o=c;break;case`dangerouslySetInnerHTML`:if(c!=null)throw Error(i(91));break;default:qd(e,t,s,c,n,null)}Nt(e,r,a,o);return;case`option`:for(l in n)if(n.hasOwnProperty(l)&&(r=n[l],r!=null))switch(l){case`selected`:e.selected=r&&typeof r!=`function`&&typeof r!=`symbol`;break;default:qd(e,t,l,r,n,null)}return;case`dialog`:Nd(`beforetoggle`,e),Nd(`toggle`,e),Nd(`cancel`,e),Nd(`close`,e);break;case`iframe`:case`object`:Nd(`load`,e);break;case`video`:case`audio`:for(r=0;r<Ad.length;r++)Nd(Ad[r],e);break;case`image`:Nd(`error`,e),Nd(`load`,e);break;case`details`:Nd(`toggle`,e);break;case`embed`:case`source`:case`link`:Nd(`error`,e),Nd(`load`,e);case`area`:case`base`:case`br`:case`col`:case`hr`:case`keygen`:case`meta`:case`param`:case`track`:case`wbr`:case`menuitem`:for(u in n)if(n.hasOwnProperty(u)&&(r=n[u],r!=null))switch(u){case`children`:case`dangerouslySetInnerHTML`:throw Error(i(137,t));default:qd(e,t,u,r,n,null)}return;default:if(Rt(t)){for(d in n)n.hasOwnProperty(d)&&(r=n[d],r!==void 0&&Jd(e,t,d,r,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(r=n[c],r!=null&&qd(e,t,c,r,n,null))}function Xd(e,t,n,r){switch(t){case`div`:case`span`:case`svg`:case`path`:case`a`:case`g`:case`p`:case`li`:break;case`input`:var a=null,o=null,s=null,c=null,l=null,u=null,d=null;for(m in n){var f=n[m];if(n.hasOwnProperty(m)&&f!=null)switch(m){case`checked`:break;case`value`:break;case`defaultValue`:l=f;default:r.hasOwnProperty(m)||qd(e,t,m,null,r,f)}}for(var p in r){var m=r[p];if(f=n[p],r.hasOwnProperty(p)&&(m!=null||f!=null))switch(p){case`type`:o=m;break;case`name`:a=m;break;case`checked`:u=m;break;case`defaultChecked`:d=m;break;case`value`:s=m;break;case`defaultValue`:c=m;break;case`children`:case`dangerouslySetInnerHTML`:if(m!=null)throw Error(i(137,t));break;default:m!==f&&qd(e,t,p,m,r,f)}}Ot(e,s,c,l,u,d,o,a);return;case`select`:for(o in m=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&l!=null)switch(o){case`value`:break;case`multiple`:m=l;default:r.hasOwnProperty(o)||qd(e,t,o,null,r,l)}for(a in r)if(o=r[a],l=n[a],r.hasOwnProperty(a)&&(o!=null||l!=null))switch(a){case`value`:p=o;break;case`defaultValue`:c=o;break;case`multiple`:s=o;default:o!==l&&qd(e,t,a,o,r,l)}t=c,n=s,r=m,p==null?!!r!=!!n&&(t==null?jt(e,!!n,n?[]:``,!1):jt(e,!!n,t,!0)):jt(e,!!n,p,!1);return;case`textarea`:for(c in m=p=null,n)if(a=n[c],n.hasOwnProperty(c)&&a!=null&&!r.hasOwnProperty(c))switch(c){case`value`:break;case`children`:break;default:qd(e,t,c,null,r,a)}for(s in r)if(a=r[s],o=n[s],r.hasOwnProperty(s)&&(a!=null||o!=null))switch(s){case`value`:p=a;break;case`defaultValue`:m=a;break;case`children`:break;case`dangerouslySetInnerHTML`:if(a!=null)throw Error(i(91));break;default:a!==o&&qd(e,t,s,a,r,o)}Mt(e,p,m);return;case`option`:for(var h in n)if(p=n[h],n.hasOwnProperty(h)&&p!=null&&!r.hasOwnProperty(h))switch(h){case`selected`:e.selected=!1;break;default:qd(e,t,h,null,r,p)}for(l in r)if(p=r[l],m=n[l],r.hasOwnProperty(l)&&p!==m&&(p!=null||m!=null))switch(l){case`selected`:e.selected=p&&typeof p!=`function`&&typeof p!=`symbol`;break;default:qd(e,t,l,p,r,m)}return;case`img`:case`link`:case`area`:case`base`:case`br`:case`col`:case`embed`:case`hr`:case`keygen`:case`meta`:case`param`:case`source`:case`track`:case`wbr`:case`menuitem`:for(var g in n)p=n[g],n.hasOwnProperty(g)&&p!=null&&!r.hasOwnProperty(g)&&qd(e,t,g,null,r,p);for(u in r)if(p=r[u],m=n[u],r.hasOwnProperty(u)&&p!==m&&(p!=null||m!=null))switch(u){case`children`:case`dangerouslySetInnerHTML`:if(p!=null)throw Error(i(137,t));break;default:qd(e,t,u,p,r,m)}return;default:if(Rt(t)){for(var _ in n)p=n[_],n.hasOwnProperty(_)&&p!==void 0&&!r.hasOwnProperty(_)&&Jd(e,t,_,void 0,r,p);for(d in r)p=r[d],m=n[d],!r.hasOwnProperty(d)||p===m||p===void 0&&m===void 0||Jd(e,t,d,p,r,m);return}}for(var v in n)p=n[v],n.hasOwnProperty(v)&&p!=null&&!r.hasOwnProperty(v)&&qd(e,t,v,null,r,p);for(f in r)p=r[f],m=n[f],!r.hasOwnProperty(f)||p===m||p==null&&m==null||qd(e,t,f,p,r,m)}function Zd(e){switch(e){case`css`:case`script`:case`font`:case`img`:case`image`:case`input`:case`link`:return!0;default:return!1}}function Qd(){if(typeof performance.getEntriesByType==`function`){for(var e=0,t=0,n=performance.getEntriesByType(`resource`),r=0;r<n.length;r++){var i=n[r],a=i.transferSize,o=i.initiatorType,s=i.duration;if(a&&s&&Zd(o)){for(o=0,s=i.responseEnd,r+=1;r<n.length;r++){var c=n[r],l=c.startTime;if(l>s)break;var u=c.transferSize,d=c.initiatorType;u&&Zd(d)&&(c=c.responseEnd,o+=u*(c<s?1:(s-l)/(c-l)))}if(--r,t+=8*(a+o)/(i.duration/1e3),e++,10<e)break}}if(0<e)return t/e/1e6}return navigator.connection&&(e=navigator.connection.downlink,typeof e==`number`)?e:5}var $d=null,ef=null;function tf(e){return e.nodeType===9?e:e.ownerDocument}function nf(e){switch(e){case`http://www.w3.org/2000/svg`:return 1;case`http://www.w3.org/1998/Math/MathML`:return 2;default:return 0}}function rf(e,t){if(e===0)switch(t){case`svg`:return 1;case`math`:return 2;default:return 0}return e===1&&t===`foreignObject`?0:e}function af(e,t){return e===`textarea`||e===`noscript`||typeof t.children==`string`||typeof t.children==`number`||typeof t.children==`bigint`||typeof t.dangerouslySetInnerHTML==`object`&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var sf=null;function cf(){var e=window.event;return e&&e.type===`popstate`?e===sf?!1:(sf=e,!0):(sf=null,!1)}var lf=typeof setTimeout==`function`?setTimeout:void 0,uf=typeof clearTimeout==`function`?clearTimeout:void 0,df=typeof Promise==`function`?Promise:void 0,ff=typeof queueMicrotask==`function`?queueMicrotask:df===void 0?lf:function(e){return df.resolve(null).then(e).catch(pf)};function pf(e){setTimeout(function(){throw e})}function mf(e){return e===`head`}function hf(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n===`/$`||n===`/&`){if(r===0){e.removeChild(i),Yp(t);return}r--}else if(n===`$`||n===`$?`||n===`$~`||n===`$!`||n===`&`)r++;else if(n===`html`)kf(e.ownerDocument.documentElement);else if(n===`head`){n=e.ownerDocument.head,kf(n);for(var a=n.firstChild;a;){var o=a.nextSibling,s=a.nodeName;a[nt]||s===`SCRIPT`||s===`STYLE`||s===`LINK`&&a.rel.toLowerCase()===`stylesheet`||n.removeChild(a),a=o}}else n===`body`&&kf(e.ownerDocument.body);n=i}while(n);Yp(t)}function gf(e,t){var n=e;e=0;do{var r=n.nextSibling;if(n.nodeType===1?t?(n._stashedDisplay=n.style.display,n.style.display=`none`):(n.style.display=n._stashedDisplay||``,n.getAttribute(`style`)===``&&n.removeAttribute(`style`)):n.nodeType===3&&(t?(n._stashedText=n.nodeValue,n.nodeValue=``):n.nodeValue=n._stashedText||``),r&&r.nodeType===8)if(n=r.data,n===`/$`){if(e===0)break;e--}else n!==`$`&&n!==`$?`&&n!==`$~`&&n!==`$!`||e++;n=r}while(n)}function _f(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case`HTML`:case`HEAD`:case`BODY`:_f(n),rt(n);continue;case`SCRIPT`:case`STYLE`:continue;case`LINK`:if(n.rel.toLowerCase()===`stylesheet`)continue}e.removeChild(n)}}function vf(e,t,n,r){for(;e.nodeType===1;){var i=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!r&&(e.nodeName!==`INPUT`||e.type!==`hidden`))break}else if(r){if(!e[nt])switch(t){case`meta`:if(!e.hasAttribute(`itemprop`))break;return e;case`link`:if(a=e.getAttribute(`rel`),a===`stylesheet`&&e.hasAttribute(`data-precedence`)||a!==i.rel||e.getAttribute(`href`)!==(i.href==null||i.href===``?null:i.href)||e.getAttribute(`crossorigin`)!==(i.crossOrigin==null?null:i.crossOrigin)||e.getAttribute(`title`)!==(i.title==null?null:i.title))break;return e;case`style`:if(e.hasAttribute(`data-precedence`))break;return e;case`script`:if(a=e.getAttribute(`src`),(a!==(i.src==null?null:i.src)||e.getAttribute(`type`)!==(i.type==null?null:i.type)||e.getAttribute(`crossorigin`)!==(i.crossOrigin==null?null:i.crossOrigin))&&a&&e.hasAttribute(`async`)&&!e.hasAttribute(`itemprop`))break;return e;default:return e}}else if(t===`input`&&e.type===`hidden`){var a=i.name==null?null:``+i.name;if(i.type===`hidden`&&e.getAttribute(`name`)===a)return e}else return e;if(e=wf(e.nextSibling),e===null)break}return null}function yf(e,t,n){if(t===``)return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!==`INPUT`||e.type!==`hidden`)&&!n||(e=wf(e.nextSibling),e===null))return null;return e}function bf(e,t){for(;e.nodeType!==8;)if((e.nodeType!==1||e.nodeName!==`INPUT`||e.type!==`hidden`)&&!t||(e=wf(e.nextSibling),e===null))return null;return e}function xf(e){return e.data===`$?`||e.data===`$~`}function Sf(e){return e.data===`$!`||e.data===`$?`&&e.ownerDocument.readyState!==`loading`}function Cf(e,t){var n=e.ownerDocument;if(e.data===`$~`)e._reactRetry=t;else if(e.data!==`$?`||n.readyState!==`loading`)t();else{var r=function(){t(),n.removeEventListener(`DOMContentLoaded`,r)};n.addEventListener(`DOMContentLoaded`,r),e._reactRetry=r}}function wf(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t===`$`||t===`$!`||t===`$?`||t===`$~`||t===`&`||t===`F!`||t===`F`)break;if(t===`/$`||t===`/&`)return null}}return e}var Tf=null;function Ef(e){e=e.nextSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n===`/$`||n===`/&`){if(t===0)return wf(e.nextSibling);t--}else n!==`$`&&n!==`$!`&&n!==`$?`&&n!==`$~`&&n!==`&`||t++}e=e.nextSibling}return null}function Df(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n===`$`||n===`$!`||n===`$?`||n===`$~`||n===`&`){if(t===0)return e;t--}else n!==`/$`&&n!==`/&`||t++}e=e.previousSibling}return null}function Of(e,t,n){switch(t=tf(n),e){case`html`:if(e=t.documentElement,!e)throw Error(i(452));return e;case`head`:if(e=t.head,!e)throw Error(i(453));return e;case`body`:if(e=t.body,!e)throw Error(i(454));return e;default:throw Error(i(451))}}function kf(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);rt(e)}var Af=new Map,jf=new Set;function Mf(e){return typeof e.getRootNode==`function`?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Nf=L.d;L.d={f:Pf,r:Ff,D:Rf,C:zf,L:Bf,m:Vf,X:Uf,S:Hf,M:Wf};function Pf(){var e=Nf.f(),t=Au();return e||t}function Ff(e){var t=at(e);t!==null&&t.tag===5&&t.type===`form`?js(t):Nf.r(e)}var If=typeof document>`u`?null:document;function Lf(e,t,n){var r=If;if(r&&typeof t==`string`&&t){var i=Dt(t);i=`link[rel="`+e+`"][href="`+i+`"]`,typeof n==`string`&&(i+=`[crossorigin="`+n+`"]`),jf.has(i)||(jf.add(i),e={rel:e,crossOrigin:n,href:t},r.querySelector(i)===null&&(t=r.createElement(`link`),Yd(t,`link`,e),ct(t),r.head.appendChild(t)))}}function Rf(e){Nf.D(e),Lf(`dns-prefetch`,e,null)}function zf(e,t){Nf.C(e,t),Lf(`preconnect`,e,t)}function Bf(e,t,n){Nf.L(e,t,n);var r=If;if(r&&e&&t){var i=`link[rel="preload"][as="`+Dt(t)+`"]`;t===`image`&&n&&n.imageSrcSet?(i+=`[imagesrcset="`+Dt(n.imageSrcSet)+`"]`,typeof n.imageSizes==`string`&&(i+=`[imagesizes="`+Dt(n.imageSizes)+`"]`)):i+=`[href="`+Dt(e)+`"]`;var a=i;switch(t){case`style`:a=Kf(e);break;case`script`:a=Xf(e)}Af.has(a)||(e=p({rel:`preload`,href:t===`image`&&n&&n.imageSrcSet?void 0:e,as:t},n),Af.set(a,e),r.querySelector(i)!==null||t===`style`&&r.querySelector(qf(a))||t===`script`&&r.querySelector(Zf(a))||(t=r.createElement(`link`),Yd(t,`link`,e),ct(t),r.head.appendChild(t)))}}function Vf(e,t){Nf.m(e,t);var n=If;if(n&&e){var r=t&&typeof t.as==`string`?t.as:`script`,i=`link[rel="modulepreload"][as="`+Dt(r)+`"][href="`+Dt(e)+`"]`,a=i;switch(r){case`audioworklet`:case`paintworklet`:case`serviceworker`:case`sharedworker`:case`worker`:case`script`:a=Xf(e)}if(!Af.has(a)&&(e=p({rel:`modulepreload`,href:e},t),Af.set(a,e),n.querySelector(i)===null)){switch(r){case`audioworklet`:case`paintworklet`:case`serviceworker`:case`sharedworker`:case`worker`:case`script`:if(n.querySelector(Zf(a)))return}r=n.createElement(`link`),Yd(r,`link`,e),ct(r),n.head.appendChild(r)}}}function Hf(e,t,n){Nf.S(e,t,n);var r=If;if(r&&e){var i=st(r).hoistableStyles,a=Kf(e);t||=`default`;var o=i.get(a);if(!o){var s={loading:0,preload:null};if(o=r.querySelector(qf(a)))s.loading=5;else{e=p({rel:`stylesheet`,href:e,"data-precedence":t},n),(n=Af.get(a))&&ep(e,n);var c=o=r.createElement(`link`);ct(c),Yd(c,`link`,e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener(`load`,function(){s.loading|=1}),c.addEventListener(`error`,function(){s.loading|=2}),s.loading|=4,$f(o,t,r)}o={type:`stylesheet`,instance:o,count:1,state:s},i.set(a,o)}}}function Uf(e,t){Nf.X(e,t);var n=If;if(n&&e){var r=st(n).hoistableScripts,i=Xf(e),a=r.get(i);a||(a=n.querySelector(Zf(i)),a||(e=p({src:e,async:!0},t),(t=Af.get(i))&&tp(e,t),a=n.createElement(`script`),ct(a),Yd(a,`link`,e),n.head.appendChild(a)),a={type:`script`,instance:a,count:1,state:null},r.set(i,a))}}function Wf(e,t){Nf.M(e,t);var n=If;if(n&&e){var r=st(n).hoistableScripts,i=Xf(e),a=r.get(i);a||(a=n.querySelector(Zf(i)),a||(e=p({src:e,async:!0,type:`module`},t),(t=Af.get(i))&&tp(e,t),a=n.createElement(`script`),ct(a),Yd(a,`link`,e),n.head.appendChild(a)),a={type:`script`,instance:a,count:1,state:null},r.set(i,a))}}function Gf(e,t,n,r){var a=(a=z.current)?Mf(a):null;if(!a)throw Error(i(446));switch(e){case`meta`:case`title`:return null;case`style`:return typeof n.precedence==`string`&&typeof n.href==`string`?(t=Kf(n.href),n=st(a).hoistableStyles,r=n.get(t),r||(r={type:`style`,instance:null,count:0,state:null},n.set(t,r)),r):{type:`void`,instance:null,count:0,state:null};case`link`:if(n.rel===`stylesheet`&&typeof n.href==`string`&&typeof n.precedence==`string`){e=Kf(n.href);var o=st(a).hoistableStyles,s=o.get(e);if(s||(a=a.ownerDocument||a,s={type:`stylesheet`,instance:null,count:0,state:{loading:0,preload:null}},o.set(e,s),(o=a.querySelector(qf(e)))&&!o._p&&(s.instance=o,s.state.loading=5),Af.has(e)||(n={rel:`preload`,as:`style`,href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Af.set(e,n),o||Yf(a,e,n,s.state))),t&&r===null)throw Error(i(528,``));return s}if(t&&r!==null)throw Error(i(529,``));return null;case`script`:return t=n.async,n=n.src,typeof n==`string`&&t&&typeof t!=`function`&&typeof t!=`symbol`?(t=Xf(n),n=st(a).hoistableScripts,r=n.get(t),r||(r={type:`script`,instance:null,count:0,state:null},n.set(t,r)),r):{type:`void`,instance:null,count:0,state:null};default:throw Error(i(444,e))}}function Kf(e){return`href="`+Dt(e)+`"`}function qf(e){return`link[rel="stylesheet"][`+e+`]`}function Jf(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function Yf(e,t,n,r){e.querySelector(`link[rel="preload"][as="style"][`+t+`]`)?r.loading=1:(t=e.createElement(`link`),r.preload=t,t.addEventListener(`load`,function(){return r.loading|=1}),t.addEventListener(`error`,function(){return r.loading|=2}),Yd(t,`link`,n),ct(t),e.head.appendChild(t))}function Xf(e){return`[src="`+Dt(e)+`"]`}function Zf(e){return`script[async]`+e}function Qf(e,t,n){if(t.count++,t.instance===null)switch(t.type){case`style`:var r=e.querySelector(`style[data-href~="`+Dt(n.href)+`"]`);if(r)return t.instance=r,ct(r),r;var a=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return r=(e.ownerDocument||e).createElement(`style`),ct(r),Yd(r,`style`,a),$f(r,n.precedence,e),t.instance=r;case`stylesheet`:a=Kf(n.href);var o=e.querySelector(qf(a));if(o)return t.state.loading|=4,t.instance=o,ct(o),o;r=Jf(n),(a=Af.get(a))&&ep(r,a),o=(e.ownerDocument||e).createElement(`link`),ct(o);var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),Yd(o,`link`,r),t.state.loading|=4,$f(o,n.precedence,e),t.instance=o;case`script`:return o=Xf(n.src),(a=e.querySelector(Zf(o)))?(t.instance=a,ct(a),a):(r=n,(a=Af.get(o))&&(r=p({},n),tp(r,a)),e=e.ownerDocument||e,a=e.createElement(`script`),ct(a),Yd(a,`link`,r),e.head.appendChild(a),t.instance=a);case`void`:return null;default:throw Error(i(443,t.type))}else t.type===`stylesheet`&&!(t.state.loading&4)&&(r=t.instance,t.state.loading|=4,$f(r,n.precedence,e));return t.instance}function $f(e,t,n){for(var r=n.querySelectorAll(`link[rel="stylesheet"][data-precedence],style[data-precedence]`),i=r.length?r[r.length-1]:null,a=i,o=0;o<r.length;o++){var s=r[o];if(s.dataset.precedence===t)a=s;else if(a!==i)break}a?a.parentNode.insertBefore(e,a.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function ep(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.title??=t.title}function tp(e,t){e.crossOrigin??=t.crossOrigin,e.referrerPolicy??=t.referrerPolicy,e.integrity??=t.integrity}var np=null;function rp(e,t,n){if(np===null){var r=new Map,i=np=new Map;i.set(n,r)}else i=np,r=i.get(n),r||(r=new Map,i.set(n,r));if(r.has(e))return r;for(r.set(e,null),n=n.getElementsByTagName(e),i=0;i<n.length;i++){var a=n[i];if(!(a[nt]||a[Ye]||e===`link`&&a.getAttribute(`rel`)===`stylesheet`)&&a.namespaceURI!==`http://www.w3.org/2000/svg`){var o=a.getAttribute(t)||``;o=e+o;var s=r.get(o);s?s.push(a):r.set(o,[a])}}return r}function ip(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t===`title`?e.querySelector(`head > title`):null)}function ap(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case`meta`:case`title`:return!0;case`style`:if(typeof t.precedence!=`string`||typeof t.href!=`string`||t.href===``)break;return!0;case`link`:if(typeof t.rel!=`string`||typeof t.href!=`string`||t.href===``||t.onLoad||t.onError)break;switch(t.rel){case`stylesheet`:return e=t.disabled,typeof t.precedence==`string`&&e==null;default:return!0}case`script`:if(t.async&&typeof t.async!=`function`&&typeof t.async!=`symbol`&&!t.onLoad&&!t.onError&&t.src&&typeof t.src==`string`)return!0}return!1}function op(e){return!(e.type===`stylesheet`&&!(e.state.loading&3))}function sp(e,t,n,r){if(n.type===`stylesheet`&&(typeof r.media!=`string`||!1!==matchMedia(r.media).matches)&&!(n.state.loading&4)){if(n.instance===null){var i=Kf(r.href),a=t.querySelector(qf(i));if(a){t=a._p,typeof t==`object`&&t&&typeof t.then==`function`&&(e.count++,e=up.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=a,ct(a);return}a=t.ownerDocument||t,r=Jf(r),(i=Af.get(i))&&ep(r,i),a=a.createElement(`link`),ct(a);var o=a;o._p=new Promise(function(e,t){o.onload=e,o.onerror=t}),Yd(a,`link`,r),n.instance=a}e.stylesheets===null&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&!(n.state.loading&3)&&(e.count++,n=up.bind(e),t.addEventListener(`load`,n),t.addEventListener(`error`,n))}}var cp=0;function lp(e,t){return e.stylesheets&&e.count===0&&fp(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var r=setTimeout(function(){if(e.stylesheets&&fp(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&cp===0&&(cp=62500*Qd());var i=setTimeout(function(){if(e.waitingForImages=!1,e.count===0&&(e.stylesheets&&fp(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>cp?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(r),clearTimeout(i)}}:null}function up(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)fp(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var dp=null;function fp(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,dp=new Map,t.forEach(pp,e),dp=null,up.call(e))}function pp(e,t){if(!(t.state.loading&4)){var n=dp.get(e);if(n)var r=n.get(null);else{n=new Map,dp.set(e,n);for(var i=e.querySelectorAll(`link[data-precedence],style[data-precedence]`),a=0;a<i.length;a++){var o=i[a];(o.nodeName===`LINK`||o.getAttribute(`media`)!==`not all`)&&(n.set(o.dataset.precedence,o),r=o)}r&&n.set(null,r)}i=t.instance,o=i.getAttribute(`data-precedence`),a=n.get(o)||r,a===r&&n.set(null,i),n.set(o,i),this.count++,r=up.bind(this),i.addEventListener(`load`,r),i.addEventListener(`error`,r),a?a.parentNode.insertBefore(i,a.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(i,e.firstChild)),t.state.loading|=4}}var mp={$$typeof:C,Provider:null,Consumer:null,_currentValue:R,_currentValue2:R,_threadCount:0};function hp(e,t,n,r,i,a,o,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Re(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Re(0),this.hiddenUpdates=Re(null),this.identifierPrefix=r,this.onUncaughtError=i,this.onCaughtError=a,this.onRecoverableError=o,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function gp(e,t,n,r,i,a,o,s,c,l,u,d){return e=new hp(e,t,n,o,c,l,u,d,s),t=1,!0===a&&(t|=24),a=oi(3,null,null,t),e.current=a,a.stateNode=e,t=sa(),t.refCount++,e.pooledCache=t,t.refCount++,a.memoizedState={element:r,isDehydrated:n,cache:t},Ba(a),e}function _p(e){return e?(e=ii,e):ii}function vp(e,t,n,r,i,a){i=_p(i),r.context===null?r.context=i:r.pendingContext=i,r=Ha(t),r.payload={element:n},a=a===void 0?null:a,a!==null&&(r.callback=a),n=Ua(e,r,t),n!==null&&(Tu(n,e,t),Wa(n,e,t))}function yp(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function bp(e,t){yp(e,t),(e=e.alternate)&&yp(e,t)}function xp(e){if(e.tag===13||e.tag===31){var t=ti(e,67108864);t!==null&&Tu(t,e,67108864),bp(e,67108864)}}function Sp(e){if(e.tag===13||e.tag===31){var t=Cu();t=We(t);var n=ti(e,t);n!==null&&Tu(n,e,t),bp(e,t)}}var Cp=!0;function wp(e,t,n,r){var i=I.T;I.T=null;var a=L.p;try{L.p=2,Ep(e,t,n,r)}finally{L.p=a,I.T=i}}function Tp(e,t,n,r){var i=I.T;I.T=null;var a=L.p;try{L.p=8,Ep(e,t,n,r)}finally{L.p=a,I.T=i}}function Ep(e,t,n,r){if(Cp){var i=Dp(r);if(i===null)Rd(e,t,r,Op,n),zp(e,r);else if(Vp(i,e,t,n,r))r.stopPropagation();else if(zp(e,r),t&4&&-1<Rp.indexOf(e)){for(;i!==null;){var a=at(i);if(a!==null)switch(a.tag){case 3:if(a=a.stateNode,a.current.memoizedState.isDehydrated){var o=Ne(a.pendingLanes);if(o!==0){var s=a;for(s.pendingLanes|=2,s.entangledLanes|=2;o;){var c=1<<31-Ee(o);s.entanglements[1]|=c,o&=~c}md(a),!(Gl&6)&&(fu=_e()+500,hd(0,!1))}}break;case 31:case 13:s=ti(a,2),s!==null&&Tu(s,a,2),Au(),bp(a,2)}if(a=Dp(r),a===null&&Rd(e,t,r,Op,n),a===i)break;i=a}i!==null&&r.stopPropagation()}else Rd(e,t,r,null,n)}}function Dp(e){return e=Wt(e),kp(e)}var Op=null;function kp(e){if(Op=null,e=it(e),e!==null){var t=o(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=s(t),e!==null)return e;e=null}else if(n===31){if(e=c(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Op=e,null}function Ap(e){switch(e){case`beforetoggle`:case`cancel`:case`click`:case`close`:case`contextmenu`:case`copy`:case`cut`:case`auxclick`:case`dblclick`:case`dragend`:case`dragstart`:case`drop`:case`focusin`:case`focusout`:case`input`:case`invalid`:case`keydown`:case`keypress`:case`keyup`:case`mousedown`:case`mouseup`:case`paste`:case`pause`:case`play`:case`pointercancel`:case`pointerdown`:case`pointerup`:case`ratechange`:case`reset`:case`resize`:case`seeked`:case`submit`:case`toggle`:case`touchcancel`:case`touchend`:case`touchstart`:case`volumechange`:case`change`:case`selectionchange`:case`textInput`:case`compositionstart`:case`compositionend`:case`compositionupdate`:case`beforeblur`:case`afterblur`:case`beforeinput`:case`blur`:case`fullscreenchange`:case`focus`:case`hashchange`:case`popstate`:case`select`:case`selectstart`:return 2;case`drag`:case`dragenter`:case`dragexit`:case`dragleave`:case`dragover`:case`mousemove`:case`mouseout`:case`mouseover`:case`pointermove`:case`pointerout`:case`pointerover`:case`scroll`:case`touchmove`:case`wheel`:case`mouseenter`:case`mouseleave`:case`pointerenter`:case`pointerleave`:return 8;case`message`:switch(q()){case ve:return 2;case ye:return 8;case be:case xe:return 32;case Se:return 268435456;default:return 32}default:return 32}}var jp=!1,Mp=null,Np=null,Pp=null,Fp=new Map,Ip=new Map,Lp=[],Rp=`mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset`.split(` `);function zp(e,t){switch(e){case`focusin`:case`focusout`:Mp=null;break;case`dragenter`:case`dragleave`:Np=null;break;case`mouseover`:case`mouseout`:Pp=null;break;case`pointerover`:case`pointerout`:Fp.delete(t.pointerId);break;case`gotpointercapture`:case`lostpointercapture`:Ip.delete(t.pointerId)}}function Bp(e,t,n,r,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[i]},t!==null&&(t=at(t),t!==null&&xp(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Vp(e,t,n,r,i){switch(t){case`focusin`:return Mp=Bp(Mp,e,t,n,r,i),!0;case`dragenter`:return Np=Bp(Np,e,t,n,r,i),!0;case`mouseover`:return Pp=Bp(Pp,e,t,n,r,i),!0;case`pointerover`:var a=i.pointerId;return Fp.set(a,Bp(Fp.get(a)||null,e,t,n,r,i)),!0;case`gotpointercapture`:return a=i.pointerId,Ip.set(a,Bp(Ip.get(a)||null,e,t,n,r,i)),!0}return!1}function Hp(e){var t=it(e.target);if(t!==null){var n=o(t);if(n!==null){if(t=n.tag,t===13){if(t=s(n),t!==null){e.blockedOn=t,qe(e.priority,function(){Sp(n)});return}}else if(t===31){if(t=c(n),t!==null){e.blockedOn=t,qe(e.priority,function(){Sp(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Up(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Dp(e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ut=r,n.target.dispatchEvent(r),Ut=null}else return t=at(n),t!==null&&xp(t),e.blockedOn=n,!1;t.shift()}return!0}function Wp(e,t,n){Up(e)&&n.delete(t)}function Gp(){jp=!1,Mp!==null&&Up(Mp)&&(Mp=null),Np!==null&&Up(Np)&&(Np=null),Pp!==null&&Up(Pp)&&(Pp=null),Fp.forEach(Wp),Ip.forEach(Wp)}function Kp(e,n){e.blockedOn===n&&(e.blockedOn=null,jp||(jp=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Gp)))}var qp=null;function Jp(e){qp!==e&&(qp=e,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){qp===e&&(qp=null);for(var t=0;t<e.length;t+=3){var n=e[t],r=e[t+1],i=e[t+2];if(typeof r!=`function`){if(kp(r||n)===null)continue;break}var a=at(n);a!==null&&(e.splice(t,3),t-=3,ks(a,{pending:!0,data:i,method:n.method,action:r},r,i))}}))}function Yp(e){function t(t){return Kp(t,e)}Mp!==null&&Kp(Mp,e),Np!==null&&Kp(Np,e),Pp!==null&&Kp(Pp,e),Fp.forEach(t),Ip.forEach(t);for(var n=0;n<Lp.length;n++){var r=Lp[n];r.blockedOn===e&&(r.blockedOn=null)}for(;0<Lp.length&&(n=Lp[0],n.blockedOn===null);)Hp(n),n.blockedOn===null&&Lp.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(r=0;r<n.length;r+=3){var i=n[r],a=n[r+1],o=i[Xe]||null;if(typeof a==`function`)o||Jp(n);else if(o){var s=null;if(a&&a.hasAttribute(`formAction`)){if(i=a,o=a[Xe]||null)s=o.formAction;else if(kp(i)!==null)continue}else s=o.action;typeof s==`function`?n[r+1]=s:(n.splice(r,3),r-=3),Jp(n)}}}function Xp(){function e(e){e.canIntercept&&e.info===`react-transition`&&e.intercept({handler:function(){return new Promise(function(e){return i=e})},focusReset:`manual`,scroll:`manual`})}function t(){i!==null&&(i(),i=null),r||setTimeout(n,20)}function n(){if(!r&&!navigation.transition){var e=navigation.currentEntry;e&&e.url!=null&&navigation.navigate(e.url,{state:e.getState(),info:`react-transition`,history:`replace`})}}if(typeof navigation==`object`){var r=!1,i=null;return navigation.addEventListener(`navigate`,e),navigation.addEventListener(`navigatesuccess`,t),navigation.addEventListener(`navigateerror`,t),setTimeout(n,100),function(){r=!0,navigation.removeEventListener(`navigate`,e),navigation.removeEventListener(`navigatesuccess`,t),navigation.removeEventListener(`navigateerror`,t),i!==null&&(i(),i=null)}}}function Zp(e){this._internalRoot=e}Qp.prototype.render=Zp.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(i(409));var n=t.current,r=Cu();vp(n,r,e,t,null,null)},Qp.prototype.unmount=Zp.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;vp(e.current,2,null,e,null,null),Au(),t[Ze]=null}};function Qp(e){this._internalRoot=e}Qp.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ke();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Lp.length&&t!==0&&t<Lp[n].priority;n++);Lp.splice(n,0,e),n===0&&Hp(e)}};var $p=n.version;if($p!==`19.2.0`)throw Error(i(527,$p,`19.2.0`));L.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render==`function`?Error(i(188)):(e=Object.keys(e).join(`,`),Error(i(268,e)));return e=u(t),e=e===null?null:d(e),e=e===null?null:e.stateNode,e};var em={bundleType:0,version:`19.2.0`,rendererPackageName:`react-dom`,currentDispatcherRef:I,reconcilerVersion:`19.2.0`};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<`u`){var tm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tm.isDisabled&&tm.supportsFiber)try{we=tm.inject(em),Te=tm}catch{}}e.createRoot=function(e,t){if(!a(e))throw Error(i(299));var n=!1,r=``,o=Qs,s=$s,c=ec;return t!=null&&(!0===t.unstable_strictMode&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onUncaughtError!==void 0&&(o=t.onUncaughtError),t.onCaughtError!==void 0&&(s=t.onCaughtError),t.onRecoverableError!==void 0&&(c=t.onRecoverableError)),t=gp(e,1,!1,null,null,n,r,null,o,s,c,Xp),e[Ze]=t.current,Id(e),new Zp(t)}})),v=l(o(((e,t)=>{function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>`u`||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!=`function`))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}n(),t.exports=_()}))()),y=l(f(),1),b=`modulepreload`,x=function(e){return`/ahir-book/`+e},S={};const C=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=document.getElementsByTagName(`link`),i=document.querySelector(`meta[property=csp-nonce]`),a=i?.nonce||i?.getAttribute(`nonce`);function o(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:`fulfilled`,value:e}),e=>({status:`rejected`,reason:e}))))}r=o(t.map(t=>{if(t=x(t,n),t in S)return;S[t]=!0;let r=t.endsWith(`.css`),i=r?`[rel="stylesheet"]`:``;if(n)for(let n=e.length-1;n>=0;n--){let i=e[n];if(i.href===t&&(!r||i.rel===`stylesheet`))return}else if(document.querySelector(`link[href="${t}"]${i}`))return;let o=document.createElement(`link`);if(o.rel=r?`stylesheet`:b,r||(o.as=`script`),o.crossOrigin=``,o.href=t,a&&o.setAttribute(`nonce`,a),document.head.appendChild(o),r)return new Promise((e,n)=>{o.addEventListener(`load`,e),o.addEventListener(`error`,()=>n(Error(`Unable to preload CSS for ${t}`)))})}))}function i(e){let t=new Event(`vite:preloadError`,{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(let e of t||[])e.status===`rejected`&&i(e.reason);return e().catch(i)})};var w=`popstate`;function T(e={}){function t(e,t){let{pathname:n,search:r,hash:i}=e.location;return A(``,{pathname:n,search:r,hash:i},t.state&&t.state.usr||null,t.state&&t.state.key||`default`)}function n(e,t){return typeof t==`string`?t:j(t)}return N(t,n,null,e)}function E(e,t){if(e===!1||e==null)throw Error(t)}function D(e,t){if(!e){typeof console<`u`&&console.warn(t);try{throw Error(t)}catch{}}}function O(){return Math.random().toString(36).substring(2,10)}function k(e,t){return{usr:e.state,key:e.key,idx:t}}function A(e,t,n=null,r){return{pathname:typeof e==`string`?e:e.pathname,search:``,hash:``,...typeof t==`string`?M(t):t,state:n,key:t&&t.key||r||O()}}function j({pathname:e=`/`,search:t=``,hash:n=``}){return t&&t!==`?`&&(e+=t.charAt(0)===`?`?t:`?`+t),n&&n!==`#`&&(e+=n.charAt(0)===`#`?n:`#`+n),e}function M(e){let t={};if(e){let n=e.indexOf(`#`);n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf(`?`);r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function N(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:a=!1}=r,o=i.history,s=`POP`,c=null,l=u();l??(l=0,o.replaceState({...o.state,idx:l},``));function u(){return(o.state||{idx:null}).idx}function d(){s=`POP`;let e=u(),t=e==null?null:e-l;l=e,c&&c({action:s,location:h.location,delta:t})}function f(e,t){s=`PUSH`;let r=A(h.location,e,t);n&&n(r,e),l=u()+1;let d=k(r,l),f=h.createHref(r);try{o.pushState(d,``,f)}catch(e){if(e instanceof DOMException&&e.name===`DataCloneError`)throw e;i.location.assign(f)}a&&c&&c({action:s,location:h.location,delta:1})}function p(e,t){s=`REPLACE`;let r=A(h.location,e,t);n&&n(r,e),l=u();let i=k(r,l),d=h.createHref(r);o.replaceState(i,``,d),a&&c&&c({action:s,location:h.location,delta:0})}function m(e){return P(e)}let h={get action(){return s},get location(){return e(i,o)},listen(e){if(c)throw Error(`A history only accepts one active listener`);return i.addEventListener(w,d),c=e,()=>{i.removeEventListener(w,d),c=null}},createHref(e){return t(i,e)},createURL:m,encodeLocation(e){let t=m(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:f,replace:p,go(e){return o.go(e)}};return h}function P(e,t=!1){let n=`http://localhost`;typeof window<`u`&&(n=window.location.origin===`null`?window.location.href:window.location.origin),E(n,`No window.location.(origin|href) available to create URL`);let r=typeof e==`string`?e:j(e);return r=r.replace(/ $/,`%20`),!t&&r.startsWith(`//`)&&(r=n+r),new URL(r,n)}function F(e,t,n=`/`){return I(e,t,n,!1)}function I(e,t,n,r){let i=typeof t==`string`?M(t):t,a=V(i.pathname||`/`,n);if(a==null)return null;let o=R(e);te(o);let s=null;for(let e=0;s==null&&e<o.length;++e){let t=fe(a);s=le(o[e],t,r)}return s}function L(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],loaderData:t[n.id],handle:n.handle}}function R(e,t=[],n=[],r=``,i=!1){let a=(e,a,o=i,s)=>{let c={relativePath:s===void 0?e.path||``:s,caseSensitive:e.caseSensitive===!0,childrenIndex:a,route:e};if(c.relativePath.startsWith(`/`)){if(!c.relativePath.startsWith(r)&&o)return;E(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length)}let l=G([r,c.relativePath]),u=n.concat(c);e.children&&e.children.length>0&&(E(e.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),R(e.children,t,u,l,o)),!(e.path==null&&!e.index)&&t.push({path:l,score:ce(l,e.index),routesMeta:u})};return e.forEach((e,t)=>{if(e.path===``||!e.path?.includes(`?`))a(e,t);else for(let n of ee(e.path))a(e,t,!0,n)}),t}function ee(e){let t=e.split(`/`);if(t.length===0)return[];let[n,...r]=t,i=n.endsWith(`?`),a=n.replace(/\?$/,``);if(r.length===0)return i?[a,``]:[a];let o=ee(r.join(`/`)),s=[];return s.push(...o.map(e=>e===``?a:[a,e].join(`/`))),i&&s.push(...o),s.map(t=>e.startsWith(`/`)&&t===``?`/`:t)}function te(e){e.sort((e,t)=>e.score===t.score?B(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)):t.score-e.score)}var ne=/^:[\w-]+$/,re=3,ie=2,ae=1,oe=10,z=-2,se=e=>e===`*`;function ce(e,t){let n=e.split(`/`),r=n.length;return n.some(se)&&(r+=z),t&&(r+=ie),n.filter(e=>!se(e)).reduce((e,t)=>e+(ne.test(t)?re:t===``?ae:oe),r)}function B(e,t){return e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n])?e[e.length-1]-t[t.length-1]:0}function le(e,t,n=!1){let{routesMeta:r}=e,i={},a=`/`,o=[];for(let e=0;e<r.length;++e){let s=r[e],c=e===r.length-1,l=a===`/`?t:t.slice(a.length)||`/`,u=ue({path:s.relativePath,caseSensitive:s.caseSensitive,end:c},l),d=s.route;if(!u&&c&&n&&!r[r.length-1].route.index&&(u=ue({path:s.relativePath,caseSensitive:s.caseSensitive,end:!1},l)),!u)return null;Object.assign(i,u.params),o.push({params:i,pathname:G([a,u.pathname]),pathnameBase:K(G([a,u.pathnameBase])),route:d}),u.pathnameBase!==`/`&&(a=G([a,u.pathnameBase]))}return o}function ue(e,t){typeof e==`string`&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=de(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let a=i[0],o=a.replace(/(.)\/+$/,`$1`),s=i.slice(1);return{params:r.reduce((e,{paramName:t,isOptional:n},r)=>{if(t===`*`){let e=s[r]||``;o=a.slice(0,a.length-e.length).replace(/(.)\/+$/,`$1`)}let i=s[r];return n&&!i?e[t]=void 0:e[t]=(i||``).replace(/%2F/g,`/`),e},{}),pathname:a,pathnameBase:o,pattern:e}}function de(e,t=!1,n=!0){D(e===`*`||!e.endsWith(`*`)||e.endsWith(`/*`),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,`/*`)}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,`/*`)}".`);let r=[],i=`^`+e.replace(/\/*\*?$/,``).replace(/^\/*/,`/`).replace(/[\\.*+^${}|()[\]]/g,`\\$&`).replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(r.push({paramName:t,isOptional:n!=null}),n?`/?([^\\/]+)?`:`/([^\\/]+)`)).replace(/\/([\w-]+)\?(\/|$)/g,`(/$1)?$2`);return e.endsWith(`*`)?(r.push({paramName:`*`}),i+=e===`*`||e===`/*`?`(.*)$`:`(?:\\/(.+)|\\/*)$`):n?i+=`\\/*$`:e!==``&&e!==`/`&&(i+=`(?:(?=\\/|$))`),[new RegExp(i,t?void 0:`i`),r]}function fe(e){try{return e.split(`/`).map(e=>decodeURIComponent(e).replace(/\//g,`%2F`)).join(`/`)}catch(t){return D(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function V(e,t){if(t===`/`)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith(`/`)?t.length-1:t.length,r=e.charAt(n);return r&&r!==`/`?null:e.slice(n)||`/`}function H(e,t=`/`){let{pathname:n,search:r=``,hash:i=``}=typeof e==`string`?M(e):e;return{pathname:n?n.startsWith(`/`)?n:U(n,t):t,search:ge(r),hash:_e(i)}}function U(e,t){let n=t.replace(/\/+$/,``).split(`/`);return e.split(`/`).forEach(e=>{e===`..`?n.length>1&&n.pop():e!==`.`&&n.push(e)}),n.length>1?n.join(`/`):`/`}function pe(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function me(e){return e.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function W(e){let t=me(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function he(e,t,n,r=!1){let i;typeof e==`string`?i=M(e):(i={...e},E(!i.pathname||!i.pathname.includes(`?`),pe(`?`,`pathname`,`search`,i)),E(!i.pathname||!i.pathname.includes(`#`),pe(`#`,`pathname`,`hash`,i)),E(!i.search||!i.search.includes(`#`),pe(`#`,`search`,`hash`,i)));let a=e===``||i.pathname===``,o=a?`/`:i.pathname,s;if(o==null)s=n;else{let e=t.length-1;if(!r&&o.startsWith(`..`)){let t=o.split(`/`);for(;t[0]===`..`;)t.shift(),--e;i.pathname=t.join(`/`)}s=e>=0?t[e]:`/`}let c=H(i,s),l=o&&o!==`/`&&o.endsWith(`/`),u=(a||o===`.`)&&n.endsWith(`/`);return!c.pathname.endsWith(`/`)&&(l||u)&&(c.pathname+=`/`),c}var G=e=>e.join(`/`).replace(/\/\/+/g,`/`),K=e=>e.replace(/\/+$/,``).replace(/^\/*/,`/`),ge=e=>!e||e===`?`?``:e.startsWith(`?`)?e:`?`+e,_e=e=>!e||e===`#`?``:e.startsWith(`#`)?e:`#`+e;function q(e){return e!=null&&typeof e.status==`number`&&typeof e.statusText==`string`&&typeof e.internal==`boolean`&&`data`in e}var ve=y.createContext(null);ve.displayName=`DataRouter`;var ye=y.createContext(null);ye.displayName=`DataRouterState`,y.createContext(!1);var be=y.createContext({isTransitioning:!1});be.displayName=`ViewTransition`;var xe=y.createContext(new Map);xe.displayName=`Fetchers`;var Se=y.createContext(null);Se.displayName=`Await`;var J=y.createContext(null);J.displayName=`Navigation`;var Ce=y.createContext(null);Ce.displayName=`Location`;var we=y.createContext({outlet:null,matches:[],isDataRoute:!1});we.displayName=`Route`;var Te=y.createContext(null);Te.displayName=`RouteError`;function Y(e,{relative:t}={}){E(Ee(),`useHref() may be used only in the context of a <Router> component.`);let{basename:n,navigator:r}=y.useContext(J),{hash:i,pathname:a,search:o}=Ne(e,{relative:t}),s=a;return n!==`/`&&(s=a===`/`?n:G([n,a])),r.createHref({pathname:s,search:o,hash:i})}function Ee(){return y.useContext(Ce)!=null}function De(){return E(Ee(),`useLocation() may be used only in the context of a <Router> component.`),y.useContext(Ce).location}var Oe=`You should call navigate() in a React.useEffect(), not when your component is first rendered.`;function ke(e){y.useContext(J).static||y.useLayoutEffect(e)}function Ae(){let{isDataRoute:e}=y.useContext(we);return e?Xe():je()}function je(){E(Ee(),`useNavigate() may be used only in the context of a <Router> component.`);let e=y.useContext(ve),{basename:t,navigator:n}=y.useContext(J),{matches:r}=y.useContext(we),{pathname:i}=De(),a=JSON.stringify(W(r)),o=y.useRef(!1);return ke(()=>{o.current=!0}),y.useCallback((r,s={})=>{if(D(o.current,Oe),!o.current)return;if(typeof r==`number`){n.go(r);return}let c=he(r,JSON.parse(a),i,s.relative===`path`);e==null&&t!==`/`&&(c.pathname=c.pathname===`/`?t:G([t,c.pathname])),(s.replace?n.replace:n.push)(c,s.state,s)},[t,n,a,i,e])}y.createContext(null);function Me(){let{matches:e}=y.useContext(we),t=e[e.length-1];return t?t.params:{}}function Ne(e,{relative:t}={}){let{matches:n}=y.useContext(we),{pathname:r}=De(),i=JSON.stringify(W(n));return y.useMemo(()=>he(e,JSON.parse(i),r,t===`path`),[e,i,r,t])}function Pe(e,t){return Fe(e,t)}function Fe(e,t,n,r,i){E(Ee(),`useRoutes() may be used only in the context of a <Router> component.`);let{navigator:a}=y.useContext(J),{matches:o}=y.useContext(we),s=o[o.length-1],c=s?s.params:{},l=s?s.pathname:`/`,u=s?s.pathnameBase:`/`,d=s&&s.route;{let e=d&&d.path||``;Qe(l,!d||e.endsWith(`*`)||e.endsWith(`*?`),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${e}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${e}"> to <Route path="${e===`/`?`*`:`${e}/*`}">.`)}let f=De(),p;if(t){let e=typeof t==`string`?M(t):t;E(u===`/`||e.pathname?.startsWith(u),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${u}" but pathname "${e.pathname}" was given in the \`location\` prop.`),p=e}else p=f;let m=p.pathname||`/`,h=m;if(u!==`/`){let e=u.replace(/^\//,``).split(`/`);h=`/`+m.replace(/^\//,``).split(`/`).slice(e.length).join(`/`)}let g=F(e,{pathname:h});D(d||g!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),D(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=Be(g&&g.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:G([u,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,`%3F`).replace(/#/g,`%23`)).pathname:e.pathname]),pathnameBase:e.pathnameBase===`/`?u:G([u,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,`%3F`).replace(/#/g,`%23`)).pathname:e.pathnameBase])})),o,n,r,i);return t&&_?y.createElement(Ce.Provider,{value:{location:{pathname:`/`,search:``,hash:``,state:null,key:`default`,...p},navigationType:`POP`}},_):_}function Ie(){let e=Ye(),t=q(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r=`rgba(200,200,200, 0.5)`,i={padding:`0.5rem`,backgroundColor:r},a={padding:`2px 4px`,backgroundColor:r},o=null;return console.error(`Error handled by React Router default ErrorBoundary:`,e),o=y.createElement(y.Fragment,null,y.createElement(`p`,null,`💿 Hey developer 👋`),y.createElement(`p`,null,`You can provide a way better UX than this when your app throws errors by providing your own `,y.createElement(`code`,{style:a},`ErrorBoundary`),` or`,` `,y.createElement(`code`,{style:a},`errorElement`),` prop on your route.`)),y.createElement(y.Fragment,null,y.createElement(`h2`,null,`Unexpected Application Error!`),y.createElement(`h3`,{style:{fontStyle:`italic`}},t),n?y.createElement(`pre`,{style:i},n):null,o)}var Le=y.createElement(Ie,null),Re=class extends y.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!==`idle`&&e.revalidation===`idle`?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error===void 0?t.error:e.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error(`React Router caught the following error during render`,e)}render(){return this.state.error===void 0?this.props.children:y.createElement(we.Provider,{value:this.props.routeContext},y.createElement(Te.Provider,{value:this.state.error,children:this.props.component}))}};function ze({routeContext:e,match:t,children:n}){let r=y.useContext(ve);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),y.createElement(we.Provider,{value:e},n)}function Be(e,t=[],n=null,r=null,i=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let a=e,o=n?.errors;if(o!=null){let e=a.findIndex(e=>e.route.id&&o?.[e.route.id]!==void 0);E(e>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(`,`)}`),a=a.slice(0,Math.min(a.length,e+1))}let s=!1,c=-1;if(n)for(let e=0;e<a.length;e++){let t=a[e];if((t.route.HydrateFallback||t.route.hydrateFallbackElement)&&(c=e),t.route.id){let{loaderData:e,errors:r}=n,i=t.route.loader&&!e.hasOwnProperty(t.route.id)&&(!r||r[t.route.id]===void 0);if(t.route.lazy||i){s=!0,a=c>=0?a.slice(0,c+1):[a[0]];break}}}return a.reduceRight((e,i,l)=>{let u,d=!1,f=null,p=null;n&&(u=o&&i.route.id?o[i.route.id]:void 0,f=i.route.errorElement||Le,s&&(c<0&&l===0?(Qe(`route-fallback`,!1,"No `HydrateFallback` element provided to render during initial hydration"),d=!0,p=null):c===l&&(d=!0,p=i.route.hydrateFallbackElement||null)));let m=t.concat(a.slice(0,l+1)),h=()=>{let t;return t=u?f:d?p:i.route.Component?y.createElement(i.route.Component,null):i.route.element?i.route.element:e,y.createElement(ze,{match:i,routeContext:{outlet:e,matches:m,isDataRoute:n!=null},children:t})};return n&&(i.route.ErrorBoundary||i.route.errorElement||l===0)?y.createElement(Re,{location:n.location,revalidation:n.revalidation,component:f,error:u,children:h(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:r}):h()},null)}function Ve(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function He(e){let t=y.useContext(ve);return E(t,Ve(e)),t}function Ue(e){let t=y.useContext(ye);return E(t,Ve(e)),t}function We(e){let t=y.useContext(we);return E(t,Ve(e)),t}function Ge(e){let t=We(e),n=t.matches[t.matches.length-1];return E(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function Ke(){return Ge(`useRouteId`)}function qe(){return Ue(`useNavigation`).navigation}function Je(){let{matches:e,loaderData:t}=Ue(`useMatches`);return y.useMemo(()=>e.map(e=>L(e,t)),[e,t])}function Ye(){let e=y.useContext(Te),t=Ue(`useRouteError`),n=Ge(`useRouteError`);return e===void 0?t.errors?.[n]:e}function Xe(){let{router:e}=He(`useNavigate`),t=Ge(`useNavigate`),n=y.useRef(!1);return ke(()=>{n.current=!0}),y.useCallback(async(r,i={})=>{D(n.current,Oe),n.current&&(typeof r==`number`?e.navigate(r):await e.navigate(r,{fromRouteId:t,...i}))},[e,t])}var Ze={};function Qe(e,t,n){!t&&!Ze[e]&&(Ze[e]=!0,D(!1,n))}y.memo($e);function $e({routes:e,future:t,state:n,unstable_onError:r}){return Fe(e,void 0,n,r,t)}function et(e){E(!1,`A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.`)}function tt({basename:e=`/`,children:t=null,location:n,navigationType:r=`POP`,navigator:i,static:a=!1}){E(!Ee(),`You cannot render a <Router> inside another <Router>. You should never have more than one in your app.`);let o=e.replace(/^\/*/,`/`),s=y.useMemo(()=>({basename:o,navigator:i,static:a,future:{}}),[o,i,a]);typeof n==`string`&&(n=M(n));let{pathname:c=`/`,search:l=``,hash:u=``,state:d=null,key:f=`default`}=n,p=y.useMemo(()=>{let e=V(c,o);return e==null?null:{location:{pathname:e,search:l,hash:u,state:d,key:f},navigationType:r}},[o,c,l,u,d,f,r]);return D(p!=null,`<Router basename="${o}"> is not able to match the URL "${c}${l}${u}" because it does not start with the basename, so the <Router> won't render anything.`),p==null?null:y.createElement(J.Provider,{value:s},y.createElement(Ce.Provider,{children:t,value:p}))}function nt({children:e,location:t}){return Pe(rt(e),t)}function rt(e,t=[]){let n=[];return y.Children.forEach(e,(e,r)=>{if(!y.isValidElement(e))return;let i=[...t,r];if(e.type===y.Fragment){n.push.apply(n,rt(e.props.children,i));return}E(e.type===et,`[${typeof e.type==`string`?e.type:e.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),E(!e.props.index||!e.props.children,`An index route cannot have child routes.`);let a={id:e.props.id||i.join(`-`),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:e.props.hasErrorBoundary===!0||e.props.ErrorBoundary!=null||e.props.errorElement!=null,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=rt(e.props.children,i)),n.push(a)}),n}var it=`get`,at=`application/x-www-form-urlencoded`;function ot(e){return e!=null&&typeof e.tagName==`string`}function st(e){return ot(e)&&e.tagName.toLowerCase()===`button`}function ct(e){return ot(e)&&e.tagName.toLowerCase()===`form`}function lt(e){return ot(e)&&e.tagName.toLowerCase()===`input`}function ut(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function dt(e,t){return e.button===0&&(!t||t===`_self`)&&!ut(e)}function ft(e=``){return new URLSearchParams(typeof e==`string`||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(e=>[n,e]):[[n,r]])},[]))}function pt(e,t){let n=ft(e);return t&&t.forEach((e,r)=>{n.has(r)||t.getAll(r).forEach(e=>{n.append(r,e)})}),n}var mt=null;function ht(){if(mt===null)try{new FormData(document.createElement(`form`),0),mt=!1}catch{mt=!0}return mt}var gt=new Set([`application/x-www-form-urlencoded`,`multipart/form-data`,`text/plain`]);function _t(e){return e!=null&&!gt.has(e)?(D(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${at}"`),null):e}function vt(e,t){let n,r,i,a,o;if(ct(e)){let o=e.getAttribute(`action`);r=o?V(o,t):null,n=e.getAttribute(`method`)||it,i=_t(e.getAttribute(`enctype`))||at,a=new FormData(e)}else if(st(e)||lt(e)&&(e.type===`submit`||e.type===`image`)){let o=e.form;if(o==null)throw Error(`Cannot submit a <button> or <input type="submit"> without a <form>`);let s=e.getAttribute(`formaction`)||o.getAttribute(`action`);if(r=s?V(s,t):null,n=e.getAttribute(`formmethod`)||o.getAttribute(`method`)||it,i=_t(e.getAttribute(`formenctype`))||_t(o.getAttribute(`enctype`))||at,a=new FormData(o,e),!ht()){let{name:t,type:n,value:r}=e;if(n===`image`){let e=t?`${t}.`:``;a.append(`${e}x`,`0`),a.append(`${e}y`,`0`)}else t&&a.append(t,r)}}else if(ot(e))throw Error(`Cannot submit element that is not <form>, <button>, or <input type="submit|image">`);else n=it,r=null,i=at,o=e;return a&&i===`text/plain`&&(o=a,a=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:a,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join(`\0`);function yt(e,t){if(e===!1||e==null)throw Error(t)}function bt(e,t,n){let r=typeof e==`string`?new URL(e,typeof window>`u`?`server://singlefetch/`:window.location.origin):e;return r.pathname===`/`?r.pathname=`_root.${n}`:t&&V(r.pathname,t)===`/`?r.pathname=`${t.replace(/\/$/,``)}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,``)}.${n}`,r}async function xt(e,t){if(e.id in t)return t[e.id];try{let n=await C(()=>import(e.module),[]);return t[e.id]=n,n}catch(t){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function St(e){return e!=null&&typeof e.page==`string`}function Ct(e){return e==null?!1:e.href==null?e.rel===`preload`&&typeof e.imageSrcSet==`string`&&typeof e.imageSizes==`string`:typeof e.rel==`string`&&typeof e.href==`string`}async function wt(e,t,n){let r=await Promise.all(e.map(async e=>{let r=t.routes[e.route.id];if(r){let e=await xt(r,n);return e.links?e.links():[]}return[]}));return kt(r.flat(1).filter(Ct).filter(e=>e.rel===`stylesheet`||e.rel===`preload`).map(e=>e.rel===`stylesheet`?{...e,rel:`prefetch`,as:`style`}:{...e,rel:`prefetch`}))}function Tt(e,t,n,r,i,a){let o=(e,t)=>n[t]?e.route.id!==n[t].route.id:!0,s=(e,t)=>n[t].pathname!==e.pathname||n[t].route.path?.endsWith(`*`)&&n[t].params[`*`]!==e.params[`*`];return a===`assets`?t.filter((e,t)=>o(e,t)||s(e,t)):a===`data`?t.filter((t,a)=>{let c=r.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(o(t,a)||s(t,a))return!0;if(t.route.shouldRevalidate){let r=t.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if(typeof r==`boolean`)return r}return!0}):[]}function Et(e,t,{includeHydrateFallback:n}={}){return Dt(e.map(e=>{let r=t.routes[e.route.id];if(!r)return[];let i=[r.module];return r.clientActionModule&&(i=i.concat(r.clientActionModule)),r.clientLoaderModule&&(i=i.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(i=i.concat(r.hydrateFallbackModule)),r.imports&&(i=i.concat(r.imports)),i}).flat(1))}function Dt(e){return[...new Set(e)]}function Ot(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function kt(e,t){let n=new Set,r=new Set(t);return e.reduce((e,i)=>{if(t&&!St(i)&&i.as===`script`&&i.href&&r.has(i.href))return e;let a=JSON.stringify(Ot(i));return n.has(a)||(n.add(a),e.push({key:a,link:i})),e},[])}function At(){let e=y.useContext(ve);return yt(e,`You must render this element inside a <DataRouterContext.Provider> element`),e}function jt(){let e=y.useContext(ye);return yt(e,`You must render this element inside a <DataRouterStateContext.Provider> element`),e}var Mt=y.createContext(void 0);Mt.displayName=`FrameworkContext`;function Nt(){let e=y.useContext(Mt);return yt(e,`You must render this element inside a <HydratedRouter> element`),e}function Pt(e,t){let n=y.useContext(Mt),[r,i]=y.useState(!1),[a,o]=y.useState(!1),{onFocus:s,onBlur:c,onMouseEnter:l,onMouseLeave:u,onTouchStart:d}=t,f=y.useRef(null);y.useEffect(()=>{if(e===`render`&&o(!0),e===`viewport`){let e=new IntersectionObserver(e=>{e.forEach(e=>{o(e.isIntersecting)})},{threshold:.5});return f.current&&e.observe(f.current),()=>{e.disconnect()}}},[e]),y.useEffect(()=>{if(r){let e=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(e)}}},[r]);let p=()=>{i(!0)},m=()=>{i(!1),o(!1)};return n?e===`intent`?[a,f,{onFocus:Ft(s,p),onBlur:Ft(c,m),onMouseEnter:Ft(l,p),onMouseLeave:Ft(u,m),onTouchStart:Ft(d,p)}]:[a,f,{}]:[!1,f,{}]}function Ft(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function It({page:e,...t}){let{router:n}=At(),r=y.useMemo(()=>F(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?y.createElement(Rt,{page:e,matches:r,...t}):null}function Lt(e){let{manifest:t,routeModules:n}=Nt(),[r,i]=y.useState([]);return y.useEffect(()=>{let r=!1;return wt(e,t,n).then(e=>{r||i(e)}),()=>{r=!0}},[e,t,n]),r}function Rt({page:e,matches:t,...n}){let r=De(),{manifest:i,routeModules:a}=Nt(),{basename:o}=At(),{loaderData:s,matches:c}=jt(),l=y.useMemo(()=>Tt(e,t,c,i,r,`data`),[e,t,c,i,r]),u=y.useMemo(()=>Tt(e,t,c,i,r,`assets`),[e,t,c,i,r]),d=y.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let n=new Set,c=!1;if(t.forEach(e=>{let t=i.routes[e.route.id];!t||!t.hasLoader||(!l.some(t=>t.route.id===e.route.id)&&e.route.id in s&&a[e.route.id]?.shouldRevalidate||t.hasClientLoader?c=!0:n.add(e.route.id))}),n.size===0)return[];let u=bt(e,o,`data`);return c&&n.size>0&&u.searchParams.set(`_routes`,t.filter(e=>n.has(e.route.id)).map(e=>e.route.id).join(`,`)),[u.pathname+u.search]},[o,s,r,i,l,t,e,a]),f=y.useMemo(()=>Et(u,i),[u,i]),p=Lt(u);return y.createElement(y.Fragment,null,d.map(e=>y.createElement(`link`,{key:e,rel:`prefetch`,as:`fetch`,href:e,...n})),f.map(e=>y.createElement(`link`,{key:e,rel:`modulepreload`,href:e,...n})),p.map(({key:e,link:t})=>y.createElement(`link`,{key:e,nonce:n.nonce,...t})))}function zt(...e){return t=>{e.forEach(e=>{typeof e==`function`?e(t):e!=null&&(e.current=t)})}}var Bt=typeof window<`u`&&window.document!==void 0&&window.document.createElement!==void 0;try{Bt&&(window.__reactRouterVersion=`7.9.4`)}catch{}function Vt({basename:e,children:t,window:n}){let r=y.useRef();r.current??=T({window:n,v5Compat:!0});let i=r.current,[a,o]=y.useState({action:i.action,location:i.location}),s=y.useCallback(e=>{y.startTransition(()=>o(e))},[o]);return y.useLayoutEffect(()=>i.listen(s),[i,s]),y.createElement(tt,{basename:e,children:t,location:a.location,navigationType:a.action,navigator:i})}function Ht({basename:e,children:t,history:n}){let[r,i]=y.useState({action:n.action,location:n.location}),a=y.useCallback(e=>{y.startTransition(()=>i(e))},[i]);return y.useLayoutEffect(()=>n.listen(a),[n,a]),y.createElement(tt,{basename:e,children:t,location:r.location,navigationType:r.action,navigator:n})}Ht.displayName=`unstable_HistoryRouter`;var Ut=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Wt=y.forwardRef(function({onClick:e,discover:t=`render`,prefetch:n=`none`,relative:r,reloadDocument:i,replace:a,state:o,target:s,to:c,preventScrollReset:l,viewTransition:u,...d},f){let{basename:p}=y.useContext(J),m=typeof c==`string`&&Ut.test(c),h,g=!1;if(typeof c==`string`&&m&&(h=c,Bt))try{let e=new URL(window.location.href),t=c.startsWith(`//`)?new URL(e.protocol+c):new URL(c),n=V(t.pathname,p);t.origin===e.origin&&n!=null?c=n+t.search+t.hash:g=!0}catch{D(!1,`<Link to="${c}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=Y(c,{relative:r}),[v,b,x]=Pt(n,d),S=Zt(c,{replace:a,state:o,target:s,preventScrollReset:l,relative:r,viewTransition:u});function C(t){e&&e(t),t.defaultPrevented||S(t)}let w=y.createElement(`a`,{...d,...x,href:h||_,onClick:g||i?e:C,ref:zt(f,b),target:s,"data-discover":!m&&t===`render`?`true`:void 0});return v&&!m?y.createElement(y.Fragment,null,w,y.createElement(It,{page:_})):w});Wt.displayName=`Link`;var Gt=y.forwardRef(function({"aria-current":e=`page`,caseSensitive:t=!1,className:n=``,end:r=!1,style:i,to:a,viewTransition:o,children:s,...c},l){let u=Ne(a,{relative:c.relative}),d=De(),f=y.useContext(ye),{navigator:p,basename:m}=y.useContext(J),h=f!=null&&ln(u)&&o===!0,g=p.encodeLocation?p.encodeLocation(u).pathname:u.pathname,_=d.pathname,v=f&&f.navigation&&f.navigation.location?f.navigation.location.pathname:null;t||(_=_.toLowerCase(),v=v?v.toLowerCase():null,g=g.toLowerCase()),v&&m&&(v=V(v,m)||v);let b=g!==`/`&&g.endsWith(`/`)?g.length-1:g.length,x=_===g||!r&&_.startsWith(g)&&_.charAt(b)===`/`,S=v!=null&&(v===g||!r&&v.startsWith(g)&&v.charAt(g.length)===`/`),C={isActive:x,isPending:S,isTransitioning:h},w=x?e:void 0,T;T=typeof n==`function`?n(C):[n,x?`active`:null,S?`pending`:null,h?`transitioning`:null].filter(Boolean).join(` `);let E=typeof i==`function`?i(C):i;return y.createElement(Wt,{...c,"aria-current":w,className:T,ref:l,style:E,to:a,viewTransition:o},typeof s==`function`?s(C):s)});Gt.displayName=`NavLink`;var Kt=y.forwardRef(({discover:e=`render`,fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:a,method:o=it,action:s,onSubmit:c,relative:l,preventScrollReset:u,viewTransition:d,...f},p)=>{let m=tn(),h=nn(s,{relative:l}),g=o.toLowerCase()===`get`?`get`:`post`,_=typeof s==`string`&&Ut.test(s);return y.createElement(`form`,{ref:p,method:g,action:h,onSubmit:r?c:e=>{if(c&&c(e),e.defaultPrevented)return;e.preventDefault();let r=e.nativeEvent.submitter,s=r?.getAttribute(`formmethod`)||o;m(r||e.currentTarget,{fetcherKey:t,method:s,navigate:n,replace:i,state:a,relative:l,preventScrollReset:u,viewTransition:d})},...f,"data-discover":!_&&e===`render`?`true`:void 0})});Kt.displayName=`Form`;function qt({getKey:e,storageKey:t,...n}){let r=y.useContext(Mt),{basename:i}=y.useContext(J),a=De(),o=Je();sn({getKey:e,storageKey:t});let s=y.useMemo(()=>{if(!r||!e)return null;let t=on(a,o,i,e);return t===a.key?null:t},[]);if(!r||r.isSpaMode)return null;let c=((e,t)=>{if(!window.history.state||!window.history.state.key){let e=Math.random().toString(32).slice(2);window.history.replaceState({key:e},``)}try{let n=JSON.parse(sessionStorage.getItem(e)||`{}`)[t||window.history.state.key];typeof n==`number`&&window.scrollTo(0,n)}catch(t){console.error(t),sessionStorage.removeItem(e)}}).toString();return y.createElement(`script`,{...n,suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:`(${c})(${JSON.stringify(t||rn)}, ${JSON.stringify(s)})`}})}qt.displayName=`ScrollRestoration`;function Jt(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Yt(e){let t=y.useContext(ve);return E(t,Jt(e)),t}function Xt(e){let t=y.useContext(ye);return E(t,Jt(e)),t}function Zt(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:a,viewTransition:o}={}){let s=Ae(),c=De(),l=Ne(e,{relative:a});return y.useCallback(u=>{if(dt(u,t)){u.preventDefault();let t=n===void 0?j(c)===j(l):n;s(e,{replace:t,state:r,preventScrollReset:i,relative:a,viewTransition:o})}},[c,s,l,n,r,t,e,i,a,o])}function Qt(e){D(typeof URLSearchParams<`u`,"You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let t=y.useRef(ft(e)),n=y.useRef(!1),r=De(),i=y.useMemo(()=>pt(r.search,n.current?null:t.current),[r.search]),a=Ae(),o=y.useCallback((e,t)=>{let r=ft(typeof e==`function`?e(new URLSearchParams(i)):e);n.current=!0,a(`?`+r,t)},[a,i]);return[i,o]}var $t=0,en=()=>`__${String(++$t)}__`;function tn(){let{router:e}=Yt(`useSubmit`),{basename:t}=y.useContext(J),n=Ke();return y.useCallback(async(r,i={})=>{let{action:a,method:o,encType:s,formData:c,body:l}=vt(r,t);if(i.navigate===!1){let t=i.fetcherKey||en();await e.fetch(t,n,i.action||a,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||o,formEncType:i.encType||s,flushSync:i.flushSync})}else await e.navigate(i.action||a,{preventScrollReset:i.preventScrollReset,formData:c,body:l,formMethod:i.method||o,formEncType:i.encType||s,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function nn(e,{relative:t}={}){let{basename:n}=y.useContext(J),r=y.useContext(we);E(r,`useFormAction must be used inside a RouteContext`);let[i]=r.matches.slice(-1),a={...Ne(e||`.`,{relative:t})},o=De();if(e==null){a.search=o.search;let e=new URLSearchParams(a.search),t=e.getAll(`index`);if(t.some(e=>e===``)){e.delete(`index`),t.filter(e=>e).forEach(t=>e.append(`index`,t));let n=e.toString();a.search=n?`?${n}`:``}}return(!e||e===`.`)&&i.route.index&&(a.search=a.search?a.search.replace(/^\?/,`?index&`):`?index`),n!==`/`&&(a.pathname=a.pathname===`/`?n:G([n,a.pathname])),j(a)}var rn=`react-router-scroll-positions`,an={};function on(e,t,n,r){let i=null;return r&&(i=r(n===`/`?e:{...e,pathname:V(e.pathname,n)||e.pathname},t)),i??=e.key,i}function sn({getKey:e,storageKey:t}={}){let{router:n}=Yt(`useScrollRestoration`),{restoreScrollPosition:r,preventScrollReset:i}=Xt(`useScrollRestoration`),{basename:a}=y.useContext(J),o=De(),s=Je(),c=qe();y.useEffect(()=>(window.history.scrollRestoration=`manual`,()=>{window.history.scrollRestoration=`auto`}),[]),cn(y.useCallback(()=>{if(c.state===`idle`){let t=on(o,s,a,e);an[t]=window.scrollY}try{sessionStorage.setItem(t||rn,JSON.stringify(an))}catch(e){D(!1,`Failed to save scroll positions in sessionStorage, <ScrollRestoration /> will not work properly (${e}).`)}window.history.scrollRestoration=`auto`},[c.state,e,a,o,s,t])),typeof document<`u`&&(y.useLayoutEffect(()=>{try{let e=sessionStorage.getItem(t||rn);e&&(an=JSON.parse(e))}catch{}},[t]),y.useLayoutEffect(()=>{let t=n?.enableScrollRestoration(an,()=>window.scrollY,e?(t,n)=>on(t,n,a,e):void 0);return()=>t&&t()},[n,a,e]),y.useLayoutEffect(()=>{if(r!==!1){if(typeof r==`number`){window.scrollTo(0,r);return}try{if(o.hash){let e=document.getElementById(decodeURIComponent(o.hash.slice(1)));if(e){e.scrollIntoView();return}}}catch{D(!1,`"${o.hash.slice(1)}" is not a decodable element ID. The view will not scroll to it.`)}i!==!0&&window.scrollTo(0,0)}},[o,r,i]))}function cn(e,t){let{capture:n}=t||{};y.useEffect(()=>{let t=n==null?void 0:{capture:n};return window.addEventListener(`pagehide`,e,t),()=>{window.removeEventListener(`pagehide`,e,t)}},[e,n])}function ln(e,{relative:t}={}){let n=y.useContext(be);E(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Yt(`useViewTransitionState`),i=Ne(e,{relative:t});if(!n.isTransitioning)return!1;let a=V(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=V(n.nextLocation.pathname,r)||n.nextLocation.pathname;return ue(i.pathname,o)!=null||ue(i.pathname,a)!=null}var un=l(o(((e,t)=>{(function(n,r){typeof e==`object`&&t!==void 0?t.exports=r():typeof define==`function`&&define.amd?define(r):(n=typeof globalThis<`u`?globalThis:n||self).Dexie=r()})(e,function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)},t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function n(e,t,n){if(n||arguments.length===2)for(var r,i=0,a=t.length;i<a;i++)!r&&i in t||((r||=Array.prototype.slice.call(t,0,i))[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var r=typeof globalThis<`u`?globalThis:typeof self<`u`?self:typeof window<`u`?window:global,i=Object.keys,a=Array.isArray;function o(e,t){return typeof t!=`object`||i(t).forEach(function(n){e[n]=t[n]}),e}typeof Promise>`u`||r.Promise||(r.Promise=Promise);var s=Object.getPrototypeOf,c={}.hasOwnProperty;function l(e,t){return c.call(e,t)}function u(e,t){typeof t==`function`&&(t=t(s(e))),(typeof Reflect>`u`?i:Reflect.ownKeys)(t).forEach(function(n){f(e,n,t[n])})}var d=Object.defineProperty;function f(e,t,n,r){d(e,t,o(n&&l(n,`get`)&&typeof n.get==`function`?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function p(e){return{from:function(t){return e.prototype=Object.create(t.prototype),f(e.prototype,`constructor`,e),{extend:u.bind(null,e.prototype)}}}}var m=Object.getOwnPropertyDescriptor,h=[].slice;function g(e,t,n){return h.call(e,t,n)}function _(e,t){return t(e)}function v(e){if(!e)throw Error(`Assertion Failed`)}function y(e){r.setImmediate?setImmediate(e):setTimeout(e,0)}function b(e,t){if(typeof t==`string`&&l(e,t))return e[t];if(!t)return e;if(typeof t!=`string`){for(var n=[],r=0,i=t.length;r<i;++r){var a=b(e,t[r]);n.push(a)}return n}var o=t.indexOf(`.`);if(o!==-1){var s=e[t.substr(0,o)];return s==null?void 0:b(s,t.substr(o+1))}}function x(e,t,n){if(e&&t!==void 0&&!(`isFrozen`in Object&&Object.isFrozen(e)))if(typeof t!=`string`&&`length`in t){v(typeof n!=`string`&&`length`in n);for(var r=0,i=t.length;r<i;++r)x(e,t[r],n[r])}else{var o,s,c=t.indexOf(`.`);c===-1?n===void 0?a(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n:(o=t.substr(0,c),(s=t.substr(c+1))===``?n===void 0?a(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n:x(c=!(c=e[o])||!l(e,o)?e[o]={}:c,s,n))}}function S(e){var t,n={};for(t in e)l(e,t)&&(n[t]=e[t]);return n}var C=[].concat;function w(e){return C.apply([],e)}var T=`BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey`.split(`,`).concat(w([8,16,32,64].map(function(e){return[`Int`,`Uint`,`Float`].map(function(t){return t+e+`Array`})}))).filter(function(e){return r[e]}),E=new Set(T.map(function(e){return r[e]})),D=null;function O(e){return D=new WeakMap,e=function e(t){if(!t||typeof t!=`object`)return t;var n=D.get(t);if(n)return n;if(a(t)){n=[],D.set(t,n);for(var r=0,i=t.length;r<i;++r)n.push(e(t[r]))}else if(E.has(t.constructor))n=t;else{var o,c=s(t);for(o in n=c===Object.prototype?{}:Object.create(c),D.set(t,n),t)l(t,o)&&(n[o]=e(t[o]))}return n}(e),D=null,e}var k={}.toString;function A(e){return k.call(e).slice(8,-1)}var j=typeof Symbol<`u`?Symbol.iterator:`@@iterator`,M=typeof j==`symbol`?function(e){var t;return e!=null&&(t=e[j])&&t.apply(e)}:function(){return null};function N(e,t){return t=e.indexOf(t),0<=t&&e.splice(t,1),0<=t}var P={};function F(e){var t,n,r,i;if(arguments.length===1){if(a(e))return e.slice();if(this===P&&typeof e==`string`)return[e];if(i=M(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(e==null||typeof(t=e.length)!=`number`)return[e];for(n=Array(t);t--;)n[t]=e[t];return n}for(t=arguments.length,n=Array(t);t--;)n[t]=arguments[t];return n}var I=typeof Symbol<`u`?function(e){return e[Symbol.toStringTag]===`AsyncFunction`}:function(){return!1},L=[`Unknown`,`Constraint`,`Data`,`TransactionInactive`,`ReadOnly`,`Version`,`NotFound`,`InvalidState`,`InvalidAccess`,`Abort`,`Timeout`,`QuotaExceeded`,`Syntax`,`DataClone`],R=[`Modify`,`Bulk`,`OpenFailed`,`VersionChange`,`Schema`,`Upgrade`,`InvalidTable`,`MissingAPI`,`NoSuchDatabase`,`InvalidArgument`,`SubTransaction`,`Unsupported`,`Internal`,`DatabaseClosed`,`PrematureCommit`,`ForeignAwait`].concat(L),ee={VersionChanged:`Database version changed by other database connection`,DatabaseClosed:`Database has been closed`,Abort:`Transaction aborted`,TransactionInactive:`Transaction has already completed or failed`,MissingAPI:`IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb`};function te(e,t){this.name=e,this.message=t}function ne(e,t){return e+`. Errors: `+Object.keys(t).map(function(e){return t[e].toString()}).filter(function(e,t,n){return n.indexOf(e)===t}).join(`
`)}function re(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=ne(e,t)}function ie(e,t){this.name=`BulkError`,this.failures=Object.keys(t).map(function(e){return t[e]}),this.failuresByPos=t,this.message=ne(e,this.failures)}p(te).from(Error).extend({toString:function(){return this.name+`: `+this.message}}),p(re).from(te),p(ie).from(te);var ae=R.reduce(function(e,t){return e[t]=t+`Error`,e},{}),oe=te,z=R.reduce(function(e,t){var n=t+`Error`;function r(e,r){this.name=n,e?typeof e==`string`?(this.message=`${e}${r?`
 `+r:``}`,this.inner=r||null):typeof e==`object`&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=ee[t]||n,this.inner=null)}return p(r).from(oe),e[t]=r,e},{});z.Syntax=SyntaxError,z.Type=TypeError,z.Range=RangeError;var se=L.reduce(function(e,t){return e[t+`Error`]=z[t],e},{}),ce=R.reduce(function(e,t){return[`Syntax`,`Type`,`Range`].indexOf(t)===-1&&(e[t+`Error`]=z[t]),e},{});function B(){}function le(e){return e}function ue(e,t){return e==null||e===le?t:function(n){return t(e(n))}}function de(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function fe(e,t){return e===B?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?de(r,this.onsuccess):r),i&&(this.onerror=this.onerror?de(i,this.onerror):i),a===void 0?n:a}}function V(e,t){return e===B?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?de(n,this.onsuccess):n),r&&(this.onerror=this.onerror?de(r,this.onerror):r)}}function H(e,t){return e===B?t:function(n){var r=e.apply(this,arguments);o(n,r);var i=this.onsuccess,a=this.onerror;return this.onsuccess=null,this.onerror=null,n=t.apply(this,arguments),i&&(this.onsuccess=this.onsuccess?de(i,this.onsuccess):i),a&&(this.onerror=this.onerror?de(a,this.onerror):a),r===void 0?n===void 0?void 0:n:o(r,n)}}function U(e,t){return e===B?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function pe(e,t){return e===B?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then==`function`){for(var r=this,i=arguments.length,a=Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}ce.ModifyError=re,ce.DexieError=te,ce.BulkError=ie;var me=typeof location<`u`&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function W(e){me=e}var he={},G=100,T=typeof Promise>`u`?[]:function(){var e=Promise.resolve();if(typeof crypto>`u`||!crypto.subtle)return[e,s(e),e];var t=crypto.subtle.digest(`SHA-512`,new Uint8Array([0]));return[t,s(t),e]}(),L=T[0],R=T[1],T=T[2],R=R&&R.then,K=L&&L.constructor,ge=!!T,_e=function(e,t){Ce.push([e,t]),ve&&=(queueMicrotask(Me),!1)},q=!0,ve=!0,ye=[],be=[],xe=le,Se={id:`global`,global:!0,ref:0,unhandleds:[],onunhandled:B,pgp:!1,env:{},finalize:B},J=Se,Ce=[],we=0,Te=[];function Y(e){if(typeof this!=`object`)throw TypeError(`Promises must be constructed via new`);this._listeners=[],this._lib=!1;var t=this._PSD=J;if(typeof e!=`function`){if(e!==he)throw TypeError(`Not a function`);this._state=arguments[1],this._value=arguments[2],!1===this._state&&Oe(this,this._value);return}this._state=null,this._value=null,++t.ref,function e(t,n){try{n(function(n){if(t._state===null){if(n===t)throw TypeError(`A promise cannot be resolved with itself.`);var r=t._lib&&Ne();n&&typeof n.then==`function`?e(t,function(e,t){n instanceof Y?n._then(e,t):n.then(e,t)}):(t._state=!0,t._value=n,ke(t)),r&&Pe()}},Oe.bind(null,t))}catch(e){Oe(t,e)}}(this,e)}var Ee={get:function(){var e=J,t=He;function n(n,r){var i=this,a=!e.global&&(e!==J||t!==He),o=a&&!Ke(),s=new Y(function(t,s){Ae(i,new De(Qe(n,e,a,o),Qe(r,e,a,o),t,s,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=he,n},set:function(e){f(this,`then`,e&&e.prototype===he?Ee:{get:function(){return e},set:Ee.set})}};function De(e,t,n,r,i){this.onFulfilled=typeof e==`function`?e:null,this.onRejected=typeof t==`function`?t:null,this.resolve=n,this.reject=r,this.psd=i}function Oe(e,t){var n,r;be.push(t),e._state===null&&(n=e._lib&&Ne(),t=xe(t),e._state=!1,e._value=t,r=e,ye.some(function(e){return e._value===r._value})||ye.push(r),ke(e),n&&Pe())}function ke(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)Ae(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),we===0&&(++we,_e(function(){--we==0&&Fe()},[]))}function Ae(e,t){if(e._state!==null){var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++we,_e(je,[n,e,t])}else e._listeners.push(t)}function je(e,t,n){try{var r,i=t._value;!t._state&&be.length&&(be=[]),r=me&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),t._state||be.indexOf(i)!==-1||function(e){for(var t=ye.length;t;)if(ye[--t]._value===e._value)return ye.splice(t,1)}(t),n.resolve(r)}catch(e){n.reject(e)}finally{--we==0&&Fe(),--n.psd.ref||n.psd.finalize()}}function Me(){Ze(Se,function(){Ne()&&Pe()})}function Ne(){var e=q;return ve=q=!1,e}function Pe(){var e,t,n;do for(;0<Ce.length;)for(e=Ce,Ce=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(0<Ce.length);ve=q=!0}function Fe(){var e=ye;ye=[],e.forEach(function(e){e._PSD.onunhandled.call(null,e._value,e)});for(var t=Te.slice(0),n=t.length;n;)t[--n]()}function Ie(e){return new Y(he,!1,e)}function Le(e,t){var n=J;return function(){var r=Ne(),i=J;try{return Ye(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Ye(i,!1),r&&Pe()}}}u(Y.prototype,{then:Ee,_then:function(e,t){Ae(this,new De(null,null,e,t,J))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=e,n=arguments[1];return typeof t==`function`?this.then(null,function(e){return(e instanceof t?n:Ie)(e)}):this.then(null,function(e){return(e&&e.name===t?n:Ie)(e)})},finally:function(e){return this.then(function(t){return Y.resolve(e()).then(function(){return t})},function(t){return Y.resolve(e()).then(function(){return Ie(t)})})},timeout:function(e,t){var n=this;return e<1/0?new Y(function(r,i){var a=setTimeout(function(){return i(new z.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<`u`&&Symbol.toStringTag&&f(Y.prototype,Symbol.toStringTag,`Dexie.Promise`),Se.env=Xe(),u(Y,{all:function(){var e=F.apply(null,arguments).map(qe);return new Y(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return Y.resolve(i).then(function(n){e[a]=n,--r||t(e)},n)})})},resolve:function(e){return e instanceof Y?e:e&&typeof e.then==`function`?new Y(function(t,n){e.then(t,n)}):new Y(he,!0,e)},reject:Ie,race:function(){var e=F.apply(null,arguments).map(qe);return new Y(function(t,n){e.map(function(e){return Y.resolve(e).then(t,n)})})},PSD:{get:function(){return J},set:function(e){return J=e}},totalEchoes:{get:function(){return He}},newPSD:We,usePSD:Ze,scheduler:{get:function(){return _e},set:function(e){_e=e}},rejectionMapper:{get:function(){return xe},set:function(e){xe=e}},follow:function(e,t){return new Y(function(n,r){return We(function(t,n){var r=J;r.unhandleds=[],r.onunhandled=n,r.finalize=de(function(){var e,r=this;e=function(){r.unhandleds.length===0?t():n(r.unhandleds[0])},Te.push(function t(){e(),Te.splice(Te.indexOf(t),1)}),++we,_e(function(){--we==0&&Fe()},[])},r.finalize),e()},t,n,r)})}}),K&&(K.allSettled&&f(Y,`allSettled`,function(){var e=F.apply(null,arguments).map(qe);return new Y(function(t){e.length===0&&t([]);var n=e.length,r=Array(n);e.forEach(function(e,i){return Y.resolve(e).then(function(e){return r[i]={status:`fulfilled`,value:e}},function(e){return r[i]={status:`rejected`,reason:e}}).then(function(){return--n||t(r)})})})}),K.any&&typeof AggregateError<`u`&&f(Y,`any`,function(){var e=F.apply(null,arguments).map(qe);return new Y(function(t,n){e.length===0&&n(AggregateError([]));var r=e.length,i=Array(r);e.forEach(function(e,a){return Y.resolve(e).then(function(e){return t(e)},function(e){i[a]=e,--r||n(AggregateError(i))})})})}),K.withResolvers&&(Y.withResolvers=K.withResolvers));var Re={awaits:0,echoes:0,id:0},ze=0,Be=[],Ve=0,He=0,Ue=0;function We(e,t,n,r){var i=J,a=Object.create(i);return a.parent=i,a.ref=0,a.global=!1,a.id=++Ue,Se.env,a.env=ge?{Promise:Y,PromiseProp:{value:Y,configurable:!0,writable:!0},all:Y.all,race:Y.race,allSettled:Y.allSettled,any:Y.any,resolve:Y.resolve,reject:Y.reject}:{},t&&o(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()},r=Ze(a,e,n,r),a.ref===0&&a.finalize(),r}function Ge(){return Re.id||=++ze,++Re.awaits,Re.echoes+=G,Re.id}function Ke(){return!!Re.awaits&&(--Re.awaits==0&&(Re.id=0),Re.echoes=Re.awaits*G,!0)}function qe(e){return Re.echoes&&e&&e.constructor===K?(Ge(),e.then(function(e){return Ke(),e},function(e){return Ke(),et(e)})):e}function Je(){var e=Be[Be.length-1];Be.pop(),Ye(e,!1)}function Ye(e,t){var n,i=J;(t?!Re.echoes||Ve++&&e===J:!Ve||--Ve&&e===J)||queueMicrotask(t?function(e){++He,Re.echoes&&--Re.echoes!=0||(Re.echoes=Re.awaits=Re.id=0),Be.push(J),Ye(e,!0)}.bind(null,e):Je),e!==J&&(J=e,i===Se&&(Se.env=Xe()),ge&&(n=Se.env.Promise,t=e.env,(i.global||e.global)&&(Object.defineProperty(r,`Promise`,t.PromiseProp),n.all=t.all,n.race=t.race,n.resolve=t.resolve,n.reject=t.reject,t.allSettled&&(n.allSettled=t.allSettled),t.any&&(n.any=t.any))))}function Xe(){var e=r.Promise;return ge?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(r,`Promise`),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function Ze(e,t,n,r,i){var a=J;try{return Ye(e,!0),t(n,r,i)}finally{Ye(a,!1)}}function Qe(e,t,n,r){return typeof e==`function`?function(){var i=J;n&&Ge(),Ye(t,!0);try{return e.apply(this,arguments)}finally{Ye(i,!1),r&&queueMicrotask(Ke)}}:e}function $e(e){Promise===K&&Re.echoes===0?Ve===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}(``+R).indexOf(`[native code]`)===-1&&(Ge=Ke=B);var et=Y.reject,tt=`￿`,nt=`Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.`,rt=`String expected.`,it=[],at=`__dbnames`,ot=`readonly`,st=`readwrite`;function ct(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var lt={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function ut(e){return typeof e!=`string`||/\./.test(e)?function(e){return e}:function(t){return t[e]===void 0&&e in t&&delete(t=O(t))[e],t}}function dt(){throw z.Type(`Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.`)}function ft(e,t){try{var n=pt(e),r=pt(t);if(n!==r)return n===`Array`?1:r===`Array`?-1:n===`binary`?1:r===`binary`?-1:n===`string`?1:r===`string`?-1:n===`Date`?1:r===`Date`?-1:NaN;switch(n){case`number`:case`Date`:case`string`:return t<e?1:e<t?-1:0;case`binary`:return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}(mt(e),mt(t));case`Array`:return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var o=ft(e[a],t[a]);if(o!==0)return o}return n===r?0:n<r?-1:1}(e,t)}}catch{}return NaN}function pt(e){var t=typeof e;return t==`object`?ArrayBuffer.isView(e)?`binary`:(e=A(e),e===`ArrayBuffer`?`binary`:e):t}function mt(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function ht(e,t,n){var r=e.schema.yProps;return r?(t&&0<n.numFailures&&(t=t.filter(function(e,t){return!n.failures[t]})),Promise.all(r.map(function(n){return n=n.updatesTable,t?e.db.table(n).where(`k`).anyOf(t).delete():e.db.table(n).clear()})).then(function(){return n})):n}var gt=(_t.prototype.execute=function(e){var t=this[`@@propmod`];if(t.add!==void 0){var r=t.add;if(a(r))return n(n([],a(e)?e:[],!0),r,!0).sort();if(typeof r==`number`)return(Number(e)||0)+r;if(typeof r==`bigint`)try{return BigInt(e)+r}catch{return BigInt(0)+r}throw TypeError(`Invalid term ${r}`)}if(t.remove!==void 0){var i=t.remove;if(a(i))return a(e)?e.filter(function(e){return!i.includes(e)}).sort():[];if(typeof i==`number`)return Number(e)-i;if(typeof i==`bigint`)try{return BigInt(e)-i}catch{return BigInt(0)-i}throw TypeError(`Invalid subtrahend ${i}`)}return r=(r=t.replacePrefix)?.[0],r&&typeof e==`string`&&e.startsWith(r)?t.replacePrefix[1]+e.substring(r.length):e},_t);function _t(e){this[`@@propmod`]=e}function vt(e,t){for(var n=i(t),r=n.length,a=!1,o=0;o<r;++o){var s=n[o],c=t[s],l=b(e,s);c instanceof gt?(x(e,s,c.execute(l)),a=!0):l!==c&&(x(e,s,c),a=!0)}return a}var yt=(bt.prototype._trans=function(e,t,n){var r=this._tx||J.trans,i=this.name,a=me&&typeof console<`u`&&console.createTask&&console.createTask(`Dexie: ${e===`readonly`?`read`:`write`} ${this.name}`);function o(e,n,r){if(!r.schema[i])throw new z.NotFound(`Table `+i+` not part of transaction`);return t(r.idbtrans,r)}var s=Ne();try{var c=r&&r.db._novip===this.db._novip?r===J.trans?r._promise(e,o,n):We(function(){return r._promise(e,o,n)},{trans:r,transless:J.transless||J}):function e(t,n,r,i){if(t.idbdb&&(t._state.openComplete||J.letThrough||t._vip)){var a=t._createTransaction(n,r,t._dbSchema);try{a.create(),t._state.PR1398_maxLoop=3}catch(a){return a.name===ae.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn(`Dexie: Need to reopen db`),t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,n,r,i)})):et(a)}return a._promise(n,function(e,t){return We(function(){return J.trans=a,i(e,t,a)})}).then(function(e){if(n===`readwrite`)try{a.idbtrans.commit()}catch{}return n===`readonly`?e:a._completion.then(function(){return e})})}if(t._state.openComplete)return et(new z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return et(new z.DatabaseClosed);t.open().catch(B)}return t._state.dbReadyPromise.then(function(){return e(t,n,r,i)})}(this.db,e,[this.name],o);return a&&(c._consoleTask=a,c=c.catch(function(e){return console.trace(e),et(e)})),c}finally{s&&Pe()}},bt.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):e==null?et(new z.Type(`Invalid argument to Table.get()`)):this._trans(`readonly`,function(t){return n.core.get({trans:t,key:e}).then(function(e){return n.hook.reading.fire(e)})}).then(t)},bt.prototype.where=function(e){if(typeof e==`string`)return new this.db.WhereClause(this,e);if(a(e))return new this.db.WhereClause(this,`[${e.join(`+`)}]`);var t=i(e);if(t.length===1)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter(function(e){if(e.compound&&t.every(function(t){return 0<=e.keyPath.indexOf(t)})){for(var n=0;n<t.length;++n)if(t.indexOf(e.keyPath[n])===-1)return!1;return!0}return!1}).sort(function(e,t){return e.keyPath.length-t.keyPath.length})[0];if(n&&this.db._maxKey!==tt){var r=n.keyPath.slice(0,t.length);return this.where(r).equals(r.map(function(t){return e[t]}))}!n&&me&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit from a compound index [${t.join(`+`)}]`);var o=this.schema.idxByName;function s(e,t){return ft(e,t)===0}var c=t.reduce(function(t,n){var r=t[0],i=t[1],t=o[n],c=e[n];return[r||t,r||!t?ct(i,t&&t.multi?function(e){return e=b(e,n),a(e)&&e.some(function(e){return s(c,e)})}:function(e){return s(c,b(e,n))}):i]},[null,null]),r=c[0],c=c[1];return r?this.where(r.name).equals(e[r.keyPath]).filter(c):n?this.filter(c):this.where(t).equals(``)},bt.prototype.filter=function(e){return this.toCollection().and(e)},bt.prototype.count=function(e){return this.toCollection().count(e)},bt.prototype.offset=function(e){return this.toCollection().offset(e)},bt.prototype.limit=function(e){return this.toCollection().limit(e)},bt.prototype.each=function(e){return this.toCollection().each(e)},bt.prototype.toArray=function(e){return this.toCollection().toArray(e)},bt.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},bt.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,a(e)?`[${e.join(`+`)}]`:e))},bt.prototype.reverse=function(){return this.toCollection().reverse()},bt.prototype.mapToClass=function(t){var n,r=this.db,i=this.name;function a(){return n!==null&&n.apply(this,arguments)||this}(this.schema.mappedClass=t).prototype instanceof dt&&(function(t,n){if(typeof n!=`function`&&n!==null)throw TypeError(`Class extends value `+String(n)+` is not a constructor or null`);function r(){this.constructor=t}e(t,n),t.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}(a,n=t),Object.defineProperty(a.prototype,`db`,{get:function(){return r},enumerable:!1,configurable:!0}),a.prototype.table=function(){return i},t=a);for(var o=new Set,c=t.prototype;c;c=s(c))Object.getOwnPropertyNames(c).forEach(function(e){return o.add(e)});function l(e){if(!e)return e;var n,r=Object.create(t.prototype);for(n in e)if(!o.has(n))try{r[n]=e[n]}catch{}return r}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=l,this.hook(`reading`,l),t},bt.prototype.defineClass=function(){return this.mapToClass(function(e){o(this,e)})},bt.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,o=e;return a&&i&&(o=ut(a)(e)),this._trans(`readwrite`,function(e){return n.core.mutate({trans:e,type:`add`,keys:t==null?null:[t],values:[o]})}).then(function(e){return e.numFailures?Y.reject(e.failures[0]):e.lastResult}).then(function(t){if(a)try{x(e,a,t)}catch{}return t})},bt.prototype.upsert=function(e,t){var n=this,r=this.schema.primKey.keyPath;return this._trans(`readwrite`,function(i){return n.core.get({trans:i,key:e}).then(function(a){var o=a??{};return vt(o,t),r&&x(o,r,e),n.core.mutate({trans:i,type:`put`,values:[o],keys:[e],upsert:!0,updates:{keys:[e],changeSpecs:[t]}}).then(function(e){return e.numFailures?Y.reject(e.failures[0]):!!a})})})},bt.prototype.update=function(e,t){return typeof e!=`object`||a(e)?this.where(`:id`).equals(e).modify(t):(e=b(e,this.schema.primKey.keyPath),e===void 0?et(new z.InvalidArgument(`Given object does not contain its primary key`)):this.where(`:id`).equals(e).modify(t))},bt.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,a=r.keyPath,o=e;return a&&i&&(o=ut(a)(e)),this._trans(`readwrite`,function(e){return n.core.mutate({trans:e,type:`put`,values:[o],keys:t==null?null:[t]})}).then(function(e){return e.numFailures?Y.reject(e.failures[0]):e.lastResult}).then(function(t){if(a)try{x(e,a,t)}catch{}return t})},bt.prototype.delete=function(e){var t=this;return this._trans(`readwrite`,function(n){return t.core.mutate({trans:n,type:`delete`,keys:[e]}).then(function(n){return ht(t,[e],n)}).then(function(e){return e.numFailures?Y.reject(e.failures[0]):void 0})})},bt.prototype.clear=function(){var e=this;return this._trans(`readwrite`,function(t){return e.core.mutate({trans:t,type:`deleteRange`,range:lt}).then(function(t){return ht(e,null,t)})}).then(function(e){return e.numFailures?Y.reject(e.failures[0]):void 0})},bt.prototype.bulkGet=function(e){var t=this;return this._trans(`readonly`,function(n){return t.core.getMany({keys:e,trans:n}).then(function(e){return e.map(function(e){return t.hook.reading.fire(e)})})})},bt.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n||=i?void 0:t)?n.allKeys:void 0;return this._trans(`readwrite`,function(t){var n=r.schema.primKey,o=n.auto,n=n.keyPath;if(n&&i)throw new z.InvalidArgument(`bulkAdd(): keys argument invalid on tables with inbound keys`);if(i&&i.length!==e.length)throw new z.InvalidArgument(`Arguments objects and keys must have the same length`);var s=e.length,n=n&&o?e.map(ut(n)):e;return r.core.mutate({trans:t,type:`add`,keys:i,values:n,wantResults:a}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,e=e.failures;if(t===0)return a?n:i;throw new ie(`${r.name}.bulkAdd(): ${t} of ${s} operations failed`,e)})})},bt.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,a=(n||=i?void 0:t)?n.allKeys:void 0;return this._trans(`readwrite`,function(t){var n=r.schema.primKey,o=n.auto,n=n.keyPath;if(n&&i)throw new z.InvalidArgument(`bulkPut(): keys argument invalid on tables with inbound keys`);if(i&&i.length!==e.length)throw new z.InvalidArgument(`Arguments objects and keys must have the same length`);var s=e.length,n=n&&o?e.map(ut(n)):e;return r.core.mutate({trans:t,type:`put`,keys:i,values:n,wantResults:a}).then(function(e){var t=e.numFailures,n=e.results,i=e.lastResult,e=e.failures;if(t===0)return a?n:i;throw new ie(`${r.name}.bulkPut(): ${t} of ${s} operations failed`,e)})})},bt.prototype.bulkUpdate=function(e){var t=this,n=this.core,r=e.map(function(e){return e.key}),i=e.map(function(e){return e.changes}),a=[];return this._trans(`readwrite`,function(o){return n.getMany({trans:o,keys:r,cache:`clone`}).then(function(s){var c=[],l=[];e.forEach(function(e,n){var r=e.key,i=e.changes,o=s[n];if(o){for(var u=0,d=Object.keys(i);u<d.length;u++){var f=d[u],p=i[f];if(f===t.schema.primKey.keyPath){if(ft(p,r)!==0)throw new z.Constraint(`Cannot update primary key in bulkUpdate()`)}else x(o,f,p)}a.push(n),c.push(r),l.push(o)}});var u=c.length;return n.mutate({trans:o,type:`put`,keys:c,values:l,updates:{keys:r,changeSpecs:i}}).then(function(e){var n=e.numFailures,r=e.failures;if(n===0)return u;for(var i=0,o=Object.keys(r);i<o.length;i++){var s,c=o[i],l=a[Number(c)];l!=null&&(s=r[c],delete r[c],r[l]=s)}throw new ie(`${t.name}.bulkUpdate(): ${n} of ${u} operations failed`,r)})})})},bt.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans(`readwrite`,function(n){return t.core.mutate({trans:n,type:`delete`,keys:e}).then(function(n){return ht(t,e,n)})}).then(function(e){var r=e.numFailures,i=e.lastResult,e=e.failures;if(r===0)return i;throw new ie(`${t.name}.bulkDelete(): ${r} of ${n} operations failed`,e)})},bt);function bt(){}function xt(e){function t(t,r){if(r){for(var i=arguments.length,a=Array(i-1);--i;)a[i-1]=arguments[i];return n[t].subscribe.apply(null,a),e}if(typeof t==`string`)return n[t]}var n={};t.addEventType=s;for(var r=1,o=arguments.length;r<o;++r)s(arguments[r]);return t;function s(e,r,o){if(typeof e!=`object`){var c;r||=U;var l={subscribers:[],fire:o||=B,subscribe:function(e){l.subscribers.indexOf(e)===-1&&(l.subscribers.push(e),l.fire=r(l.fire,e))},unsubscribe:function(e){l.subscribers=l.subscribers.filter(function(t){return t!==e}),l.fire=l.subscribers.reduce(r,o)}};return n[e]=t[e]=l}i(c=e).forEach(function(e){var t=c[e];if(a(t))s(e,c[e][0],c[e][1]);else{if(t!==`asap`)throw new z.InvalidArgument(`Invalid event config`);var n=s(e,le,function(){for(var e=arguments.length,t=Array(e);e--;)t[e]=arguments[e];n.subscribers.forEach(function(e){y(function(){e.apply(null,t)})})})}})}}function St(e,t){return p(t).from({prototype:e}),t}function Ct(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function wt(e,t){e.filter=ct(e.filter,t)}function Tt(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return ct(r(),t())}:t,e.justLimit=n&&!r}function Et(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new z.Schema(`KeyPath `+e.index+` on object store `+t.name+` is not indexed`);return n}function Dt(e,t,n){var r=Et(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir===`prev`,unique:!!e.unique,query:{index:r,range:e.range}})}function Ot(e,t,n,r){var i=e.replayFilter?ct(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},o=function(e,n,r){var o,s;i&&!i(n,r,function(e){return n.stop(e)},function(e){return n.fail(e)})||((s=``+(o=n.primaryKey))==`[object ArrayBuffer]`&&(s=``+new Uint8Array(o)),l(a,s)||(a[s]=!0,t(e,n,r)))};return Promise.all([e.or._iterate(o,n),kt(Dt(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return kt(Dt(e,r,n),ct(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function kt(e,t,n,r){var i=Le(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then(function(e){if(e)return e.start(function(){var n=function(){return e.continue()};t&&!t(e,function(e){return n=e},function(t){e.stop(t),n=B},function(t){e.fail(t),n=B})||i(e.value,e,function(e){return n=e}),n()})})}var At=(jt.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,et.bind(null,n.error)):n.table._trans(`readonly`,e).then(t)},jt.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,et.bind(null,t.error)):t.table._trans(`readwrite`,e,`locked`)},jt.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=ct(t.algorithm,e)},jt.prototype._iterate=function(e,t){return Ot(this._ctx,e,t,this._ctx.table.core)},jt.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&o(n,e),t._ctx=n,t},jt.prototype.raw=function(){return this._ctx.valueMapper=null,this},jt.prototype.each=function(e){var t=this._ctx;return this._read(function(n){return Ot(t,e,n,t.table.core)})},jt.prototype.count=function(e){var t=this;return this._read(function(e){var n=t._ctx,r=n.table.core;if(Ct(n,!0))return r.count({trans:e,query:{index:Et(n,r.schema),range:n.range}}).then(function(e){return Math.min(e,n.limit)});var i=0;return Ot(n,function(){return++i,!1},e,r).then(function(){return i})}).then(e)},jt.prototype.sortBy=function(e,t){var n=e.split(`.`).reverse(),r=n[0],i=n.length-1;function a(e,t){return t?a(e[n[t]],t-1):e[r]}var o=this._ctx.dir===`next`?1:-1;function s(e,t){return ft(a(e,i),a(t,i))*o}return this.toArray(function(e){return e.sort(s)}).then(t)},jt.prototype.toArray=function(e){var t=this;return this._read(function(e){var n=t._ctx;if(n.dir===`next`&&Ct(n,!0)&&0<n.limit){var r=n.valueMapper,i=Et(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then(function(e){return e=e.result,r?e.map(r):e})}var a=[];return Ot(n,function(e){return a.push(e)},e,n.table.core).then(function(){return a})},e)},jt.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,Ct(t)?Tt(t,function(){var t=e;return function(e,n){return t===0||(t===1?--t:n(function(){e.advance(t),t=0}),!1)}}):Tt(t,function(){var t=e;return function(){return--t<0}})),this},jt.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),Tt(this._ctx,function(){var t=e;return function(e,n,r){return--t<=0&&n(r),0<=t}},!0),this},jt.prototype.until=function(e,t){return wt(this._ctx,function(n,r,i){return!e(n.value)||(r(i),t)}),this},jt.prototype.first=function(e){return this.limit(1).toArray(function(e){return e[0]}).then(e)},jt.prototype.last=function(e){return this.reverse().first(e)},jt.prototype.filter=function(e){var t;return wt(this._ctx,function(t){return e(t.value)}),(t=this._ctx).isMatch=ct(t.isMatch,e),this},jt.prototype.and=function(e){return this.filter(e)},jt.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},jt.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir===`prev`?`next`:`prev`,this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},jt.prototype.desc=function(){return this.reverse()},jt.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.key,n)})},jt.prototype.eachUniqueKey=function(e){return this._ctx.unique=`unique`,this.eachKey(e)},jt.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each(function(t,n){e(n.primaryKey,n)})},jt.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.key)}).then(function(){return n}).then(e)},jt.prototype.primaryKeys=function(e){var t=this._ctx;if(t.dir===`next`&&Ct(t,!0)&&0<t.limit)return this._read(function(e){var n=Et(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})}).then(function(e){return e.result}).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each(function(e,t){n.push(t.primaryKey)}).then(function(){return n}).then(e)},jt.prototype.uniqueKeys=function(e){return this._ctx.unique=`unique`,this.keys(e)},jt.prototype.firstKey=function(e){return this.limit(1).keys(function(e){return e[0]}).then(e)},jt.prototype.lastKey=function(e){return this.reverse().firstKey(e)},jt.prototype.distinct=function(){var e=this._ctx,e=e.index&&e.table.schema.idxByName[e.index];if(!e||!e.multi)return this;var t={};return wt(this._ctx,function(e){var n=e.primaryKey.toString(),e=l(t,n);return t[n]=!0,!e}),this},jt.prototype.modify=function(e){var t=this,n=this._ctx;return this._write(function(r){var a=typeof e==`function`?e:function(t){return vt(t,e)},o=n.table.core,s=o.schema.primaryKey,c=s.outbound,l=s.extractKey,u=200,s=t.db._options.modifyChunkSize;s&&(u=typeof s==`object`?s[o.name]||s[`*`]||200:s);function d(e,t){var n=t.failures,t=t.numFailures;p+=e-t;for(var r=0,a=i(n);r<a.length;r++){var o=a[r];f.push(n[o])}}var f=[],p=0,m=[],h=e===Mt;return t.clone().primaryKeys().then(function(t){function i(f){var p=Math.min(u,t.length-f),m=t.slice(f,f+p);return(h?Promise.resolve([]):o.getMany({trans:r,keys:m,cache:`immutable`})).then(function(g){var _=[],v=[],y=c?[]:null,b=h?m:[];if(!h)for(var x=0;x<p;++x){var S=g[x],C={value:O(S),primKey:t[f+x]};!1!==a.call(C,C.value,C)&&(C.value==null?b.push(t[f+x]):c||ft(l(S),l(C.value))===0?(v.push(C.value),c&&y.push(t[f+x])):(b.push(t[f+x]),_.push(C.value)))}return Promise.resolve(0<_.length&&o.mutate({trans:r,type:`add`,values:_}).then(function(e){for(var t in e.failures)b.splice(parseInt(t),1);d(_.length,e)})).then(function(){return(0<v.length||s&&typeof e==`object`)&&o.mutate({trans:r,type:`put`,keys:y,values:v,criteria:s,changeSpec:typeof e!=`function`&&e,isAdditionalChunk:0<f}).then(function(e){return d(v.length,e)})}).then(function(){return(0<b.length||s&&h)&&o.mutate({trans:r,type:`delete`,keys:b,criteria:s,isAdditionalChunk:0<f}).then(function(e){return ht(n.table,b,e)}).then(function(e){return d(b.length,e)})}).then(function(){return t.length>f+p&&i(f+u)})})}var s=Ct(n)&&n.limit===1/0&&(typeof e!=`function`||h)&&{index:n.index,range:n.range};return i(0).then(function(){if(0<f.length)throw new re(`Error modifying one or more objects`,f,p,m);return t.length})})})},jt.prototype.delete=function(){var e=this._ctx,t=e.range;return!Ct(e)||e.table.schema.yProps||!e.isPrimKey&&t.type!==3?this.modify(Mt):this._write(function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then(function(t){return e.table.core.mutate({trans:n,type:`deleteRange`,range:i}).then(function(e){var n=e.failures,e=e.numFailures;if(e)throw new re(`Could not delete some values`,Object.keys(n).map(function(e){return n[e]}),t-e);return t-e})})})},jt);function jt(){}var Mt=function(e,t){return t.value=null};function Nt(e,t){return e<t?-1:e===t?0:1}function Pt(e,t){return t<e?-1:e===t?0:1}function Ft(e,t,n){return e=e instanceof Bt?new e.Collection(e):e,e._ctx.error=new(n||TypeError)(t),e}function It(e){return new e.Collection(e,function(){return zt(``)}).limit(0)}function Lt(e,t,n,r){var i,a,o,s,c,l,u,d=n.length;if(!n.every(function(e){return typeof e==`string`}))return Ft(e,rt);function f(e){i=e===`next`?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()},a=e===`next`?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()},o=e===`next`?Nt:Pt;var t=n.map(function(e){return{lower:a(e),upper:i(e)}}).sort(function(e,t){return o(e.lower,t.lower)});s=t.map(function(e){return e.upper}),c=t.map(function(e){return e.lower}),u=(l=e)===`next`?``:r}f(`next`),e=new e.Collection(e,function(){return Rt(s[0],c[d-1]+r)}),e._ondirectionchange=function(e){f(e)};var p=0;return e._addAlgorithm(function(e,n,r){var i=e.key;if(typeof i!=`string`)return!1;var f=a(i);if(t(f,c,p))return!0;for(var m=null,h=p;h<d;++h){var g=function(e,t,n,r,i,a){for(var o=Math.min(e.length,r.length),s=-1,c=0;c<o;++c){var l=t[c];if(l!==r[c])return i(e[c],n[c])<0?e.substr(0,c)+n[c]+n.substr(c+1):i(e[c],r[c])<0?e.substr(0,c)+r[c]+n.substr(c+1):0<=s?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[c],l)<0&&(s=c)}return o<r.length&&a===`next`?e+n.substr(e.length):o<e.length&&a===`prev`?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}(i,f,s[h],c[h],o,l);g===null&&m===null?p=h+1:(m===null||0<o(m,g))&&(m=g)}return n(m===null?r:function(){e.continue(m+u)}),!1}),e}function Rt(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function zt(e){return{type:1,lower:e,upper:e}}var Bt=(Object.defineProperty(Vt.prototype,`Collection`,{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Vt.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return 0<this._cmp(e,t)||this._cmp(e,t)===0&&(n||r)&&(!n||!r)?It(this):new this.Collection(this,function(){return Rt(e,t,!n,!r)})}catch{return Ft(this,nt)}},Vt.prototype.equals=function(e){return e==null?Ft(this,nt):new this.Collection(this,function(){return zt(e)})},Vt.prototype.above=function(e){return e==null?Ft(this,nt):new this.Collection(this,function(){return Rt(e,void 0,!0)})},Vt.prototype.aboveOrEqual=function(e){return e==null?Ft(this,nt):new this.Collection(this,function(){return Rt(e,void 0,!1)})},Vt.prototype.below=function(e){return e==null?Ft(this,nt):new this.Collection(this,function(){return Rt(void 0,e,!1,!0)})},Vt.prototype.belowOrEqual=function(e){return e==null?Ft(this,nt):new this.Collection(this,function(){return Rt(void 0,e)})},Vt.prototype.startsWith=function(e){return typeof e==`string`?this.between(e,e+tt,!0,!0):Ft(this,rt)},Vt.prototype.startsWithIgnoreCase=function(e){return e===``?this.startsWith(e):Lt(this,function(e,t){return e.indexOf(t[0])===0},[e],tt)},Vt.prototype.equalsIgnoreCase=function(e){return Lt(this,function(e,t){return e===t[0]},[e],``)},Vt.prototype.anyOfIgnoreCase=function(){var e=F.apply(P,arguments);return e.length===0?It(this):Lt(this,function(e,t){return t.indexOf(e)!==-1},e,``)},Vt.prototype.startsWithAnyOfIgnoreCase=function(){var e=F.apply(P,arguments);return e.length===0?It(this):Lt(this,function(e,t){return t.some(function(t){return e.indexOf(t)===0})},e,tt)},Vt.prototype.anyOf=function(){var e=this,t=F.apply(P,arguments),n=this._cmp;try{t.sort(n)}catch{return Ft(this,nt)}if(t.length===0)return It(this);var r=new this.Collection(this,function(){return Rt(t[0],t[t.length-1])});r._ondirectionchange=function(r){n=r===`next`?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm(function(e,r,a){for(var o=e.key;0<n(o,t[i]);)if(++i===t.length)return r(a),!1;return n(o,t[i])===0||(r(function(){e.continue(t[i])}),!1)}),r},Vt.prototype.notEqual=function(e){return this.inAnyRange([[-1/0,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Vt.prototype.noneOf=function(){var e=F.apply(P,arguments);if(e.length===0)return new this.Collection(this);try{e.sort(this._ascending)}catch{return Ft(this,nt)}var t=e.reduce(function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-1/0,t]]},null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},Vt.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,a=this._descending,o=this._min,s=this._max;if(e.length===0)return It(this);if(!e.every(function(e){return e[0]!==void 0&&e[1]!==void 0&&i(e[0],e[1])<=0}))return Ft(this,`First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower`,z.InvalidArgument);var c=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers,u,d=i;function f(e,t){return d(e[0],t[0])}try{(u=e.reduce(function(e,t){for(var n=0,i=e.length;n<i;++n){var a=e[n];if(r(t[0],a[1])<0&&0<r(t[1],a[0])){a[0]=o(a[0],t[0]),a[1]=s(a[1],t[1]);break}}return n===i&&e.push(t),e},[])).sort(f)}catch{return Ft(this,nt)}var p=0,m=l?function(e){return 0<i(e,u[p][1])}:function(e){return 0<=i(e,u[p][1])},h=c?function(e){return 0<a(e,u[p][0])}:function(e){return 0<=a(e,u[p][0])},g=m,e=new this.Collection(this,function(){return Rt(u[0][0],u[u.length-1][1],!c,!l)});return e._ondirectionchange=function(e){d=e===`next`?(g=m,i):(g=h,a),u.sort(f)},e._addAlgorithm(function(e,t,r){for(var a,o=e.key;g(o);)if(++p===u.length)return t(r),!1;return!m(a=o)&&!h(a)||(n._cmp(o,u[p][1])===0||n._cmp(o,u[p][0])===0||t(function(){d===i?e.continue(u[p][0]):e.continue(u[p][1])}),!1)}),e},Vt.prototype.startsWithAnyOf=function(){var e=F.apply(P,arguments);return e.every(function(e){return typeof e==`string`})?e.length===0?It(this):this.inAnyRange(e.map(function(e){return[e,e+tt]})):Ft(this,`startsWithAnyOf() only works with strings`)},Vt);function Vt(){}function Ht(e){return Le(function(t){return Ut(t),e(t.target.error),!1})}function Ut(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var Wt=`storagemutated`,Gt=`x-storagemutated-1`,Kt=xt(null,Wt),qt=(Jt.prototype._lock=function(){return v(!J.global),++this._reculock,this._reculock!==1||J.global||(J.lockOwnerFor=this),this},Jt.prototype._unlock=function(){if(v(!J.global),--this._reculock==0)for(J.global||(J.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var e=this._blockedFuncs.shift();try{Ze(e[1],e[0])}catch{}}return this},Jt.prototype._locked=function(){return this._reculock&&J.lockOwnerFor!==this},Jt.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(v(!this.idbtrans),!e&&!n)switch(r&&r.name){case`DatabaseClosedError`:throw new z.DatabaseClosed(r);case`MissingAPIError`:throw new z.MissingAPI(r.message,r);default:throw new z.OpenFailed(r)}if(!this.active)throw new z.TransactionInactive;return v(this._completion._state===null),(e=this.idbtrans=e||(this.db.core||n).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Le(function(n){Ut(n),t._reject(e.error)}),e.onabort=Le(function(n){Ut(n),t.active&&t._reject(new z.Abort(e.error)),t.active=!1,t.on(`abort`).fire(n)}),e.oncomplete=Le(function(){t.active=!1,t._resolve(),`mutatedParts`in e&&Kt.storagemutated.fire(e.mutatedParts)}),this},Jt.prototype._promise=function(e,t,n){var r=this;if(e===`readwrite`&&this.mode!==`readwrite`)return et(new z.ReadOnly(`Transaction is readonly`));if(!this.active)return et(new z.TransactionInactive);if(this._locked())return new Y(function(i,a){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,a)},J])});if(n)return We(function(){var e=new Y(function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)});return e.finally(function(){return r._unlock()}),e._lib=!0,e});var i=new Y(function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)});return i._lib=!0,i},Jt.prototype._root=function(){return this.parent?this.parent._root():this},Jt.prototype.waitFor=function(e){var t,n=this._root(),r=Y.resolve(e);n._waitingFor?n._waitingFor=n._waitingFor.then(function(){return r}):(n._waitingFor=r,n._waitingQueue=[],t=n.idbtrans.objectStore(n.storeNames[0]),function e(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(t.get(-1/0).onsuccess=e)}());var i=n._waitingFor;return new Y(function(e,t){r.then(function(t){return n._waitingQueue.push(Le(e.bind(null,t)))},function(e){return n._waitingQueue.push(Le(t.bind(null,e)))}).finally(function(){n._waitingFor===i&&(n._waitingFor=null)})})},Jt.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new z.Abort))},Jt.prototype.table=function(e){var t=this._memoizedTables||={};if(l(t,e))return t[e];var n=this.schema[e];if(!n)throw new z.NotFound(`Table `+e+` not part of transaction`);return n=new this.db.Table(e,n,this),n.core=this.db.core.table(e),t[e]=n},Jt);function Jt(){}function Yt(e,t,n,r,i,a,o,s){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!o?`&`:``)+(r?`*`:``)+(i?`++`:``)+Xt(t),type:s}}function Xt(e){return typeof e==`string`?e:e?`[`+[].join.call(e,`+`)+`]`:``}function Zt(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:(r=function(e){return[e.name,e]},n.reduce(function(e,t,n){return n=r(t,n),n&&(e[n[0]]=n[1]),e},{}))};var r}var Qt=function(e){try{return e.only([[]]),Qt=function(){return[[]]},[[]]}catch{return Qt=function(){return tt},tt}};function $t(e){return e==null?function(){}:typeof e==`string`?(t=e).split(`.`).length===1?function(e){return e[t]}:function(e){return b(e,t)}:function(t){return b(t,e)};var t}function en(e){return[].slice.call(e)}var tn=0;function nn(e){return e==null?`:id`:typeof e==`string`?e:`[${e.join(`+`)}]`}function rn(e,t,n){function r(e){if(e.type===3)return null;if(e.type===4)throw Error(`Cannot convert never type to IDBKeyRange`);var n=e.lower,r=e.upper,i=e.lowerOpen,e=e.upperOpen;return n===void 0?r===void 0?null:t.upperBound(r,!!e):r===void 0?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!e)}function i(e){var t,n=e.name;return{name:n,schema:e,mutate:function(e){var t=e.trans,i=e.type,a=e.keys,o=e.values,s=e.range;return new Promise(function(e,c){e=Le(e);var l=t.objectStore(n),u=l.keyPath==null,d=i===`put`||i===`add`;if(!d&&i!==`delete`&&i!==`deleteRange`)throw Error(`Invalid operation type: `+i);var f,p=(a||o||{length:1}).length;if(a&&o&&a.length!==o.length)throw Error(`Given keys array must have same length as given values array.`);if(p===0)return e({numFailures:0,failures:{},results:[],lastResult:void 0});function m(e){++_,Ut(e)}var h=[],g=[],_=0;if(i===`deleteRange`){if(s.type===4)return e({numFailures:_,failures:g,results:[],lastResult:void 0});s.type===3?h.push(f=l.clear()):h.push(f=l.delete(r(s)))}else{var u=d?u?[o,a]:[o,null]:[a,null],v=u[0],y=u[1];if(d)for(var b=0;b<p;++b)h.push(f=y&&y[b]!==void 0?l[i](v[b],y[b]):l[i](v[b])),f.onerror=m;else for(b=0;b<p;++b)h.push(f=l[i](v[b])),f.onerror=m}function x(t){t=t.target.result,h.forEach(function(e,t){return e.error!=null&&(g[t]=e.error)}),e({numFailures:_,failures:g,results:i===`delete`?a:h.map(function(e){return e.result}),lastResult:t})}f.onerror=function(e){m(e),x(e)},f.onsuccess=x})},getMany:function(e){var t=e.trans,r=e.keys;return new Promise(function(e,i){e=Le(e);for(var a,o=t.objectStore(n),s=r.length,c=Array(s),l=0,u=0,d=function(t){t=t.target,c[t._pos]=t.result,++u===l&&e(c)},f=Ht(i),p=0;p<s;++p)r[p]!=null&&((a=o.get(r[p]))._pos=p,a.onsuccess=d,a.onerror=f,++l);l===0&&e(c)})},get:function(e){var t=e.trans,r=e.key;return new Promise(function(e,i){e=Le(e);var a=t.objectStore(n).get(r);a.onsuccess=function(t){return e(t.target.result)},a.onerror=Ht(i)})},query:(t=u,function(e){return new Promise(function(i,a){i=Le(i);var o,s,c,l=e.trans,u=e.values,d=e.limit,f=e.query,p=d===1/0?void 0:d,m=f.index,f=f.range,l=l.objectStore(n),m=m.isPrimaryKey?l:l.index(m.name),f=r(f);if(d===0)return i({result:[]});t?((p=u?m.getAll(f,p):m.getAllKeys(f,p)).onsuccess=function(e){return i({result:e.target.result})},p.onerror=Ht(a)):(o=0,s=!u&&`openKeyCursor`in m?m.openKeyCursor(f):m.openCursor(f),c=[],s.onsuccess=function(e){var t=s.result;return t?(c.push(u?t.value:t.primaryKey),++o===d?i({result:c}):void t.continue()):i({result:c})},s.onerror=Ht(a))})}),openCursor:function(e){var t=e.trans,i=e.values,a=e.query,o=e.reverse,s=e.unique;return new Promise(function(e,c){e=Le(e);var l=a.index,u=a.range,d=t.objectStore(n),d=l.isPrimaryKey?d:d.index(l.name),l=o?s?`prevunique`:`prev`:s?`nextunique`:`next`,f=!i&&`openKeyCursor`in d?d.openKeyCursor(r(u),l):d.openCursor(r(u),l);f.onerror=Ht(c),f.onsuccess=Le(function(n){var r,i,a,o,s=f.result;s?(s.___id=++tn,s.done=!1,r=s.continue.bind(s),i=(i=s.continuePrimaryKey)&&i.bind(s),a=s.advance.bind(s),o=function(){throw Error(`Cursor not stopped`)},s.trans=t,s.stop=s.continue=s.continuePrimaryKey=s.advance=function(){throw Error(`Cursor not started`)},s.fail=Le(c),s.next=function(){var e=this,t=1;return this.start(function(){return t--?e.continue():e.stop()}).then(function(){return e})},s.start=function(e){function t(){if(f.result)try{e()}catch(e){s.fail(e)}else s.done=!0,s.start=function(){throw Error(`Cursor behind last entry`)},s.stop()}var n=new Promise(function(e,t){e=Le(e),f.onerror=Ht(t),s.fail=t,s.stop=function(t){s.stop=s.continue=s.continuePrimaryKey=s.advance=o,e(t)}});return f.onsuccess=Le(function(e){f.onsuccess=t,t()}),s.continue=r,s.continuePrimaryKey=i,s.advance=a,t(),n},e(s)):e(null)},c)})},count:function(e){var t=e.query,i=e.trans,a=t.index,o=t.range;return new Promise(function(e,t){var s=i.objectStore(n),c=a.isPrimaryKey?s:s.index(a.name),s=r(o),c=s?c.count(s):c.count();c.onsuccess=Le(function(t){return e(t.target.result)}),c.onerror=Ht(t)})}}}var o,s,c,l=(s=n,c=en((o=e).objectStoreNames),{schema:{name:o.name,tables:c.map(function(e){return s.objectStore(e)}).map(function(e){var t=e.keyPath,n=e.autoIncrement,r=a(t),i={},n={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:t==null,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:$t(t)},indexes:en(e.indexNames).map(function(t){return e.index(t)}).map(function(e){var t=e.name,n=e.unique,r=e.multiEntry,e=e.keyPath,r={name:t,compound:a(e),keyPath:e,unique:n,multiEntry:r,extractKey:$t(e)};return i[nn(e)]=r}),getIndexByKeyPath:function(e){return i[nn(e)]}};return i[`:id`]=n.primaryKey,t!=null&&(i[nn(t)]=n.primaryKey),n})},hasGetAll:0<c.length&&`getAll`in s.objectStore(c[0])&&!(typeof navigator<`u`&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),n=l.schema,u=l.hasGetAll,l=n.tables.map(i),d={};return l.forEach(function(e){return d[e.name]=e}),{stack:`dbcore`,transaction:e.transaction.bind(e),table:function(e){if(!d[e])throw Error(`Table '${e}' not found`);return d[e]},MIN_KEY:-1/0,MAX_KEY:Qt(t),schema:n}}function an(e,n,r,i){var a=r.IDBKeyRange;return r.indexedDB,{dbcore:(i=rn(n,a,i),e.dbcore.reduce(function(e,n){return n=n.create,t(t({},e),n(e))},i))}}function on(e,t){var n=t.db,t=an(e._middlewares,n,e._deps,t);e.core=t.dbcore,e.tables.forEach(function(t){var n=t.name;e.core.schema.tables.some(function(e){return e.name===n})&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))})}function sn(e,t,n,r){n.forEach(function(n){var i=r[n];t.forEach(function(t){var r=function e(t,n){return m(t,n)||(t=s(t))&&e(t,n)}(t,n);(!r||`value`in r&&r.value===void 0)&&(t===e.Transaction.prototype||t instanceof e.Transaction?f(t,n,{get:function(){return this.table(n)},set:function(e){d(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))})})}function cn(e,t){t.forEach(function(t){for(var n in t)t[n]instanceof e.Table&&delete t[n]})}function ln(e,t){return e._cfg.version-t._cfg.version}function un(e,t,n,r){var a=e._dbSchema;n.objectStoreNames.contains(`$meta`)&&!a.$meta&&(a.$meta=Zt(`$meta`,vn(``)[0],[]),e._storeNames.push(`$meta`));var o=e._createTransaction(`readwrite`,e._storeNames,a);o.create(n),o._completion.catch(r);var s=o._reject.bind(o),c=J.transless||J;We(function(){return J.trans=o,J.transless=c,t===0?(i(a).forEach(function(e){pn(n,e,a[e].primKey,a[e].indexes)}),on(e,n),void Y.follow(function(){return e.on.populate.fire(o)}).catch(s)):(on(e,n),l=t,((r=o).storeNames.includes(`$meta`)?r.table(`$meta`).get(`version`).then(function(e){return e??l}):Y.resolve(l)).then(function(t){return a=t,s=o,c=n,l=[],t=(r=e)._versions,u=r._dbSchema=gn(0,r.idbdb,c),(t=t.filter(function(e){return e._cfg.version>=a})).length===0?Y.resolve():(t.forEach(function(e){l.push(function(){var t=u,n=e._cfg.dbschema;_n(r,t,c),_n(r,n,c),u=r._dbSchema=n;var o=fn(t,n);o.add.forEach(function(e){pn(c,e[0],e[1].primKey,e[1].indexes)}),o.change.forEach(function(e){if(e.recreate)throw new z.Upgrade(`Not yet support for changing primary key`);var t=c.objectStore(e.name);e.add.forEach(function(e){return hn(t,e)}),e.change.forEach(function(e){t.deleteIndex(e.name),hn(t,e)}),e.del.forEach(function(e){return t.deleteIndex(e)})});var l=e._cfg.contentUpgrade;if(l&&e._cfg.version>a){on(r,c),s._memoizedTables={};var d=S(n);o.del.forEach(function(e){d[e]=t[e]}),cn(r,[r.Transaction.prototype]),sn(r,[r.Transaction.prototype],i(d),d),s.schema=d;var f,p=I(l);return p&&Ge(),o=Y.follow(function(){var e;(f=l(s))&&p&&(e=Ke.bind(null,null),f.then(e,e))}),f&&typeof f.then==`function`?Y.resolve(f):o.then(function(){return f})}}),l.push(function(t){var n=e._cfg.dbschema,i=t;[].slice.call(i.db.objectStoreNames).forEach(function(e){return n[e]==null&&i.db.deleteObjectStore(e)}),cn(r,[r.Transaction.prototype]),sn(r,[r.Transaction.prototype],r._storeNames,r._dbSchema),s.schema=r._dbSchema}),l.push(function(t){r.idbdb.objectStoreNames.contains(`$meta`)&&(Math.ceil(r.idbdb.version/10)===e._cfg.version?(r.idbdb.deleteObjectStore(`$meta`),delete r._dbSchema.$meta,r._storeNames=r._storeNames.filter(function(e){return e!==`$meta`})):t.objectStore(`$meta`).put(e._cfg.version,`version`))})}),function e(){return l.length?Y.resolve(l.shift()(s.idbtrans)).then(e):Y.resolve()}().then(function(){mn(u,c)}));var r,a,s,c,l,u}).catch(s));var r,l})}function dn(e,t){mn(e._dbSchema,t),t.db.version%10!=0||t.objectStoreNames.contains(`$meta`)||t.db.createObjectStore(`$meta`).add(Math.ceil(t.db.version/10-1),`version`);var n=gn(0,e.idbdb,t);_n(e,e._dbSchema,t);for(var r=0,i=fn(n,e._dbSchema).change;r<i.length;r++){var a=function(e){if(e.change.length||e.recreate)return console.warn(`Unable to patch indexes of table ${e.name} because it has changes on the type of index or primary key.`),{value:void 0};var n=t.objectStore(e.name);e.add.forEach(function(t){me&&console.debug(`Dexie upgrade patch: Creating missing index ${e.name}.${t.src}`),hn(n,t)})}(i[r]);if(typeof a==`object`)return a.value}}function fn(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],a=t[n];if(i){var o={name:n,def:a,recreate:!1,del:[],add:[],change:[]};if(``+(i.primKey.keyPath||``)!=``+(a.primKey.keyPath||``)||i.primKey.auto!==a.primKey.auto)o.recreate=!0,r.change.push(o);else{var s=i.idxByName,c=a.idxByName,l=void 0;for(l in s)c[l]||o.del.push(l);for(l in c){var u=s[l],d=c[l];u?u.src!==d.src&&o.change.push(d):o.add.push(d)}(0<o.del.length||0<o.add.length||0<o.change.length)&&r.change.push(o)}}else r.add.push([n,a])}return r}function pn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(e){return hn(i,e)}),i}function mn(e,t){i(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(me&&console.debug(`Dexie: Creating missing table`,n),pn(t,n,e[n].primKey,e[n].indexes))})}function hn(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function gn(e,t,n){var r={};return g(t.objectStoreNames,0).forEach(function(e){for(var t=n.objectStore(e),i=Yt(Xt(c=t.keyPath),c||``,!0,!1,!!t.autoIncrement,c&&typeof c!=`string`,!0),a=[],o=0;o<t.indexNames.length;++o){var s=t.index(t.indexNames[o]),c=s.keyPath,s=Yt(s.name,c,!!s.unique,!!s.multiEntry,!1,c&&typeof c!=`string`,!1);a.push(s)}r[e]=Zt(e,i,a)}),r}function _n(e,t,n){for(var i=n.db.objectStoreNames,a=0;a<i.length;++a){var o=i[a],s=n.objectStore(o);e._hasGetAll=`getAll`in s;for(var c=0;c<s.indexNames.length;++c){var l=s.indexNames[c],u=s.index(l).keyPath,d=typeof u==`string`?u:`[`+g(u).join(`+`)+`]`;!t[o]||(u=t[o].idxByName[d])&&(u.name=l,delete t[o].idxByName[d],t[o].idxByName[l]=u)}}typeof navigator<`u`&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&r.WorkerGlobalScope&&r instanceof r.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function vn(e){return e.split(`,`).map(function(e,t){var n=e.split(`:`),r=(i=n[1])?.trim(),i=(e=n[0].trim()).replace(/([&*]|\+\+)/g,``),n=/^\[/.test(i)?i.match(/^\[(.*)\]$/)[1].split(`+`):i;return Yt(i,n||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),a(n),t===0,r)})}var yn=(bn.prototype._createTableSchema=Zt,bn.prototype._parseIndexSyntax=vn,bn.prototype._parseStoresSpec=function(e,t){var n=this;i(e).forEach(function(r){if(e[r]!==null){var i=n._parseIndexSyntax(e[r]),a=i.shift();if(!a)throw new z.Schema(`Invalid schema for table `+r+`: `+e[r]);if(a.unique=!0,a.multi)throw new z.Schema(`Primary key cannot be multiEntry*`);i.forEach(function(e){if(e.auto)throw new z.Schema(`Only primary key can be marked as autoIncrement (++)`);if(!e.keyPath)throw new z.Schema(`Index must have a name and cannot be an empty string`)}),i=n._createTableSchema(r,a,i),t[r]=i}})},bn.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?o(this._cfg.storesSource,e):e;var e=t._versions,n={},r={};return e.forEach(function(e){o(n,e._cfg.storesSource),r=e._cfg.dbschema={},e._parseStoresSpec(n,r)}),t._dbSchema=r,cn(t,[t._allTables,t,t.Transaction.prototype]),sn(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],i(r),r),t._storeNames=i(r),this},bn.prototype.upgrade=function(e){return this._cfg.contentUpgrade=pe(this._cfg.contentUpgrade||B,e),this},bn);function bn(){}function xn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new ar(at,{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:`name`}),n.table(`dbnames`)}function Sn(e){return e&&typeof e.databases==`function`}function Cn(e){return We(function(){return J.letThrough=!0,e()})}function wn(e){return!(`from`in e)}var Tn=function(e,t){if(!this){var n=new Tn;return e&&`d`in e&&o(n,e),n}o(this,arguments.length?{d:1,from:e,to:1<arguments.length?t:e}:{d:0})};function En(e,t,n){var r=ft(t,n);if(!isNaN(r)){if(0<r)throw RangeError();if(wn(e))return o(e,{from:t,to:n,d:1});var i=e.l,r=e.r;if(ft(n,e.from)<0)return i?En(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},An(e);if(0<ft(t,e.to))return r?En(r,t,n):e.r={from:t,to:n,d:1,l:null,r:null},An(e);ft(t,e.from)<0&&(e.from=t,e.l=null,e.d=r?r.d+1:1),0<ft(n,e.to)&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1),n=!e.r,i&&!e.l&&Dn(e,i),r&&n&&Dn(e,r)}}function Dn(e,t){wn(t)||function e(t,n){var r=n.from,i=n.to,a=n.l,n=n.r;En(t,r,i),a&&e(t,a),n&&e(t,n)}(e,t)}function On(e,t){var n=kn(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=kn(e),o=a.next(i.from),s=o.value;!r.done&&!o.done;){if(ft(s.from,i.to)<=0&&0<=ft(s.to,i.from))return!0;ft(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(o=a.next(i.from)).value}return!1}function kn(e){var t=wn(e)?null:{s:0,n:e};return{next:function(e){for(var n=0<arguments.length;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&ft(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||ft(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function An(e){var n,r,i=((n=e.r)?.d||0)-((r=e.l)?.d||0),a=1<i?`r`:i<-1?`l`:``;a&&(n=a==`r`?`l`:`r`,r=t({},e),i=e[a],e.from=i.from,e.to=i.to,e[a]=i[a],r[a]=i[n],(e[n]=r).d=jn(r)),e.d=jn(e)}function jn(e){var t=e.r,e=e.l;return(t?e?Math.max(t.d,e.d):t.d:e?e.d:0)+1}function Mn(e,t){return i(t).forEach(function(n){e[n]?Dn(e[n],t[n]):e[n]=function e(t){var n,r,i={};for(n in t)l(t,n)&&(r=t[n],i[n]=!r||typeof r!=`object`||E.has(r.constructor)?r:e(r));return i}(t[n])}),e}function Nn(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&On(t[n],e[n])})}u(Tn.prototype,((R={add:function(e){return Dn(this,e),this},addKey:function(e){return En(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(e){return En(t,e,e)}),this},hasKey:function(e){var t=kn(this).next(e).value;return t&&ft(t.from,e)<=0&&0<=ft(t.to,e)}})[j]=function(){return kn(this)},R));var Pn={},Fn={},In=!1;function Ln(e){Mn(Fn,e),In||(In=!0,setTimeout(function(){In=!1,Rn(Fn,!(Fn={}))},0))}function Rn(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(Pn);r<i.length;r++)zn(o=i[r],e,n,t);else for(var a in e){var o,s=/^idb\:\/\/(.*)\/(.*)\//.exec(a);s&&(a=s[1],s=s[2],(o=Pn[`idb://${a}/${s}`])&&zn(o,e,n,t))}n.forEach(function(e){return e()})}function zn(e,t,n,r){for(var i=[],a=0,o=Object.entries(e.queries.query);a<o.length;a++){for(var s=o[a],c=s[0],l=[],u=0,d=s[1];u<d.length;u++){var f=d[u];Nn(t,f.obsSet)?f.subscribers.forEach(function(e){return n.add(e)}):r&&l.push(f)}r&&i.push([c,l])}if(r)for(var p=0,m=i;p<m.length;p++){var h=m[p],c=h[0],l=h[1];e.queries.query[c]=l}}function Bn(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?et(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,a=Math.round(10*e.verno),o=!1;function s(){if(t.openCanceller!==r)throw new z.DatabaseClosed(`db.open() was cancelled`)}function c(){return new Y(function(r,l){if(s(),!n)throw new z.MissingAPI;var u=e.name,p=t.autoSchema||!a?n.open(u):n.open(u,a);if(!p)throw new z.MissingAPI;p.onerror=Ht(l),p.onblocked=Le(e._fireOnBlocked),p.onupgradeneeded=Le(function(r){var i;d=p.transaction,t.autoSchema&&!e._options.allowEmptyDB?(p.onerror=Ut,d.abort(),p.result.close(),(i=n.deleteDatabase(u)).onsuccess=i.onerror=Le(function(){l(new z.NoSuchDatabase(`Database ${u} doesnt exist`))})):(d.onerror=Ht(l),r=r.oldVersion>2**62?0:r.oldVersion,f=r<1,e.idbdb=p.result,o&&dn(e,d),un(e,r/10,d,l))},l),p.onsuccess=Le(function(){d=null;var n,s,l,m,h,_=e.idbdb=p.result,v=g(_.objectStoreNames);if(0<v.length)try{var y=_.transaction((m=v).length===1?m[0]:m,`readonly`);if(t.autoSchema)s=_,l=y,(n=e).verno=s.version/10,l=n._dbSchema=gn(0,s,l),n._storeNames=g(s.objectStoreNames,0),sn(n,[n._allTables],i(l),l);else if(_n(e,e._dbSchema,y),((h=fn(gn(0,(h=e).idbdb,y),h._dbSchema)).add.length||h.change.some(function(e){return e.add.length||e.change.length}))&&!o)return console.warn(`Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.`),_.close(),a=_.version+1,o=!0,r(c());on(e,y)}catch{}it.push(e),_.onversionchange=Le(function(n){t.vcFired=!0,e.on(`versionchange`).fire(n)}),_.onclose=Le(function(){e.close({disableAutoOpen:!1})}),f&&(h=e._deps,y=u,_=h.indexedDB,h=h.IDBKeyRange,Sn(_)||y===at||xn(_,h).put({name:y}).catch(B)),r()},l)}).catch(function(e){switch(e?.name){case`UnknownError`:if(0<t.PR1398_maxLoop)return t.PR1398_maxLoop--,console.warn(`Dexie: Workaround for Chrome UnknownError on open()`),c();break;case`VersionError`:if(0<a)return a=0,c()}return Y.reject(e)})}var l,u=t.dbReadyResolve,d=null,f=!1;return Y.race([r,(typeof navigator>`u`?Y.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(e){function t(){return indexedDB.databases().finally(e)}l=setInterval(t,100),t()}).finally(function(){return clearInterval(l)}):Promise.resolve()).then(c)]).then(function(){return s(),t.onReadyBeingFired=[],Y.resolve(Cn(function(){return e.on.ready.fire(e.vip)})).then(function n(){if(0<t.onReadyBeingFired.length){var r=t.onReadyBeingFired.reduce(pe,B);return t.onReadyBeingFired=[],Y.resolve(Cn(function(){return r(e.vip)})).then(n)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(n){t.dbOpenError=n;try{d&&d.abort()}catch{}return r===t.openCanceller&&e._close(),et(n)}).finally(function(){t.openComplete=!0,u()}).then(function(){var t;return f&&(t={},e.tables.forEach(function(n){n.schema.indexes.forEach(function(r){r.name&&(t[`idb://${e.name}/${n.name}/${r.name}`]=new Tn(-1/0,[[[]]]))}),t[`idb://${e.name}/${n.name}/`]=t[`idb://${e.name}/${n.name}/:dels`]=new Tn(-1/0,[[[]]])}),Kt(Wt).fire(t),Rn(t,!0)),e})}function Vn(e){function t(t){return e.next(t)}var n=i(t),r=i(function(t){return e.throw(t)});function i(e){return function(t){var i=e(t),t=i.value;return i.done?t:t&&typeof t.then==`function`?t.then(n,r):a(t)?Promise.all(t).then(n,r):n(t)}}return i(t)()}function Hn(e,t,n){for(var r=a(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var X={stack:`dbcore`,name:`VirtualIndexMiddleware`,level:1,create:function(e){return t(t({},e),{table:function(n){var r=e.table(n),i=r.schema,a={},o=[];function s(e,n,r){var i=nn(e),c=a[i]=a[i]||[],l=e==null?0:typeof e==`string`?1:e.length,u=0<n,u=t(t({},r),{name:u?`${i}(virtual-from:${r.name})`:r.name,lowLevelIndex:r,isVirtual:u,keyTail:n,keyLength:l,extractKey:$t(e),unique:!u&&r.unique});return c.push(u),u.isPrimaryKey||o.push(u),1<l&&s(l===2?e[0]:e.slice(0,l-1),n+1,r),c.sort(function(e,t){return e.keyTail-t.keyTail}),u}n=s(i.primaryKey.keyPath,0,i.primaryKey),a[`:id`]=[n];for(var c=0,l=i.indexes;c<l.length;c++){var u=l[c];s(u.keyPath,0,u)}function d(n){var r,i=n.query.index;return i.isVirtual?t(t({},n),{query:{index:i.lowLevelIndex,range:(r=n.query.range,i=i.keyTail,{type:r.type===1?2:r.type,lower:Hn(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:Hn(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}):n}return t(t({},r),{schema:t(t({},i),{primaryKey:n,indexes:o,getIndexByKeyPath:function(e){return(e=a[nn(e)])&&e[0]}}),count:function(e){return r.count(d(e))},query:function(e){return r.query(d(e))},openCursor:function(t){var n=t.query.index,i=n.keyTail,a=n.isVirtual,o=n.keyLength;return a?r.openCursor(d(t)).then(function(e){return e&&s(e)}):r.openCursor(t);function s(n){return Object.create(n,{continue:{value:function(r){r==null?t.unique?n.continue(n.key.slice(0,o).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue():n.continue(Hn(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i))}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(Hn(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return o===1?e[0]:e.slice(0,o)}},value:{get:function(){return n.value}}})}}})}})}};function Un(e,t,n,r){return n||={},r||=``,i(e).forEach(function(i){var a,o,s;l(t,i)?(a=e[i],o=t[i],typeof a==`object`&&typeof o==`object`&&a&&o?(s=A(a))===A(o)?s===`Object`?Un(a,o,n,r+i+`.`):a!==o&&(n[r+i]=t[i]):n[r+i]=t[i]:a!==o&&(n[r+i]=t[i])):n[r+i]=void 0}),i(t).forEach(function(i){l(e,i)||(n[r+i]=t[i])}),n}function Wn(e,t){return t.type===`delete`?t.keys:t.keys||t.values.map(e.extractKey)}var Gn={stack:`dbcore`,name:`HooksMiddleware`,level:2,create:function(e){return t(t({},e),{table:function(r){var i=e.table(r),a=i.schema.primaryKey;return t(t({},i),{mutate:function(e){var o=J.trans,s=o.table(r).hook,c=s.deleting,u=s.creating,d=s.updating;switch(e.type){case`add`:if(u.fire===B)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`put`:if(u.fire===B&&d.fire===B)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`delete`:if(c.fire===B)break;return o._promise(`readwrite`,function(){return f(e)},!0);case`deleteRange`:if(c.fire===B)break;return o._promise(`readwrite`,function(){return function e(n,r,o){return i.query({trans:n,values:!1,query:{index:a,range:r},limit:o}).then(function(i){var a=i.result;return f({type:`delete`,keys:a,trans:n}).then(function(i){return 0<i.numFailures?Promise.reject(i.failures[0]):a.length<o?{failures:[],numFailures:0,lastResult:void 0}:e(n,t(t({},r),{lower:a[a.length-1],lowerOpen:!0}),o)})})}(e.trans,e.range,1e4)},!0)}return i.mutate(e);function f(e){var r,o,s,f=J.trans,p=e.keys||Wn(a,e);if(!p)throw Error(`Keys missing`);return(e=e.type===`add`||e.type===`put`?t(t({},e),{keys:p}):t({},e)).type!==`delete`&&(e.values=n([],e.values,!0)),e.keys&&=n([],e.keys,!0),r=i,s=p,((o=e).type===`add`?Promise.resolve([]):r.getMany({trans:o.trans,keys:s,cache:`immutable`})).then(function(t){var n=p.map(function(n,r){var i,o,s,p=t[r],m={onerror:null,onsuccess:null};return e.type===`delete`?c.fire.call(m,n,p,f):e.type===`add`||p===void 0?(i=u.fire.call(m,n,e.values[r],f),n==null&&i!=null&&(e.keys[r]=n=i,a.outbound||x(e.values[r],a.keyPath,n))):(i=Un(p,e.values[r]),(o=d.fire.call(m,i,n,p,f))&&(s=e.values[r],Object.keys(o).forEach(function(e){l(s,e)?s[e]=o[e]:x(s,e,o[e])}))),m});return i.mutate(e).then(function(r){for(var i=r.failures,a=r.results,o=r.numFailures,r=r.lastResult,s=0;s<p.length;++s){var c=(a||p)[s],l=n[s];c==null?l.onerror&&l.onerror(i[s]):l.onsuccess&&l.onsuccess(e.type===`put`&&t[s]?e.values[s]:c)}return{failures:i,results:a,numFailures:o,lastResult:r}}).catch(function(e){return n.forEach(function(t){return t.onerror&&t.onerror(e)}),Promise.reject(e)})})}}})}})}};function Kn(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)ft(t.keys[i],e[a])===0&&(r.push(n?O(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var qn={stack:`dbcore`,level:-1,create:function(e){return{table:function(n){var r=e.table(n);return t(t({},r),{getMany:function(e){if(!e.cache)return r.getMany(e);var t=Kn(e.keys,e.trans._cache,e.cache===`clone`);return t?Y.resolve(t):r.getMany(e).then(function(t){return e.trans._cache={keys:e.keys,values:e.cache===`clone`?O(t):t},t})},mutate:function(e){return e.type!==`add`&&(e.trans._cache=null),r.mutate(e)}})}}}};function Jn(e,t){return e.trans.mode===`readonly`&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!==`disabled`&&!t.schema.primaryKey.outbound}function Yn(e,t){switch(e){case`query`:return t.values&&!t.unique;case`get`:case`getMany`:case`count`:case`openCursor`:return!1}}var Xn={stack:`dbcore`,level:0,name:`Observability`,create:function(e){var n=e.schema.name,r=new Tn(e.MIN_KEY,e.MAX_KEY);return t(t({},e),{transaction:function(t,n,r){if(J.subscr&&n!==`readonly`)throw new z.ReadOnly(`Readwrite transaction in liveQuery context. Querier source: ${J.querier}`);return e.transaction(t,n,r)},table:function(o){var s=e.table(o),c=s.schema,l=c.primaryKey,u=c.indexes,d=l.extractKey,f=l.outbound,p=l.autoIncrement&&u.filter(function(e){return e.compound&&e.keyPath.includes(l.keyPath)}),m=t(t({},s),{mutate:function(t){function i(e){return e=`idb://${n}/${o}/${e}`,h[e]||(h[e]=new Tn)}var u,d,f,m=t.trans,h=t.mutatedParts||={},g=i(``),_=i(`:dels`),v=t.type,y=t.type===`deleteRange`?[t.range]:t.type===`delete`?[t.keys]:t.values.length<50?[Wn(l,t).filter(function(e){return e}),t.values]:[],b=y[0],x=y[1],y=t.trans._cache;return a(b)?(g.addKeys(b),(y=v===`delete`||b.length===x.length?Kn(b,y):null)||_.addKeys(b),(y||x)&&(u=i,d=y,f=x,c.indexes.forEach(function(e){var t=u(e.name||``);function n(t){return t==null?null:e.extractKey(t)}function r(n){return e.multiEntry&&a(n)?n.forEach(function(e){return t.addKey(e)}):t.addKey(n)}(d||f).forEach(function(e,t){var i=d&&n(d[t]),t=f&&n(f[t]);ft(i,t)!==0&&(i!=null&&r(i),t!=null&&r(t))})}))):b?(x={from:(x=b.lower)??e.MIN_KEY,to:(x=b.upper)??e.MAX_KEY},_.add(x),g.add(x)):(g.add(r),_.add(r),c.indexes.forEach(function(e){return i(e.name).add(r)})),s.mutate(t).then(function(e){return!b||t.type!==`add`&&t.type!==`put`||(g.addKeys(e.results),p&&p.forEach(function(n){for(var r=t.values.map(function(e){return n.extractKey(e)}),a=n.keyPath.findIndex(function(e){return e===l.keyPath}),o=0,s=e.results.length;o<s;++o)r[o][a]=e.results[o];i(n.name).addKeys(r)})),m.mutatedParts=Mn(m.mutatedParts||{},h),e})}}),u=function(t){var n=t.query,t=n.index,n=n.range;return[t,new Tn((t=n.lower)??e.MIN_KEY,(n=n.upper)??e.MAX_KEY)]},h={get:function(e){return[l,new Tn(e.key)]},getMany:function(e){return[l,new Tn().addKeys(e.keys)]},count:u,query:u,openCursor:u};return i(h).forEach(function(e){m[e]=function(i){var a=J.subscr,c=!!a,l=Jn(J,s)&&Yn(e,i)?i.obsSet={}:a;if(c){var u=function(e){return e=`idb://${n}/${o}/${e}`,l[e]||(l[e]=new Tn)},p=u(``),m=u(`:dels`),a=h[e](i),c=a[0],a=a[1];if((e===`query`&&c.isPrimaryKey&&!i.values?m:u(c.name||``)).add(a),!c.isPrimaryKey){if(e!==`count`){var g=e===`query`&&f&&i.values&&s.query(t(t({},i),{values:!1}));return s[e].apply(this,arguments).then(function(t){if(e===`query`){if(f&&i.values)return g.then(function(e){return e=e.result,p.addKeys(e),t});var n=i.values?t.result.map(d):t.result;(i.values?p:m).addKeys(n)}else if(e===`openCursor`){var r=t,a=i.values;return r&&Object.create(r,{key:{get:function(){return m.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return m.addKey(e),e}},value:{get:function(){return a&&p.addKey(r.primaryKey),r.value}}})}return t})}m.add(r)}}return s[e].apply(this,arguments)}}),m}})}};function Zn(e,n,r){if(r.numFailures===0)return n;if(n.type===`deleteRange`)return null;var i=n.keys?n.keys.length:`values`in n&&n.values?n.values.length:1;return r.numFailures===i?null:(n=t({},n),a(n.keys)&&(n.keys=n.keys.filter(function(e,t){return!(t in r.failures)})),`values`in n&&a(n.values)&&(n.values=n.values.filter(function(e,t){return!(t in r.failures)})),n)}function Qn(e,t){return n=e,((r=t).lower===void 0||(r.lowerOpen?0<ft(n,r.lower):0<=ft(n,r.lower)))&&(e=e,(t=t).upper===void 0||(t.upperOpen?ft(e,t.upper)<0:ft(e,t.upper)<=0));var n,r}function $n(e,t,n,r,i,o){if(!n||n.length===0)return e;var s=t.query.index,c=s.multiEntry,l=t.query.range,u=r.schema.primaryKey.extractKey,d=s.extractKey,f=(s.lowLevelIndex||s).extractKey,n=n.reduce(function(e,n){var r=e,i=[];if(n.type===`add`||n.type===`put`)for(var o=new Tn,s=n.values.length-1;0<=s;--s){var f,p=n.values[s],m=u(p);o.hasKey(m)||(f=d(p),(c&&a(f)?f.some(function(e){return Qn(e,l)}):Qn(f,l))&&(o.addKey(m),i.push(p)))}switch(n.type){case`add`:var h=new Tn().addKeys(t.values?e.map(function(e){return u(e)}):e),r=e.concat(t.values?i.filter(function(e){return e=u(e),!h.hasKey(e)&&(h.addKey(e),!0)}):i.map(function(e){return u(e)}).filter(function(e){return!h.hasKey(e)&&(h.addKey(e),!0)}));break;case`put`:var g=new Tn().addKeys(n.values.map(function(e){return u(e)}));r=e.filter(function(e){return!g.hasKey(t.values?u(e):e)}).concat(t.values?i:i.map(function(e){return u(e)}));break;case`delete`:var _=new Tn().addKeys(n.keys);r=e.filter(function(e){return!_.hasKey(t.values?u(e):e)});break;case`deleteRange`:var v=n.range;r=e.filter(function(e){return!Qn(u(e),v)})}return r},e);return n===e?e:(n.sort(function(e,t){return ft(f(e),f(t))||ft(u(e),u(t))}),t.limit&&t.limit<1/0&&(n.length>t.limit?n.length=t.limit:e.length===t.limit&&n.length<t.limit&&(i.dirty=!0)),o?Object.freeze(n):n)}function er(e,t){return ft(e.lower,t.lower)===0&&ft(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function tr(e,t){return function(e,t,n,r){if(e===void 0)return t===void 0?0:-1;if(t===void 0)return 1;if((t=ft(e,t))===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return t}(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&0<=function(e,t,n,r){if(e===void 0)return t===void 0?0:1;if(t===void 0)return-1;if((t=ft(e,t))===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return t}(e.upper,t.upper,e.upperOpen,t.upperOpen)}function nr(e,t,n,r){e.subscribers.add(n),r.addEventListener(`abort`,function(){var r,i;e.subscribers.delete(n),e.subscribers.size===0&&(r=e,i=t,setTimeout(function(){r.subscribers.size===0&&N(i,r)},3e3))})}var rr={stack:`dbcore`,level:0,name:`Cache`,create:function(e){var n=e.schema.name;return t(t({},e),{transaction:function(t,r,i){var a,o,s=e.transaction(t,r,i);return r===`readwrite`&&(o=(a=new AbortController).signal,i=function(i){return function(){if(a.abort(),r===`readwrite`){for(var o=new Set,c=0,l=t;c<l.length;c++){var u=l[c],d=Pn[`idb://${n}/${u}`];if(d){var f=e.table(u),p=d.optimisticOps.filter(function(e){return e.trans===s});if(s._explicit&&i&&s.mutatedParts)for(var m=0,h=Object.values(d.queries.query);m<h.length;m++)for(var g=0,_=(b=h[m]).slice();g<_.length;g++)Nn((x=_[g]).obsSet,s.mutatedParts)&&(N(b,x),x.subscribers.forEach(function(e){return o.add(e)}));else if(0<p.length){d.optimisticOps=d.optimisticOps.filter(function(e){return e.trans!==s});for(var v=0,y=Object.values(d.queries.query);v<y.length;v++)for(var b,x,S,C=0,w=(b=y[v]).slice();C<w.length;C++)(x=w[C]).res!=null&&s.mutatedParts&&(i&&!x.dirty?(S=Object.isFrozen(x.res),S=$n(x.res,x.req,p,f,x,S),x.dirty?(N(b,x),x.subscribers.forEach(function(e){return o.add(e)})):S!==x.res&&(x.res=S,x.promise=Y.resolve({result:S}))):(x.dirty&&N(b,x),x.subscribers.forEach(function(e){return o.add(e)})))}}}o.forEach(function(e){return e()})}}},s.addEventListener(`abort`,i(!1),{signal:o}),s.addEventListener(`error`,i(!1),{signal:o}),s.addEventListener(`complete`,i(!0),{signal:o})),s},table:function(r){var i=e.table(r),a=i.schema.primaryKey;return t(t({},i),{mutate:function(e){var o=J.trans;if(a.outbound||o.db._options.cache===`disabled`||o.explicit||o.idbtrans.mode!==`readwrite`)return i.mutate(e);var s=Pn[`idb://${n}/${r}`];return s?(o=i.mutate(e),e.type!==`add`&&e.type!==`put`||!(50<=e.values.length||Wn(a,e).some(function(e){return e==null}))?(s.optimisticOps.push(e),e.mutatedParts&&Ln(e.mutatedParts),o.then(function(t){0<t.numFailures&&(N(s.optimisticOps,e),(t=Zn(0,e,t))&&s.optimisticOps.push(t),e.mutatedParts&&Ln(e.mutatedParts))}),o.catch(function(){N(s.optimisticOps,e),e.mutatedParts&&Ln(e.mutatedParts)})):o.then(function(n){var r=Zn(0,t(t({},e),{values:e.values.map(function(e,r){var i;return n.failures[r]?e:(e=(i=a.keyPath)!=null&&i.includes(`.`)?O(e):t({},e),x(e,a.keyPath,n.results[r]),e)})}),n);s.optimisticOps.push(r),queueMicrotask(function(){return e.mutatedParts&&Ln(e.mutatedParts)})}),o):i.mutate(e)},query:function(e){if(!Jn(J,i)||!Yn(`query`,e))return i.query(e);var t=(c=J.trans)?.db._options.cache===`immutable`,a=J,o=a.requery,s=a.signal,c=function(e,t,n,r){var i=Pn[`idb://${e}/${t}`];if(!i)return[];if(!(t=i.queries[n]))return[null,!1,i,null];var a=t[(r.query?r.query.index.name:null)||``];if(!a)return[null,!1,i,null];switch(n){case`query`:var o=a.find(function(e){return e.req.limit===r.limit&&e.req.values===r.values&&er(e.req.query.range,r.query.range)});return o?[o,!0,i,a]:[a.find(function(e){return(`limit`in e.req?e.req.limit:1/0)>=r.limit&&(!r.values||e.req.values)&&tr(e.req.query.range,r.query.range)}),!1,i,a];case`count`:return o=a.find(function(e){return er(e.req.query.range,r.query.range)}),[o,!!o,i,a]}}(n,r,`query`,e),l=c[0],a=c[1],u=c[2],d=c[3];return l&&a?l.obsSet=e.obsSet:(a=i.query(e).then(function(e){var n=e.result;if(l&&(l.res=n),t){for(var r=0,i=n.length;r<i;++r)Object.freeze(n[r]);Object.freeze(n)}else e.result=O(n);return e}).catch(function(e){return d&&l&&N(d,l),Promise.reject(e)}),l={obsSet:e.obsSet,promise:a,subscribers:new Set,type:`query`,req:e,dirty:!1},d?d.push(l):(d=[l],(u||=Pn[`idb://${n}/${r}`]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}).queries.query[e.query.index.name||``]=d)),nr(l,d,o,s),l.promise.then(function(n){return{result:$n(n.result,e,u?.optimisticOps,i,l,t)}})}})}})}};function ir(e,t){return new Proxy(e,{get:function(e,n,r){return n===`db`?t:Reflect.get(e,n,r)}})}var ar=(or.prototype.version=function(e){if(isNaN(e)||e<.1)throw new z.Type(`Given version is not a positive number`);if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new z.Schema(`Cannot add version when database is open`);this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter(function(t){return t._cfg.version===e})[0];return n||(n=new this.Version(e),t.push(n),t.sort(ln),n.stores({}),this._state.autoSchema=!1,n)},or.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||J.letThrough||this._vip)?e():new Y(function(e,n){if(t._state.openComplete)return n(new z.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._state.autoOpen)return void n(new z.DatabaseClosed);t.open().catch(B)}t._state.dbReadyPromise.then(e,n)}).then(e)},or.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;return i&&this.unuse({stack:t,name:i}),e=this._middlewares[t]||(this._middlewares[t]=[]),e.push({stack:t,create:n,level:r??10,name:i}),e.sort(function(e,t){return e.level-t.level}),this},or.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter(function(e){return r?e.create!==r:!!n&&e.name!==n})),this},or.prototype.open=function(){var e=this;return Ze(Se,function(){return Bn(e)})},or.prototype._close=function(){this.on.close.fire(new CustomEvent(`close`));var e=this._state,t=it.indexOf(this);if(0<=t&&it.splice(t,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}e.isBeingOpened||(e.dbReadyPromise=new Y(function(t){e.dbReadyResolve=t}),e.openCanceller=new Y(function(t,n){e.cancelOpen=n}))},or.prototype.close=function(e){var t=(e===void 0?{disableAutoOpen:!0}:e).disableAutoOpen,e=this._state;t?(e.isBeingOpened&&e.cancelOpen(new z.DatabaseClosed),this._close(),e.autoOpen=!1,e.dbOpenError=new z.DatabaseClosed):(this._close(),e.autoOpen=this._options.autoOpen||e.isBeingOpened,e.openComplete=!1,e.dbOpenError=null)},or.prototype.delete=function(e){var t=this;e===void 0&&(e={disableAutoOpen:!0});var n=0<arguments.length&&typeof arguments[0]!=`object`,r=this._state;return new Y(function(i,a){function o(){t.close(e);var n=t._deps.indexedDB.deleteDatabase(t.name);n.onsuccess=Le(function(){var e=t._deps,n=t.name,r=e.indexedDB;e=e.IDBKeyRange,Sn(r)||n===at||xn(r,e).delete(n).catch(B),i()}),n.onerror=Ht(a),n.onblocked=t._fireOnBlocked}if(n)throw new z.InvalidArgument(`Invalid closeOptions argument to db.delete()`);r.isBeingOpened?r.dbReadyPromise.then(o):o()})},or.prototype.backendDB=function(){return this.idbdb},or.prototype.isOpen=function(){return this.idbdb!==null},or.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&e.name===`DatabaseClosed`},or.prototype.hasFailed=function(){return this._state.dbOpenError!==null},or.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(or.prototype,`tables`,{get:function(){var e=this;return i(this._allTables).map(function(t){return e._allTables[t]})},enumerable:!1,configurable:!0}),or.prototype.transaction=function(){var e=function(e,t,n){var r=arguments.length;if(r<2)throw new z.InvalidArgument(`Too few arguments`);for(var i=Array(r-1);--r;)i[r-1]=arguments[r];return n=i.pop(),[e,w(i),n]}.apply(this,arguments);return this._transaction.apply(this,e)},or.prototype._transaction=function(e,t,n){var r=this,i=J.trans;i&&i.db===this&&e.indexOf(`!`)===-1||(i=null);var a,o,s=e.indexOf(`?`)!==-1;e=e.replace(`!`,``).replace(`?`,``);try{if(o=t.map(function(e){if(e=e instanceof r.Table?e.name:e,typeof e!=`string`)throw TypeError(`Invalid table argument to Dexie.transaction(). Only Table or String are allowed`);return e}),e==`r`||e===ot)a=ot;else{if(e!=`rw`&&e!=st)throw new z.InvalidArgument(`Invalid transaction mode: `+e);a=st}if(i){if(i.mode===ot&&a===st){if(!s)throw new z.SubTransaction(`Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY`);i=null}i&&o.forEach(function(e){if(i&&i.storeNames.indexOf(e)===-1){if(!s)throw new z.SubTransaction(`Table `+e+` not included in parent transaction.`);i=null}}),s&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,function(t,n){n(e)}):et(e)}var c=function e(t,n,r,i,a){return Y.resolve().then(function(){var o=J.transless||J,s=t._createTransaction(n,r,t._dbSchema,i);if(s.explicit=!0,o={trans:s,transless:o},i)s.idbtrans=i.idbtrans;else try{s.create(),s.idbtrans._explicit=!0,t._state.PR1398_maxLoop=3}catch(i){return i.name===ae.InvalidState&&t.isOpen()&&0<--t._state.PR1398_maxLoop?(console.warn(`Dexie: Need to reopen db`),t.close({disableAutoOpen:!1}),t.open().then(function(){return e(t,n,r,null,a)})):et(i)}var c,l=I(a);return l&&Ge(),o=Y.follow(function(){var e;(c=a.call(s,s))&&(l?(e=Ke.bind(null,null),c.then(e,e)):typeof c.next==`function`&&typeof c.throw==`function`&&(c=Vn(c)))},o),(c&&typeof c.then==`function`?Y.resolve(c).then(function(e){return s.active?e:et(new z.PrematureCommit(`Transaction committed too early. See http://bit.ly/2kdckMn`))}):o.then(function(){return c})).then(function(e){return i&&s._resolve(),s._completion.then(function(){return e})}).catch(function(e){return s._reject(e),et(e)})})}.bind(null,this,a,o,i,n);return i?i._promise(a,c,`lock`):J.trans?Ze(J.transless,function(){return r._whenReady(c)}):this._whenReady(c)},or.prototype.table=function(e){if(!l(this._allTables,e))throw new z.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]},or);function or(e,n){var r=this;this._middlewares={},this.verno=0;var i=or.dependencies;this._options=n=t({addons:or.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:`cloned`},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange},i=n.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,o,s,c,l,u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:B,dbReadyPromise:null,cancelOpen:B,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};u.dbReadyPromise=new Y(function(e){u.dbReadyResolve=e}),u.openCanceller=new Y(function(e,t){u.cancelOpen=t}),this._state=u,this.name=e,this.on=xt(this,`populate`,`blocked`,`versionchange`,`close`,{ready:[pe,B]}),this.once=function(e,t){var n=function(){var i=[...arguments];r.on(e).unsubscribe(n),t.apply(r,i)};return r.on(e,n)},this.on.ready.subscribe=_(this.on.ready.subscribe,function(e){return function(t,n){or.vip(function(){var i,a=r._state;a.openComplete?(a.dbOpenError||Y.resolve().then(t),n&&e(t)):a.onReadyBeingFired?(a.onReadyBeingFired.push(t),n&&e(t)):(e(t),i=r,n||e(function e(){i.on.ready.unsubscribe(t),i.on.ready.unsubscribe(e)}))})}}),this.Collection=(a=this,St(At.prototype,function(e,t){this.db=a;var n=lt,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,t=i.table,e=t.hook.reading.fire;this._ctx={table:t,index:i.index,isPrimKey:!i.index||t.schema.primKey.keyPath&&i.index===t.schema.primKey.name,range:n,keysOnly:!1,dir:`next`,unique:``,algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:e===le?null:e}})),this.Table=(o=this,St(yt.prototype,function(e,t,n){this.db=o,this._tx=n,this.name=e,this.schema=t,this.hook=o._allTables[e]?o._allTables[e].hook:xt(null,{creating:[fe,B],reading:[ue,le],updating:[H,B],deleting:[V,B]})})),this.Transaction=(s=this,St(qt.prototype,function(e,t,n,r,i){var a=this;e!==`readonly`&&t.forEach(function(e){e=(e=n[e])?.yProps,e&&(t=t.concat(e.map(function(e){return e.updatesTable})))}),this.db=s,this.mode=e,this.storeNames=t,this.schema=n,this.chromeTransactionDurability=r,this.idbtrans=null,this.on=xt(this,`complete`,`error`,`abort`),this.parent=i||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Y(function(e,t){a._resolve=e,a._reject=t}),this._completion.then(function(){a.active=!1,a.on.complete.fire()},function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),et(e)})})),this.Version=(c=this,St(yn.prototype,function(e){this.db=c,this._cfg={version:e,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(l=this,St(Bt.prototype,function(e,t,n){if(this.db=l,this._ctx={table:e,index:t===`:id`?null:t,or:n},this._cmp=this._ascending=ft,this._descending=function(e,t){return ft(t,e)},this._max=function(e,t){return 0<ft(e,t)?e:t},this._min=function(e,t){return ft(e,t)<0?e:t},this._IDBKeyRange=l._deps.IDBKeyRange,!this._IDBKeyRange)throw new z.MissingAPI})),this.on(`versionchange`,function(e){0<e.newVersion?console.warn(`Another connection wants to upgrade database '${r.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${r.name}'. Closing db now to resume the delete request.`),r.close({disableAutoOpen:!1})}),this.on(`blocked`,function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${r.name}') was blocked`):console.warn(`Upgrade '${r.name}' blocked by other connection holding version ${e.oldVersion/10}`)}),this._maxKey=Qt(n.IDBKeyRange),this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){r.on(`blocked`).fire(e),it.filter(function(e){return e.name===r.name&&e!==r&&!e._state.vcFired}).map(function(t){return t.on(`versionchange`).fire(e)})},this.use(qn),this.use(rr),this.use(Xn),this.use(X),this.use(Gn);var d=new Proxy(this,{get:function(e,t,n){if(t===`_vip`)return!0;if(t===`table`)return function(e){return ir(r.table(e),d)};var i=Reflect.get(e,t,n);return i instanceof yt?ir(i,d):t===`tables`?i.map(function(e){return ir(e,d)}):t===`_createTransaction`?function(){return ir(i.apply(this,arguments),d)}:i}});this.vip=d,i.forEach(function(e){return e(r)})}var sr,R=typeof Symbol<`u`&&`observable`in Symbol?Symbol.observable:`@@observable`,cr=(lr.prototype.subscribe=function(e,t,n){return this._subscribe(e&&typeof e!=`function`?e:{next:e,error:t,complete:n})},lr.prototype[R]=function(){return this},lr);function lr(e){this._subscribe=e}try{sr={indexedDB:r.indexedDB||r.mozIndexedDB||r.webkitIndexedDB||r.msIndexedDB,IDBKeyRange:r.IDBKeyRange||r.webkitIDBKeyRange}}catch{sr={indexedDB:null,IDBKeyRange:null}}function ur(e){var t,n=!1,r=new cr(function(r){var i=I(e),a,o=!1,s={},c={},u={get closed(){return o},unsubscribe:function(){o||(o=!0,a&&a.abort(),d&&Kt.storagemutated.unsubscribe(p))}};r.start&&r.start(u);var d=!1,f=function(){return $e(m)},p=function(e){Mn(s,e),Nn(c,s)&&f()},m=function(){var u,m,h;!o&&sr.indexedDB&&(s={},u={},a&&a.abort(),a=new AbortController,h=function(t){var n=Ne();try{i&&Ge();var r=We(e,t);return r=i?r.finally(Ke):r}finally{n&&Pe()}}(m={subscr:u,signal:a.signal,requery:f,querier:e,trans:null}),Promise.resolve(h).then(function(e){n=!0,t=e,o||m.signal.aborted||(s={},function(e){for(var t in e)if(l(e,t))return;return 1}(c=u)||d||(Kt(Wt,p),d=!0),$e(function(){return!o&&r.next&&r.next(e)}))},function(e){n=!1,[`DatabaseClosedError`,`AbortError`].includes(e?.name)||o||$e(function(){o||r.error&&r.error(e)})}))};return setTimeout(f,0),u});return r.hasValue=function(){return n},r.getValue=function(){return t},r}var dr=ar;function fr(e){var t=mr;try{mr=!0,Kt.storagemutated.fire(e),Rn(e,!0)}finally{mr=t}}u(dr,t(t({},ce),{delete:function(e){return new dr(e,{addons:[]}).delete()},exists:function(e){return new dr(e,{addons:[]}).open().then(function(e){return e.close(),!0}).catch(`NoSuchDatabaseError`,function(){return!1})},getDatabaseNames:function(e){try{return t=dr.dependencies,n=t.indexedDB,t=t.IDBKeyRange,(Sn(n)?Promise.resolve(n.databases()).then(function(e){return e.map(function(e){return e.name}).filter(function(e){return e!==at})}):xn(n,t).toCollection().primaryKeys()).then(e)}catch{return et(new z.MissingAPI)}var t,n},defineClass:function(){return function(e){o(this,e)}},ignoreTransaction:function(e){return J.trans?Ze(J.transless,e):e()},vip:Cn,async:function(e){return function(){try{var t=Vn(e.apply(this,arguments));return t&&typeof t.then==`function`?t:Y.resolve(t)}catch(e){return et(e)}}},spawn:function(e,t,n){try{var r=Vn(e.apply(n,t||[]));return r&&typeof r.then==`function`?r:Y.resolve(r)}catch(e){return et(e)}},currentTransaction:{get:function(){return J.trans||null}},waitFor:function(e,t){return t=Y.resolve(typeof e==`function`?dr.ignoreTransaction(e):e).timeout(t||6e4),J.trans?J.trans.waitFor(t):t},Promise:Y,debug:{get:function(){return me},set:function(e){W(e)}},derive:p,extend:o,props:u,override:_,Events:xt,on:Kt,liveQuery:ur,extendObservabilitySet:Mn,getByKeyPath:b,setByKeyPath:x,delByKeyPath:function(e,t){typeof t==`string`?x(e,t,void 0):`length`in t&&[].map.call(t,function(t){x(e,t,void 0)})},shallowClone:S,deepClone:O,getObjectDiff:Un,cmp:ft,asap:y,minKey:-1/0,addons:[],connections:it,errnames:ae,dependencies:sr,cache:Pn,semVer:`4.2.1`,version:`4.2.1`.split(`.`).map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/10**(2*n)})})),dr.maxKey=Qt(dr.dependencies.IDBKeyRange),typeof dispatchEvent<`u`&&typeof addEventListener<`u`&&(Kt(Wt,function(e){mr||=(e=new CustomEvent(Gt,{detail:e}),mr=!0,dispatchEvent(e),!1)}),addEventListener(Gt,function(e){e=e.detail,mr||fr(e)}));var pr,mr=!1,hr=function(){};return typeof BroadcastChannel<`u`&&((hr=function(){(pr=new BroadcastChannel(Gt)).onmessage=function(e){return e.data&&fr(e.data)}})(),typeof pr.unref==`function`&&pr.unref(),Kt(Wt,function(e){mr||pr.postMessage(e)})),typeof addEventListener<`u`&&(addEventListener(`pagehide`,function(e){if(!ar.disableBfCache&&e.persisted){me&&console.debug(`Dexie: handling persisted pagehide`),pr?.close();for(var t=0,n=it;t<n.length;t++)n[t].close({disableAutoOpen:!1})}}),addEventListener(`pageshow`,function(e){!ar.disableBfCache&&e.persisted&&(me&&console.debug(`Dexie: handling persisted pageshow`),hr(),fr({all:new Tn(-1/0,[[]])}))})),Y.rejectionMapper=function(e,t){return!e||e instanceof te||e instanceof TypeError||e instanceof SyntaxError||!e.name||!se[e.name]?e:(t=new se[e.name](t||e.message,e),`stack`in e&&f(t,`stack`,{get:function(){return this.inner.stack}}),t)},W(me),t(ar,Object.freeze({__proto__:null,Dexie:ar,liveQuery:ur,Entity:dt,cmp:ft,PropModification:gt,replacePrefix:function(e,t){return new gt({replacePrefix:[e,t]})},add:function(e){return new gt({add:e})},remove:function(e){return new gt({remove:e})},default:ar,RangeSet:Tn,mergeRanges:Dn,rangesOverlap:On}),{default:ar}),ar})}))(),1),dn=Symbol.for(`Dexie`),fn=globalThis[dn]||(globalThis[dn]=un.default);if(un.default.semVer!==fn.semVer)throw Error(`Two different versions of Dexie loaded in the same app: ${un.default.semVer} and ${fn.semVer}`);var{liveQuery:pn,mergeRanges:mn,rangesOverlap:hn,RangeSet:gn,cmp:_n,Entity:vn,PropModification:yn,replacePrefix:bn,add:xn,remove:Sn,DexieYProvider:Cn}=fn,wn=fn;const Tn=new class extends wn{constructor(){super(`AhirBookDB`),this.version(1).stores({books:`++id, title, author, format, createdAt`,bookmarks:`++id, bookId, pageId, createdAt`,bookContent:`++id, bookId, pageNumber, [bookId+pageNumber], indexedAt`})}},En=async e=>{try{return await Tn.books.add(e)}catch(e){throw console.error(`Error adding book:`,e),e}},Dn=async()=>{try{return await Tn.books.toArray()}catch(e){throw console.error(`Error fetching books:`,e),e}},On=async e=>{try{return await Tn.books.get(e)}catch(e){throw console.error(`Error fetching book:`,e),e}},kn=async e=>{try{await Tn.transaction(`rw`,[Tn.books,Tn.bookmarks,Tn.bookContent],async()=>{await Tn.books.delete(e),await Tn.bookmarks.where(`bookId`).equals(e).delete(),await Tn.bookContent.where(`bookId`).equals(e).delete()})}catch(e){throw console.error(`Error deleting book:`,e),e}},An=async(e,t)=>{try{return await Tn.bookmarks.add({bookId:e,pageId:t,createdAt:new Date})}catch(e){throw console.error(`Error adding bookmark:`,e),e}},jn=async()=>{try{return await Tn.bookmarks.toArray()}catch(e){throw console.error(`Error fetching bookmarks:`,e),e}},Mn=async e=>{try{await Tn.bookmarks.delete(e)}catch(e){throw console.error(`Error deleting bookmark:`,e),e}},Nn=async(e,t)=>{try{await Tn.bookContent.where(`bookId`).equals(e).delete();let n=t.map(t=>({bookId:e,pageNumber:t.pageNumber,contentText:t.text,indexedAt:new Date}));await Tn.bookContent.bulkAdd(n)}catch(e){throw console.error(`Error indexing book content:`,e),e}},Pn=async()=>{if(`storage`in navigator&&`estimate`in navigator.storage){let e=await navigator.storage.estimate(),t=e.usage||0,n=e.quota||0,r=t/n*100;return{usage:t,quota:n,percentUsed:r,available:n-t}}return null},Fn=e=>e.toLowerCase().replace(/i/g,`i`).replace(/İ/g,`i`).replace(/I/g,`ı`);var In=[`#FBBF24`,`#34D399`,`#60A5FA`,`#F87171`,`#A78BFA`,`#FB923C`,`#EC4899`,`#14B8A6`];const Ln=e=>In[e%In.length],Rn=(e,t)=>{let n=e;return t.forEach((e,t)=>{let r=Fn(e),i=Ln(t),a=RegExp(`(${r})`,`gi`);n=n.replace(a,`<mark style="background-color: ${i}; padding: 2px 4px; border-radius: 2px;">$1</mark>`)}),n};var zn=(e,t,n=300)=>{let r=Fn(e),i=Fn(t),a=r.indexOf(i);if(a===-1)return e.substring(0,n)+`...`;let o=Math.max(0,a-n),s=Math.min(e.length,a+t.length+n),c=e.substring(o,s);return o>0&&(c=`...`+c),s<e.length&&(c+=`...`),c};const Bn=async(e,t,n=0,r,i=`grouped`)=>{if(!e.trim())return[];let a=e.split(`,`).map(e=>e.trim()).filter(e=>e.length>0);if(a.length===0)return[];try{let e=await Tn.bookContent.toArray();r&&r.length>0&&(e=e.filter(e=>r.includes(e.bookId)));let o=[];for(let t of e){let e=Fn(t.contentText),n=a.filter(t=>{let n=Fn(t);return e.includes(n)});if(n.length>0){let e=await Tn.books.get(t.bookId);if(!e)continue;let r=zn(t.contentText,n[0]),i=Rn(r,n);o.push({id:t.id,bookId:t.bookId,bookTitle:e.title,pageNumber:t.pageNumber,snippet:r,highlightedSnippet:i})}}if(i===`grouped`)o.sort((e,t)=>e.bookId===t.bookId?e.pageNumber-t.pageNumber:e.bookId-t.bookId);else{let e={};o.forEach(t=>{e[t.bookId]||(e[t.bookId]=[]),e[t.bookId].push(t)}),Object.values(e).forEach(e=>{e.sort((e,t)=>e.pageNumber-t.pageNumber)});let t=Object.keys(e).map(Number),n=[],r=Math.max(...Object.values(e).map(e=>e.length));for(let i=0;i<r;i++)for(let r of t){let t=e[r];i<t.length&&n.push(t[i])}o.length=0,o.push(...n)}return t?o.slice(n,n+t):o.slice(n)}catch(e){throw console.error(`Search error:`,e),e}},Vn=async(e,t=1,n=10,r,i=`grouped`)=>{let a=(t-1)*n,o=await Bn(e,void 0,0,r,i),s=o.length,c=o.slice(a,a+n),l=a+n<s;return{results:c,hasMore:l,total:s}};var Hn=o((e=>{var t=Symbol.for(`react.transitional.element`),n=Symbol.for(`react.fragment`);function r(e,n,r){var i=null;if(r!==void 0&&(i=``+r),n.key!==void 0&&(i=``+n.key),`key`in n)for(var a in r={},n)a!==`key`&&(r[a]=n[a]);else r=n;return n=r.ref,{$$typeof:t,type:e,key:i,ref:n===void 0?null:n,props:r}}e.Fragment=n,e.jsx=r,e.jsxs=r})),X=l(o(((e,t)=>{t.exports=Hn()}))());function Un(){let[e,t]=(0,y.useState)(!1),n=()=>t(!e),r=()=>t(!1);return(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(`button`,{onClick:n,className:`p-2 hover:bg-gray-200 rounded-lg transition`,"aria-label":`Menü`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M4 6h16M4 12h16M4 18h16`})})}),e&&(0,X.jsx)(`div`,{className:`fixed inset-0 bg-black bg-opacity-50 z-40`,onClick:r}),(0,X.jsx)(`div`,{className:`fixed top-0 left-0 h-full w-64 bg-white shadow-xl z-50 transform transition-transform duration-300 ${e?`translate-x-0`:`-translate-x-full`}`,children:(0,X.jsxs)(`div`,{className:`p-4`,children:[(0,X.jsxs)(`div`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(`h2`,{className:`text-xl font-bold text-primary`,children:`Ahir Book`}),(0,X.jsx)(`button`,{onClick:r,className:`p-2 hover:bg-gray-200 rounded-lg transition`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M6 18L18 6M6 6l12 12`})})})]}),(0,X.jsxs)(`nav`,{className:`space-y-2`,children:[(0,X.jsxs)(Wt,{to:`/`,onClick:r,className:`flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition`,children:[(0,X.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z`})}),(0,X.jsx)(`span`,{children:`Ana Sayfa`})]}),(0,X.jsxs)(Wt,{to:`/library`,onClick:r,className:`flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition`,children:[(0,X.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253`})}),(0,X.jsx)(`span`,{children:`Kütüphane`})]}),(0,X.jsxs)(Wt,{to:`/bookmarks`,onClick:r,className:`flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition`,children:[(0,X.jsx)(`svg`,{className:`w-5 h-5`,fill:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{d:`M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z`})}),(0,X.jsx)(`span`,{children:`Yıldızlı Sayfalar`})]}),(0,X.jsxs)(Wt,{to:`/settings`,onClick:r,className:`flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-100 transition`,children:[(0,X.jsxs)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:[(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z`}),(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 12a3 3 0 11-6 0 3 3 0 016 0z`})]}),(0,X.jsx)(`span`,{children:`Ayarlar`})]})]})]})})]})}function Wn(){let[e,t]=(0,y.useState)(``),[n,r]=(0,y.useState)([]),[i,a]=(0,y.useState)([]),[o,s]=(0,y.useState)(!1),[c,l]=(0,y.useState)(!1),[u,d]=(0,y.useState)(1),[f,p]=(0,y.useState)(!0),m=(0,y.useRef)(!1),[h,g]=(0,y.useState)([]),[_,v]=(0,y.useState)([]),[b,x]=(0,y.useState)(`grouped`),[S,C]=(0,y.useState)(!1),w=(0,y.useRef)(null),T=(0,y.useCallback)(e=>{o||m.current||(w.current&&w.current.disconnect(),w.current=new IntersectionObserver(e=>{e[0].isIntersecting&&f&&!m.current&&d(e=>e+1)}),e&&w.current.observe(e))},[o,f]);(0,y.useEffect)(()=>{E()},[]);let E=async()=>{let e=await Dn();g(e),v(e.map(e=>e.id))};(0,y.useEffect)(()=>{let e=sessionStorage.getItem(`searchState`);if(e)try{let{query:n,keywords:i,results:o,scrollY:s,selectedBookIds:c,sortOrder:u}=JSON.parse(e);t(n||``),r(i||[]),a(o||[]),l(o&&o.length>0),c&&v(c),u&&x(u),s&&o&&o.length>0&&setTimeout(()=>{window.scrollTo(0,s)},100)}catch(e){console.error(`Failed to restore search state:`,e)}},[]),(0,y.useEffect)(()=>{if(c){let t=window.scrollY;sessionStorage.setItem(`searchState`,JSON.stringify({query:e,keywords:n,results:i,scrollY:t,selectedBookIds:_,sortOrder:b}))}},[e,n,i,c,_,b]);let D=e=>{let i=e.split(`,`),a=i[i.length-1].trim();if(i.length>1){let e=i.slice(0,-1).map(e=>e.trim()).filter(Boolean);r([...n,...e]),t(a)}else t(e)},O=e=>{r(n.filter((t,n)=>n!==e))},k=async(t=!1)=>{let r=[...n,...e.split(`,`).map(e=>e.trim()).filter(Boolean)];if(r.length!==0){t?m.current=!0:(s(!0),l(!0),d(1),p(!0));try{let e=r.join(`,`),n=t?(u-1)*10:0,i=await Bn(e,10,n,_.length>0?_:void 0,b);a(t?e=>[...e,...i]:i),i.length<10&&p(!1)}catch(e){console.error(`Search error:`,e)}finally{t?m.current=!1:s(!1)}}};return(0,y.useEffect)(()=>{u>1&&c&&k(!0)},[u]),(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Un,{}),(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Ahir Book`}),(0,X.jsx)(`div`,{className:`w-8`})]}),(0,X.jsxs)(`div`,{className:`space-y-4`,children:[(0,X.jsxs)(`button`,{onClick:()=>C(!S),className:`w-full flex items-center justify-between px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition`,children:[(0,X.jsx)(`span`,{className:`font-medium text-secondary`,children:`🔍 Arama Filtreleri`}),(0,X.jsx)(`svg`,{className:`w-5 h-5 transition-transform ${S?`rotate-180`:``}`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M19 9l-7 7-7-7`})})]}),S&&(0,X.jsxs)(`div`,{className:`bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-4`,children:[(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`label`,{className:`block text-sm font-semibold text-secondary mb-2`,children:`📚 Aranacak Kitaplar`}),(0,X.jsxs)(`div`,{className:`space-y-2`,children:[(0,X.jsx)(`button`,{onClick:()=>{_.length===h.length?v([]):v(h.map(e=>e.id))},className:`text-xs text-accent hover:underline`,children:_.length===h.length?`Tümünü Kaldır`:`Tümünü Seç`}),h.map(e=>(0,X.jsxs)(`label`,{className:`flex items-center gap-2 cursor-pointer`,children:[(0,X.jsx)(`input`,{type:`checkbox`,checked:_.includes(e.id),onChange:t=>{t.target.checked?v([..._,e.id]):v(_.filter(t=>t!==e.id))},className:`w-4 h-4 text-accent rounded focus:ring-accent`}),(0,X.jsx)(`span`,{className:`text-sm text-gray-700`,children:e.title})]},e.id))]})]}),(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`label`,{className:`block text-sm font-semibold text-secondary mb-2`,children:`📊 Sonuç Sırası`}),(0,X.jsxs)(`div`,{className:`space-y-2`,children:[(0,X.jsxs)(`label`,{className:`flex items-center gap-2 cursor-pointer`,children:[(0,X.jsx)(`input`,{type:`radio`,name:`sortOrder`,value:`grouped`,checked:b===`grouped`,onChange:e=>x(e.target.value),className:`w-4 h-4 text-accent focus:ring-accent`}),(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`div`,{className:`text-sm font-medium text-gray-700`,children:`Kitaplara Göre`}),(0,X.jsx)(`div`,{className:`text-xs text-gray-500`,children:`Önce 1. kitabın tüm sonuçları, sonra 2. kitabın...`})]})]}),(0,X.jsxs)(`label`,{className:`flex items-center gap-2 cursor-pointer`,children:[(0,X.jsx)(`input`,{type:`radio`,name:`sortOrder`,value:`interleaved`,checked:b===`interleaved`,onChange:e=>x(e.target.value),className:`w-4 h-4 text-accent focus:ring-accent`}),(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`div`,{className:`text-sm font-medium text-gray-700`,children:`Karışık`}),(0,X.jsx)(`div`,{className:`text-xs text-gray-500`,children:`Her kitaptan sırayla birer sonuç`})]})]})]})]})]}),(0,X.jsx)(`div`,{className:`flex flex-wrap gap-2 mb-2`,children:n.map((e,t)=>(0,X.jsxs)(`div`,{className:`bg-accent text-white px-3 py-1 rounded-full flex items-center gap-2 text-sm`,children:[(0,X.jsx)(`span`,{children:e}),(0,X.jsx)(`button`,{onClick:()=>O(t),className:`hover:opacity-75 transition`,title:`Etiketi kaldır`,children:`✕`})]},t))}),(0,X.jsx)(`input`,{type:`text`,value:e,onChange:e=>D(e.target.value),onKeyPress:e=>{e.key===`Enter`&&k(!1)},placeholder:`Virgülle ayrılmış kelimeler ile ara...`,className:`w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent`}),(0,X.jsx)(`button`,{onClick:()=>k(!1),disabled:o||n.length===0&&e.trim()===``||_.length===0,className:`w-full bg-accent text-white py-3 rounded-lg hover:bg-blue-600 transition disabled:opacity-50`,children:o?`Aranıyor...`:`Arama`})]}),(0,X.jsxs)(`div`,{className:`mt-8 space-y-4`,children:[(0,X.jsx)(`h2`,{className:`text-lg font-semibold text-primary`,children:`Arama Sonuçları`}),o?(0,X.jsx)(`div`,{className:`flex justify-center py-8`,children:(0,X.jsx)(`div`,{className:`w-8 h-8 border-4 border-accent border-t-transparent rounded-full animate-spin`})}):c&&i.length===0?(0,X.jsx)(`p`,{className:`text-gray-500`,children:`Hiç sonuç bulunamadı`}):c?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(`div`,{className:`space-y-3`,children:i.map((t,r)=>(0,X.jsxs)(`div`,{ref:r===i.length-1?T:null,className:`bg-white p-4 rounded-lg shadow-md`,children:[(0,X.jsxs)(`div`,{className:`flex justify-between items-start mb-2`,children:[(0,X.jsx)(`h3`,{className:`font-semibold text-primary`,children:t.bookTitle}),(0,X.jsxs)(`span`,{className:`text-sm text-gray-500`,children:[`Sayfa `,t.pageNumber]})]}),(0,X.jsx)(`p`,{className:`text-sm text-gray-700 mb-3`,dangerouslySetInnerHTML:{__html:t.highlightedSnippet}}),(0,X.jsx)(`div`,{className:`flex gap-2`,children:(0,X.jsx)(Wt,{to:`/reader/${t.bookId}/${t.pageNumber}?q=${encodeURIComponent([...n,e].filter(Boolean).join(`,`))}`,className:`px-4 py-2 bg-accent text-white rounded-lg hover:bg-blue-600 transition text-sm`,children:`Sayfaya Git`})})]},t.id))}),o&&u>1&&(0,X.jsx)(`div`,{className:`flex justify-center py-4`,children:(0,X.jsx)(`div`,{className:`w-8 h-8 border-4 border-accent border-t-transparent rounded-full animate-spin`})}),!f&&i.length>0&&(0,X.jsx)(`p`,{className:`text-center text-gray-500 py-4`,children:`Tüm sonuçlar gösterildi`})]}):(0,X.jsx)(`p`,{className:`text-gray-500`,children:`Arama yapmak için yukarıdaki kutuyu kullanın`})]})]})})}function Gn(){let[e,t]=(0,y.useState)([]),[n,r]=(0,y.useState)(!0);(0,y.useEffect)(()=>{i()},[]);let i=async()=>{try{let e=await Dn();t(e)}catch(e){console.error(`Error loading books:`,e)}finally{r(!1)}},a=async e=>{if(window.confirm(`Bu kitabı silmek istediğinizden emin misiniz?`))try{await kn(e),await i()}catch(e){console.error(`Error deleting book:`,e),alert(`Kitap silinirken hata oluştu`)}},o=e=>e?URL.createObjectURL(e):null;return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Kütüphane`}),(0,X.jsx)(`div`,{className:`w-8`})]}),(0,X.jsx)(`div`,{className:`mb-6`,children:(0,X.jsx)(Wt,{to:`/import`,className:`w-full bg-accent text-white py-3 rounded-lg hover:bg-blue-600 transition block text-center`,children:`+ Kitap Ekle`})}),n?(0,X.jsx)(`div`,{className:`flex justify-center py-12`,children:(0,X.jsx)(`div`,{className:`w-12 h-12 border-4 border-accent border-t-transparent rounded-full animate-spin`})}):e.length===0?(0,X.jsx)(`div`,{className:`space-y-4`,children:(0,X.jsx)(`p`,{className:`text-gray-500 text-center py-8`,children:`Henüz kitap eklenmemiş. Başlamak için "Kitap Ekle" butonuna tıklayın.`})}):(0,X.jsx)(`div`,{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4`,children:e.map(e=>(0,X.jsxs)(`div`,{className:`bg-white rounded-lg shadow-md overflow-hidden group`,children:[(0,X.jsx)(Wt,{to:`/reader/${e.id}/1`,className:`block`,children:e.coverBlob?(0,X.jsx)(`img`,{src:o(e.coverBlob),alt:e.title,className:`w-full h-48 object-cover`}):(0,X.jsx)(`div`,{className:`w-full h-48 bg-gray-200 flex items-center justify-center`,children:(0,X.jsx)(`svg`,{className:`w-16 h-16 text-gray-400`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253`})})})}),(0,X.jsxs)(`div`,{className:`p-3`,children:[(0,X.jsx)(Wt,{to:`/reader/${e.id}/1`,children:(0,X.jsx)(`h3`,{className:`font-semibold text-sm truncate hover:text-accent`,children:e.title})}),e.author&&(0,X.jsx)(`p`,{className:`text-xs text-gray-600 truncate`,children:e.author}),(0,X.jsxs)(`div`,{className:`flex items-center justify-between mt-2`,children:[(0,X.jsx)(`span`,{className:`text-xs text-gray-500 uppercase`,children:e.format}),(0,X.jsx)(`button`,{onClick:()=>a(e.id),className:`text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100 transition`,children:(0,X.jsx)(`svg`,{className:`w-4 h-4`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16`})})})]})]})]},e.id))}),e.length>0&&(0,X.jsxs)(`div`,{className:`mt-6 text-center text-sm text-gray-500`,children:[`Toplam `,e.length,` kitap`]})]})})}function Kn(){let[e,t]=(0,y.useState)([]),[n,r]=(0,y.useState)(!0);(0,y.useEffect)(()=>{i()},[]);let i=async()=>{try{r(!0);let e=await jn(),n=await Promise.all(e.map(async e=>{let t=await On(e.bookId);return{...e,bookTitle:t?.title||`Bilinmeyen Kitap`}}));n.sort((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()),t(n)}catch(e){console.error(`Error loading bookmarks:`,e)}finally{r(!1)}},a=async e=>{if(window.confirm(`Bu işareti kaldırmak istediğinizden emin misiniz?`))try{await Mn(e),await i()}catch(e){console.error(`Error deleting bookmark:`,e),alert(`İşaret silinirken hata oluştu`)}};return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Yıldızlı Sayfalar`}),(0,X.jsx)(`div`,{className:`w-8`})]}),n?(0,X.jsx)(`div`,{className:`flex justify-center py-12`,children:(0,X.jsx)(`div`,{className:`w-12 h-12 border-4 border-accent border-t-transparent rounded-full animate-spin`})}):e.length===0?(0,X.jsxs)(`div`,{className:`text-center py-12`,children:[(0,X.jsx)(`svg`,{className:`w-16 h-16 mx-auto mb-4 text-gray-400`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z`})}),(0,X.jsx)(`p`,{className:`text-gray-500 mb-4`,children:`Henüz işaretlenmiş sayfa yok`}),(0,X.jsx)(`p`,{className:`text-sm text-gray-400`,children:`Kitap okurken yıldız simgesine tıklayarak sayfaları işaretleyebilirsiniz`})]}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsxs)(`div`,{className:`mb-4 text-sm text-gray-600`,children:[`Toplam `,e.length,` işaretli sayfa`]}),(0,X.jsx)(`div`,{className:`space-y-3`,children:e.map(e=>(0,X.jsxs)(`div`,{className:`bg-white p-4 rounded-lg shadow-md group`,children:[(0,X.jsxs)(`div`,{className:`flex justify-between items-start mb-2`,children:[(0,X.jsxs)(`div`,{className:`flex-1`,children:[(0,X.jsx)(`h3`,{className:`font-semibold text-primary mb-1`,children:e.bookTitle}),(0,X.jsxs)(`p`,{className:`text-sm text-gray-600`,children:[`Sayfa `,e.pageId]}),(0,X.jsxs)(`p`,{className:`text-xs text-gray-400 mt-1`,children:[`İşaretlenme: `,new Date(e.createdAt).toLocaleDateString(`tr-TR`,{year:`numeric`,month:`long`,day:`numeric`,hour:`2-digit`,minute:`2-digit`})]})]}),(0,X.jsx)(`button`,{onClick:()=>a(e.id),className:`p-2 text-red-500 hover:text-red-700 opacity-0 group-hover:opacity-100 transition`,title:`İşareti kaldır`,children:(0,X.jsx)(`svg`,{className:`w-5 h-5`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16`})})})]}),(0,X.jsx)(Wt,{to:`/reader/${e.bookId}/${e.pageId}`,className:`inline-block px-4 py-2 bg-accent text-white rounded-lg hover:bg-blue-600 transition text-sm`,children:`Sayfaya Git`})]},e.id))})]})]})})}function qn(){return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Ayarlar`}),(0,X.jsx)(`div`,{className:`w-8`})]}),(0,X.jsxs)(`div`,{className:`space-y-6`,children:[(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`label`,{className:`block text-sm font-medium text-primary mb-2`,children:`OpenRouter API Key`}),(0,X.jsx)(`input`,{type:`password`,placeholder:`API anahtarınızı girin`,className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent`})]}),(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`label`,{className:`block text-sm font-medium text-primary mb-2`,children:`Tema`}),(0,X.jsxs)(`select`,{className:`w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-accent`,children:[(0,X.jsx)(`option`,{children:`Açık`}),(0,X.jsx)(`option`,{children:`Koyu`}),(0,X.jsx)(`option`,{children:`Sistem`})]})]}),(0,X.jsx)(`button`,{className:`w-full bg-red-500 text-white py-3 rounded-lg hover:bg-red-600 transition`,children:`Cache Temizle`})]})]})})}function Jn(){let[e]=Qt(),t=e.get(`q`)||``,[n,r]=(0,y.useState)([]),[i,a]=(0,y.useState)(!1),[o,s]=(0,y.useState)(1),[c,l]=(0,y.useState)(!0),[u,d]=(0,y.useState)(0),[f,p]=(0,y.useState)(!1),[m,h]=(0,y.useState)({}),g=(0,y.useRef)(null),_=(0,y.useCallback)(e=>{i||(g.current&&g.current.disconnect(),g.current=new IntersectionObserver(e=>{e[0].isIntersecting&&c&&s(e=>e+1)}),e&&g.current.observe(e))},[i,c]);(0,y.useEffect)(()=>{r([]),s(1),l(!0),d(0)},[t]),(0,y.useEffect)(()=>{t&&v()},[t,o]);let v=async()=>{if(t.trim()){a(!0);try{let{results:e,hasMore:n,total:i}=await Vn(t,o,10);r(t=>o===1?e:[...t,...e]),l(n),d(i)}catch(e){console.error(`Search error:`,e)}finally{a(!1)}}};return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsxs)(`div`,{className:`text-center`,children:[(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Arama Sonuçları`}),u>0&&(0,X.jsxs)(`p`,{className:`text-sm text-gray-600`,children:[u,` sonuç bulundu`]})]}),(0,X.jsx)(`div`,{className:`w-8`})]}),(0,X.jsxs)(`div`,{className:`mb-4`,children:[(0,X.jsx)(`div`,{className:`bg-gray-100 p-3 rounded-lg mb-4`,children:(0,X.jsxs)(`p`,{className:`text-sm text-gray-700`,children:[`Aranan: `,(0,X.jsx)(`span`,{className:`font-semibold`,children:t})]})}),n.length>0&&(0,X.jsx)(`button`,{onClick:async()=>{let e=localStorage.getItem(`openrouter_api_key`);if(!e){alert(`Lütfen ayarlardan OpenRouter API anahtarınızı girin`);return}p(!0);let t={};try{let r=n.slice(0,5);for(let n of r)try{let r=await(await fetch(`https://openrouter.ai/api/v1/chat/completions`,{method:`POST`,headers:{Authorization:`Bearer ${e}`,"Content-Type":`application/json`,"HTTP-Referer":window.location.origin},body:JSON.stringify({model:`openai/gpt-4o`,messages:[{role:`user`,content:`Lütfen şu metni kısaca özetle:\n\n${n.snippet}`}]})})).json();t[n.id]=r.choices[0].message.content}catch(e){console.error(`Summary error for result`,n.id,e),t[n.id]=`Özet oluşturulamadı`}h(t)}catch{alert(`Toplu özet oluşturulurken hata oluştu`)}finally{p(!1)}},disabled:f,className:`w-full bg-accent text-white py-3 rounded-lg hover:bg-blue-600 transition disabled:opacity-50`,children:f?`Özetleniyor...`:`📝 İlk 5 Sonucu Toplu Özetle`})]}),(0,X.jsxs)(`div`,{className:`space-y-4`,children:[n.length===0&&!i?(0,X.jsx)(`p`,{className:`text-gray-500 text-center py-8`,children:`Hiç sonuç bulunamadı`}):n.map((e,r)=>(0,X.jsxs)(`div`,{ref:r===n.length-1?_:null,className:`bg-white p-4 rounded-lg shadow-md`,children:[(0,X.jsxs)(`div`,{className:`flex justify-between items-start mb-2`,children:[(0,X.jsx)(`h3`,{className:`font-semibold text-primary`,children:e.bookTitle}),(0,X.jsxs)(`span`,{className:`text-sm text-gray-500`,children:[`Sayfa `,e.pageNumber]})]}),(0,X.jsx)(`p`,{className:`text-sm text-gray-700 mb-3`,dangerouslySetInnerHTML:{__html:e.highlightedSnippet}}),m[e.id]&&(0,X.jsxs)(`div`,{className:`mb-3 p-3 bg-blue-50 border border-blue-200 rounded`,children:[(0,X.jsx)(`p`,{className:`text-xs font-semibold text-blue-900 mb-1`,children:`Özet:`}),(0,X.jsx)(`p`,{className:`text-xs text-blue-800`,children:m[e.id]})]}),(0,X.jsx)(Wt,{to:`/reader/${e.bookId}/${e.pageNumber}?q=${encodeURIComponent(t)}`,className:`inline-block px-4 py-2 bg-accent text-white rounded-lg hover:bg-blue-600 transition text-sm`,children:`Sayfaya Git`})]},e.id)),i&&(0,X.jsx)(`div`,{className:`flex justify-center py-8`,children:(0,X.jsx)(`div`,{className:`w-8 h-8 border-4 border-accent border-t-transparent rounded-full animate-spin`})}),!c&&n.length>0&&(0,X.jsx)(`p`,{className:`text-center text-gray-500 py-4`,children:`Tüm sonuçlar gösterildi`})]})]})})}function Yn(){let{bookId:e,pageId:t}=Me(),n=Ae(),[r]=Qt(),[i,a]=(0,y.useState)(null),[o,s]=(0,y.useState)(!0),[c,l]=(0,y.useState)(null),[u,d]=(0,y.useState)(0),[f,p]=(0,y.useState)(!1),[m,h]=(0,y.useState)([]),[g,_]=(0,y.useState)(``),[v,b]=(0,y.useState)(!1),[x,S]=(0,y.useState)(!1),[C,w]=(0,y.useState)(``),[T,E]=(0,y.useState)(``),[D,O]=(0,y.useState)(`base`),[k,A]=(0,y.useState)(!1),[j,M]=(0,y.useState)(``),[N,P]=(0,y.useState)(!1),[F,I]=(0,y.useState)(`serif`),[L,R]=(0,y.useState)(`white`),ee=parseInt(t||`1`),te=parseInt(e||`0`);(0,y.useEffect)(()=>{ne(),re()},[e]),(0,y.useEffect)(()=>{i&&(ae(),ie())},[t,i,m]);let ne=async()=>{try{s(!0);let e=await On(te);if(!e){l(`Kitap bulunamadı`);return}a(e)}catch{l(`Kitap yüklenirken hata oluştu`)}finally{s(!1)}},re=async()=>{let e=await jn();h(e)},ie=()=>{let e=m.some(e=>e.bookId===te&&e.pageId===t);p(e)},ae=async()=>{try{s(!0);let e=await Tn.bookContent.where(`[bookId+pageNumber]`).equals([te,ee]).first();if(e){E(e.contentText);let t=await Tn.bookContent.where(`bookId`).equals(te).count();d(t)}else E(``),l(`Sayfa içeriği bulunamadı`)}catch(e){console.error(`Page load error:`,e),l(`Sayfa yüklenirken hata oluştu`)}finally{s(!1)}},oe=()=>{ee>1&&n(`/reader/${e}/${ee-1}`)},z=()=>{ee<u&&n(`/reader/${e}/${ee+1}`)},se=async()=>{if(f){let e=m.find(e=>e.bookId===te&&e.pageId===t);e?.id&&await Mn(e.id)}else await An(te,t);await re()},ce=()=>{let e=window.getSelection()?.toString().trim();e&&e.length>0?(_(e),b(!0)):b(!1)},B=async()=>{if(g){S(!0),w(``);try{let e=localStorage.getItem(`openrouter_api_key`);if(!e){alert(`Lütfen ayarlardan OpenRouter API anahtarınızı girin`),n(`/settings`);return}let t=await(await fetch(`https://openrouter.ai/api/v1/chat/completions`,{method:`POST`,headers:{Authorization:`Bearer ${e}`,"Content-Type":`application/json`,"HTTP-Referer":window.location.origin},body:JSON.stringify({model:`openai/gpt-4o`,messages:[{role:`user`,content:`Lütfen şu metni özetle:\n\n${g}`}]})})).json();w(t.choices[0].message.content)}catch{alert(`Özet oluşturulurken hata oluştu`)}finally{S(!1)}}},le=()=>{if(!g)return;let e=new SpeechSynthesisUtterance(g);e.lang=`tr-TR`,window.speechSynthesis.speak(e)},ue=t=>{t.preventDefault();let r=parseInt(j);r>=1&&r<=u&&(n(`/reader/${e}/${r}`),A(!1),M(``))};if(o)return(0,X.jsx)(`div`,{className:`min-h-screen bg-background flex items-center justify-center`,children:(0,X.jsx)(`div`,{className:`w-16 h-16 border-4 border-accent border-t-transparent rounded-full animate-spin`})});if(c||!i)return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto text-center py-12`,children:[(0,X.jsx)(`p`,{className:`text-red-500 mb-4`,children:c||`Kitap bulunamadı`}),(0,X.jsx)(Wt,{to:`/library`,className:`text-accent hover:underline`,children:`Kütüphaneye Dön`})]})});let de={sm:`text-sm`,base:`text-base`,lg:`text-lg`,xl:`text-xl`},fe={serif:`Georgia, Cambria, "Times New Roman", Times, serif`,merriweather:`"Merriweather", Georgia, serif`,system:`system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif`,roboto:`"Roboto", system-ui, sans-serif`,opensans:`"Open Sans", system-ui, sans-serif`,arial:`Arial, Helvetica, sans-serif`,poppins:`"Poppins", system-ui, sans-serif`,verdana:`Verdana, Geneva, sans-serif`,mono:`"Courier New", Courier, monospace`},V={white:{bg:`#FFFFFF`,text:`#2D3748`},sepia:{bg:`#F4ECD8`,text:`#5C4B37`},dark:{bg:`#1A202C`,text:`#E2E8F0`},cream:{bg:`#FFF8DC`,text:`#3E3E3E`}};return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/library`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsxs)(`div`,{className:`text-center flex-1 relative`,children:[(0,X.jsx)(`h2`,{className:`font-semibold text-lg`,children:i.title}),(0,X.jsxs)(`div`,{className:`text-sm text-gray-600 cursor-pointer hover:text-accent transition`,onClick:()=>A(!k),children:[`Sayfa `,ee,` / `,u]}),k&&(0,X.jsxs)(`form`,{onSubmit:ue,className:`absolute top-full mt-2 left-1/2 -translate-x-1/2 bg-white shadow-lg rounded-lg p-2 flex gap-2 z-10`,children:[(0,X.jsx)(`input`,{type:`number`,value:j,onChange:e=>M(e.target.value),className:`w-24 p-1 border rounded-md text-center`,placeholder:`1-${u}`,min:1,max:u,autoFocus:!0}),(0,X.jsx)(`button`,{type:`submit`,className:`px-3 py-1 bg-accent text-white rounded-md hover:bg-blue-600`,children:`Git`})]})]}),(0,X.jsxs)(`div`,{className:`flex items-center gap-2`,children:[(0,X.jsx)(`button`,{onClick:()=>P(!0),className:`p-2 hover:bg-gray-200 rounded-lg transition`,title:`Okuma Ayarları`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4`})})}),(0,X.jsx)(`button`,{onClick:se,className:`p-2 hover:bg-gray-200 rounded-lg transition`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6 ${f?`text-highlight fill-current`:`text-gray-400`}`,fill:f?`currentColor`:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z`})})})]})]}),(0,X.jsxs)(`div`,{className:`rounded-lg shadow-lg overflow-hidden`,style:{backgroundColor:V[L].bg},children:[(0,X.jsx)(`div`,{className:`border-b px-8 py-4 text-center`,style:{backgroundColor:L===`dark`?`#2D3748`:L===`sepia`?`#E8DCC0`:L===`cream`?`#F5E6B3`:`#F7FAFC`,borderColor:L===`dark`?`#4A5568`:`#E2E8F0`},children:(0,X.jsxs)(`span`,{className:`text-sm font-medium`,style:{color:V[L].text},children:[`Sayfa `,ee]})}),(0,X.jsx)(`div`,{className:`p-8 min-h-[600px]`,onMouseUp:ce,style:{backgroundColor:V[L].bg},children:(0,X.jsx)(`div`,{className:`${de[D]} leading-loose whitespace-pre-wrap break-words`,style:{fontFamily:fe[F],lineHeight:D===`sm`?`1.8`:D===`base`?`2.0`:`2.2`,textAlign:`justify`,hyphens:`auto`,wordSpacing:`0.05em`,letterSpacing:`0.01em`,color:V[L].text},dangerouslySetInnerHTML:{__html:Rn(T,r.get(`q`)?.split(`,`).map(e=>e.trim()).filter(Boolean)||[])}})})]}),N&&(0,X.jsx)(`div`,{className:`fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50`,onClick:()=>P(!1),children:(0,X.jsxs)(`div`,{className:`bg-white rounded-lg shadow-2xl p-6 max-w-md w-full mx-4`,onClick:e=>e.stopPropagation(),children:[(0,X.jsxs)(`div`,{className:`flex justify-between items-center mb-6`,children:[(0,X.jsx)(`h3`,{className:`text-xl font-semibold text-secondary`,children:`Okuma Ayarları`}),(0,X.jsx)(`button`,{onClick:()=>P(!1),className:`text-gray-500 hover:text-gray-700`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M6 18L18 6M6 6l12 12`})})})]}),(0,X.jsxs)(`div`,{className:`mb-6`,children:[(0,X.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-3`,children:`Yazı Boyutu`}),(0,X.jsx)(`div`,{className:`grid grid-cols-4 gap-2`,children:[`sm`,`base`,`lg`,`xl`].map(e=>(0,X.jsx)(`button`,{onClick:()=>O(e),className:`px-4 py-2 rounded-lg border-2 transition ${D===e?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,children:e===`sm`?`Küçük`:e===`base`?`Normal`:e===`lg`?`Büyük`:`Çok Büyük`},e))})]}),(0,X.jsxs)(`div`,{className:`mb-6`,children:[(0,X.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-3`,children:`Yazı Tipi`}),(0,X.jsxs)(`div`,{className:`mb-3`,children:[(0,X.jsx)(`p`,{className:`text-xs text-gray-600 mb-2 font-semibold`,children:`SERIF (Klasik)`}),(0,X.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,X.jsx)(`button`,{onClick:()=>I(`serif`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`serif`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.serif},children:`Georgia`}),(0,X.jsx)(`button`,{onClick:()=>I(`merriweather`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`merriweather`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.merriweather},children:`Merriweather`})]})]}),(0,X.jsxs)(`div`,{className:`mb-3`,children:[(0,X.jsx)(`p`,{className:`text-xs text-gray-600 mb-2 font-semibold`,children:`SANS-SERIF (Modern)`}),(0,X.jsxs)(`div`,{className:`grid grid-cols-3 gap-2`,children:[(0,X.jsx)(`button`,{onClick:()=>I(`system`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`system`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.system},children:`System UI`}),(0,X.jsx)(`button`,{onClick:()=>I(`roboto`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`roboto`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.roboto},children:`Roboto`}),(0,X.jsx)(`button`,{onClick:()=>I(`opensans`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`opensans`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.opensans},children:`Open Sans`}),(0,X.jsx)(`button`,{onClick:()=>I(`poppins`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`poppins`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.poppins},children:`Poppins`}),(0,X.jsx)(`button`,{onClick:()=>I(`arial`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`arial`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.arial},children:`Arial`}),(0,X.jsx)(`button`,{onClick:()=>I(`verdana`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`verdana`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.verdana},children:`Verdana`})]})]}),(0,X.jsxs)(`div`,{children:[(0,X.jsx)(`p`,{className:`text-xs text-gray-600 mb-2 font-semibold`,children:`MONOSPACE (Teknik)`}),(0,X.jsx)(`div`,{className:`grid grid-cols-1 gap-2`,children:(0,X.jsx)(`button`,{onClick:()=>I(`mono`),className:`px-3 py-2 rounded-lg border-2 transition text-sm ${F===`mono`?`border-accent bg-accent text-white`:`border-gray-300 hover:border-accent`}`,style:{fontFamily:fe.mono},children:`Courier New`})})]})]}),(0,X.jsxs)(`div`,{className:`mb-6`,children:[(0,X.jsx)(`label`,{className:`block text-sm font-medium text-gray-700 mb-3`,children:`Arka Plan`}),(0,X.jsxs)(`div`,{className:`grid grid-cols-2 gap-2`,children:[(0,X.jsxs)(`button`,{onClick:()=>R(`white`),className:`px-4 py-3 rounded-lg border-2 transition flex items-center gap-2 ${L===`white`?`border-accent ring-2 ring-accent`:`border-gray-300 hover:border-accent`}`,children:[(0,X.jsx)(`div`,{className:`w-6 h-6 rounded bg-white border border-gray-300`}),(0,X.jsx)(`span`,{children:`Beyaz`})]}),(0,X.jsxs)(`button`,{onClick:()=>R(`sepia`),className:`px-4 py-3 rounded-lg border-2 transition flex items-center gap-2 ${L===`sepia`?`border-accent ring-2 ring-accent`:`border-gray-300 hover:border-accent`}`,children:[(0,X.jsx)(`div`,{className:`w-6 h-6 rounded`,style:{backgroundColor:`#F4ECD8`}}),(0,X.jsx)(`span`,{children:`Sepya`})]}),(0,X.jsxs)(`button`,{onClick:()=>R(`cream`),className:`px-4 py-3 rounded-lg border-2 transition flex items-center gap-2 ${L===`cream`?`border-accent ring-2 ring-accent`:`border-gray-300 hover:border-accent`}`,children:[(0,X.jsx)(`div`,{className:`w-6 h-6 rounded`,style:{backgroundColor:`#FFF8DC`}}),(0,X.jsx)(`span`,{children:`Krem`})]}),(0,X.jsxs)(`button`,{onClick:()=>R(`dark`),className:`px-4 py-3 rounded-lg border-2 transition flex items-center gap-2 ${L===`dark`?`border-accent ring-2 ring-accent`:`border-gray-300 hover:border-accent`}`,children:[(0,X.jsx)(`div`,{className:`w-6 h-6 rounded bg-gray-800`}),(0,X.jsx)(`span`,{children:`Karanlık`})]})]})]}),(0,X.jsx)(`button`,{onClick:()=>P(!1),className:`w-full px-4 py-2 bg-accent text-white rounded-lg hover:bg-blue-600 transition`,children:`Tamam`})]})}),v&&(0,X.jsxs)(`div`,{className:`fixed bottom-24 right-8 bg-white rounded-lg shadow-xl p-4 space-y-2`,children:[(0,X.jsx)(`button`,{onClick:B,disabled:x,className:`w-full px-4 py-2 bg-accent text-white rounded hover:bg-blue-600 disabled:opacity-50`,children:x?`Özetleniyor...`:`📝 Özetle`}),(0,X.jsx)(`button`,{onClick:le,className:`w-full px-4 py-2 bg-secondary text-white rounded hover:bg-gray-600`,children:`🔊 Sesli Oku`})]}),C&&(0,X.jsxs)(`div`,{className:`mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg`,children:[(0,X.jsx)(`h3`,{className:`font-semibold mb-2`,children:`Özet:`}),(0,X.jsx)(`p`,{className:`text-sm`,children:C}),(0,X.jsx)(`button`,{onClick:()=>w(``),className:`mt-2 text-xs text-gray-500 hover:text-gray-700`,children:`Kapat`})]}),(0,X.jsxs)(`div`,{className:`flex justify-between mt-6`,children:[(0,X.jsx)(`button`,{onClick:oe,disabled:ee===1,className:`px-4 py-2 bg-secondary text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed`,children:`← Önceki Sayfa`}),(0,X.jsx)(`button`,{onClick:z,disabled:ee===u,className:`px-4 py-2 bg-secondary text-white rounded-lg hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed`,children:`Sonraki Sayfa →`})]})]})})}var Xn={};Xn.d=(e,t)=>{for(var n in t)Xn.o(t,n)&&!Xn.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Xn.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Zn=typeof process==`object`&&process+``==`[object process]`&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!==`browser`),Qn=[.001,0,0,.001,0,0],$n=1.35;.35/$n;var er={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},tr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},nr=`pdfjs_internal_editor_`,rr={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ir={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},ar={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},or={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},sr={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},cr={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},lr={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ur={ERRORS:0,WARNINGS:1,INFOS:5},dr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},fr={moveTo:0,lineTo:1,curveTo:2,closePath:3},pr={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},mr=ur.WARNINGS;function hr(e){Number.isInteger(e)&&(mr=e)}function gr(){return mr}function _r(e){mr>=ur.INFOS&&console.info(`Info: ${e}`)}function vr(e){mr>=ur.WARNINGS&&console.warn(`Warning: ${e}`)}function yr(e){throw Error(e)}function br(e,t){e||yr(t)}function xr(e){switch(e?.protocol){case`http:`:case`https:`:case`ftp:`:case`mailto:`:case`tel:`:return!0;default:return!1}}function Sr(e,t=null,n=null){if(!e)return null;if(n&&typeof e==`string`&&(n.addDefaultProtocol&&e.startsWith(`www.`)&&e.match(/\./g)?.length>=2&&(e=`http://${e}`),n.tryConvertEncoding))try{e=zr(e)}catch{}let r=t?URL.parse(e,t):URL.parse(e);return xr(r)?r:null}function Cr(e,t,n=!1){let r=URL.parse(e);return r?(r.hash=t,r.href):n&&Sr(e,`http://example.com`)?e.split(`#`,1)[0]+`${t?`#${t}`:``}`:``}function wr(e,t,n,r=!1){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!0,writable:!1}),n}var Tr=function(){function e(e,t){this.message=e,this.name=t}return e.prototype=Error(),e.constructor=e,e}(),Er=class extends Tr{constructor(e,t){super(e,`PasswordException`),this.code=t}},Dr=class extends Tr{constructor(e,t){super(e,`UnknownErrorException`),this.details=t}},Or=class extends Tr{constructor(e){super(e,`InvalidPDFException`)}},kr=class extends Tr{constructor(e,t,n){super(e,`ResponseException`),this.status=t,this.missing=n}},Ar=class extends Tr{constructor(e){super(e,`FormatError`)}},jr=class extends Tr{constructor(e){super(e,`AbortException`)}};function Mr(e){(typeof e!=`object`||e?.length===void 0)&&yr(`Invalid argument for bytesToString`);let t=e.length,n=8192;if(t<n)return String.fromCharCode.apply(null,e);let r=[];for(let i=0;i<t;i+=n){let a=Math.min(i+n,t),o=e.subarray(i,a);r.push(String.fromCharCode.apply(null,o))}return r.join(``)}function Nr(e){typeof e!=`string`&&yr(`Invalid argument for stringToBytes`);let t=e.length,n=new Uint8Array(t);for(let r=0;r<t;++r)n[r]=e.charCodeAt(r)&255;return n}function Pr(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,e&255)}function Fr(){let e=new Uint8Array(4);return e[0]=1,new Uint32Array(e.buffer,0,1)[0]===1}function Ir(){try{return Function(``),!0}catch{return!1}}var Lr=class{static get isLittleEndian(){return wr(this,`isLittleEndian`,Fr())}static get isEvalSupported(){return wr(this,`isEvalSupported`,Ir())}static get isOffscreenCanvasSupported(){return wr(this,`isOffscreenCanvasSupported`,typeof OffscreenCanvas<`u`)}static get isImageDecoderSupported(){return wr(this,`isImageDecoderSupported`,typeof ImageDecoder<`u`)}static get platform(){let{platform:e,userAgent:t}=navigator;return wr(this,`platform`,{isAndroid:t.includes(`Android`),isLinux:e.includes(`Linux`),isMac:e.includes(`Mac`),isWindows:e.includes(`Win`),isFirefox:t.includes(`Firefox`)})}static get isCSSRoundSupported(){return wr(this,`isCSSRoundSupported`,globalThis.CSS?.supports?.(`width: round(1.5px, 1px)`))}},Rr=Array.from(Array(256).keys(),e=>e.toString(16).padStart(2,`0`)),Z=class{static makeHexColor(e,t,n){return`#${Rr[e]}${Rr[t]}${Rr[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){let r=e[n],i=e[n+1];e[n]=r*t[0]+i*t[2]+t[4],e[n+1]=r*t[1]+i*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){let r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5];for(let t=0;t<6;t+=2){let l=e[n+t],u=e[n+t+1];e[n+t]=l*r+u*a+s,e[n+t+1]=l*i+u*o+c}}static applyInverseTransform(e,t){let n=e[0],r=e[1],i=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-r*t[2]+t[2]*t[5]-t[4]*t[3])/i,e[1]=(-n*t[1]+r*t[0]+t[4]*t[1]-t[5]*t[0])/i}static axialAlignedBoundingBox(e,t,n){let r=t[0],i=t[1],a=t[2],o=t[3],s=t[4],c=t[5],l=e[0],u=e[1],d=e[2],f=e[3],p=r*l+s,m=p,h=r*d+s,g=h,_=o*u+c,v=_,y=o*f+c,b=y;if(i!==0||a!==0){let e=i*l,t=i*d,n=a*u,r=a*f;p+=n,g+=n,h+=r,m+=r,_+=e,b+=e,y+=t,v+=t}n[0]=Math.min(n[0],p,h,m,g),n[1]=Math.min(n[1],_,y,v,b),n[2]=Math.max(n[2],p,h,m,g),n[3]=Math.max(n[3],_,y,v,b)}static inverseTransform(e){let t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){let n=e[0],r=e[1],i=e[2],a=e[3],o=n**2+r**2,s=n*i+r*a,c=i**2+a**2,l=(o+c)/2,u=Math.sqrt(l**2-(o*c-s**2));t[0]=Math.sqrt(l+u||1),t[1]=Math.sqrt(l-u||1)}static normalizeRect(e){let t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){let n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),r=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>r)return null;let i=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return i>a?null:[n,i,r,a]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,r,i){i[0]=Math.min(i[0],e,n),i[1]=Math.min(i[1],t,r),i[2]=Math.max(i[2],e,n),i[3]=Math.max(i[3],t,r)}static#getExtremumOnCurve(e,t,n,r,i,a,o,s,c,l){if(c<=0||c>=1)return;let u=1-c,d=c*c,f=d*c,p=u*(u*(u*e+3*c*t)+3*d*n)+f*r,m=u*(u*(u*i+3*c*a)+3*d*o)+f*s;l[0]=Math.min(l[0],p),l[1]=Math.min(l[1],m),l[2]=Math.max(l[2],p),l[3]=Math.max(l[3],m)}static#getExtremum(e,t,n,r,i,a,o,s,c,l,u,d){if(Math.abs(c)<1e-12){Math.abs(l)>=1e-12&&this.#getExtremumOnCurve(e,t,n,r,i,a,o,s,-u/l,d);return}let f=l**2-4*u*c;if(f<0)return;let p=Math.sqrt(f),m=2*c;this.#getExtremumOnCurve(e,t,n,r,i,a,o,s,(-l+p)/m,d),this.#getExtremumOnCurve(e,t,n,r,i,a,o,s,(-l-p)/m,d)}static bezierBoundingBox(e,t,n,r,i,a,o,s,c){c[0]=Math.min(c[0],e,o),c[1]=Math.min(c[1],t,s),c[2]=Math.max(c[2],e,o),c[3]=Math.max(c[3],t,s),this.#getExtremum(e,n,i,o,t,r,a,s,3*(-e+3*(n-i)+o),6*(e-2*n+i),3*(n-e),c),this.#getExtremum(e,n,i,o,t,r,a,s,3*(-t+3*(r-a)+s),6*(t-2*r+a),3*(r-t),c)}};function zr(e){return decodeURIComponent(escape(e))}var Br=null,Vr=null;function Hr(e){return Br||(Br=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Vr=new Map([[`ﬅ`,`ſt`]])),e.replaceAll(Br,(e,t,n)=>t?t.normalize(`NFKC`):Vr.get(n))}function Ur(){if(typeof crypto.randomUUID==`function`)return crypto.randomUUID();let e=new Uint8Array(32);return crypto.getRandomValues(e),Mr(e)}var Wr=`pdfjs_internal_id_`;function Gr(e,t,n){if(!Array.isArray(n)||n.length<2)return!1;let[r,i,...a]=n;if(!e(r)&&!Number.isInteger(r)||!t(i))return!1;let o=a.length,s=!0;switch(i.name){case`XYZ`:if(o<2||o>3)return!1;break;case`Fit`:case`FitB`:return o===0;case`FitH`:case`FitBH`:case`FitV`:case`FitBV`:if(o>1)return!1;break;case`FitR`:if(o!==4)return!1;s=!1;break;default:return!1}for(let e of a)if(!(typeof e==`number`||s&&e===null))return!1;return!0}function Kr(e,t,n){return Math.min(Math.max(e,t),n)}function qr(e){return Uint8Array.prototype.toBase64?e.toBase64():btoa(Mr(e))}function Jr(e){return Uint8Array.fromBase64?Uint8Array.fromBase64(e):Nr(atob(e))}typeof Promise.try!=`function`&&(Promise.try=function(e,...t){return new Promise(n=>{n(e(...t))})}),typeof Math.sumPrecise!=`function`&&(Math.sumPrecise=function(e){return e.reduce((e,t)=>e+t,0)});var Yr=class e{static textContent(t){let n=[],r={items:n,styles:Object.create(null)};function i(t){if(!t)return;let r=null,a=t.name;if(a===`#text`)r=t.value;else if(e.shouldBuildText(a))t?.attributes?.textContent?r=t.attributes.textContent:t.value&&(r=t.value);else return;if(r!==null&&n.push({str:r}),t.children)for(let e of t.children)i(e)}return i(t),r}static shouldBuildText(e){return!(e===`textarea`||e===`input`||e===`option`||e===`select`)}},Xr=class{static setupStorage(e,t,n,r,i){let a=r.getValue(t,{value:null});switch(n.name){case`textarea`:if(a.value!==null&&(e.textContent=a.value),i===`print`)break;e.addEventListener(`input`,e=>{r.setValue(t,{value:e.target.value})});break;case`input`:if(n.attributes.type===`radio`||n.attributes.type===`checkbox`){if(a.value===n.attributes.xfaOn?e.setAttribute(`checked`,!0):a.value===n.attributes.xfaOff&&e.removeAttribute(`checked`),i===`print`)break;e.addEventListener(`change`,e=>{r.setValue(t,{value:e.target.checked?e.target.getAttribute(`xfaOn`):e.target.getAttribute(`xfaOff`)})})}else{if(a.value!==null&&e.setAttribute(`value`,a.value),i===`print`)break;e.addEventListener(`input`,e=>{r.setValue(t,{value:e.target.value})})}break;case`select`:if(a.value!==null){e.setAttribute(`value`,a.value);for(let e of n.children)e.attributes.value===a.value?e.attributes.selected=!0:e.attributes.hasOwnProperty(`selected`)&&delete e.attributes.selected}e.addEventListener(`input`,e=>{let n=e.target.options,i=n.selectedIndex===-1?``:n[n.selectedIndex].value;r.setValue(t,{value:i})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:r,linkService:i}){let{attributes:a}=t,o=e instanceof HTMLAnchorElement;a.type===`radio`&&(a.name=`${a.name}-${r}`);for(let[t,n]of Object.entries(a))if(n!=null)switch(t){case`class`:n.length&&e.setAttribute(t,n.join(` `));break;case`dataId`:break;case`id`:e.setAttribute(`data-element-id`,n);break;case`style`:Object.assign(e.style,n);break;case`textContent`:e.textContent=n;break;default:(!o||t!==`href`&&t!==`newWindow`)&&e.setAttribute(t,n)}o&&i.addLinkAttributes(e,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(e,a.dataId,t,n)}static render(e){let t=e.annotationStorage,n=e.linkService,r=e.xfaHtml,i=e.intent||`display`,a=document.createElement(r.name);r.attributes&&this.setAttributes({html:a,element:r,intent:i,linkService:n});let o=i!==`richText`,s=e.div;if(s.append(a),e.viewport){let t=`matrix(${e.viewport.transform.join(`,`)})`;s.style.transform=t}o&&s.setAttribute(`class`,`xfaLayer xfaFont`);let c=[];if(r.children.length===0){if(r.value){let e=document.createTextNode(r.value);a.append(e),o&&Yr.shouldBuildText(r.name)&&c.push(e)}return{textDivs:c}}let l=[[r,-1,a]];for(;l.length>0;){let[e,r,a]=l.at(-1);if(r+1===e.children.length){l.pop();continue}let s=e.children[++l.at(-1)[1]];if(s===null)continue;let{name:u}=s;if(u===`#text`){let e=document.createTextNode(s.value);c.push(e),a.append(e);continue}let d=s?.attributes?.xmlns?document.createElementNS(s.attributes.xmlns,u):document.createElement(u);if(a.append(d),s.attributes&&this.setAttributes({html:d,element:s,storage:t,intent:i,linkService:n}),s.children?.length>0)l.push([s,-1,d]);else if(s.value){let e=document.createTextNode(s.value);o&&Yr.shouldBuildText(u)&&c.push(e),d.append(e)}}for(let e of s.querySelectorAll(`.xfaNonInteractive input, .xfaNonInteractive textarea`))e.setAttribute(`readOnly`,!0);return{textDivs:c}}static update(e){let t=`matrix(${e.viewport.transform.join(`,`)})`;e.div.style.transform=t,e.div.hidden=!1}},Zr=`http://www.w3.org/2000/svg`,Qr=class{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF};async function $r(e,t=`text`){if(si(e,document.baseURI)){let n=await fetch(e);if(!n.ok)throw Error(n.statusText);switch(t){case`arraybuffer`:return n.arrayBuffer();case`blob`:return n.blob();case`json`:return n.json()}return n.text()}return new Promise((n,r)=>{let i=new XMLHttpRequest;i.open(`GET`,e,!0),i.responseType=t,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(t){case`arraybuffer`:case`blob`:case`json`:n(i.response);return}n(i.responseText);return}r(Error(i.statusText))}},i.send(null)})}var ei=class e{constructor({viewBox:e,userUnit:t,scale:n,rotation:r,offsetX:i=0,offsetY:a=0,dontFlip:o=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=r,this.offsetX=i,this.offsetY=a,n*=t;let s=(e[2]+e[0])/2,c=(e[3]+e[1])/2,l,u,d,f;switch(r%=360,r<0&&(r+=360),r){case 180:l=-1,u=0,d=0,f=1;break;case 90:l=0,u=1,d=1,f=0;break;case 270:l=0,u=-1,d=-1,f=0;break;case 0:l=1,u=0,d=0,f=-1;break;default:throw Error(`PageViewport: Invalid rotation, must be a multiple of 90 degrees.`)}o&&(d=-d,f=-f);let p,m,h,g;l===0?(p=Math.abs(c-e[1])*n+i,m=Math.abs(s-e[0])*n+a,h=(e[3]-e[1])*n,g=(e[2]-e[0])*n):(p=Math.abs(s-e[0])*n+i,m=Math.abs(c-e[1])*n+a,h=(e[2]-e[0])*n,g=(e[3]-e[1])*n),this.transform=[l*n,u*n,d*n,f*n,p-l*n*s-d*n*c,m-u*n*s-f*n*c],this.width=h,this.height=g}get rawDims(){let e=this.viewBox;return wr(this,`rawDims`,{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:t=this.scale,rotation:n=this.rotation,offsetX:r=this.offsetX,offsetY:i=this.offsetY,dontFlip:a=!1}={}){return new e({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:n,offsetX:r,offsetY:i,dontFlip:a})}convertToViewportPoint(e,t){let n=[e,t];return Z.applyTransform(n,this.transform),n}convertToViewportRectangle(e){let t=[e[0],e[1]];Z.applyTransform(t,this.transform);let n=[e[2],e[3]];return Z.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){let n=[e,t];return Z.applyInverseTransform(n,this.transform),n}},ti=class extends Tr{constructor(e,t=0){super(e,`RenderingCancelledException`),this.extraDelay=t}};function ni(e){let t=e.length,n=0;for(;n<t&&e[n].trim()===``;)n++;return e.substring(n,n+5).toLowerCase()===`data:`}function ri(e){return typeof e==`string`&&/\.pdf$/i.test(e)}function ii(e){return[e]=e.split(/[#?]/,1),e.substring(e.lastIndexOf(`/`)+1)}function ai(e,t=`document.pdf`){if(typeof e!=`string`)return t;if(ni(e))return vr(`getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.`),t;let n=(e=>{try{return new URL(e)}catch{try{return new URL(decodeURIComponent(e))}catch{try{return new URL(e,`https://foo.bar`)}catch{try{return new URL(decodeURIComponent(e),`https://foo.bar`)}catch{return null}}}}})(e);if(!n)return t;let r=e=>{try{let t=decodeURIComponent(e);return t.includes(`/`)?(t=t.split(`/`).at(-1),t.test(/^\.pdf$/i)?t:e):t}catch{return e}},i=/\.pdf$/i,a=n.pathname.split(`/`).at(-1);if(i.test(a))return r(a);if(n.searchParams.size>0){let e=Array.from(n.searchParams.values()).reverse();for(let t of e)if(i.test(t))return r(t);let t=Array.from(n.searchParams.keys()).reverse();for(let e of t)if(i.test(e))return r(e)}if(n.hash){let e=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(e)return r(e[0])}return t}var oi=class{started=Object.create(null);times=[];time(e){e in this.started&&vr(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||vr(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){let e=[],t=0;for(let{name:e}of this.times)t=Math.max(e.length,t);for(let{name:n,start:r,end:i}of this.times)e.push(`${n.padEnd(t)} ${i-r}ms\n`);return e.join(``)}};function si(e,t){let n=t?URL.parse(e,t):URL.parse(e);return n?.protocol===`http:`||n?.protocol===`https:`}function ci(e){e.preventDefault()}function li(e){e.preventDefault(),e.stopPropagation()}function ui(e){console.log(`Deprecated API usage: `+e)}var di=class{static#regex;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!=`string`)return null;this.#regex||=RegExp(`^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?`);let t=this.#regex.exec(e);if(!t)return null;let n=parseInt(t[1],10),r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let i=parseInt(t[3],10);i=i>=1&&i<=31?i:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let o=parseInt(t[5],10);o=o>=0&&o<=59?o:0;let s=parseInt(t[6],10);s=s>=0&&s<=59?s:0;let c=t[7]||`Z`,l=parseInt(t[8],10);l=l>=0&&l<=23?l:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,c===`-`?(a+=l,o+=u):c===`+`&&(a-=l,o-=u),new Date(Date.UTC(n,r,i,a,o,s))}};function fi(e,{scale:t=1,rotation:n=0}){let{width:r,height:i}=e.attributes.style;return new ei({viewBox:[0,0,parseInt(r),parseInt(i)],userUnit:1,scale:t,rotation:n})}function pi(e){if(e.startsWith(`#`)){let t=parseInt(e.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return e.startsWith(`rgb(`)?e.slice(4,-1).split(`,`).map(e=>parseInt(e)):e.startsWith(`rgba(`)?e.slice(5,-1).split(`,`).map(e=>parseInt(e)).slice(0,3):(vr(`Not a valid color format: "${e}"`),[0,0,0])}function mi(e){let t=document.createElement(`span`);t.style.visibility=`hidden`,t.style.colorScheme=`only light`,document.body.append(t);for(let n of e.keys()){t.style.color=n;let r=window.getComputedStyle(t).color;e.set(n,pi(r))}t.remove()}function hi(e){let{a:t,b:n,c:r,d:i,e:a,f:o}=e.getTransform();return[t,n,r,i,a,o]}function gi(e){let{a:t,b:n,c:r,d:i,e:a,f:o}=e.getTransform().invertSelf();return[t,n,r,i,a,o]}function _i(e,t,n=!1,r=!0){if(t instanceof ei){let{pageWidth:r,pageHeight:i}=t.rawDims,{style:a}=e,o=Lr.isCSSRoundSupported,s=`var(--total-scale-factor) * ${r}px`,c=`var(--total-scale-factor) * ${i}px`,l=o?`round(down, ${s}, var(--scale-round-x))`:`calc(${s})`,u=o?`round(down, ${c}, var(--scale-round-y))`:`calc(${c})`;!n||t.rotation%180==0?(a.width=l,a.height=u):(a.width=u,a.height=l)}r&&e.setAttribute(`data-main-rotation`,t.rotation)}var vi=class e{constructor(){let{pixelRatio:t}=e;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,n,r,i,a=-1){let o=1/0,s=1/0,c=1/0;r=e.capPixels(r,a),r>0&&(o=Math.sqrt(r/(t*n))),i!==-1&&(s=i/t,c=i/n);let l=Math.min(o,s,c);return this.sx>l||this.sy>l?(this.sx=l,this.sy=l,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){let n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}},yi=[`image/apng`,`image/avif`,`image/bmp`,`image/gif`,`image/jpeg`,`image/png`,`image/svg+xml`,`image/webp`,`image/x-icon`],bi=class{static get isDarkMode(){return wr(this,`isDarkMode`,!!window?.matchMedia?.(`(prefers-color-scheme: dark)`).matches)}},xi=class{static get commentForegroundColor(){let e=document.createElement(`span`);e.classList.add(`comment`,`sidebar`);let{style:t}=e;t.width=t.height=`0`,t.display=`none`,t.color=`var(--comment-fg-color)`,document.body.append(e);let{color:n}=window.getComputedStyle(e);return e.remove(),wr(this,`commentForegroundColor`,pi(n))}};function Si(e,t,n,r){r=Math.min(Math.max(r??1,0),1);let i=255*(1-r);return e=Math.round(e*r+i),t=Math.round(t*r+i),n=Math.round(n*r+i),[e,t,n]}function Ci(e,t){let n=e[0]/255,r=e[1]/255,i=e[2]/255,a=Math.max(n,r,i),o=Math.min(n,r,i),s=(a+o)/2;if(a===o)t[0]=t[1]=0;else{let e=a-o;switch(t[1]=s<.5?e/(a+o):e/(2-a-o),a){case n:t[0]=((r-i)/e+(r<i?6:0))*60;break;case r:t[0]=((i-n)/e+2)*60;break;case i:t[0]=((n-r)/e+4)*60;break}}t[2]=s}function wi(e,t){let n=e[0],r=e[1],i=e[2],a=(1-Math.abs(2*i-1))*r,o=a*(1-Math.abs(n/60%2-1)),s=i-a/2;switch(Math.floor(n/60)){case 0:t[0]=a+s,t[1]=o+s,t[2]=s;break;case 1:t[0]=o+s,t[1]=a+s,t[2]=s;break;case 2:t[0]=s,t[1]=a+s,t[2]=o+s;break;case 3:t[0]=s,t[1]=o+s,t[2]=a+s;break;case 4:t[0]=o+s,t[1]=s,t[2]=a+s;break;case 5:case 6:t[0]=a+s,t[1]=s,t[2]=o+s;break}}function Ti(e){return e<=.03928?e/12.92:((e+.055)/1.055)**2.4}function Ei(e,t,n){wi(e,n),n.map(Ti);let r=.2126*n[0]+.7152*n[1]+.0722*n[2];wi(t,n),n.map(Ti);let i=.2126*n[0]+.7152*n[1]+.0722*n[2];return r>i?(r+.05)/(i+.05):(i+.05)/(r+.05)}var Di=new Map;function Oi(e,t){let n=e[0]+e[1]*256+e[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776,r=Di.get(n);if(r)return r;let i=new Float32Array(9),a=i.subarray(0,3),o=i.subarray(3,6);Ci(e,o);let s=i.subarray(6,9);Ci(t,s);let c=s[2]<.5,l=c?12:4.5;if(o[2]=c?Math.sqrt(o[2]):1-Math.sqrt(1-o[2]),Ei(o,s,a)<l){let e,t;for(c?(e=o[2],t=1):(e=0,t=o[2]);t-e>.005;){let n=o[2]=(e+t)/2;c===Ei(o,s,a)<l?e=n:t=n}o[2]=c?t:e}return wi(o,a),r=Z.makeHexColor(Math.round(a[0]*255),Math.round(a[1]*255),Math.round(a[2]*255)),Di.set(n,r),r}function ki({html:e,dir:t,className:n},r){let i=document.createDocumentFragment();if(typeof e==`string`){let n=document.createElement(`p`);n.dir=t||`auto`;let r=e.split(/(?:\r\n?|\n)/);for(let e=0,t=r.length;e<t;++e){let i=r[e];n.append(document.createTextNode(i)),e<t-1&&n.append(document.createElement(`br`))}i.append(n)}else Xr.render({xfaHtml:e,div:i,intent:`richText`});i.firstChild.classList.add(`richText`,n),r.append(i)}var Ai=class e{#toolbar=null;#colorPicker=null;#editor;#buttons=null;#altText=null;#comment=null;#commentButtonDivider=null;#signatureDescriptionButton=null;static#l10nRemove=null;constructor(t){this.#editor=t,e.#l10nRemove||=Object.freeze({freetext:`pdfjs-editor-remove-freetext-button`,highlight:`pdfjs-editor-remove-highlight-button`,ink:`pdfjs-editor-remove-ink-button`,stamp:`pdfjs-editor-remove-stamp-button`,signature:`pdfjs-editor-remove-signature-button`})}render(){let t=this.#toolbar=document.createElement(`div`);t.classList.add(`editToolbar`,`hidden`),t.setAttribute(`role`,`toolbar`);let n=this.#editor._uiManager._signal;n instanceof AbortSignal&&!n.aborted&&(t.addEventListener(`contextmenu`,ci,{signal:n}),t.addEventListener(`pointerdown`,e.#pointerDown,{signal:n}));let r=this.#buttons=document.createElement(`div`);r.className=`buttons`,t.append(r);let i=this.#editor.toolbarPosition;if(i){let{style:e}=t;e.insetInlineEnd=`${100*(this.#editor._uiManager.direction===`ltr`?1-i[0]:i[0])}%`,e.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#toolbar}static#pointerDown(e){e.stopPropagation()}#focusIn(e){this.#editor._focusEventsAllowed=!1,li(e)}#focusOut(e){this.#editor._focusEventsAllowed=!0,li(e)}#addListenersToElement(e){let t=this.#editor._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener(`focusin`,this.#focusIn.bind(this),{capture:!0,signal:t}),e.addEventListener(`focusout`,this.#focusOut.bind(this),{capture:!0,signal:t}),e.addEventListener(`contextmenu`,ci,{signal:t}),!0)}hide(){this.#toolbar.classList.add(`hidden`),this.#colorPicker?.hideDropdown()}show(){this.#toolbar.classList.remove(`hidden`),this.#altText?.shown(),this.#comment?.shown()}addDeleteButton(){let{editorType:t,_uiManager:n}=this.#editor,r=document.createElement(`button`);r.classList.add(`basic`,`deleteButton`),r.tabIndex=0,r.setAttribute(`data-l10n-id`,e.#l10nRemove[t]),this.#addListenersToElement(r)&&r.addEventListener(`click`,e=>{n.delete()},{signal:n._signal}),this.#buttons.append(r)}get#divider(){let e=document.createElement(`div`);return e.className=`divider`,e}async addAltText(e){let t=await e.render();this.#addListenersToElement(t),this.#buttons.append(t,this.#divider),this.#altText=e}addComment(e,t=null){if(this.#comment)return;let n=e.renderForToolbar();if(!n)return;this.#addListenersToElement(n);let r=this.#commentButtonDivider=this.#divider;t?(this.#buttons.insertBefore(n,t),this.#buttons.insertBefore(r,t)):this.#buttons.append(n,r),this.#comment=e,e.toolbar=this}addColorPicker(e){if(this.#colorPicker)return;this.#colorPicker=e;let t=e.renderButton();this.#addListenersToElement(t),this.#buttons.append(t,this.#divider)}async addEditSignatureButton(e){let t=this.#signatureDescriptionButton=await e.renderEditButton(this.#editor);this.#addListenersToElement(t),this.#buttons.append(t,this.#divider)}removeButton(e){switch(e){case`comment`:this.#comment?.removeToolbarCommentButton(),this.#comment=null,this.#commentButtonDivider?.remove(),this.#commentButtonDivider=null;break}}async addButton(e,t){switch(e){case`colorPicker`:this.addColorPicker(t);break;case`altText`:await this.addAltText(t);break;case`editSignature`:await this.addEditSignatureButton(t);break;case`delete`:this.addDeleteButton();break;case`comment`:this.addComment(t);break}}async addButtonBefore(e,t,n){let r=this.#buttons.querySelector(n);r&&e===`comment`&&this.addComment(t,r)}updateEditSignatureButton(e){this.#signatureDescriptionButton&&(this.#signatureDescriptionButton.title=e)}remove(){this.#toolbar.remove(),this.#colorPicker?.destroy(),this.#colorPicker=null}},ji=class{#buttons=null;#toolbar=null;#uiManager;constructor(e){this.#uiManager=e}#render(){let e=this.#toolbar=document.createElement(`div`);e.className=`editToolbar`,e.setAttribute(`role`,`toolbar`);let t=this.#uiManager._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener(`contextmenu`,ci,{signal:t});let n=this.#buttons=document.createElement(`div`);return n.className=`buttons`,e.append(n),this.#uiManager.hasCommentManager()&&this.#makeButton(`commentButton`,`pdfjs-comment-floating-button`,`pdfjs-comment-floating-button-label`,()=>{this.#uiManager.commentSelection(`floating_button`)}),this.#makeButton(`highlightButton`,`pdfjs-highlight-floating-button1`,`pdfjs-highlight-floating-button-label`,()=>{this.#uiManager.highlightSelection(`floating_button`)}),e}#getLastPoint(e,t){let n=0,r=0;for(let i of e){let e=i.y+i.height;if(e<n)continue;let a=i.x+(t?i.width:0);if(e>n){r=a,n=e;continue}t?a>r&&(r=a):a<r&&(r=a)}return[t?1-r:r,n]}show(e,t,n){let[r,i]=this.#getLastPoint(t,n),{style:a}=this.#toolbar||=this.#render();e.append(this.#toolbar),a.insetInlineEnd=`${100*r}%`,a.top=`calc(${100*i}% + var(--editor-toolbar-vert-offset))`}hide(){this.#toolbar.remove()}#makeButton(e,t,n,r){let i=document.createElement(`button`);i.classList.add(`basic`,e),i.tabIndex=0,i.setAttribute(`data-l10n-id`,t);let a=document.createElement(`span`);i.append(a),a.className=`visuallyHidden`,a.setAttribute(`data-l10n-id`,n);let o=this.#uiManager._signal;o instanceof AbortSignal&&!o.aborted&&(i.addEventListener(`contextmenu`,ci,{signal:o}),i.addEventListener(`click`,r,{signal:o})),this.#buttons.append(i)}};function Mi(e,t,n){for(let r of n)t.addEventListener(r,e[r].bind(e))}var Ni=class{#id=0;get id(){return`${nr}${this.#id++}`}},Pi=class e{#baseId=Ur();#id=0;#cache=null;static get _isSVGFittingCanvas(){let e=new OffscreenCanvas(1,3).getContext(`2d`,{willReadFrequently:!0}),t=new Image;t.src=`data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>`;let n=t.decode().then(()=>(e.drawImage(t,0,0,1,1,0,0,1,3),new Uint32Array(e.getImageData(0,0,1,1).data.buffer)[0]===0));return wr(this,`_isSVGFittingCanvas`,n)}async#get(t,n){this.#cache||=new Map;let r=this.#cache.get(t);if(r===null)return null;if(r?.bitmap)return r.refCounter+=1,r;try{r||={bitmap:null,id:`image_${this.#baseId}_${this.#id++}`,refCounter:0,isSvg:!1};let t;if(typeof n==`string`?(r.url=n,t=await $r(n,`blob`)):n instanceof File?t=r.file=n:n instanceof Blob&&(t=n),t.type===`image/svg+xml`){let n=e._isSVGFittingCanvas,i=new FileReader,a=new Image,o=new Promise((e,t)=>{a.onload=()=>{r.bitmap=a,r.isSvg=!0,e()},i.onload=async()=>{let e=r.svgUrl=i.result;a.src=await n?`${e}#svgView(preserveAspectRatio(none))`:e},a.onerror=i.onerror=t});i.readAsDataURL(t),await o}else r.bitmap=await createImageBitmap(t);r.refCounter=1}catch(e){vr(e),r=null}return this.#cache.set(t,r),r&&this.#cache.set(r.id,r),r}async getFromFile(e){let{lastModified:t,name:n,size:r,type:i}=e;return this.#get(`${t}_${n}_${r}_${i}`,e)}async getFromUrl(e){return this.#get(e,e)}async getFromBlob(e,t){let n=await t;return this.#get(e,n)}async getFromId(e){this.#cache||=new Map;let t=this.#cache.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){let{blobPromise:e}=t;return delete t.blobPromise,this.getFromBlob(t.id,e)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#cache||=new Map;let n=this.#cache.get(e);if(n?.bitmap)return n.refCounter+=1,n;let r=new OffscreenCanvas(t.width,t.height);return r.getContext(`2d`).drawImage(t,0,0),n={bitmap:r.transferToImageBitmap(),id:`image_${this.#baseId}_${this.#id++}`,refCounter:1,isSvg:!1},this.#cache.set(e,n),this.#cache.set(n.id,n),n}getSvgUrl(e){let t=this.#cache.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#cache||=new Map;let t=this.#cache.get(e);if(!t||(--t.refCounter,t.refCounter!==0))return;let{bitmap:n}=t;if(!t.url&&!t.file){let e=new OffscreenCanvas(n.width,n.height);e.getContext(`bitmaprenderer`).transferFromImageBitmap(n),t.blobPromise=e.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#baseId}_`)}},Fi=class{#commands=[];#locked=!1;#maxSize;#position=-1;constructor(e=128){this.#maxSize=e}add({cmd:e,undo:t,post:n,mustExec:r,type:i=NaN,overwriteIfSameType:a=!1,keepUndo:o=!1}){if(r&&e(),this.#locked)return;let s={cmd:e,undo:t,post:n,type:i};if(this.#position===-1){this.#commands.length>0&&(this.#commands.length=0),this.#position=0,this.#commands.push(s);return}if(a&&this.#commands[this.#position].type===i){o&&(s.undo=this.#commands[this.#position].undo),this.#commands[this.#position]=s;return}let c=this.#position+1;c===this.#maxSize?this.#commands.splice(0,1):(this.#position=c,c<this.#commands.length&&this.#commands.splice(c)),this.#commands.push(s)}undo(){if(this.#position===-1)return;this.#locked=!0;let{undo:e,post:t}=this.#commands[this.#position];e(),t?.(),this.#locked=!1,--this.#position}redo(){if(this.#position<this.#commands.length-1){this.#position+=1,this.#locked=!0;let{cmd:e,post:t}=this.#commands[this.#position];e(),t?.(),this.#locked=!1}}hasSomethingToUndo(){return this.#position!==-1}hasSomethingToRedo(){return this.#position<this.#commands.length-1}cleanType(e){if(this.#position!==-1){for(let t=this.#position;t>=0;t--)if(this.#commands[t].type!==e){this.#commands.splice(t+1,this.#position-t),this.#position=t;return}this.#commands.length=0,this.#position=-1}}destroy(){this.#commands=null}},Ii=class{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;let{isMac:t}=Lr.platform;for(let[n,r,i={}]of e)for(let e of n){let n=e.startsWith(`mac+`);t&&n?(this.callbacks.set(e.slice(4),{callback:r,options:i}),this.allKeys.add(e.split(`+`).at(-1))):!t&&!n&&(this.callbacks.set(e,{callback:r,options:i}),this.allKeys.add(e.split(`+`).at(-1)))}}#serialize(e){e.altKey&&this.buffer.push(`alt`),e.ctrlKey&&this.buffer.push(`ctrl`),e.metaKey&&this.buffer.push(`meta`),e.shiftKey&&this.buffer.push(`shift`),this.buffer.push(e.key);let t=this.buffer.join(`+`);return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;let n=this.callbacks.get(this.#serialize(t));if(!n)return;let{callback:r,options:{bubbles:i=!1,args:a=[],checker:o=null}}=n;o&&!o(e,t)||(r.bind(e,...a,t)(),i||li(t))}},Li=class e{static _colorsMapping=new Map([[`CanvasText`,[0,0,0]],[`Canvas`,[255,255,255]]]);get _colors(){let e=new Map([[`CanvasText`,null],[`Canvas`,null]]);return mi(e),wr(this,`_colors`,e)}convert(t){let n=pi(t);if(!window.matchMedia(`(forced-colors: active)`).matches)return n;for(let[t,r]of this._colors)if(r.every((e,t)=>e===n[t]))return e._colorsMapping.get(t);return n}getHexCode(e){let t=this._colors.get(e);return t?Z.makeHexColor(...t):e}},Ri=class e{#abortController=new AbortController;#activeEditor=null;#allEditableAnnotations=null;#allEditors=new Map;#allLayers=new Map;#altTextManager=null;#annotationStorage=null;#changedExistingAnnotations=null;#commandManager=new Fi;#commentManager=null;#copyPasteAC=null;#currentDrawingSession=null;#currentPageIndex=0;#deletedAnnotationsElementIds=new Set;#draggingEditors=null;#editorTypes=null;#editorsToRescale=new Set;_editorUndoBar=null;#enableHighlightFloatingButton=!1;#enableUpdatedAddImage=!1;#enableNewAltTextWhenAddingImage=!1;#filterFactory=null;#focusMainContainerTimeoutId=null;#focusManagerAC=null;#highlightColors=null;#highlightWhenShiftUp=!1;#floatingToolbar=null;#idManager=new Ni;#isEnabled=!1;#isPointerDown=!1;#isWaiting=!1;#keyboardManagerAC=null;#lastActiveElement=null;#mainHighlightColorPicker=null;#missingCanvases=null;#mlManager=null;#mode=rr.NONE;#selectedEditors=new Set;#selectedTextNode=null;#signatureManager=null;#pageColors=null;#showAllStates=null;#pdfDocument=null;#previousStates={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#translation=[0,0];#translationTimeoutId=null;#container=null;#viewer=null;#viewerAlert=null;#updateModeCapability=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){let t=e.prototype,n=e=>e.#container.contains(document.activeElement)&&document.activeElement.tagName!==`BUTTON`&&e.hasSomethingToControl(),r=(e,{target:t})=>{if(t instanceof HTMLInputElement){let{type:e}=t;return e!==`text`&&e!==`number`}return!0},i=this.TRANSLATE_SMALL,a=this.TRANSLATE_BIG;return wr(this,`_keyboardManager`,new Ii([[[`ctrl+a`,`mac+meta+a`],t.selectAll,{checker:r}],[[`ctrl+z`,`mac+meta+z`],t.undo,{checker:r}],[[`ctrl+y`,`ctrl+shift+z`,`mac+meta+shift+z`,`ctrl+shift+Z`,`mac+meta+shift+Z`],t.redo,{checker:r}],[[`Backspace`,`alt+Backspace`,`ctrl+Backspace`,`shift+Backspace`,`mac+Backspace`,`mac+alt+Backspace`,`mac+ctrl+Backspace`,`Delete`,`ctrl+Delete`,`shift+Delete`,`mac+Delete`],t.delete,{checker:r}],[[`Enter`,`mac+Enter`],t.addNewEditorFromKeyboard,{checker:(e,{target:t})=>!(t instanceof HTMLButtonElement)&&e.#container.contains(t)&&!e.isEnterHandled}],[[` `,`mac+ `],t.addNewEditorFromKeyboard,{checker:(e,{target:t})=>!(t instanceof HTMLButtonElement)&&e.#container.contains(document.activeElement)}],[[`Escape`,`mac+Escape`],t.unselectAll],[[`ArrowLeft`,`mac+ArrowLeft`],t.translateSelectedEditors,{args:[-i,0],checker:n}],[[`ctrl+ArrowLeft`,`mac+shift+ArrowLeft`],t.translateSelectedEditors,{args:[-a,0],checker:n}],[[`ArrowRight`,`mac+ArrowRight`],t.translateSelectedEditors,{args:[i,0],checker:n}],[[`ctrl+ArrowRight`,`mac+shift+ArrowRight`],t.translateSelectedEditors,{args:[a,0],checker:n}],[[`ArrowUp`,`mac+ArrowUp`],t.translateSelectedEditors,{args:[0,-i],checker:n}],[[`ctrl+ArrowUp`,`mac+shift+ArrowUp`],t.translateSelectedEditors,{args:[0,-a],checker:n}],[[`ArrowDown`,`mac+ArrowDown`],t.translateSelectedEditors,{args:[0,i],checker:n}],[[`ctrl+ArrowDown`,`mac+shift+ArrowDown`],t.translateSelectedEditors,{args:[0,a],checker:n}]]))}constructor(e,t,n,r,i,a,o,s,c,l,u,d,f,p,m,h){let g=this._signal=this.#abortController.signal;this.#container=e,this.#viewer=t,this.#viewerAlert=n,this.#altTextManager=r,this.#commentManager=i,this.#signatureManager=a,this.#pdfDocument=s,this._eventBus=o,o._on(`editingaction`,this.onEditingAction.bind(this),{signal:g}),o._on(`pagechanging`,this.onPageChanging.bind(this),{signal:g}),o._on(`scalechanging`,this.onScaleChanging.bind(this),{signal:g}),o._on(`rotationchanging`,this.onRotationChanging.bind(this),{signal:g}),o._on(`setpreference`,this.onSetPreference.bind(this),{signal:g}),o._on(`switchannotationeditorparams`,e=>this.updateParams(e.type,e.value),{signal:g}),window.addEventListener(`pointerdown`,()=>{this.#isPointerDown=!0},{capture:!0,signal:g}),window.addEventListener(`pointerup`,()=>{this.#isPointerDown=!1},{capture:!0,signal:g}),this.#addSelectionListener(),this.#addDragAndDropListeners(),this.#addKeyboardManager(),this.#annotationStorage=s.annotationStorage,this.#filterFactory=s.filterFactory,this.#pageColors=c,this.#highlightColors=l||null,this.#enableHighlightFloatingButton=u,this.#enableUpdatedAddImage=d,this.#enableNewAltTextWhenAddingImage=f,this.#mlManager=p||null,this.viewParameters={realScale:Qr.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=m||null,this._supportsPinchToZoom=h!==!1,i?.setSidebarUiManager(this)}destroy(){this.#updateModeCapability?.resolve(),this.#updateModeCapability=null,this.#abortController?.abort(),this.#abortController=null,this._signal=null;for(let e of this.#allLayers.values())e.destroy();this.#allLayers.clear(),this.#allEditors.clear(),this.#editorsToRescale.clear(),this.#missingCanvases?.clear(),this.#activeEditor=null,this.#selectedEditors.clear(),this.#commandManager.destroy(),this.#altTextManager?.destroy(),this.#commentManager?.destroy(),this.#signatureManager?.destroy(),this.#floatingToolbar?.hide(),this.#floatingToolbar=null,this.#mainHighlightColorPicker?.destroy(),this.#mainHighlightColorPicker=null,this.#allEditableAnnotations=null,this.#focusMainContainerTimeoutId&&=(clearTimeout(this.#focusMainContainerTimeoutId),null),this.#translationTimeoutId&&=(clearTimeout(this.#translationTimeoutId),null),this._editorUndoBar?.destroy(),this.#pdfDocument=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#mlManager}get useNewAltTextFlow(){return this.#enableUpdatedAddImage}get useNewAltTextWhenAddingImage(){return this.#enableNewAltTextWhenAddingImage}get hcmFilter(){return wr(this,`hcmFilter`,this.#pageColors?this.#filterFactory.addHCMFilter(this.#pageColors.foreground,this.#pageColors.background):`none`)}get direction(){return wr(this,`direction`,getComputedStyle(this.#container).direction)}get _highlightColors(){return wr(this,`_highlightColors`,this.#highlightColors?new Map(this.#highlightColors.split(`,`).map(e=>(e=e.split(`=`).map(e=>e.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){let{_highlightColors:e}=this;if(!e)return wr(this,`highlightColors`,null);let t=new Map,n=!!this.#pageColors;for(let[r,i]of e){let e=r.endsWith(`_HCM`);if(n&&e){t.set(r.replace(`_HCM`,``),i);continue}!n&&!e&&t.set(r,i)}return wr(this,`highlightColors`,t)}get highlightColorNames(){return wr(this,`highlightColorNames`,this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;let t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#currentDrawingSession=e}setMainHighlightColorPicker(e){this.#mainHighlightColorPicker=e}editAltText(e,t=!1){this.#altTextManager?.editAltText(this,e,t)}hasCommentManager(){return!!this.#commentManager}editComment(e,t,n,r){this.#commentManager?.showDialog(this,e,t,n,r)}selectComment(e,t){(this.#allLayers.get(e)?.getEditorByUID(t))?.toggleComment(!0,!0)}updateComment(e){this.#commentManager?.updateComment(e.getData())}updatePopupColor(e){this.#commentManager?.updatePopupColor(e)}removeComment(e){this.#commentManager?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#commentManager?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#commentManager?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#commentManager?.dialogElement||null}async waitForEditorsRendered(e){if(this.#allLayers.has(e-1))return;let{resolve:t,promise:n}=Promise.withResolvers(),r=n=>{n.pageNumber===e&&(this._eventBus._off(`editorsrendered`,r),t())};this._eventBus.on(`editorsrendered`,r),await n}getSignature(e){this.#signatureManager?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#signatureManager}switchToMode(e,t){this._eventBus.on(`annotationeditormodechanged`,t,{once:!0,signal:this._signal}),this._eventBus.dispatch(`showannotationeditorui`,{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch(`setpreference`,{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case`enableNewAltTextWhenAddingImage`:this.#enableNewAltTextWhenAddingImage=t;break}}onPageChanging({pageNumber:e}){this.#currentPageIndex=e-1}focusMainContainer(){this.#container.focus()}findParent(e,t){for(let n of this.#allLayers.values()){let{x:r,y:i,width:a,height:o}=n.div.getBoundingClientRect();if(e>=r&&e<=r+a&&t>=i&&t<=i+o)return n}return null}disableUserSelect(e=!1){this.#viewer.classList.toggle(`noUserSelect`,e)}addShouldRescale(e){this.#editorsToRescale.add(e)}removeShouldRescale(e){this.#editorsToRescale.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*Qr.PDF_TO_CSS_UNITS;for(let e of this.#editorsToRescale)e.onScaleChanging();this.#currentDrawingSession?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#getAnchorElementForSelection({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#getLayerForTextLayer(e){let{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(let t of this.#allLayers.values())if(t.hasTextLayer(e))return t;return null}highlightSelection(e=``,t=!1){let n=document.getSelection();if(!n||n.isCollapsed)return;let{anchorNode:r,anchorOffset:i,focusNode:a,focusOffset:o}=n,s=n.toString(),c=this.#getAnchorElementForSelection(n).closest(`.textLayer`),l=this.getSelectionBoxes(c);if(!l)return;n.empty();let u=this.#getLayerForTextLayer(c),d=this.#mode===rr.NONE,f=()=>{let n=u?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:l,anchorNode:r,anchorOffset:i,focusNode:a,focusOffset:o,text:s});d&&this.showAllEditors(`highlight`,!0,!0),t&&n?.editComment()};if(d){this.switchToMode(rr.HIGHLIGHT,f);return}f()}commentSelection(e=``){this.highlightSelection(e,!0)}#displayFloatingToolbar(){let e=document.getSelection();if(!e||e.isCollapsed)return;let t=this.#getAnchorElementForSelection(e).closest(`.textLayer`),n=this.getSelectionBoxes(t);n&&(this.#floatingToolbar||=new ji(this),this.#floatingToolbar.show(t,n,this.direction===`ltr`))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#annotationStorage)return null;let t=`${nr}${e}`,n=this.#annotationStorage.getRawValue(t);return n&&this.#annotationStorage.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#annotationStorage&&!this.#annotationStorage.has(e.id)&&this.#annotationStorage.setValue(e.id,e)}a11yAlert(e,t=null){let n=this.#viewerAlert;n&&(n.setAttribute(`data-l10n-id`,e),t?n.setAttribute(`data-l10n-args`,JSON.stringify(t)):n.removeAttribute(`data-l10n-args`))}#selectionChange(){let e=document.getSelection();if(!e||e.isCollapsed){this.#selectedTextNode&&(this.#floatingToolbar?.hide(),this.#selectedTextNode=null,this.#dispatchUpdateStates({hasSelectedText:!1}));return}let{anchorNode:t}=e;if(t===this.#selectedTextNode)return;let n=this.#getAnchorElementForSelection(e).closest(`.textLayer`);if(!n){this.#selectedTextNode&&(this.#floatingToolbar?.hide(),this.#selectedTextNode=null,this.#dispatchUpdateStates({hasSelectedText:!1}));return}if(this.#floatingToolbar?.hide(),this.#selectedTextNode=t,this.#dispatchUpdateStates({hasSelectedText:!0}),!(this.#mode!==rr.HIGHLIGHT&&this.#mode!==rr.NONE)&&(this.#mode===rr.HIGHLIGHT&&this.showAllEditors(`highlight`,!0,!0),this.#highlightWhenShiftUp=this.isShiftKeyDown,!this.isShiftKeyDown)){let e=this.#mode===rr.HIGHLIGHT?this.#getLayerForTextLayer(n):null;if(e?.toggleDrawing(),this.#isPointerDown){let t=new AbortController,n=this.combinedSignal(t),r=n=>{n.type===`pointerup`&&n.button!==0||(t.abort(),e?.toggleDrawing(!0),n.type===`pointerup`&&this.#onSelectEnd(`main_toolbar`))};window.addEventListener(`pointerup`,r,{signal:n}),window.addEventListener(`blur`,r,{signal:n})}else e?.toggleDrawing(!0),this.#onSelectEnd(`main_toolbar`)}}#onSelectEnd(e=``){this.#mode===rr.HIGHLIGHT?this.highlightSelection(e):this.#enableHighlightFloatingButton&&this.#displayFloatingToolbar()}#addSelectionListener(){document.addEventListener(`selectionchange`,this.#selectionChange.bind(this),{signal:this._signal})}#addFocusManager(){if(this.#focusManagerAC)return;this.#focusManagerAC=new AbortController;let e=this.combinedSignal(this.#focusManagerAC);window.addEventListener(`focus`,this.focus.bind(this),{signal:e}),window.addEventListener(`blur`,this.blur.bind(this),{signal:e})}#removeFocusManager(){this.#focusManagerAC?.abort(),this.#focusManagerAC=null}blur(){if(this.isShiftKeyDown=!1,this.#highlightWhenShiftUp&&(this.#highlightWhenShiftUp=!1,this.#onSelectEnd(`main_toolbar`)),!this.hasSelection)return;let{activeElement:e}=document;for(let t of this.#selectedEditors)if(t.div.contains(e)){this.#lastActiveElement=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#lastActiveElement)return;let[e,t]=this.#lastActiveElement;this.#lastActiveElement=null,t.addEventListener(`focusin`,()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#addKeyboardManager(){if(this.#keyboardManagerAC)return;this.#keyboardManagerAC=new AbortController;let e=this.combinedSignal(this.#keyboardManagerAC);window.addEventListener(`keydown`,this.keydown.bind(this),{signal:e}),window.addEventListener(`keyup`,this.keyup.bind(this),{signal:e})}#removeKeyboardManager(){this.#keyboardManagerAC?.abort(),this.#keyboardManagerAC=null}#addCopyPasteListeners(){if(this.#copyPasteAC)return;this.#copyPasteAC=new AbortController;let e=this.combinedSignal(this.#copyPasteAC);document.addEventListener(`copy`,this.copy.bind(this),{signal:e}),document.addEventListener(`cut`,this.cut.bind(this),{signal:e}),document.addEventListener(`paste`,this.paste.bind(this),{signal:e})}#removeCopyPasteListeners(){this.#copyPasteAC?.abort(),this.#copyPasteAC=null}#addDragAndDropListeners(){let e=this._signal;document.addEventListener(`dragover`,this.dragOver.bind(this),{signal:e}),document.addEventListener(`drop`,this.drop.bind(this),{signal:e})}addEditListeners(){this.#addKeyboardManager(),this.#addCopyPasteListeners()}removeEditListeners(){this.#removeKeyboardManager(),this.#removeCopyPasteListeners()}dragOver(e){for(let{type:t}of e.dataTransfer.items)for(let n of this.#editorTypes)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect=`copy`,e.preventDefault();return}}drop(e){for(let t of e.dataTransfer.items)for(let n of this.#editorTypes)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#activeEditor?.commitOrRemove(),!this.hasSelection)return;let t=[];for(let e of this.#selectedEditors){let n=e.serialize(!0);n&&t.push(n)}t.length!==0&&e.clipboardData.setData(`application/pdfjs`,JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();let{clipboardData:t}=e;for(let e of t.items)for(let t of this.#editorTypes)if(t.isHandlingMimeForPasting(e.type)){t.paste(e,this.currentLayer);return}let n=t.getData(`application/pdfjs`);if(!n)return;try{n=JSON.parse(n)}catch(e){vr(`paste: "${e.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();let r=this.currentLayer;try{let e=[];for(let t of n){let n=await r.deserialize(t);if(!n)return;e.push(n)}this.addCommands({cmd:()=>{for(let t of e)this.#addEditorToLayer(t);this.#selectEditors(e)},undo:()=>{for(let t of e)t.remove()},mustExec:!0})}catch(e){vr(`paste: "${e.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key===`Shift`&&(this.isShiftKeyDown=!0),this.#mode!==rr.NONE&&!this.isEditorHandlingKeyboard&&e._keyboardManager.exec(this,t)}keyup(e){this.isShiftKeyDown&&e.key===`Shift`&&(this.isShiftKeyDown=!1,this.#highlightWhenShiftUp&&(this.#highlightWhenShiftUp=!1,this.#onSelectEnd(`main_toolbar`)))}onEditingAction({name:e}){switch(e){case`undo`:case`redo`:case`delete`:case`selectAll`:this[e]();break;case`highlightSelection`:this.highlightSelection(`context_menu`);break;case`commentSelection`:this.commentSelection(`context_menu`);break}}#dispatchUpdateStates(e){Object.entries(e).some(([e,t])=>this.#previousStates[e]!==t)&&(this._eventBus.dispatch(`annotationeditorstateschanged`,{source:this,details:Object.assign(this.#previousStates,e)}),this.#mode===rr.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#dispatchUpdateUI([[ir.HIGHLIGHT_FREE,!0]]))}#dispatchUpdateUI(e){this._eventBus.dispatch(`annotationeditorparamschanged`,{source:this,details:e})}setEditingState(e){e?(this.#addFocusManager(),this.#addCopyPasteListeners(),this.#dispatchUpdateStates({isEditing:this.#mode!==rr.NONE,isEmpty:this.#isEmpty(),hasSomethingToUndo:this.#commandManager.hasSomethingToUndo(),hasSomethingToRedo:this.#commandManager.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#removeFocusManager(),this.#removeCopyPasteListeners(),this.#dispatchUpdateStates({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#editorTypes){this.#editorTypes=e;for(let e of this.#editorTypes)this.#dispatchUpdateUI(e.defaultPropertiesToUpdate)}}getId(){return this.#idManager.id}get currentLayer(){return this.#allLayers.get(this.#currentPageIndex)}getLayer(e){return this.#allLayers.get(e)}get currentPageIndex(){return this.#currentPageIndex}addLayer(e){this.#allLayers.set(e.pageIndex,e),this.#isEnabled?e.enable():e.disable()}removeLayer(e){this.#allLayers.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,r=!1,i=!1){if(this.#mode!==e&&!(this.#updateModeCapability&&(await this.#updateModeCapability.promise,!this.#updateModeCapability))){if(this.#updateModeCapability=Promise.withResolvers(),this.#currentDrawingSession?.commitOrRemove(),this.#mode===rr.POPUP&&this.#commentManager?.hideSidebar(),this.#commentManager?.destroyPopup(),this.#mode=e,e===rr.NONE){this.setEditingState(!1),this.#disableAll();for(let e of this.#allEditors.values())e.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#updateModeCapability.resolve();return}for(let e of this.#allEditors.values())e.addStandaloneCommentButton();e===rr.SIGNATURE&&await this.#signatureManager?.loadSignatures(),this.setEditingState(!0),await this.#enableAll(),this.unselectAll();for(let t of this.#allLayers.values())t.updateMode(e);if(e===rr.POPUP){this.#allEditableAnnotations||=await this.#pdfDocument.getAnnotationsByType(new Set(this.#editorTypes.map(e=>e._editorType)));let e=new Set,t=[];for(let n of this.#allEditors.values()){let{annotationElementId:r,hasComment:i,deleted:a}=n;r&&e.add(r),i&&!a&&t.push(n.getData())}for(let n of this.#allEditableAnnotations){let{id:r,popupRef:i,contentsObj:a}=n;i&&a?.str&&!e.has(r)&&!this.#deletedAnnotationsElementIds.has(r)&&t.push(n)}this.#commentManager?.showSidebar(t)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#updateModeCapability.resolve();return}for(let e of this.#allEditors.values())e.uid===t?(this.setSelected(e),i?e.editComment():r?e.enterInEditMode():e.focus()):e.unselect();this.#updateModeCapability.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#mode&&this._eventBus.dispatch(`switchannotationeditormode`,{source:this,...e})}updateParams(e,t){if(this.#editorTypes){switch(e){case ir.CREATE:this.currentLayer.addNewEditor(t);return;case ir.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch(`reporttelemetry`,{source:this,details:{type:`editing`,data:{type:`highlight`,action:`toggle_visibility`}}}),(this.#showAllStates||=new Map).set(e,t),this.showAllEditors(`highlight`,t);break}if(this.hasSelection)for(let n of this.#selectedEditors)n.updateParams(e,t);else for(let n of this.#editorTypes)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(let n of this.#allEditors.values())n.editorType===e&&n.show(t);(this.#showAllStates?.get(ir.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#dispatchUpdateUI([[ir.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#isWaiting!==e){this.#isWaiting=e;for(let t of this.#allLayers.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle(`waiting`,e)}}async#enableAll(){if(!this.#isEnabled){this.#isEnabled=!0;let e=[];for(let t of this.#allLayers.values())e.push(t.enable());await Promise.all(e);for(let e of this.#allEditors.values())e.enable()}}#disableAll(){if(this.unselectAll(),this.#isEnabled){this.#isEnabled=!1;for(let e of this.#allLayers.values())e.disable();for(let e of this.#allEditors.values())e.disable()}}*getEditors(e){for(let t of this.#allEditors.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#allEditors.get(e)}addEditor(e){this.#allEditors.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#focusMainContainerTimeoutId&&clearTimeout(this.#focusMainContainerTimeoutId),this.#focusMainContainerTimeoutId=setTimeout(()=>{this.focusMainContainer(),this.#focusMainContainerTimeoutId=null},0)),this.#allEditors.delete(e.id),e.annotationElementId&&this.#missingCanvases?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#deletedAnnotationsElementIds.has(e.annotationElementId))&&this.#annotationStorage?.remove(e.id)}addDeletedAnnotationElement(e){this.#deletedAnnotationsElementIds.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#deletedAnnotationsElementIds.has(e)}removeDeletedAnnotationElement(e){this.#deletedAnnotationsElementIds.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#addEditorToLayer(e){let t=this.#allLayers.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#activeEditor!==e&&(this.#activeEditor=e,e&&this.#dispatchUpdateUI(e.propertiesToUpdate))}get#lastSelectedEditor(){let e=null;for(e of this.#selectedEditors);return e}updateUI(e){this.#lastSelectedEditor===e&&this.#dispatchUpdateUI(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#dispatchUpdateUI(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#selectedEditors.has(e)){this.#selectedEditors.delete(e),e.unselect(),this.#dispatchUpdateStates({hasSelectedEditor:this.hasSelection});return}this.#selectedEditors.add(e),e.select(),this.#dispatchUpdateUI(e.propertiesToUpdate),this.#dispatchUpdateStates({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#currentDrawingSession?.commitOrRemove();for(let t of this.#selectedEditors)t!==e&&t.unselect();this.#selectedEditors.clear(),this.#selectedEditors.add(e),e.select(),this.#dispatchUpdateUI(e.propertiesToUpdate),this.#dispatchUpdateStates({hasSelectedEditor:!0})}isSelected(e){return this.#selectedEditors.has(e)}get firstSelectedEditor(){return this.#selectedEditors.values().next().value}unselect(e){e.unselect(),this.#selectedEditors.delete(e),this.#dispatchUpdateStates({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#selectedEditors.size!==0}get isEnterHandled(){return this.#selectedEditors.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#commandManager.undo(),this.#dispatchUpdateStates({hasSomethingToUndo:this.#commandManager.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#isEmpty()}),this._editorUndoBar?.hide()}redo(){this.#commandManager.redo(),this.#dispatchUpdateStates({hasSomethingToUndo:!0,hasSomethingToRedo:this.#commandManager.hasSomethingToRedo(),isEmpty:this.#isEmpty()})}addCommands(e){this.#commandManager.add(e),this.#dispatchUpdateStates({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#isEmpty()})}cleanUndoStack(e){this.#commandManager.cleanType(e)}#isEmpty(){if(this.#allEditors.size===0)return!0;if(this.#allEditors.size===1)for(let e of this.#allEditors.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();let e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;let t=e?[e]:[...this.#selectedEditors],n=()=>{this._editorUndoBar?.show(r,t.length===1?t[0].editorType:t.length);for(let e of t)e.remove()},r=()=>{for(let e of t)this.#addEditorToLayer(e)};this.addCommands({cmd:n,undo:r,mustExec:!0})}commitOrRemove(){this.#activeEditor?.commitOrRemove()}hasSomethingToControl(){return this.#activeEditor||this.hasSelection}#selectEditors(e){for(let e of this.#selectedEditors)e.unselect();this.#selectedEditors.clear();for(let t of e)t.isEmpty()||(this.#selectedEditors.add(t),t.select());this.#dispatchUpdateStates({hasSelectedEditor:this.hasSelection})}selectAll(){for(let e of this.#selectedEditors)e.commit();this.#selectEditors(this.#allEditors.values())}unselectAll(){if(!(this.#activeEditor&&(this.#activeEditor.commitOrRemove(),this.#mode!==rr.NONE))&&!this.#currentDrawingSession?.commitOrRemove()&&this.hasSelection){for(let e of this.#selectedEditors)e.unselect();this.#selectedEditors.clear(),this.#dispatchUpdateStates({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#translation[0]+=e,this.#translation[1]+=t;let[r,i]=this.#translation,a=[...this.#selectedEditors];this.#translationTimeoutId&&clearTimeout(this.#translationTimeoutId),this.#translationTimeoutId=setTimeout(()=>{this.#translationTimeoutId=null,this.#translation[0]=this.#translation[1]=0,this.addCommands({cmd:()=>{for(let e of a)this.#allEditors.has(e.id)&&(e.translateInPage(r,i),e.translationDone())},undo:()=>{for(let e of a)this.#allEditors.has(e.id)&&(e.translateInPage(-r,-i),e.translationDone())},mustExec:!1})},1e3);for(let n of a)n.translateInPage(e,t),n.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#draggingEditors=new Map;for(let e of this.#selectedEditors)this.#draggingEditors.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#draggingEditors)return!1;this.disableUserSelect(!1);let e=this.#draggingEditors;this.#draggingEditors=null;let t=!1;for(let[{x:n,y:r,pageIndex:i},a]of e)a.newX=n,a.newY=r,a.newPageIndex=i,t||=n!==a.savedX||r!==a.savedY||i!==a.savedPageIndex;if(!t)return!1;let n=(e,t,n,r)=>{if(this.#allEditors.has(e.id)){let i=this.#allLayers.get(r);i?e._setParentAndPosition(i,t,n):(e.pageIndex=r,e.x=t,e.y=n)}};return this.addCommands({cmd:()=>{for(let[t,{newX:r,newY:i,newPageIndex:a}]of e)n(t,r,i,a)},undo:()=>{for(let[t,{savedX:r,savedY:i,savedPageIndex:a}]of e)n(t,r,i,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#draggingEditors)for(let n of this.#draggingEditors.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){let t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#selectedEditors.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#activeEditor===e}getActive(){return this.#activeEditor}getMode(){return this.#mode}isEditingMode(){return this.#mode!==rr.NONE}get imageManager(){return wr(this,`imageManager`,new Pi)}getSelectionBoxes(e){if(!e)return null;let t=document.getSelection();for(let n=0,r=t.rangeCount;n<r;n++)if(!e.contains(t.getRangeAt(n).commonAncestorContainer))return null;let{x:n,y:r,width:i,height:a}=e.getBoundingClientRect(),o;switch(e.getAttribute(`data-main-rotation`)){case`90`:o=(e,t,o,s)=>({x:(t-r)/a,y:1-(e+o-n)/i,width:s/a,height:o/i});break;case`180`:o=(e,t,o,s)=>({x:1-(e+o-n)/i,y:1-(t+s-r)/a,width:o/i,height:s/a});break;case`270`:o=(e,t,o,s)=>({x:1-(t+s-r)/a,y:(e-n)/i,width:s/a,height:o/i});break;default:o=(e,t,o,s)=>({x:(e-n)/i,y:(t-r)/a,width:o/i,height:s/a});break}let s=[];for(let e=0,n=t.rangeCount;e<n;e++){let n=t.getRangeAt(e);if(!n.collapsed)for(let{x:e,y:t,width:r,height:i}of n.getClientRects())r===0||i===0||s.push(o(e,t,r,i))}return s.length===0?null:s}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#changedExistingAnnotations||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#changedExistingAnnotations?.delete(e)}renderAnnotationElement(e){let t=this.#changedExistingAnnotations?.get(e.data.id);if(!t)return;let n=this.#annotationStorage.getRawValue(t);n&&(this.#mode===rr.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){let r=this.#missingCanvases?.get(e);r&&(r.setCanvas(t,n),this.#missingCanvases.delete(e))}addMissingCanvas(e,t){(this.#missingCanvases||=new Map).set(e,t)}},zi=class e{#altText=null;#altTextDecorative=!1;#altTextButton=null;#altTextButtonLabel=null;#altTextTooltip=null;#altTextTooltipTimeout=null;#altTextWasFromKeyBoard=!1;#badge=null;#editor=null;#guessedText=null;#textWithDisclaimer=null;#useNewAltTextFlow=!1;static#l10nNewButton=null;static _l10n=null;constructor(t){this.#editor=t,this.#useNewAltTextFlow=t._uiManager.useNewAltTextFlow,e.#l10nNewButton||=Object.freeze({added:`pdfjs-editor-new-alt-text-added-button`,"added-label":`pdfjs-editor-new-alt-text-added-button-label`,missing:`pdfjs-editor-new-alt-text-missing-button`,"missing-label":`pdfjs-editor-new-alt-text-missing-button-label`,review:`pdfjs-editor-new-alt-text-to-review-button`,"review-label":`pdfjs-editor-new-alt-text-to-review-button-label`})}static initialize(t){e._l10n??=t}async render(){let t=this.#altTextButton=document.createElement(`button`);t.className=`altText`,t.tabIndex=`0`;let n=this.#altTextButtonLabel=document.createElement(`span`);t.append(n),this.#useNewAltTextFlow?(t.classList.add(`new`),t.setAttribute(`data-l10n-id`,e.#l10nNewButton.missing),n.setAttribute(`data-l10n-id`,e.#l10nNewButton[`missing-label`])):(t.setAttribute(`data-l10n-id`,`pdfjs-editor-alt-text-button`),n.setAttribute(`data-l10n-id`,`pdfjs-editor-alt-text-button-label`));let r=this.#editor._uiManager._signal;t.addEventListener(`contextmenu`,ci,{signal:r}),t.addEventListener(`pointerdown`,e=>e.stopPropagation(),{signal:r});let i=e=>{e.preventDefault(),this.#editor._uiManager.editAltText(this.#editor),this.#useNewAltTextFlow&&this.#editor._reportTelemetry({action:`pdfjs.image.alt_text.image_status_label_clicked`,data:{label:this.#label}})};return t.addEventListener(`click`,i,{capture:!0,signal:r}),t.addEventListener(`keydown`,e=>{e.target===t&&e.key===`Enter`&&(this.#altTextWasFromKeyBoard=!0,i(e))},{signal:r}),await this.#setState(),t}get#label(){return this.#altText&&`added`||this.#altText===null&&this.guessedText&&`review`||`missing`}finish(){this.#altTextButton&&(this.#altTextButton.focus({focusVisible:this.#altTextWasFromKeyBoard}),this.#altTextWasFromKeyBoard=!1)}isEmpty(){return this.#useNewAltTextFlow?this.#altText===null:!this.#altText&&!this.#altTextDecorative}hasData(){return this.#useNewAltTextFlow?this.#altText!==null||!!this.#guessedText:this.isEmpty()}get guessedText(){return this.#guessedText}async setGuessedText(t){this.#altText===null&&(this.#guessedText=t,this.#textWithDisclaimer=await e._l10n.get(`pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer`,{generatedAltText:t}),this.#setState())}toggleAltTextBadge(e=!1){if(!this.#useNewAltTextFlow||this.#altText){this.#badge?.remove(),this.#badge=null;return}if(!this.#badge){let e=this.#badge=document.createElement(`div`);e.className=`noAltTextBadge`,this.#editor.div.append(e)}this.#badge.classList.toggle(`hidden`,!e)}serialize(e){let t=this.#altText;return!e&&this.#guessedText===t&&(t=this.#textWithDisclaimer),{altText:t,decorative:this.#altTextDecorative,guessedText:this.#guessedText,textWithDisclaimer:this.#textWithDisclaimer}}get data(){return{altText:this.#altText,decorative:this.#altTextDecorative}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:r,cancel:i=!1}){n&&(this.#guessedText=n,this.#textWithDisclaimer=r),!(this.#altText===e&&this.#altTextDecorative===t)&&(i||(this.#altText=e,this.#altTextDecorative=t),this.#setState())}toggle(e=!1){this.#altTextButton&&(!e&&this.#altTextTooltipTimeout&&(clearTimeout(this.#altTextTooltipTimeout),this.#altTextTooltipTimeout=null),this.#altTextButton.disabled=!e)}shown(){this.#editor._reportTelemetry({action:`pdfjs.image.alt_text.image_status_label_displayed`,data:{label:this.#label}})}destroy(){this.#altTextButton?.remove(),this.#altTextButton=null,this.#altTextButtonLabel=null,this.#altTextTooltip=null,this.#badge?.remove(),this.#badge=null}async#setState(){let t=this.#altTextButton;if(!t)return;if(this.#useNewAltTextFlow){if(t.classList.toggle(`done`,!!this.#altText),t.setAttribute(`data-l10n-id`,e.#l10nNewButton[this.#label]),this.#altTextButtonLabel?.setAttribute(`data-l10n-id`,e.#l10nNewButton[`${this.#label}-label`]),!this.#altText){this.#altTextTooltip?.remove();return}}else{if(!this.#altText&&!this.#altTextDecorative){t.classList.remove(`done`),this.#altTextTooltip?.remove();return}t.classList.add(`done`),t.setAttribute(`data-l10n-id`,`pdfjs-editor-alt-text-edit-button`)}let n=this.#altTextTooltip;if(!n){this.#altTextTooltip=n=document.createElement(`span`),n.className=`tooltip`,n.setAttribute(`role`,`tooltip`),n.id=`alt-text-tooltip-${this.#editor.id}`;let e=this.#editor._uiManager._signal;e.addEventListener(`abort`,()=>{clearTimeout(this.#altTextTooltipTimeout),this.#altTextTooltipTimeout=null},{once:!0}),t.addEventListener(`mouseenter`,()=>{this.#altTextTooltipTimeout=setTimeout(()=>{this.#altTextTooltipTimeout=null,this.#altTextTooltip.classList.add(`show`),this.#editor._reportTelemetry({action:`alt_text_tooltip`})},100)},{signal:e}),t.addEventListener(`mouseleave`,()=>{this.#altTextTooltipTimeout&&=(clearTimeout(this.#altTextTooltipTimeout),null),this.#altTextTooltip?.classList.remove(`show`)},{signal:e})}this.#altTextDecorative?n.setAttribute(`data-l10n-id`,`pdfjs-editor-alt-text-decorative-tooltip`):(n.removeAttribute(`data-l10n-id`),n.textContent=this.#altText),n.parentNode||t.append(n),this.#editor.getElementForAltText()?.setAttribute(`aria-describedby`,n.id)}},Bi=class{#commentStandaloneButton=null;#commentToolbarButton=null;#commentWasFromKeyBoard=!1;#editor=null;#initialText=null;#richText=null;#text=null;#date=null;#deleted=!1;#popupPosition=null;constructor(e){this.#editor=e}renderForToolbar(){let e=this.#commentToolbarButton=document.createElement(`button`);return e.className=`comment`,this.#render(e,!1)}renderForStandalone(){let e=this.#commentStandaloneButton=document.createElement(`button`);e.className=`annotationCommentButton`;let t=this.#editor.commentButtonPosition;if(t){let{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#editor._uiManager.direction===`ltr`?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;let r=this.#editor.commentButtonColor;r&&(n.backgroundColor=r)}return this.#render(e,!0)}focusButton(){setTimeout(()=>{(this.#commentStandaloneButton??this.#commentToolbarButton)?.focus()},0)}onUpdatedColor(){if(!this.#commentStandaloneButton)return;let e=this.#editor.commentButtonColor;e&&(this.#commentStandaloneButton.style.backgroundColor=e),this.#editor._uiManager.updatePopupColor(this.#editor)}get commentButtonWidth(){return(this.#commentStandaloneButton?.getBoundingClientRect().width??0)/this.#editor.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#popupPosition)return this.#popupPosition;if(!this.#commentStandaloneButton)return null;let{x:e,y:t,height:n}=this.#commentStandaloneButton.getBoundingClientRect(),{x:r,y:i,width:a,height:o}=this.#editor.parent.boundingClientRect;return[(e-r)/a,(t+n-i)/o]}set commentPopupPositionInLayer(e){this.#popupPosition=e}hasDefaultPopupPosition(){return this.#popupPosition===null}removeStandaloneCommentButton(){this.#commentStandaloneButton?.remove(),this.#commentStandaloneButton=null}removeToolbarCommentButton(){this.#commentToolbarButton?.remove(),this.#commentToolbarButton=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#commentStandaloneButton&&(this.#commentStandaloneButton.classList.toggle(`selected`,e),this.#commentStandaloneButton.ariaExpanded=t)}#render(e,t){if(!this.#editor._uiManager.hasCommentManager())return null;e.tabIndex=`0`,e.ariaHasPopup=`dialog`,t?(e.ariaControls=`commentPopup`,e.setAttribute(`data-l10n-id`,`pdfjs-show-comment-button`)):(e.ariaControlsElements=[this.#editor._uiManager.getCommentDialogElement()],e.setAttribute(`data-l10n-id`,`pdfjs-editor-edit-comment-button`));let n=this.#editor._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener(`contextmenu`,ci,{signal:n}),t&&(e.addEventListener(`focusin`,e=>{this.#editor._focusEventsAllowed=!1,li(e)},{capture:!0,signal:n}),e.addEventListener(`focusout`,e=>{this.#editor._focusEventsAllowed=!0,li(e)},{capture:!0,signal:n})),e.addEventListener(`pointerdown`,e=>e.stopPropagation(),{signal:n});let r=t=>{t.preventDefault(),e===this.#commentToolbarButton?this.edit():this.#editor.toggleComment(!0)};return e.addEventListener(`click`,r,{capture:!0,signal:n}),e.addEventListener(`keydown`,t=>{t.target===e&&t.key===`Enter`&&(this.#commentWasFromKeyBoard=!0,r(t))},{signal:n}),e.addEventListener(`pointerenter`,()=>{this.#editor.toggleComment(!1,!0)},{signal:n}),e.addEventListener(`pointerleave`,()=>{this.#editor.toggleComment(!1,!1)},{signal:n}),e}edit(e){let t=this.commentPopupPositionInLayer,n,r;if(t)[n,r]=t;else{[n,r]=this.#editor.commentButtonPosition;let{width:e,height:t,x:i,y:a}=this.#editor;n=i+n*e,r=a+r*t}let i=this.#editor.parent.boundingClientRect,{x:a,y:o,width:s,height:c}=i;this.#editor._uiManager.editComment(this.#editor,a+n*s,o+r*c,{...e,parentDimensions:i})}finish(){this.#commentToolbarButton&&(this.#commentToolbarButton.focus({focusVisible:this.#commentWasFromKeyBoard}),this.#commentWasFromKeyBoard=!1)}isDeleted(){return this.#deleted||this.#text===``}isEmpty(){return this.#text===null}hasBeenEdited(){return this.isDeleted()||this.#text!==this.#initialText}serialize(){return this.data}get data(){return{text:this.#text,richText:this.#richText,date:this.#date,deleted:this.isDeleted()}}set data(e){if(e!==this.#text&&(this.#richText=null),e===null){this.#text=``,this.#deleted=!0;return}this.#text=e,this.#date=new Date,this.#deleted=!1}setInitialText(e,t=null){this.#initialText=e,this.data=e,this.#date=null,this.#richText=t}shown(){}destroy(){this.#commentToolbarButton?.remove(),this.#commentToolbarButton=null,this.#commentStandaloneButton?.remove(),this.#commentStandaloneButton=null,this.#text=``,this.#richText=null,this.#date=null,this.#editor=null,this.#commentWasFromKeyBoard=!1,this.#deleted=!1}},Vi=class e{#container;#isPinching=!1;#isPinchingStopped=null;#isPinchingDisabled;#onPinchStart;#onPinching;#onPinchEnd;#pointerDownAC=null;#signal;#touchInfo=null;#touchManagerAC;#touchMoveAC=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:r=null,onPinching:i=null,onPinchEnd:a=null,signal:o}){this.#container=e,this.#isPinchingStopped=n,this.#isPinchingDisabled=t,this.#onPinchStart=r,this.#onPinching=i,this.#onPinchEnd=a,this.#touchManagerAC=new AbortController,this.#signal=AbortSignal.any([o,this.#touchManagerAC.signal]),e.addEventListener(`touchstart`,this.#onTouchStart.bind(this),{passive:!1,signal:this.#signal})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/vi.pixelRatio}#onTouchStart(e){if(this.#isPinchingDisabled?.())return;if(e.touches.length===1){if(this.#pointerDownAC)return;let e=this.#pointerDownAC=new AbortController,t=AbortSignal.any([this.#signal,e.signal]),n=this.#container,r={capture:!0,signal:t,passive:!1},i=e=>{e.pointerType===`touch`&&(this.#pointerDownAC?.abort(),this.#pointerDownAC=null)};n.addEventListener(`pointerdown`,e=>{e.pointerType===`touch`&&(li(e),i(e))},r),n.addEventListener(`pointerup`,i,r),n.addEventListener(`pointercancel`,i,r);return}if(!this.#touchMoveAC){this.#touchMoveAC=new AbortController;let e=AbortSignal.any([this.#signal,this.#touchMoveAC.signal]),t=this.#container,n={signal:e,capture:!1,passive:!1};t.addEventListener(`touchmove`,this.#onTouchMove.bind(this),n);let r=this.#onTouchEnd.bind(this);t.addEventListener(`touchend`,r,n),t.addEventListener(`touchcancel`,r,n),n.capture=!0,t.addEventListener(`pointerdown`,li,n),t.addEventListener(`pointermove`,li,n),t.addEventListener(`pointercancel`,li,n),t.addEventListener(`pointerup`,li,n),this.#onPinchStart?.()}if(li(e),e.touches.length!==2||this.#isPinchingStopped?.()){this.#touchInfo=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#touchInfo={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#onTouchMove(t){if(!this.#touchInfo||t.touches.length!==2)return;li(t);let[n,r]=t.touches;n.identifier>r.identifier&&([n,r]=[r,n]);let{screenX:i,screenY:a}=n,{screenX:o,screenY:s}=r,c=this.#touchInfo,{touch0X:l,touch0Y:u,touch1X:d,touch1Y:f}=c,p=d-l,m=f-u,h=o-i,g=s-a,_=Math.hypot(h,g)||1,v=Math.hypot(p,m)||1;if(!this.#isPinching&&Math.abs(v-_)<=e.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(c.touch0X=i,c.touch0Y=a,c.touch1X=o,c.touch1Y=s,!this.#isPinching){this.#isPinching=!0;return}let y=[(i+o)/2,(a+s)/2];this.#onPinching?.(y,v,_)}#onTouchEnd(e){e.touches.length>=2||(this.#touchMoveAC&&(this.#touchMoveAC.abort(),this.#touchMoveAC=null,this.#onPinchEnd?.()),this.#touchInfo&&(li(e),this.#touchInfo=null,this.#isPinching=!1))}destroy(){this.#touchManagerAC?.abort(),this.#touchManagerAC=null,this.#pointerDownAC?.abort(),this.#pointerDownAC=null}},Hi=class e{#accessibilityData=null;#allResizerDivs=null;#altText=null;#comment=null;#commentStandaloneButton=null;#disabled=!1;#dragPointerId=null;#dragPointerType=``;#resizersDiv=null;#lastPointerCoords=null;#savedDimensions=null;#fakeAnnotation=null;#focusAC=null;#focusedResizerName=``;#hasBeenClicked=!1;#initialRect=null;#isEditing=!1;#isInEditMode=!1;#isResizerEnabledForKeyboard=!1;#moveInDOMTimeout=null;#prevDragX=0;#prevDragY=0;#telemetryTimeouts=null;#touchManager=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#isDraggable=!1;#zIndex=e._zIndex++;static _borderLineWidth=-1;static _colorManager=new Li;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){let t=e.prototype._resizeWithKeyboard,n=Ri.TRANSLATE_SMALL,r=Ri.TRANSLATE_BIG;return wr(this,`_resizerKeyboardManager`,new Ii([[[`ArrowLeft`,`mac+ArrowLeft`],t,{args:[-n,0]}],[[`ctrl+ArrowLeft`,`mac+shift+ArrowLeft`],t,{args:[-r,0]}],[[`ArrowRight`,`mac+ArrowRight`],t,{args:[n,0]}],[[`ctrl+ArrowRight`,`mac+shift+ArrowRight`],t,{args:[r,0]}],[[`ArrowUp`,`mac+ArrowUp`],t,{args:[0,-n]}],[[`ctrl+ArrowUp`,`mac+shift+ArrowUp`],t,{args:[0,-r]}],[[`ArrowDown`,`mac+ArrowDown`],t,{args:[0,n]}],[[`ctrl+ArrowDown`,`mac+shift+ArrowDown`],t,{args:[0,r]}],[[`Escape`,`mac+Escape`],e.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;let{rotation:t,rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,r],this.pageTranslation=[i,a];let[o,s]=this.parentDimensions;this.x=e.x/o,this.y=e.y/s,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return wr(this,`_defaultLineColor`,this._colorManager.getHexCode(`CanvasText`))}static deleteAnnotationElement(e){let t=new Ui({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(t,n){if(e._l10n??=t,e._l10nResizer||=Object.freeze({topLeft:`pdfjs-editor-resizer-top-left`,topMiddle:`pdfjs-editor-resizer-top-middle`,topRight:`pdfjs-editor-resizer-top-right`,middleRight:`pdfjs-editor-resizer-middle-right`,bottomRight:`pdfjs-editor-resizer-bottom-right`,bottomMiddle:`pdfjs-editor-resizer-bottom-middle`,bottomLeft:`pdfjs-editor-resizer-bottom-left`,middleLeft:`pdfjs-editor-resizer-middle-left`}),e._borderLineWidth!==-1)return;let r=getComputedStyle(document.documentElement);e._borderLineWidth=parseFloat(r.getPropertyValue(`--outline-width`))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){yr(`Not implemented`)}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#isDraggable}set _isDraggable(e){this.#isDraggable=e,this.div?.classList.toggle(`draggable`,e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){let[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#zIndex}setParent(e){e===null?(this.#stopResizing(),this.#fakeAnnotation?.remove(),this.#fakeAnnotation=null):(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#hasBeenClicked?this.#hasBeenClicked=!1:this.parent.setSelected(this))}focusout(e){this._focusEventsAllowed&&this.isAttachedToDOM&&(e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove()))}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,r){let[i,a]=this.parentDimensions;[n,r]=this.screenToPageTranslation(n,r),this.x=(e+n)/i,this.y=(t+r)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){let[n,r]=this.parentDimensions;this.setAt(e*n,t*r,this.width*n,this.height*r),this._onTranslated()}#translate([e,t],n,r){[n,r]=this.screenToPageTranslation(n,r),this.x+=n/e,this.y+=r/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#translate(this.parentDimensions,e,t)}translateInPage(e,t){this.#initialRect||=[this.x,this.y,this.width,this.height],this.#translate(this.pageDimensions,e,t),this.div.scrollIntoView({block:`nearest`})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#initialRect||=[this.x,this.y,this.width,this.height];let{div:n,parentDimensions:[r,i]}=this;if(this.x+=e/r,this.y+=t/i,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){let{x:e,y:t}=this.div.getBoundingClientRect();this.parent.findNewParent(this,e,t)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:o}=this,[s,c]=this.getBaseTranslation();a+=s,o+=c;let{style:l}=n;l.left=`${(100*a).toFixed(2)}%`,l.top=`${(100*o).toFixed(2)}%`,this._onTranslating(a,o),n.scrollIntoView({block:`nearest`})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#initialRect&&(this.#initialRect[0]!==this.x||this.#initialRect[1]!==this.y)}get _hasBeenResized(){return!!this.#initialRect&&(this.#initialRect[2]!==this.width||this.#initialRect[3]!==this.height)}getBaseTranslation(){let[t,n]=this.parentDimensions,{_borderLineWidth:r}=e,i=r/t,a=r/n;switch(this.rotation){case 90:return[-i,a];case 180:return[i,a];case 270:return[i,-a];default:return[-i,-a]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){let{div:{style:t},pageDimensions:[n,r]}=this,{x:i,y:a,width:o,height:s}=this;if(o*=n,s*=r,i*=n,a*=r,this._mustFixPosition)switch(e){case 0:i=Kr(i,0,n-o),a=Kr(a,0,r-s);break;case 90:i=Kr(i,0,n-s),a=Kr(a,o,r);break;case 180:i=Kr(i,o,n),a=Kr(a,s,r);break;case 270:i=Kr(i,s,n),a=Kr(a,0,r-o);break}this.x=i/=n,this.y=a/=r;let[c,l]=this.getBaseTranslation();i+=c,a+=l,t.left=`${(100*i).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#rotatePoint(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(t,n){return e.#rotatePoint(t,n,this.parentRotation)}pageTranslationToScreen(t,n){return e.#rotatePoint(t,n,360-this.parentRotation)}#getRotationMatrix(e){switch(e){case 90:{let[e,t]=this.pageDimensions;return[0,-e/t,t/e,0]}case 180:return[-1,0,0,-1];case 270:{let[e,t]=this.pageDimensions;return[0,e/t,-t/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){let{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){let{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#createResizers(){if(this.#resizersDiv)return;this.#resizersDiv=document.createElement(`div`),this.#resizersDiv.classList.add(`resizers`);let e=this._willKeepAspectRatio?[`topLeft`,`topRight`,`bottomRight`,`bottomLeft`]:[`topLeft`,`topMiddle`,`topRight`,`middleRight`,`bottomRight`,`bottomMiddle`,`bottomLeft`,`middleLeft`],t=this._uiManager._signal;for(let n of e){let e=document.createElement(`div`);this.#resizersDiv.append(e),e.classList.add(`resizer`,n),e.setAttribute(`data-resizer-name`,n),e.addEventListener(`pointerdown`,this.#resizerPointerdown.bind(this,n),{signal:t}),e.addEventListener(`contextmenu`,ci,{signal:t}),e.tabIndex=-1}this.div.prepend(this.#resizersDiv)}#resizerPointerdown(e,t){t.preventDefault();let{isMac:n}=Lr.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#altText?.toggle(!1);let r=this._isDraggable;this._isDraggable=!1,this.#lastPointerCoords=[t.screenX,t.screenY];let i=new AbortController,a=this._uiManager.combinedSignal(i);this.parent.togglePointerEvents(!1),window.addEventListener(`pointermove`,this.#resizerPointermove.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener(`touchmove`,li,{passive:!1,signal:a}),window.addEventListener(`contextmenu`,ci,{signal:a}),this.#savedDimensions={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let o=this.parent.div.style.cursor,s=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;let c=()=>{i.abort(),this.parent.togglePointerEvents(!0),this.#altText?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=o,this.div.style.cursor=s,this.#addResizeToUndoStack()};window.addEventListener(`pointerup`,c,{signal:a}),window.addEventListener(`blur`,c,{signal:a})}#resize(e,t,n,r){this.width=n,this.height=r,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#addResizeToUndoStack(){if(!this.#savedDimensions)return;let{savedX:e,savedY:t,savedWidth:n,savedHeight:r}=this.#savedDimensions;this.#savedDimensions=null;let i=this.x,a=this.y,o=this.width,s=this.height;i===e&&a===t&&o===n&&s===r||this.addCommands({cmd:this.#resize.bind(this,i,a,o,s),undo:this.#resize.bind(this,e,t,n,r),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#resizerPointermove(t,n){let[r,i]=this.parentDimensions,a=this.x,o=this.y,s=this.width,c=this.height,l=e.MIN_SIZE/r,u=e.MIN_SIZE/i,d=this.#getRotationMatrix(this.rotation),f=(e,t)=>[d[0]*e+d[2]*t,d[1]*e+d[3]*t],p=this.#getRotationMatrix(360-this.rotation),m=(e,t)=>[p[0]*e+p[2]*t,p[1]*e+p[3]*t],h,g,_=!1,v=!1;switch(t){case`topLeft`:_=!0,h=(e,t)=>[0,0],g=(e,t)=>[e,t];break;case`topMiddle`:h=(e,t)=>[e/2,0],g=(e,t)=>[e/2,t];break;case`topRight`:_=!0,h=(e,t)=>[e,0],g=(e,t)=>[0,t];break;case`middleRight`:v=!0,h=(e,t)=>[e,t/2],g=(e,t)=>[0,t/2];break;case`bottomRight`:_=!0,h=(e,t)=>[e,t],g=(e,t)=>[0,0];break;case`bottomMiddle`:h=(e,t)=>[e/2,t],g=(e,t)=>[e/2,0];break;case`bottomLeft`:_=!0,h=(e,t)=>[0,t],g=(e,t)=>[e,0];break;case`middleLeft`:v=!0,h=(e,t)=>[0,t/2],g=(e,t)=>[e,t/2];break}let y=h(s,c),b=g(s,c),x=f(...b),S=e._round(a+x[0]),C=e._round(o+x[1]),w=1,T=1,E,D;if(n.fromKeyboard)({deltaX:E,deltaY:D}=n);else{let{screenX:e,screenY:t}=n,[r,i]=this.#lastPointerCoords;[E,D]=this.screenToPageTranslation(e-r,t-i),this.#lastPointerCoords[0]=e,this.#lastPointerCoords[1]=t}if([E,D]=m(E/r,D/i),_){let e=Math.hypot(s,c);w=T=Math.max(Math.min(Math.hypot(b[0]-y[0]-E,b[1]-y[1]-D)/e,1/s,1/c),l/s,u/c)}else v?w=Kr(Math.abs(b[0]-y[0]-E),l,1)/s:T=Kr(Math.abs(b[1]-y[1]-D),u,1)/c;let O=e._round(s*w),k=e._round(c*T);x=f(...g(O,k));let A=S-x[0],j=C-x[1];this.#initialRect||=[this.x,this.y,this.width,this.height],this.width=O,this.height=k,this.x=A,this.y=j,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#altText?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#isInEditMode)return this._editToolbar;this._editToolbar=new Ai(this),this.div.append(this._editToolbar.render());let{toolbarButtons:e}=this;if(e)for(let[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton(`comment`,this.addCommentButton()),this._editToolbar.addButton(`delete`),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore(`comment`,this.addCommentButton(),`.deleteButton`)}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton(`comment`)}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#altText?.destroy()}addContainer(e){let t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#altText||(zi.initialize(e._l10n),this.#altText=new zi(this),this.#accessibilityData&&=(this.#altText.data=this.#accessibilityData,null)),this.#altText}get altTextData(){return this.#altText?.data}set altTextData(e){this.#altText&&(this.#altText.data=e)}get guessedAltText(){return this.#altText?.guessedText}async setGuessedAltText(e){await this.#altText?.setGuessedText(e)}serializeAltText(e){return this.#altText?.serialize(e)}hasAltText(){return!!this.#altText&&!this.#altText.isEmpty()}hasAltTextData(){return this.#altText?.hasData()??!1}focusCommentButton(){this.#comment?.focusButton()}addCommentButton(){return this.#comment||=new Bi(this)}addStandaloneCommentButton(){if(this.#commentStandaloneButton){this._uiManager.isEditingMode()&&this.#commentStandaloneButton.classList.remove(`hidden`);return}this.hasComment&&(this.#commentStandaloneButton=this.#comment.renderForStandalone(),this.div.append(this.#commentStandaloneButton))}removeStandaloneCommentButton(){this.#comment.removeStandaloneCommentButton(),this.#commentStandaloneButton=null}hideStandaloneCommentButton(){this.#commentStandaloneButton?.classList.add(`hidden`)}get comment(){let{data:{richText:e,text:t,date:n,deleted:r}}=this.#comment;return{text:t,richText:e,date:n,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#comment||=new Bi(this),this.#comment.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#comment||=new Bi(this),this.#comment.setInitialText(e,n),!this.annotationElementId))return;let r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#comment?.hasBeenEdited()}get hasDeletedComment(){return this.#comment?.isDeleted()}get hasComment(){return!!this.#comment&&!this.#comment.isEmpty()&&!this.#comment.isDeleted()}async editComment(e){this.#comment||=new Bi(this),this.#comment.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#comment.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){let[,,,t]=e.rect,[n]=this.pageDimensions,[r]=this.pageTranslation,i=r+n+1,a=t-100,o=i+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[i,a,o,t]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#comment.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){let e=this.div=document.createElement(`div`);e.setAttribute(`data-editor-rotation`,(360-this.rotation)%360),e.className=this.name,e.setAttribute(`id`,this.id),e.tabIndex=this.#disabled?-1:0,e.setAttribute(`role`,`application`),this.defaultL10nId&&e.setAttribute(`data-l10n-id`,this.defaultL10nId),this._isVisible||e.classList.add(`hidden`),this.setInForeground(),this.#addFocusListeners();let[t,n]=this.parentDimensions;this.parentRotation%180!=0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);let[r,i]=this.getInitialTranslation();return this.translate(r,i),Mi(this,e,[`keydown`,`pointerdown`,`dblclick`]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#touchManager||=new Vi({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#touchPinchStartCallback.bind(this),onPinching:this.#touchPinchCallback.bind(this),onPinchEnd:this.#touchPinchEndCallback.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#touchPinchStartCallback(){this.#savedDimensions={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#altText?.toggle(!1),this.parent.togglePointerEvents(!1)}#touchPinchCallback(t,n,r){let i=.7,a=i*(r/n)+1-i;if(a===1)return;let o=this.#getRotationMatrix(this.rotation),s=(e,t)=>[o[0]*e+o[2]*t,o[1]*e+o[3]*t],[c,l]=this.parentDimensions,u=this.x,d=this.y,f=this.width,p=this.height,m=e.MIN_SIZE/c,h=e.MIN_SIZE/l;a=Math.max(Math.min(a,1/f,1/p),m/f,h/p);let g=e._round(f*a),_=e._round(p*a);if(g===f&&_===p)return;this.#initialRect||=[u,d,f,p];let v=s(f/2,p/2),y=e._round(u+v[0]),b=e._round(d+v[1]),x=s(g/2,_/2);this.x=y-x[0],this.y=b-x[1],this.width=g,this.height=_,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#touchPinchEndCallback(){this.#altText?.toggle(!0),this.parent.togglePointerEvents(!0),this.#addResizeToUndoStack()}pointerdown(e){let{isMac:t}=Lr.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#hasBeenClicked=!0,this._isDraggable){this.#setUpDragSession(e);return}this.#selectOnPointerEvent(e)}#selectOnPointerEvent(e){let{isMac:t}=Lr.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#setUpDragSession(e){let{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1,r=new AbortController,i=this._uiManager.combinedSignal(r),a={capture:!0,passive:!1,signal:i},o=e=>{r.abort(),this.#dragPointerId=null,this.#hasBeenClicked=!1,this._uiManager.endDragSession()||this.#selectOnPointerEvent(e),n&&this._onStopDragging()};t&&(this.#prevDragX=e.clientX,this.#prevDragY=e.clientY,this.#dragPointerId=e.pointerId,this.#dragPointerType=e.pointerType,window.addEventListener(`pointermove`,e=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());let{clientX:t,clientY:r,pointerId:i}=e;if(i!==this.#dragPointerId){li(e);return}let[a,o]=this.screenToPageTranslation(t-this.#prevDragX,r-this.#prevDragY);this.#prevDragX=t,this.#prevDragY=r,this._uiManager.dragSelectedEditors(a,o)},a),window.addEventListener(`touchmove`,li,a),window.addEventListener(`pointerdown`,e=>{e.pointerType===this.#dragPointerType&&(this.#touchManager||e.isPrimary)&&o(e),li(e)},a));let s=e=>{if(!this.#dragPointerId||this.#dragPointerId===e.pointerId){o(e);return}li(e)};window.addEventListener(`pointerup`,s,{signal:i}),window.addEventListener(`blur`,s,{signal:i})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#moveInDOMTimeout&&clearTimeout(this.#moveInDOMTimeout),this.#moveInDOMTimeout=setTimeout(()=>{this.#moveInDOMTimeout=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){let r=this.parentScale,[i,a]=this.pageDimensions,[o,s]=this.pageTranslation,c=e/r,l=t/r,u=this.x*i,d=this.y*a,f=this.width*i,p=this.height*a;switch(n){case 0:return[u+c+o,a-d-l-p+s,u+c+f+o,a-d-l+s];case 90:return[u+l+o,a-d+c+s,u+l+p+o,a-d+c+f+s];case 180:return[u-c-f+o,a-d+l+s,u-c+o,a-d+l+p+s];case 270:return[u-l-p+o,a-d-c-f+s,u-l+o,a-d-c+s];default:throw Error(`Invalid rotation`)}}getRectInCurrentCoords(e,t){let[n,r,i,a]=e,o=i-n,s=a-r;switch(this.rotation){case 0:return[n,t-a,o,s];case 90:return[n,t-r,s,o];case 180:return[i,t-r,o,s];case 270:return[i,t-a,s,o];default:throw Error(`Invalid rotation`)}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&e._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#comment?.onUpdatedColor()}getData(){let{comment:{text:e,color:t,date:n,opacity:r,deleted:i,richText:a},uid:o,pageIndex:s,creationDate:c,modificationDate:l}=this;return{id:o,pageIndex:s,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:c,modificationDate:n||l,popupRef:!i,color:t,opacity:r}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#isInEditMode=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#isInEditMode=!1,!0):!1}isInEditMode(){return this.#isInEditMode}shouldGetKeyboardEvents(){return this.#isResizerEnabledForKeyboard}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){let{top:e,left:t,bottom:n,right:r}=this.getClientDimensions(),{innerHeight:i,innerWidth:a}=window;return t<a&&r>0&&e<i&&n>0}#addFocusListeners(){if(this.#focusAC||!this.div)return;this.#focusAC=new AbortController;let e=this._uiManager.combinedSignal(this.#focusAC);this.div.addEventListener(`focusin`,this.focusin.bind(this),{signal:e}),this.div.addEventListener(`focusout`,this.focusout.bind(this),{signal:e})}rebuild(){this.#addFocusListeners()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||``}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||``}}static async deserialize(e,t,n){let r=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});r.rotation=e.rotation,r.#accessibilityData=e.accessibilityData,r._isCopy=e.isCopy||!1;let[i,a]=r.pageDimensions,[o,s,c,l]=r.getRectInCurrentCoords(e.rect,a);return r.x=o/i,r.y=s/a,r.width=c/i,r.height=l/a,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#focusAC?.abort(),this.#focusAC=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#moveInDOMTimeout&&=(clearTimeout(this.#moveInDOMTimeout),null),this.#stopResizing(),this.removeEditToolbar(),this.#telemetryTimeouts){for(let e of this.#telemetryTimeouts.values())clearTimeout(e);this.#telemetryTimeouts=null}this.parent=null,this.#touchManager?.destroy(),this.#touchManager=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#createResizers(),this.#resizersDiv.classList.remove(`hidden`))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction===`ltr`?[1,0]:[0,0]}get commentButtonPositionInPage(){let{commentButtonPosition:[t,n]}=this,[r,i,a,o]=this.getPDFRect();return[e._round(r+(a-r)*t),e._round(i+(o-i)*(1-n))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#comment.commentPopupPositionInLayer}set commentPopupPosition(e){this.#comment.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#comment.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#comment.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#comment.setCommentButtonStates(e)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!==`Enter`)return;this._uiManager.setSelected(this),this.#savedDimensions={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};let n=this.#resizersDiv.children;if(!this.#allResizerDivs){this.#allResizerDivs=Array.from(n);let t=this.#resizerKeydown.bind(this),r=this.#resizerBlur.bind(this),i=this._uiManager._signal;for(let n of this.#allResizerDivs){let a=n.getAttribute(`data-resizer-name`);n.setAttribute(`role`,`spinbutton`),n.addEventListener(`keydown`,t,{signal:i}),n.addEventListener(`blur`,r,{signal:i}),n.addEventListener(`focus`,this.#resizerFocus.bind(this,a),{signal:i}),n.setAttribute(`data-l10n-id`,e._l10nResizer[a])}}let r=this.#allResizerDivs[0],i=0;for(let e of n){if(e===r)break;i++}let a=(360-this.rotation+this.parentRotation)%360/90*(this.#allResizerDivs.length/4);if(a!==i){if(a<i)for(let e=0;e<i-a;e++)this.#resizersDiv.append(this.#resizersDiv.firstChild);else if(a>i)for(let e=0;e<a-i;e++)this.#resizersDiv.firstChild.before(this.#resizersDiv.lastChild);let t=0;for(let r of n){let n=this.#allResizerDivs[t++].getAttribute(`data-resizer-name`);r.setAttribute(`data-l10n-id`,e._l10nResizer[n])}}this.#setResizerTabIndex(0),this.#isResizerEnabledForKeyboard=!0,this.#resizersDiv.firstChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#resizerKeydown(t){e._resizerKeyboardManager.exec(this,t)}#resizerBlur(e){this.#isResizerEnabledForKeyboard&&e.relatedTarget?.parentNode!==this.#resizersDiv&&this.#stopResizing()}#resizerFocus(e){this.#focusedResizerName=this.#isResizerEnabledForKeyboard?e:``}#setResizerTabIndex(e){if(this.#allResizerDivs)for(let t of this.#allResizerDivs)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#isResizerEnabledForKeyboard&&this.#resizerPointermove(this.#focusedResizerName,{deltaX:e,deltaY:t,fromKeyboard:!0})}#stopResizing(){this.#isResizerEnabledForKeyboard=!1,this.#setResizerTabIndex(-1),this.#addResizeToUndoStack()}_stopResizingWithKeyboard(){this.#stopResizing(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add(`selectedEditor`),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains(`selectedEditor`)&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#altText?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#resizersDiv?.classList.add(`hidden`),this.div?.classList.remove(`selectedEditor`),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#altText?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!==`BUTTON`&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#isEditing}set isEditing(e){this.#isEditing=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:`added`}}get telemetryFinalData(){return null}_reportTelemetry(t,n=!1){if(n){this.#telemetryTimeouts||=new Map;let{action:n}=t,r=this.#telemetryTimeouts.get(n);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#telemetryTimeouts.delete(n),this.#telemetryTimeouts.size===0&&(this.#telemetryTimeouts=null)},e._telemetryTimeout),this.#telemetryTimeouts.set(n,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch(`reporttelemetry`,{source:this,details:{type:`editing`,data:t}})}show(e=this._isVisible){this.div.classList.toggle(`hidden`,!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#disabled=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#disabled=!0}updateFakeAnnotationElement(e){if(!this.#fakeAnnotation&&!this.deleted){this.#fakeAnnotation=e.addFakeAnnotation(this);return}if(this.deleted){this.#fakeAnnotation.remove(),this.#fakeAnnotation=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#fakeAnnotation.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(`.annotationContent`);if(!t)t=document.createElement(`div`),t.classList.add(`annotationContent`,this.editorType),e.container.prepend(t);else if(t.nodeName===`CANVAS`){let e=t;t=document.createElement(`div`),t.classList.add(`annotationContent`,this.editorType),e.before(t)}return t}resetAnnotationElement(e){let{firstChild:t}=e.container;t?.nodeName===`DIV`&&t.classList.contains(`annotationContent`)&&t.remove()}},Ui=class extends Hi{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}},Wi=3285377520,Gi=4294901760,Ki=65535,qi=class{constructor(e){this.h1=e?e&4294967295:Wi,this.h2=e?e&4294967295:Wi}update(e){let t,n;if(typeof e==`string`){t=new Uint8Array(e.length*2),n=0;for(let r=0,i=e.length;r<i;r++){let i=e.charCodeAt(r);i<=255?t[n++]=i:(t[n++]=i>>>8,t[n++]=i&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw Error(`Invalid data format, must be a string or TypedArray.`);let r=n>>2,i=n-r*4,a=new Uint32Array(t.buffer,0,r),o=0,s=0,c=this.h1,l=this.h2,u=3432918353,d=461845907,f=u&Ki,p=d&Ki;for(let e=0;e<r;e++)e&1?(o=a[e],o=o*u&Gi|o*f&Ki,o=o<<15|o>>>17,o=o*d&Gi|o*p&Ki,c^=o,c=c<<13|c>>>19,c=c*5+3864292196):(s=a[e],s=s*u&Gi|s*f&Ki,s=s<<15|s>>>17,s=s*d&Gi|s*p&Ki,l^=s,l=l<<13|l>>>19,l=l*5+3864292196);switch(o=0,i){case 3:o^=t[r*4+2]<<16;case 2:o^=t[r*4+1]<<8;case 1:o^=t[r*4],o=o*u&Gi|o*f&Ki,o=o<<15|o>>>17,o=o*d&Gi|o*p&Ki,r&1?c^=o:l^=o}this.h1=c,this.h2=l}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Gi|e*36045&Ki,t=t*4283543511&Gi|((t<<16|e>>>16)*2950163797&Gi)>>>16,e^=t>>>1,e=e*444984403&Gi|e*60499&Ki,t=t*3301882366&Gi|((t<<16|e>>>16)*3120437893&Gi)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,`0`)+(t>>>0).toString(16).padStart(8,`0`)}},Ji=Object.freeze({map:null,hash:``,transfer:void 0}),Yi=class{#modified=!1;#modifiedIds=null;#editorsMap=null;#storage=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){let n=this.#storage.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#storage.get(e)}remove(e){let t=this.#storage.get(e);if(t!==void 0&&(t instanceof Hi&&this.#editorsMap.delete(t.annotationElementId),this.#storage.delete(e),this.#storage.size===0&&this.resetModified(),typeof this.onAnnotationEditor==`function`)){for(let e of this.#storage.values())if(e instanceof Hi)return;this.onAnnotationEditor(null)}}setValue(e,t){let n=this.#storage.get(e),r=!1;if(n!==void 0)for(let[e,i]of Object.entries(t))n[e]!==i&&(r=!0,n[e]=i);else r=!0,this.#storage.set(e,t);r&&this.#setModified(),t instanceof Hi&&((this.#editorsMap||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor==`function`&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#storage.has(e)}get size(){return this.#storage.size}#setModified(){this.#modified||(this.#modified=!0,typeof this.onSetModified==`function`&&this.onSetModified())}resetModified(){this.#modified&&(this.#modified=!1,typeof this.onResetModified==`function`&&this.onResetModified())}get print(){return new Xi(this)}get serializable(){if(this.#storage.size===0)return Ji;let e=new Map,t=new qi,n=[],r=Object.create(null),i=!1;for(let[n,a]of this.#storage){let o=a instanceof Hi?a.serialize(!1,r):a;o&&(e.set(n,o),t.update(`${n}:${JSON.stringify(o)}`),i||=!!o.bitmap)}if(i)for(let t of e.values())t.bitmap&&n.push(t.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:Ji}get editorStats(){let e=null,t=new Map,n=0,r=0;for(let i of this.#storage.values()){if(!(i instanceof Hi)){i.popup&&(i.popup.deleted?r+=1:n+=1);continue}i.isCommentDeleted?r+=1:i.hasEditedComment&&(n+=1);let a=i.telemetryFinalData;if(!a)continue;let{type:o}=a;t.has(o)||t.set(o,Object.getPrototypeOf(i).constructor),e||=Object.create(null);let s=e[o]||=new Map;for(let[e,t]of Object.entries(a)){if(e===`type`)continue;let n=s.get(e);n||(n=new Map,s.set(e,n));let r=n.get(t)??0;n.set(t,r+1)}}if((r>0||n>0)&&(e||=Object.create(null),e.comments={deleted:r,edited:n}),!e)return null;for(let[n,r]of t)e[n]=r.computeTelemetryFinalData(e[n]);return e}resetModifiedIds(){this.#modifiedIds=null}updateEditor(e,t){let n=this.#editorsMap?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#editorsMap?.get(e)||null}get modifiedIds(){if(this.#modifiedIds)return this.#modifiedIds;let e=[];if(this.#editorsMap)for(let t of this.#editorsMap.values())t.serialize()&&e.push(t.annotationElementId);return this.#modifiedIds={ids:new Set(e),hash:e.join(`,`)}}[Symbol.iterator](){return this.#storage.entries()}},Xi=class extends Yi{#serializable;constructor(e){super();let{map:t,hash:n,transfer:r}=e.serializable;this.#serializable={map:structuredClone(t,r?{transfer:r}:null),hash:n,transfer:r}}get print(){yr(`Should not call PrintAnnotationStorage.print`)}get serializable(){return this.#serializable}get modifiedIds(){return wr(this,`modifiedIds`,{ids:new Set,hash:``})}},Zi=class{#systemFonts=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement(`style`),this._document.documentElement.getElementsByTagName(`head`)[0].append(this.styleElement));let t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(let e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#systemFonts.clear(),this.styleElement&&=(this.styleElement.remove(),null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#systemFonts.has(e.loadedName))){if(br(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){let{loadedName:t,src:r,style:i}=e,a=new FontFace(t,r,i);this.addNativeFontFace(a);try{await a.load(),this.#systemFonts.add(t),n?.(e)}catch{vr(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(a)}return}yr(`Not implemented: loadSystemFont without the Font Loading API.`)}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){let t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw vr(`Failed to load font '${t.family}': '${n}'.`),e.disableFontFace=!0,n}}return}let t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(t=>{let n=this._queueLoadingCallback(t);this._prepareFontLoadEvent(e,n)})}}get isFontLoadingAPISupported(){let e=!!this._document?.fonts;return wr(this,`isFontLoadingAPISupported`,e)}get isSyncFontLoadingSupported(){return wr(this,`isSyncFontLoadingSupported`,Zn||Lr.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(br(!r.done,`completeRequest() cannot be called twice.`),r.done=!0;n.length>0&&n[0].done;){let e=n.shift();setTimeout(e.callback,0)}}let{loadingRequests:n}=this,r={done:!1,complete:t,callback:e};return n.push(r),r}get _loadTestFont(){let e=atob(`T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==`);return wr(this,`_loadTestFont`,e)}_prepareFontLoadEvent(e,t){function n(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3)&255}function r(e,t,n,r){let i=e.substring(0,t),a=e.substring(t+n);return i+r+a}let i,a,o=this._document.createElement(`canvas`);o.width=1,o.height=1;let s=o.getContext(`2d`),c=0;function l(e,t){if(++c>30){vr(`Load test font never loaded.`),t();return}if(s.font=`30px `+e,s.fillText(`.`,0,20),s.getImageData(0,0,1,1).data[3]>0){t();return}setTimeout(l.bind(null,e,t))}let u=`lt${Date.now()}${this.loadTestFontId++}`,d=this._loadTestFont;d=r(d,976,u.length,u);let f=1482184792,p=n(d,16);for(i=0,a=u.length-3;i<a;i+=4)p=p-f+n(u,i)|0;i<u.length&&(p=p-f+n(u+`XXX`,i)|0),d=r(d,16,4,Pr(p));let m=`url(data:font/opentype;base64,${btoa(d)});`,h=`@font-face {font-family:"${u}";src:${m}}`;this.insertRule(h);let g=this._document.createElement(`div`);g.style.visibility=`hidden`,g.style.width=g.style.height=`10px`,g.style.position=`absolute`,g.style.top=g.style.left=`0px`;for(let t of[e.loadedName,u]){let e=this._document.createElement(`span`);e.textContent=`Hi`,e.style.fontFamily=t,g.append(e)}this._document.body.append(g),l(u,()=>{g.remove(),t.complete()})}},Qi=class{#fontData;constructor(e,t=null,n,r){this.compiledGlyphs=Object.create(null),this.#fontData=e,this._inspectFont=t,n&&Object.assign(this,n),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{let t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;let e=`url(data:${this.mimetype};base64,${qr(this.data)});`,t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];let n=this.loadedName+`_path_`+t,r;try{r=e.get(n)}catch(e){vr(`getPathGenerator - ignoring character: "${e}".`)}let i=new Path2D(r||``);return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=i}get black(){return this.#fontData.black}get bold(){return this.#fontData.bold}get disableFontFace(){return this.#fontData.disableFontFace??!1}get fontExtraProperties(){return this.#fontData.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#fontData.isInvalidPDFjsFont}get isType3Font(){return this.#fontData.isType3Font}get italic(){return this.#fontData.italic}get missingFile(){return this.#fontData.missingFile}get remeasure(){return this.#fontData.remeasure}get vertical(){return this.#fontData.vertical}get ascent(){return this.#fontData.ascent}get defaultWidth(){return this.#fontData.defaultWidth}get descent(){return this.#fontData.descent}get bbox(){return this.#fontData.bbox}get fontMatrix(){return this.#fontData.fontMatrix}get fallbackName(){return this.#fontData.fallbackName}get loadedName(){return this.#fontData.loadedName}get mimetype(){return this.#fontData.mimetype}get name(){return this.#fontData.name}get data(){return this.#fontData.data}clearData(){this.#fontData.clearData()}get cssFontInfo(){return this.#fontData.cssFontInfo}get systemFontInfo(){return this.#fontData.systemFontInfo}get defaultVMetrics(){return this.#fontData.defaultVMetrics}};function $i(e){if(e instanceof URL)return e.href;if(typeof e==`string`){if(Zn)return e;let t=URL.parse(e,window.location);if(t)return t.href}throw Error(`Invalid PDF url data: either string or URL-object is expected in the url property.`)}function ea(e){if(Zn&&typeof Buffer<`u`&&e instanceof Buffer)throw Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e==`string`)return Nr(e);if(e instanceof ArrayBuffer||ArrayBuffer.isView(e)||typeof e==`object`&&!isNaN(e?.length))return new Uint8Array(e);throw Error(`Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.`)}function ta(e){if(typeof e!=`string`)return null;if(e.endsWith(`/`))return e;throw Error(`Invalid factory url: "${e}" must include trailing slash.`)}var na=e=>typeof e==`object`&&Number.isInteger(e?.num)&&e.num>=0&&Number.isInteger(e?.gen)&&e.gen>=0,ra=Gr.bind(null,na,e=>typeof e==`object`&&typeof e?.name==`string`),ia=class{#listeners=new Map;#deferred=Promise.resolve();postMessage(e,t){let n={data:structuredClone(e,t?{transfer:t}:null)};this.#deferred.then(()=>{for(let[e]of this.#listeners)e.call(this,n)})}addEventListener(e,t,n=null){let r=null;if(n?.signal instanceof AbortSignal){let{signal:i}=n;if(i.aborted){vr("LoopbackPort - cannot use an `aborted` signal.");return}let a=()=>this.removeEventListener(e,t);r=()=>i.removeEventListener(`abort`,a),i.addEventListener(`abort`,a)}this.#listeners.set(t,r)}removeEventListener(e,t){this.#listeners.get(t)?.(),this.#listeners.delete(t)}terminate(){for(let[,e]of this.#listeners)e?.();this.#listeners.clear()}},aa={DATA:1,ERROR:2},oa={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function sa(){}function ca(e){if(e instanceof jr||e instanceof Or||e instanceof Er||e instanceof kr||e instanceof Dr)return e;switch(e instanceof Error||typeof e==`object`&&e||yr(`wrapReason: Expected "reason" to be a (possibly cloned) Error.`),e.name){case`AbortException`:return new jr(e.message);case`InvalidPDFException`:return new Or(e.message);case`PasswordException`:return new Er(e.message,e.code);case`ResponseException`:return new kr(e.message,e.status,e.missing);case`UnknownErrorException`:return new Dr(e.message,e.details)}return new Dr(e.message,e.toString())}var la=class{#messageAC=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener(`message`,this.#onMessage.bind(this),{signal:this.#messageAC.signal})}#onMessage({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#processStreamMessage(e);return}if(e.callback){let t=e.callbackId,n=this.callbackCapabilities[t];if(!n)throw Error(`Cannot resolve callback ${t}`);if(delete this.callbackCapabilities[t],e.callback===aa.DATA)n.resolve(e.data);else if(e.callback===aa.ERROR)n.reject(ca(e.reason));else throw Error(`Unexpected callback case`);return}let t=this.actionHandler[e.action];if(!t)throw Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){let n=this.sourceName,r=e.sourceName,i=this.comObj;Promise.try(t,e.data).then(function(t){i.postMessage({sourceName:n,targetName:r,callback:aa.DATA,callbackId:e.callbackId,data:t})},function(t){i.postMessage({sourceName:n,targetName:r,callback:aa.ERROR,callbackId:e.callbackId,reason:ca(t)})});return}if(e.streamId){this.#createStreamSink(e);return}t(e.data)}on(e,t){let n=this.actionHandler;if(n[e])throw Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){let r=this.callbackId++,i=Promise.withResolvers();this.callbackCapabilities[r]=i;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(e){i.reject(e)}return i.promise}sendWithStream(e,t,n,r){let i=this.streamId++,a=this.sourceName,o=this.targetName,s=this.comObj;return new ReadableStream({start:n=>{let c=Promise.withResolvers();return this.streamControllers[i]={controller:n,startCall:c,pullCall:null,cancelCall:null,isClosed:!1},s.postMessage({sourceName:a,targetName:o,action:e,streamId:i,data:t,desiredSize:n.desiredSize},r),c.promise},pull:e=>{let t=Promise.withResolvers();return this.streamControllers[i].pullCall=t,s.postMessage({sourceName:a,targetName:o,stream:oa.PULL,streamId:i,desiredSize:e.desiredSize}),t.promise},cancel:e=>{br(e instanceof Error,`cancel must have a valid reason`);let t=Promise.withResolvers();return this.streamControllers[i].cancelCall=t,this.streamControllers[i].isClosed=!0,s.postMessage({sourceName:a,targetName:o,stream:oa.CANCEL,streamId:i,reason:ca(e)}),t.promise}},n)}#createStreamSink(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,a=this,o=this.actionHandler[e.action],s={enqueue(e,a=1,o){if(this.isCancelled)return;let s=this.desiredSize;this.desiredSize-=a,s>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),i.postMessage({sourceName:n,targetName:r,stream:oa.ENQUEUE,streamId:t,chunk:e},o)},close(){this.isCancelled||(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:oa.CLOSE,streamId:t}),delete a.streamSinks[t])},error(e){br(e instanceof Error,`error must have a valid reason`),!this.isCancelled&&(this.isCancelled=!0,i.postMessage({sourceName:n,targetName:r,stream:oa.ERROR,streamId:t,reason:ca(e)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};s.sinkCapability.resolve(),s.ready=s.sinkCapability.promise,this.streamSinks[t]=s,Promise.try(o,e.data,s).then(function(){i.postMessage({sourceName:n,targetName:r,stream:oa.START_COMPLETE,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:r,stream:oa.START_COMPLETE,streamId:t,reason:ca(e)})})}#processStreamMessage(e){let t=e.streamId,n=this.sourceName,r=e.sourceName,i=this.comObj,a=this.streamControllers[t],o=this.streamSinks[t];switch(e.stream){case oa.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(ca(e.reason));break;case oa.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(ca(e.reason));break;case oa.PULL:if(!o){i.postMessage({sourceName:n,targetName:r,stream:oa.PULL_COMPLETE,streamId:t,success:!0});break}o.desiredSize<=0&&e.desiredSize>0&&o.sinkCapability.resolve(),o.desiredSize=e.desiredSize,Promise.try(o.onPull||sa).then(function(){i.postMessage({sourceName:n,targetName:r,stream:oa.PULL_COMPLETE,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:r,stream:oa.PULL_COMPLETE,streamId:t,reason:ca(e)})});break;case oa.ENQUEUE:if(br(a,`enqueue should have stream controller`),a.isClosed)break;a.controller.enqueue(e.chunk);break;case oa.CLOSE:if(br(a,`close should have stream controller`),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#deleteStreamController(a,t);break;case oa.ERROR:br(a,`error should have stream controller`),a.controller.error(ca(e.reason)),this.#deleteStreamController(a,t);break;case oa.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(ca(e.reason)),this.#deleteStreamController(a,t);break;case oa.CANCEL:if(!o)break;let s=ca(e.reason);Promise.try(o.onCancel||sa,s).then(function(){i.postMessage({sourceName:n,targetName:r,stream:oa.CANCEL_COMPLETE,streamId:t,success:!0})},function(e){i.postMessage({sourceName:n,targetName:r,stream:oa.CANCEL_COMPLETE,streamId:t,reason:ca(e)})}),o.sinkCapability.reject(s),o.isCancelled=!0,delete this.streamSinks[t];break;default:throw Error(`Unexpected stream case`)}}async#deleteStreamController(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#messageAC?.abort(),this.#messageAC=null}},ua=class{#enableHWA=!1;constructor({enableHWA:e=!1}){this.#enableHWA=e}create(e,t){if(e<=0||t<=0)throw Error(`Invalid canvas size`);let n=this._createCanvas(e,t);return{canvas:n,context:n.getContext(`2d`,{willReadFrequently:!this.#enableHWA})}}reset(e,t,n){if(!e.canvas)throw Error(`Canvas is not specified`);if(t<=0||n<=0)throw Error(`Invalid canvas size`);e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw Error(`Canvas is not specified`);e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){yr("Abstract method `_createCanvas` called.")}},da=class extends ua{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){let n=this._document.createElement(`canvas`);return n.width=e,n.height=t,n}},fa=class{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw Error(`CMap name must be specified.`);let t=this.baseUrl+e+(this.isCompressed?`.bcmap`:``);return this._fetch(t).then(e=>({cMapData:e,isCompressed:this.isCompressed})).catch(e=>{throw Error(`Unable to load ${this.isCompressed?`binary `:``}CMap at: ${t}`)})}async _fetch(e){yr("Abstract method `_fetch` called.")}},pa=class extends fa{async _fetch(e){let t=await $r(e,this.isCompressed?`arraybuffer`:`text`);return t instanceof ArrayBuffer?new Uint8Array(t):Nr(t)}},ma=class{addFilter(e){return`none`}addHCMFilter(e,t){return`none`}addAlphaFilter(e){return`none`}addLuminosityFilter(e){return`none`}addHighlightHCMFilter(e,t,n,r,i){return`none`}destroy(e=!1){}},ha=class extends ma{#baseUrl;#_cache;#_defs;#docId;#document;#_hcmCache;#id=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#docId=e,this.#document=t}get#cache(){return this.#_cache||=new Map}get#hcmCache(){return this.#_hcmCache||=new Map}get#defs(){if(!this.#_defs){let e=this.#document.createElement(`div`),{style:t}=e;t.visibility=`hidden`,t.contain=`strict`,t.width=t.height=0,t.position=`absolute`,t.top=t.left=0,t.zIndex=-1;let n=this.#document.createElementNS(Zr,`svg`);n.setAttribute(`width`,0),n.setAttribute(`height`,0),this.#_defs=this.#document.createElementNS(Zr,`defs`),e.append(n),n.append(this.#_defs),this.#document.body.append(e)}return this.#_defs}#createTables(e){if(e.length===1){let t=e[0],n=Array(256);for(let e=0;e<256;e++)n[e]=t[e]/255;let r=n.join(`,`);return[r,r,r]}let[t,n,r]=e,i=Array(256),a=Array(256),o=Array(256);for(let e=0;e<256;e++)i[e]=t[e]/255,a[e]=n[e]/255,o[e]=r[e]/255;return[i.join(`,`),a.join(`,`),o.join(`,`)]}#createUrl(e){if(this.#baseUrl===void 0){this.#baseUrl=``;let e=this.#document.URL;e!==this.#document.baseURI&&(ni(e)?vr(`#createUrl: ignore "data:"-URL for performance reasons.`):this.#baseUrl=Cr(e,``))}return`url(${this.#baseUrl}#${e})`}addFilter(e){if(!e)return`none`;let t=this.#cache.get(e);if(t)return t;let[n,r,i]=this.#createTables(e),a=e.length===1?n:`${n}${r}${i}`;if(t=this.#cache.get(a),t)return this.#cache.set(e,t),t;let o=`g_${this.#docId}_transfer_map_${this.#id++}`,s=this.#createUrl(o);this.#cache.set(e,s),this.#cache.set(a,s);let c=this.#createFilter(o);return this.#addTransferMapConversion(n,r,i,c),s}addHCMFilter(e,t){let n=`${e}-${t}`,r=`base`,i=this.#hcmCache.get(r);if(i?.key===n||(i?(i.filter?.remove(),i.key=n,i.url=`none`,i.filter=null):(i={key:n,url:`none`,filter:null},this.#hcmCache.set(r,i)),!e||!t))return i.url;let a=this.#getRGB(e);e=Z.makeHexColor(...a);let o=this.#getRGB(t);if(t=Z.makeHexColor(...o),this.#defs.style.color=``,e===`#000000`&&t===`#ffffff`||e===t)return i.url;let s=Array(256);for(let e=0;e<=255;e++){let t=e/255;s[e]=t<=.03928?t/12.92:((t+.055)/1.055)**2.4}let c=s.join(`,`),l=`g_${this.#docId}_hcm_filter`,u=i.filter=this.#createFilter(l);this.#addTransferMapConversion(c,c,c,u),this.#addGrayConversion(u);let d=(e,t)=>{let n=a[e]/255,r=o[e]/255,i=Array(t+1);for(let e=0;e<=t;e++)i[e]=n+e/t*(r-n);return i.join(`,`)};return this.#addTransferMapConversion(d(0,5),d(1,5),d(2,5),u),i.url=this.#createUrl(l),i.url}addAlphaFilter(e){let t=this.#cache.get(e);if(t)return t;let[n]=this.#createTables([e]),r=`alpha_${n}`;if(t=this.#cache.get(r),t)return this.#cache.set(e,t),t;let i=`g_${this.#docId}_alpha_map_${this.#id++}`,a=this.#createUrl(i);this.#cache.set(e,a),this.#cache.set(r,a);let o=this.#createFilter(i);return this.#addTransferMapAlphaConversion(n,o),a}addLuminosityFilter(e){let t=this.#cache.get(e||`luminosity`);if(t)return t;let n,r;if(e?([n]=this.#createTables([e]),r=`luminosity_${n}`):r=`luminosity`,t=this.#cache.get(r),t)return this.#cache.set(e,t),t;let i=`g_${this.#docId}_luminosity_map_${this.#id++}`,a=this.#createUrl(i);this.#cache.set(e,a),this.#cache.set(r,a);let o=this.#createFilter(i);return this.#addLuminosityConversion(o),e&&this.#addTransferMapAlphaConversion(n,o),a}addHighlightHCMFilter(e,t,n,r,i){let a=`${t}-${n}-${r}-${i}`,o=this.#hcmCache.get(e);if(o?.key===a||(o?(o.filter?.remove(),o.key=a,o.url=`none`,o.filter=null):(o={key:a,url:`none`,filter:null},this.#hcmCache.set(e,o)),!t||!n))return o.url;let[s,c]=[t,n].map(this.#getRGB.bind(this)),l=Math.round(.2126*s[0]+.7152*s[1]+.0722*s[2]),u=Math.round(.2126*c[0]+.7152*c[1]+.0722*c[2]),[d,f]=[r,i].map(this.#getRGB.bind(this));u<l&&([l,u,d,f]=[u,l,f,d]),this.#defs.style.color=``;let p=(e,t,n)=>{let r=Array(256),i=(u-l)/n,a=e/255,o=(t-e)/(255*n),s=0;for(let e=0;e<=n;e++){let t=Math.round(l+e*i),n=a+e*o;for(let e=s;e<=t;e++)r[e]=n;s=t+1}for(let e=s;e<256;e++)r[e]=r[s-1];return r.join(`,`)},m=`g_${this.#docId}_hcm_${e}_filter`,h=o.filter=this.#createFilter(m);return this.#addGrayConversion(h),this.#addTransferMapConversion(p(d[0],f[0],5),p(d[1],f[1],5),p(d[2],f[2],5),h),o.url=this.#createUrl(m),o.url}destroy(e=!1){e&&this.#_hcmCache?.size||(this.#_defs?.parentNode.parentNode.remove(),this.#_defs=null,this.#_cache?.clear(),this.#_cache=null,this.#_hcmCache?.clear(),this.#_hcmCache=null,this.#id=0)}#addLuminosityConversion(e){let t=this.#document.createElementNS(Zr,`feColorMatrix`);t.setAttribute(`type`,`matrix`),t.setAttribute(`values`,`0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0`),e.append(t)}#addGrayConversion(e){let t=this.#document.createElementNS(Zr,`feColorMatrix`);t.setAttribute(`type`,`matrix`),t.setAttribute(`values`,`0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0`),e.append(t)}#createFilter(e){let t=this.#document.createElementNS(Zr,`filter`);return t.setAttribute(`color-interpolation-filters`,`sRGB`),t.setAttribute(`id`,e),this.#defs.append(t),t}#appendFeFunc(e,t,n){let r=this.#document.createElementNS(Zr,t);r.setAttribute(`type`,`discrete`),r.setAttribute(`tableValues`,n),e.append(r)}#addTransferMapConversion(e,t,n,r){let i=this.#document.createElementNS(Zr,`feComponentTransfer`);r.append(i),this.#appendFeFunc(i,`feFuncR`,e),this.#appendFeFunc(i,`feFuncG`,t),this.#appendFeFunc(i,`feFuncB`,n)}#addTransferMapAlphaConversion(e,t){let n=this.#document.createElementNS(Zr,`feComponentTransfer`);t.append(n),this.#appendFeFunc(n,`feFuncA`,e)}#getRGB(e){return this.#defs.style.color=e,pi(getComputedStyle(this.#defs).getPropertyValue(`color`))}},ga=class{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw Error(`Font filename must be specified.`);let t=`${this.baseUrl}${e}`;return this._fetch(t).catch(e=>{throw Error(`Unable to load font data at: ${t}`)})}async _fetch(e){yr("Abstract method `_fetch` called.")}},_a=class extends ga{async _fetch(e){let t=await $r(e,`arraybuffer`);return new Uint8Array(t)}},va=class{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw Error(`Wasm filename must be specified.`);let t=`${this.baseUrl}${e}`;return this._fetch(t).catch(e=>{throw Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){yr("Abstract method `_fetch` called.")}},ya=class extends va{async _fetch(e){let t=await $r(e,`arraybuffer`);return new Uint8Array(t)}};Zn&&vr("Please use the `legacy` build in Node.js environments.");async function ba(e){let t=await process.getBuiltinModule(`fs`).promises.readFile(e);return new Uint8Array(t)}var xa=class extends ma{},Sa=class extends ua{_createCanvas(e,t){return process.getBuiltinModule(`module`).createRequire(import.meta.url)(`@napi-rs/canvas`).createCanvas(e,t)}},Ca=class extends fa{async _fetch(e){return ba(e)}},wa=class extends ga{async _fetch(e){return ba(e)}},Ta=class extends va{async _fetch(e){return ba(e)}},Ea=`__forcedDependency`,{floor:Da,ceil:Oa}=Math;function ka(e,t,n,r,i,a){e[t*4+0]=Math.min(e[t*4+0],n),e[t*4+1]=Math.min(e[t*4+1],r),e[t*4+2]=Math.max(e[t*4+2],i),e[t*4+3]=Math.max(e[t*4+3],a)}var Aa=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0],ja=class{#bboxes;#coords;constructor(e,t){this.#bboxes=e,this.#coords=t}get length(){return this.#bboxes.length}isEmpty(e){return this.#bboxes[e]===Aa}minX(e){return this.#coords[e*4+0]/256}minY(e){return this.#coords[e*4+1]/256}maxX(e){return(this.#coords[e*4+2]+1)/256}maxY(e){return(this.#coords[e*4+3]+1)/256}},Ma=(e,t)=>{if(!e)return;let n=e.get(t);return n||(n={dependencies:new Set,isRenderingOperation:!1},e.set(t,n)),n},Na=class{#simple={__proto__:null};#incremental={__proto__:null,transform:[],moveText:[],sameLineText:[],[Ea]:[]};#namedDependencies=new Map;#savesStack=[];#markedContentStack=[];#baseTransformStack=[[1,0,0,1,0,0]];#clipBox=[-1/0,-1/0,1/0,1/0];#pendingBBox=new Float64Array([1/0,1/0,-1/0,-1/0]);#pendingBBoxIdx=-1;#pendingDependencies=new Set;#operations=new Map;#fontBBoxTrustworthy=new Map;#canvasWidth;#canvasHeight;#bboxesCoords;#bboxes;#debugMetadata;constructor(e,t,n=!1){this.#canvasWidth=e.width,this.#canvasHeight=e.height,this.#initializeBBoxes(t),n&&(this.#debugMetadata=new Map)}growOperationsCount(e){e>=this.#bboxes.length&&this.#initializeBBoxes(e,this.#bboxes)}#initializeBBoxes(e,t){let n=new ArrayBuffer(e*4);this.#bboxesCoords=new Uint8ClampedArray(n),this.#bboxes=new Uint32Array(n),t&&t.length>0?(this.#bboxes.set(t),this.#bboxes.fill(Aa,t.length)):this.#bboxes.fill(Aa)}save(e){return this.#simple={__proto__:this.#simple},this.#incremental={__proto__:this.#incremental,transform:{__proto__:this.#incremental.transform},moveText:{__proto__:this.#incremental.moveText},sameLineText:{__proto__:this.#incremental.sameLineText},[Ea]:{__proto__:this.#incremental[Ea]}},this.#clipBox={__proto__:this.#clipBox},this.#savesStack.push(e),this}restore(e){let t=Object.getPrototypeOf(this.#simple);if(t===null)return this;this.#simple=t,this.#incremental=Object.getPrototypeOf(this.#incremental),this.#clipBox=Object.getPrototypeOf(this.#clipBox);let n=this.#savesStack.pop();return n!==void 0&&(Ma(this.#debugMetadata,e)?.dependencies.add(n),this.#bboxes[e]=this.#bboxes[n]),this}recordOpenMarker(e){return this.#savesStack.push(e),this}getOpenMarker(){return this.#savesStack.length===0?null:this.#savesStack.at(-1)}recordCloseMarker(e){let t=this.#savesStack.pop();return t!==void 0&&(Ma(this.#debugMetadata,e)?.dependencies.add(t),this.#bboxes[e]=this.#bboxes[t]),this}beginMarkedContent(e){return this.#markedContentStack.push(e),this}endMarkedContent(e){let t=this.#markedContentStack.pop();return t!==void 0&&(Ma(this.#debugMetadata,e)?.dependencies.add(t),this.#bboxes[e]=this.#bboxes[t]),this}pushBaseTransform(e){return this.#baseTransformStack.push(Z.multiplyByDOMMatrix(this.#baseTransformStack.at(-1),e.getTransform())),this}popBaseTransform(){return this.#baseTransformStack.length>1&&this.#baseTransformStack.pop(),this}recordSimpleData(e,t){return this.#simple[e]=t,this}recordIncrementalData(e,t){return this.#incremental[e].push(t),this}resetIncrementalData(e,t){return this.#incremental[e].length=0,this}recordNamedData(e,t){return this.#namedDependencies.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#simple[e]=this.#namedDependencies.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Ea,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(let t of e)t in this.#simple&&this.recordFutureForcedDependency(t,this.#simple[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(let e of this.#pendingDependencies)this.recordFutureForcedDependency(Ea,e);return this}resetBBox(e){return this.#pendingBBoxIdx!==e&&(this.#pendingBBoxIdx=e,this.#pendingBBox[0]=1/0,this.#pendingBBox[1]=1/0,this.#pendingBBox[2]=-1/0,this.#pendingBBox[3]=-1/0),this}recordClipBox(e,t,n,r,i,a){let o=Z.multiplyByDOMMatrix(this.#baseTransformStack.at(-1),t.getTransform()),s=[1/0,1/0,-1/0,-1/0];Z.axialAlignedBoundingBox([n,i,r,a],o,s);let c=Z.intersect(this.#clipBox,s);return c?(this.#clipBox[0]=c[0],this.#clipBox[1]=c[1],this.#clipBox[2]=c[2],this.#clipBox[3]=c[3]):(this.#clipBox[0]=this.#clipBox[1]=1/0,this.#clipBox[2]=this.#clipBox[3]=-1/0),this}recordBBox(e,t,n,r,i,a){let o=this.#clipBox;if(o[0]===1/0)return this;let s=Z.multiplyByDOMMatrix(this.#baseTransformStack.at(-1),t.getTransform());if(o[0]===-1/0)return Z.axialAlignedBoundingBox([n,i,r,a],s,this.#pendingBBox),this;let c=[1/0,1/0,-1/0,-1/0];return Z.axialAlignedBoundingBox([n,i,r,a],s,c),this.#pendingBBox[0]=Math.min(this.#pendingBBox[0],Math.max(c[0],o[0])),this.#pendingBBox[1]=Math.min(this.#pendingBBox[1],Math.max(c[1],o[1])),this.#pendingBBox[2]=Math.max(this.#pendingBBox[2],Math.min(c[2],o[2])),this.#pendingBBox[3]=Math.max(this.#pendingBBox[3],Math.min(c[3],o[3])),this}recordCharacterBBox(e,t,n,r=1,i=0,a=0,o){let s=n.bbox,c,l;if(s&&(c=s[2]!==s[0]&&s[3]!==s[1]&&this.#fontBBoxTrustworthy.get(n),c!==!1&&(l=[0,0,0,0],Z.axialAlignedBoundingBox(s,n.fontMatrix,l),(r!==1||i!==0||a!==0)&&Z.scaleMinMax([r,0,0,-r,i,a],l),c)))return this.recordBBox(e,t,l[0],l[2],l[1],l[3]);if(!o)return this.recordFullPageBBox(e);let u=o();return s&&l&&c===void 0&&(c=l[0]<=i-u.actualBoundingBoxLeft&&l[2]>=i+u.actualBoundingBoxRight&&l[1]<=a-u.actualBoundingBoxAscent&&l[3]>=a+u.actualBoundingBoxDescent,this.#fontBBoxTrustworthy.set(n,c),c)?this.recordBBox(e,t,l[0],l[2],l[1],l[3]):this.recordBBox(e,t,i-u.actualBoundingBoxLeft,i+u.actualBoundingBoxRight,a-u.actualBoundingBoxAscent,a+u.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#pendingBBox[0]=Math.max(0,this.#clipBox[0]),this.#pendingBBox[1]=Math.max(0,this.#clipBox[1]),this.#pendingBBox[2]=Math.min(this.#canvasWidth,this.#clipBox[2]),this.#pendingBBox[3]=Math.min(this.#canvasHeight,this.#clipBox[3]),this}getSimpleIndex(e){return this.#simple[e]}recordDependencies(e,t){let n=this.#pendingDependencies,r=this.#simple,i=this.#incremental;for(let e of t)e in this.#simple?n.add(r[e]):e in i&&i[e].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#namedDependencies.has(t)&&this.#pendingDependencies.add(this.#namedDependencies.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Ea]),this.#debugMetadata){let t=Ma(this.#debugMetadata,e),{dependencies:n}=t;this.#pendingDependencies.forEach(n.add,n),this.#savesStack.forEach(n.add,n),this.#markedContentStack.forEach(n.add,n),n.delete(e),t.isRenderingOperation=!0}if(this.#pendingBBoxIdx===e){let n=Da(this.#pendingBBox[0]*256/this.#canvasWidth),r=Da(this.#pendingBBox[1]*256/this.#canvasHeight),i=Oa(this.#pendingBBox[2]*256/this.#canvasWidth),a=Oa(this.#pendingBBox[3]*256/this.#canvasHeight);ka(this.#bboxesCoords,e,n,r,i,a);for(let t of this.#pendingDependencies)t!==e&&ka(this.#bboxesCoords,t,n,r,i,a);for(let t of this.#savesStack)t!==e&&ka(this.#bboxesCoords,t,n,r,i,a);for(let t of this.#markedContentStack)t!==e&&ka(this.#bboxesCoords,t,n,r,i,a);t||(this.#pendingDependencies.clear(),this.#pendingBBoxIdx=-1)}return this}recordShowTextOperation(e,t=!1){let n=Array.from(this.#pendingDependencies);this.recordOperation(e,t),this.recordIncrementalData(`sameLineText`,e);for(let e of n)this.recordIncrementalData(`sameLineText`,e);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#pendingBBoxIdx===e&&(this.#pendingBBoxIdx=-1,this.#clipBox[0]=Math.max(this.#clipBox[0],this.#pendingBBox[0]),this.#clipBox[1]=Math.max(this.#clipBox[1],this.#pendingBBox[1]),this.#clipBox[2]=Math.min(this.#clipBox[2],this.#pendingBBox[2]),this.#clipBox[3]=Math.min(this.#clipBox[3],this.#pendingBBox[3]),t||this.#pendingDependencies.clear()),this}_takePendingDependencies(){let e=this.#pendingDependencies;return this.#pendingDependencies=new Set,e}_extractOperation(e){let t=this.#operations.get(e);return this.#operations.delete(e),t}_pushPendingDependencies(e){for(let t of e)this.#pendingDependencies.add(t)}take(){return this.#fontBBoxTrustworthy.clear(),new ja(this.#bboxes,this.#bboxesCoords)}takeDebugMetadata(){return this.#debugMetadata}},Pa=class e{#dependencyTracker;#opIdx;#ignoreBBoxes;#nestingLevel=0;#savesLevel=0;constructor(t,n,r){if(t instanceof e&&t.#ignoreBBoxes===!!r)return t;this.#dependencyTracker=t,this.#opIdx=n,this.#ignoreBBoxes=!!r}growOperationsCount(){throw Error(`Unreachable`)}save(e){return this.#savesLevel++,this.#dependencyTracker.save(this.#opIdx),this}restore(e){return this.#savesLevel>0&&(this.#dependencyTracker.restore(this.#opIdx),this.#savesLevel--),this}recordOpenMarker(e){return this.#nestingLevel++,this}getOpenMarker(){return this.#nestingLevel>0?this.#opIdx:this.#dependencyTracker.getOpenMarker()}recordCloseMarker(e){return this.#nestingLevel--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#dependencyTracker.pushBaseTransform(e),this}popBaseTransform(){return this.#dependencyTracker.popBaseTransform(),this}recordSimpleData(e,t){return this.#dependencyTracker.recordSimpleData(e,this.#opIdx),this}recordIncrementalData(e,t){return this.#dependencyTracker.recordIncrementalData(e,this.#opIdx),this}resetIncrementalData(e,t){return this.#dependencyTracker.resetIncrementalData(e,this.#opIdx),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#dependencyTracker.recordSimpleDataFromNamed(e,t,this.#opIdx),this}recordFutureForcedDependency(e,t){return this.#dependencyTracker.recordFutureForcedDependency(e,this.#opIdx),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#dependencyTracker.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#dependencyTracker.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#ignoreBBoxes||this.#dependencyTracker.resetBBox(this.#opIdx),this}recordClipBox(e,t,n,r,i,a){return this.#ignoreBBoxes||this.#dependencyTracker.recordClipBox(this.#opIdx,t,n,r,i,a),this}recordBBox(e,t,n,r,i,a){return this.#ignoreBBoxes||this.#dependencyTracker.recordBBox(this.#opIdx,t,n,r,i,a),this}recordCharacterBBox(e,t,n,r,i,a,o){return this.#ignoreBBoxes||this.#dependencyTracker.recordCharacterBBox(this.#opIdx,t,n,r,i,a,o),this}recordFullPageBBox(e){return this.#ignoreBBoxes||this.#dependencyTracker.recordFullPageBBox(this.#opIdx),this}getSimpleIndex(e){return this.#dependencyTracker.getSimpleIndex(e)}recordDependencies(e,t){return this.#dependencyTracker.recordDependencies(this.#opIdx,t),this}recordNamedDependency(e,t){return this.#dependencyTracker.recordNamedDependency(this.#opIdx,t),this}recordOperation(e){return this.#dependencyTracker.recordOperation(this.#opIdx,!0),this}recordShowTextOperation(e){return this.#dependencyTracker.recordShowTextOperation(this.#opIdx,!0),this}bboxToClipBoxDropOperation(e){return this.#ignoreBBoxes||this.#dependencyTracker.bboxToClipBoxDropOperation(this.#opIdx,!0),this}take(){throw Error(`Unreachable`)}takeDebugMetadata(){throw Error(`Unreachable`)}},Fa={stroke:[`path`,`transform`,`filter`,`strokeColor`,`strokeAlpha`,`lineWidth`,`lineCap`,`lineJoin`,`miterLimit`,`dash`],fill:[`path`,`transform`,`filter`,`fillColor`,`fillAlpha`,`globalCompositeOperation`,`SMask`],imageXObject:[`transform`,`SMask`,`filter`,`fillAlpha`,`strokeAlpha`,`globalCompositeOperation`],rawFillPath:[`filter`,`fillColor`,`fillAlpha`],showText:[`transform`,`leading`,`charSpacing`,`wordSpacing`,`hScale`,`textRise`,`moveText`,`textMatrix`,`font`,`fontObj`,`filter`,`fillColor`,`textRenderingMode`,`SMask`,`fillAlpha`,`strokeAlpha`,`globalCompositeOperation`,`sameLineText`],transform:[`transform`],transformAndFill:[`transform`,`fillColor`]},Ia={FILL:`Fill`,STROKE:`Stroke`,SHADING:`Shading`};function La(e,t){if(!t)return;let n=t[2]-t[0],r=t[3]-t[1],i=new Path2D;i.rect(t[0],t[1],n,r),e.clip(i)}var Ra=class{isModifyingCurrentTransform(){return!1}getPattern(){yr("Abstract method `getPattern` called.")}},za=class extends Ra{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type===`axial`?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type===`radial`&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(let e of this._colorStops)t.addColorStop(e[0],e[1]);return t}getPattern(e,t,n,r){let i;if(r===Ia.STROKE||r===Ia.FILL){let a=t.current.getClippedPathBoundingBox(r,hi(e))||[0,0,0,0],o=Math.ceil(a[2]-a[0])||1,s=Math.ceil(a[3]-a[1])||1,c=t.cachedCanvases.getCanvas(`pattern`,o,s),l=c.context;l.clearRect(0,0,l.canvas.width,l.canvas.height),l.beginPath(),l.rect(0,0,l.canvas.width,l.canvas.height),l.translate(-a[0],-a[1]),n=Z.transform(n,[1,0,0,1,a[0],a[1]]),l.transform(...t.baseTransform),this.matrix&&l.transform(...this.matrix),La(l,this._bbox),l.fillStyle=this._createGradient(l),l.fill(),i=e.createPattern(c.canvas,`no-repeat`);let u=new DOMMatrix(n);i.setTransform(u)}else La(e,this._bbox),i=this._createGradient(e);return i}};function Ba(e,t,n,r,i,a,o,s){let c=t.coords,l=t.colors,u=e.data,d=e.width*4,f;c[n+1]>c[r+1]&&(f=n,n=r,r=f,f=a,a=o,o=f),c[r+1]>c[i+1]&&(f=r,r=i,i=f,f=o,o=s,s=f),c[n+1]>c[r+1]&&(f=n,n=r,r=f,f=a,a=o,o=f);let p=(c[n]+t.offsetX)*t.scaleX,m=(c[n+1]+t.offsetY)*t.scaleY,h=(c[r]+t.offsetX)*t.scaleX,g=(c[r+1]+t.offsetY)*t.scaleY,_=(c[i]+t.offsetX)*t.scaleX,v=(c[i+1]+t.offsetY)*t.scaleY;if(m>=v)return;let y=l[a],b=l[a+1],x=l[a+2],S=l[o],C=l[o+1],w=l[o+2],T=l[s],E=l[s+1],D=l[s+2],O=Math.round(m),k=Math.round(v),A,j,M,N,P,F,I,L;for(let e=O;e<=k;e++){if(e<g){let t=e<m?0:(m-e)/(m-g);A=p-(p-h)*t,j=y-(y-S)*t,M=b-(b-C)*t,N=x-(x-w)*t}else{let t;t=e>v?1:g===v?0:(g-e)/(g-v),A=h-(h-_)*t,j=S-(S-T)*t,M=C-(C-E)*t,N=w-(w-D)*t}let t;t=e<m?0:e>v?1:(m-e)/(m-v),P=p-(p-_)*t,F=y-(y-T)*t,I=b-(b-E)*t,L=x-(x-D)*t;let n=Math.round(Math.min(A,P)),r=Math.round(Math.max(A,P)),i=d*e+n*4;for(let e=n;e<=r;e++)t=(A-e)/(A-P),t<0?t=0:t>1&&(t=1),u[i++]=j-(j-F)*t|0,u[i++]=M-(M-I)*t|0,u[i++]=N-(N-L)*t|0,u[i++]=255}}function Va(e,t,n){let r=t.coords,i=t.colors,a,o;switch(t.type){case`lattice`:let s=t.verticesPerRow,c=Math.floor(r.length/s)-1,l=s-1;for(a=0;a<c;a++){let t=a*s;for(let a=0;a<l;a++,t++)Ba(e,n,r[t],r[t+1],r[t+s],i[t],i[t+1],i[t+s]),Ba(e,n,r[t+s+1],r[t+1],r[t+s],i[t+s+1],i[t+1],i[t+s])}break;case`triangles`:for(a=0,o=r.length;a<o;a+=3)Ba(e,n,r[a],r[a+1],r[a+2],i[a],i[a+1],i[a+2]);break;default:throw Error(`illegal figure`)}}var Ha=class extends Ra{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){let r=1.1,i=3e3,a=Math.floor(this._bounds[0]),o=Math.floor(this._bounds[1]),s=Math.ceil(this._bounds[2])-a,c=Math.ceil(this._bounds[3])-o,l=Math.min(Math.ceil(Math.abs(s*e[0]*r)),i),u=Math.min(Math.ceil(Math.abs(c*e[1]*r)),i),d=s/l,f=c/u,p={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-o,scaleX:1/d,scaleY:1/f},m=l+4,h=u+4,g=n.getCanvas(`mesh`,m,h),_=g.context,v=_.createImageData(l,u);if(t){let e=v.data;for(let n=0,r=e.length;n<r;n+=4)e[n]=t[0],e[n+1]=t[1],e[n+2]=t[2],e[n+3]=255}for(let e of this._figures)Va(v,e,p);return _.putImageData(v,2,2),{canvas:g.canvas,offsetX:a-2*d,offsetY:o-2*f,scaleX:d,scaleY:f}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,r){La(e,this._bbox);let i=new Float32Array(2);if(r===Ia.SHADING)Z.singularValueDecompose2dScale(hi(e),i);else if(this.matrix){Z.singularValueDecompose2dScale(this.matrix,i);let[e,n]=i;Z.singularValueDecompose2dScale(t.baseTransform,i),i[0]*=e,i[1]*=n}else Z.singularValueDecompose2dScale(t.baseTransform,i);let a=this._createMeshCanvas(i,r===Ia.SHADING?null:this._background,t.cachedCanvases);return r!==Ia.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,`no-repeat`)}},Ua=class extends Ra{getPattern(){return`hotpink`}};function Wa(e){switch(e[0]){case`RadialAxial`:return new za(e);case`Mesh`:return new Ha(e);case`Dummy`:return new Ua}throw Error(`Unknown IR type: ${e[0]}`)}var Ga={COLORED:1,UNCOLORED:2},Ka=class e{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,r){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=r}createPatternCanvas(e,t){let{bbox:n,operatorList:r,paintType:i,tilingType:a,color:o,canvasGraphicsFactory:s}=this,{xstep:c,ystep:l}=this;c=Math.abs(c),l=Math.abs(l),_r(`TilingType: `+a);let u=n[0],d=n[1],f=n[2],p=n[3],m=f-u,h=p-d,g=new Float32Array(2);Z.singularValueDecompose2dScale(this.matrix,g);let[_,v]=g;Z.singularValueDecompose2dScale(this.baseTransform,g);let y=_*g[0],b=v*g[1],x=m,S=h,C=!1,w=!1,T=Math.ceil(c*y),E=Math.ceil(l*b),D=Math.ceil(m*y),O=Math.ceil(h*b);T>=D?x=c:C=!0,E>=O?S=l:w=!0;let k=this.getSizeAndScale(x,this.ctx.canvas.width,y),A=this.getSizeAndScale(S,this.ctx.canvas.height,b),j=e.cachedCanvases.getCanvas(`pattern`,k.size,A.size),M=j.context,N=s.createCanvasGraphics(M,t);if(N.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(N,i,o),M.translate(-k.scale*u,-A.scale*d),N.transform(0,k.scale,0,0,A.scale,0,0),M.save(),N.dependencyTracker?.save(),this.clipBbox(N,u,d,f,p),N.baseTransform=hi(N.ctx),N.executeOperatorList(r),N.endDrawing(),N.dependencyTracker?.restore(),M.restore(),C||w){let t=j.canvas;C&&(x=c),w&&(S=l);let n=this.getSizeAndScale(x,this.ctx.canvas.width,y),r=this.getSizeAndScale(S,this.ctx.canvas.height,b),i=n.size,a=r.size,o=e.cachedCanvases.getCanvas(`pattern-workaround`,i,a),s=o.context,f=C?Math.floor(m/c):0,p=w?Math.floor(h/l):0;for(let e=0;e<=f;e++)for(let n=0;n<=p;n++)s.drawImage(t,i*e,a*n,i,a,0,0,i,a);return{canvas:o.canvas,scaleX:n.scale,scaleY:r.scale,offsetX:u,offsetY:d}}return{canvas:j.canvas,scaleX:k.scale,scaleY:A.scale,offsetX:u,offsetY:d}}getSizeAndScale(t,n,r){let i=Math.max(e.MAX_PATTERN_SIZE,n),a=Math.ceil(t*r);return a>=i?a=i:r=a/t,{scale:r,size:a}}clipBbox(e,t,n,r,i){let a=r-t,o=i-n;e.ctx.rect(t,n,a,o),Z.axialAlignedBoundingBox([t,n,r,i],hi(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){let r=e.ctx,i=e.current;switch(t){case Ga.COLORED:let{fillStyle:e,strokeStyle:a}=this.ctx;r.fillStyle=i.fillColor=e,r.strokeStyle=i.strokeColor=a;break;case Ga.UNCOLORED:r.fillStyle=r.strokeStyle=n,i.fillColor=i.strokeColor=n;break;default:throw new Ar(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,r,i){let a=n;r!==Ia.SHADING&&(a=Z.transform(a,t.baseTransform),this.matrix&&(a=Z.transform(a,this.matrix)));let o=this.createPatternCanvas(t,i),s=new DOMMatrix(a);s=s.translate(o.offsetX,o.offsetY),s=s.scale(1/o.scaleX,1/o.scaleY);let c=e.createPattern(o.canvas,`repeat`);return c.setTransform(s),c}};function qa({src:e,srcPos:t=0,dest:n,width:r,height:i,nonBlackColor:a=4294967295,inverseDecode:o=!1}){let s=Lr.isLittleEndian?4278190080:255,[c,l]=o?[a,s]:[s,a],u=r>>3,d=r&7,f=e.length;n=new Uint32Array(n.buffer);let p=0;for(let r=0;r<i;r++){for(let r=t+u;t<r;t++){let r=t<f?e[t]:255;n[p++]=r&128?l:c,n[p++]=r&64?l:c,n[p++]=r&32?l:c,n[p++]=r&16?l:c,n[p++]=r&8?l:c,n[p++]=r&4?l:c,n[p++]=r&2?l:c,n[p++]=r&1?l:c}if(d===0)continue;let r=t<f?e[t++]:255;for(let e=0;e<d;e++)n[p++]=r&1<<7-e?l:c}return{srcPos:t,destPos:p}}var Ja=16,Ya=100,Xa=15,Za=10,Qa=16,$a=new DOMMatrix,eo=new Float32Array(2),to=new Float32Array([1/0,1/0,-1/0,-1/0]);function no(e,t){if(e._removeMirroring)throw Error(`Context is already forwarding operations.`);e.__originalSave=e.save,e.__originalRestore=e.restore,e.__originalRotate=e.rotate,e.__originalScale=e.scale,e.__originalTranslate=e.translate,e.__originalTransform=e.transform,e.__originalSetTransform=e.setTransform,e.__originalResetTransform=e.resetTransform,e.__originalClip=e.clip,e.__originalMoveTo=e.moveTo,e.__originalLineTo=e.lineTo,e.__originalBezierCurveTo=e.bezierCurveTo,e.__originalRect=e.rect,e.__originalClosePath=e.closePath,e.__originalBeginPath=e.beginPath,e._removeMirroring=()=>{e.save=e.__originalSave,e.restore=e.__originalRestore,e.rotate=e.__originalRotate,e.scale=e.__originalScale,e.translate=e.__originalTranslate,e.transform=e.__originalTransform,e.setTransform=e.__originalSetTransform,e.resetTransform=e.__originalResetTransform,e.clip=e.__originalClip,e.moveTo=e.__originalMoveTo,e.lineTo=e.__originalLineTo,e.bezierCurveTo=e.__originalBezierCurveTo,e.rect=e.__originalRect,e.closePath=e.__originalClosePath,e.beginPath=e.__originalBeginPath,delete e._removeMirroring},e.save=function(){t.save(),this.__originalSave()},e.restore=function(){t.restore(),this.__originalRestore()},e.translate=function(e,n){t.translate(e,n),this.__originalTranslate(e,n)},e.scale=function(e,n){t.scale(e,n),this.__originalScale(e,n)},e.transform=function(e,n,r,i,a,o){t.transform(e,n,r,i,a,o),this.__originalTransform(e,n,r,i,a,o)},e.setTransform=function(e,n,r,i,a,o){t.setTransform(e,n,r,i,a,o),this.__originalSetTransform(e,n,r,i,a,o)},e.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},e.rotate=function(e){t.rotate(e),this.__originalRotate(e)},e.clip=function(e){t.clip(e),this.__originalClip(e)},e.moveTo=function(e,n){t.moveTo(e,n),this.__originalMoveTo(e,n)},e.lineTo=function(e,n){t.lineTo(e,n),this.__originalLineTo(e,n)},e.bezierCurveTo=function(e,n,r,i,a,o){t.bezierCurveTo(e,n,r,i,a,o),this.__originalBezierCurveTo(e,n,r,i,a,o)},e.rect=function(e,n,r,i){t.rect(e,n,r,i),this.__originalRect(e,n,r,i)},e.closePath=function(){t.closePath(),this.__originalClosePath()},e.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}var ro=class{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let r;return this.cache[e]===void 0?(r=this.canvasFactory.create(t,n),this.cache[e]=r):(r=this.cache[e],this.canvasFactory.reset(r,t,n)),r}delete(e){delete this.cache[e]}clear(){for(let e in this.cache){let t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}};function io(e,t,n,r,i,a,o,s,c,l){let[u,d,f,p,m,h]=hi(e);if(d===0&&f===0){let g=o*u+m,_=Math.round(g),v=s*p+h,y=Math.round(v),b=(o+c)*u+m,x=Math.abs(Math.round(b)-_)||1,S=(s+l)*p+h,C=Math.abs(Math.round(S)-y)||1;return e.setTransform(Math.sign(u),0,0,Math.sign(p),_,y),e.drawImage(t,n,r,i,a,0,0,x,C),e.setTransform(u,d,f,p,m,h),[x,C]}if(u===0&&p===0){let g=s*f+m,_=Math.round(g),v=o*d+h,y=Math.round(v),b=(s+l)*f+m,x=Math.abs(Math.round(b)-_)||1,S=(o+c)*d+h,C=Math.abs(Math.round(S)-y)||1;return e.setTransform(0,Math.sign(d),Math.sign(f),0,_,y),e.drawImage(t,n,r,i,a,0,0,C,x),e.setTransform(u,d,f,p,m,h),[C,x]}e.drawImage(t,n,r,i,a,o,s,c,l);let g=Math.hypot(u,d),_=Math.hypot(f,p);return[g*c,_*l]}var ao=class{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Qn;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=or.FILL;textRise=0;fillColor=`#000000`;strokeColor=`#000000`;patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps=`none`;constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=to.slice()}clone(){let e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=Ia.FILL,t=null){let n=this.minMax.slice();if(e===Ia.STROKE){t||yr(`Stroke bounding box must include transform.`),Z.singularValueDecompose2dScale(t,eo);let e=eo[0]*this.lineWidth/2,r=eo[1]*this.lineWidth/2;n[0]-=e,n[1]-=r,n[2]+=e,n[3]+=r}return n}updateClipFromPath(){let e=Z.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(to,0)}getClippedPathBoundingBox(e=Ia.FILL,t=null){return Z.intersect(this.clipBox,this.getPathBoundingBox(e,t))}};function oo(e,t){if(t instanceof ImageData){e.putImageData(t,0,0);return}let n=t.height,r=t.width,i=n%Qa,a=(n-i)/Qa,o=i===0?a:a+1,s=e.createImageData(r,Qa),c=0,l,u=t.data,d=s.data,f,p,m,h;if(t.kind===sr.GRAYSCALE_1BPP){let t=u.byteLength,n=new Uint32Array(d.buffer,0,d.byteLength>>2),h=n.length,g=r+7>>3,_=4294967295,v=Lr.isLittleEndian?4278190080:255;for(f=0;f<o;f++){for(m=f<a?Qa:i,l=0,p=0;p<m;p++){let e=t-c,i=0,a=e>g?r:e*8-7,o=a&-8,s=0,d=0;for(;i<o;i+=8)d=u[c++],n[l++]=d&128?_:v,n[l++]=d&64?_:v,n[l++]=d&32?_:v,n[l++]=d&16?_:v,n[l++]=d&8?_:v,n[l++]=d&4?_:v,n[l++]=d&2?_:v,n[l++]=d&1?_:v;for(;i<a;i++)s===0&&(d=u[c++],s=128),n[l++]=d&s?_:v,s>>=1}for(;l<h;)n[l++]=0;e.putImageData(s,0,f*Qa)}}else if(t.kind===sr.RGBA_32BPP){for(p=0,h=r*Qa*4,f=0;f<a;f++)d.set(u.subarray(c,c+h)),c+=h,e.putImageData(s,0,p),p+=Qa;f<o&&(h=r*i*4,d.set(u.subarray(c,c+h)),e.putImageData(s,0,p))}else if(t.kind===sr.RGB_24BPP)for(m=Qa,h=r*m,f=0;f<o;f++){for(f>=a&&(m=i,h=r*m),l=0,p=h;p--;)d[l++]=u[c++],d[l++]=u[c++],d[l++]=u[c++],d[l++]=255;e.putImageData(s,0,f*Qa)}else throw Error(`bad image kind: ${t.kind}`)}function so(e,t){if(t.bitmap){e.drawImage(t.bitmap,0,0);return}let n=t.height,r=t.width,i=n%Qa,a=(n-i)/Qa,o=i===0?a:a+1,s=e.createImageData(r,Qa),c=0,l=t.data,u=s.data;for(let t=0;t<o;t++){let n=t<a?Qa:i;({srcPos:c}=qa({src:l,srcPos:c,dest:u,width:r,height:n,nonBlackColor:0})),e.putImageData(s,0,t*Qa)}}function co(e,t){for(let n of[`strokeStyle`,`fillStyle`,`fillRule`,`globalAlpha`,`lineWidth`,`lineCap`,`lineJoin`,`miterLimit`,`globalCompositeOperation`,`font`,`filter`])e[n]!==void 0&&(t[n]=e[n]);e.setLineDash!==void 0&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function lo(e){e.strokeStyle=e.fillStyle=`#000000`,e.fillRule=`nonzero`,e.globalAlpha=1,e.lineWidth=1,e.lineCap=`butt`,e.lineJoin=`miter`,e.miterLimit=10,e.globalCompositeOperation=`source-over`,e.font=`10px sans-serif`,e.setLineDash!==void 0&&(e.setLineDash([]),e.lineDashOffset=0);let{filter:t}=e;t!==`none`&&t!==``&&(e.filter=`none`)}function uo(e,t){if(t)return!0;Z.singularValueDecompose2dScale(e,eo);let n=Math.fround(vi.pixelRatio*Qr.PDF_TO_CSS_UNITS);return eo[0]<=n&&eo[1]<=n}var fo=[`butt`,`round`,`square`],po=[`miter`,`round`,`bevel`],mo={},ho={},go=class e{constructor(e,t,n,r,i,{optionalContentConfig:a,markedContentStack:o=null},s,c,l){this.ctx=e,this.current=new ao(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=r,this.filterFactory=i,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=o||[],this.optionalContentConfig=a,this.cachedCanvases=new ro(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=s,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=c,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=l??null}getObject(e,t,n=null){return typeof t==`string`?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith(`g_`)?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:r=null}){let i=this.ctx.canvas.width,a=this.ctx.canvas.height,o=this.ctx.fillStyle;if(this.ctx.fillStyle=r||`#ffffff`,this.ctx.fillRect(0,0,i,a),this.ctx.fillStyle=o,n){let e=this.cachedCanvases.getCanvas(`transparent`,i,a);this.compositeCtx=this.ctx,this.transparentCanvas=e.canvas,this.ctx=e.context,this.ctx.save(),this.ctx.transform(...hi(this.compositeCtx))}this.ctx.save(),lo(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=hi(this.ctx)}executeOperatorList(e,t,n,r,i){let a=e.argsArray,o=e.fnArray,s=t||0,c=a.length;if(c===s)return s;let l=c-s>Za&&typeof n==`function`,u=l?Date.now()+Xa:0,d=0,f=this.commonObjs,p=this.objs,m,h;for(;;){if(r!==void 0&&s===r.nextBreakPoint)return r.breakIt(s,n),s;if(!i||i(s))if(m=o[s],h=a[s]??null,m!==dr.dependency)h===null?this[m](s):this[m](s,...h);else for(let e of h){this.dependencyTracker?.recordNamedData(e,s);let t=e.startsWith(`g_`)?f:p;if(!t.has(e))return t.get(e,n),s}if(s++,s===c)return s;if(l&&++d>Za){if(Date.now()>u)return n(),s;d=0}}}#restoreInitialState(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&=(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),null)}endDrawing(){this.#restoreInitialState(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(let e of this._cachedBitmapsMap.values()){for(let t of e.values())typeof HTMLCanvasElement<`u`&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#drawFilter()}#drawFilter(){if(this.pageColors){let e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!==`none`){let t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){let n=e.width??e.displayWidth,r=e.height??e.displayHeight,i=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),o=n,s=r,c=`prescale1`,l,u;for(;i>2&&o>1||a>2&&s>1;){let t=o,n=s;i>2&&o>1&&(t=o>=16384?Math.floor(o/2)-1||1:Math.ceil(o/2),i/=o/t),a>2&&s>1&&(n=s>=16384?Math.floor(s/2)-1||1:Math.ceil(s)/2,a/=s/n),l=this.cachedCanvases.getCanvas(c,t,n),u=l.context,u.clearRect(0,0,t,n),u.drawImage(e,0,0,o,s,0,0,t,n),e=l.canvas,o=t,s=n,c=c===`prescale1`?`prescale2`:`prescale1`}return{img:e,paintWidth:o,paintHeight:s}}_createMaskCanvas(e,t){let n=this.ctx,{width:r,height:i}=t,a=this.current.fillColor,o=this.current.patternFill,s=hi(n),c,l,u,d;if((t.bitmap||t.data)&&t.count>1){let n=t.bitmap||t.data.buffer;l=JSON.stringify(o?s:[s.slice(0,4),a]),c=this._cachedBitmapsMap.get(n),c||(c=new Map,this._cachedBitmapsMap.set(n,c));let r=c.get(l);if(r&&!o){let t=Math.round(Math.min(s[0],s[2])+s[4]),n=Math.round(Math.min(s[1],s[3])+s[5]);return this.dependencyTracker?.recordDependencies(e,Fa.transformAndFill),{canvas:r,offsetX:t,offsetY:n}}u=r}u||(d=this.cachedCanvases.getCanvas(`maskCanvas`,r,i),so(d.context,t));let f=Z.transform(s,[1/r,0,0,-1/i,0,0]);f=Z.transform(f,[1,0,0,1,0,-i]);let p=to.slice();Z.axialAlignedBoundingBox([0,0,r,i],f,p);let[m,h,g,_]=p,v=Math.round(g-m)||1,y=Math.round(_-h)||1,b=this.cachedCanvases.getCanvas(`fillCanvas`,v,y),x=b.context,S=m,C=h;x.translate(-S,-C),x.transform(...f),u||(u=this._scaleImage(d.canvas,gi(x)),u=u.img,c&&o&&c.set(l,u)),x.imageSmoothingEnabled=uo(hi(x),t.interpolate),io(x,u,0,0,u.width,u.height,0,0,r,i),x.globalCompositeOperation=`source-in`;let w=Z.transform(gi(x),[1,0,0,1,-S,-C]);return x.fillStyle=o?a.getPattern(n,this,w,Ia.FILL,e):a,x.fillRect(0,0,r,i),c&&!o&&(this.cachedCanvases.delete(`fillCanvas`),c.set(l,b.canvas)),this.dependencyTracker?.recordDependencies(e,Fa.transformAndFill),{canvas:b.canvas,offsetX:Math.round(S),offsetY:Math.round(C)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData(`lineWidth`,e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData(`lineCap`,e),this.ctx.lineCap=fo[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData(`lineJoin`,e),this.ctx.lineJoin=po[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData(`miterLimit`,e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData(`dash`,e);let r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(t),r.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(let[n,r]of t)switch(n){case`LW`:this.setLineWidth(e,r);break;case`LC`:this.setLineCap(e,r);break;case`LJ`:this.setLineJoin(e,r);break;case`ML`:this.setMiterLimit(e,r);break;case`D`:this.setDash(e,r[0],r[1]);break;case`RI`:this.setRenderingIntent(e,r);break;case`FL`:this.setFlatness(e,r);break;case`Font`:this.setFont(e,r[0],r[1]);break;case`CA`:this.dependencyTracker?.recordSimpleData(`strokeAlpha`,e),this.current.strokeAlpha=r;break;case`ca`:this.dependencyTracker?.recordSimpleData(`fillAlpha`,e),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case`BM`:this.dependencyTracker?.recordSimpleData(`globalCompositeOperation`,e),this.ctx.globalCompositeOperation=r;break;case`SMask`:this.dependencyTracker?.recordSimpleData(`SMask`,e),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case`TR`:this.dependencyTracker?.recordSimpleData(`filter`,e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){let e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw Error(`beginSMaskMode called while already in smask mode`);let t=this.ctx.canvas.width,n=this.ctx.canvas.height,r=`smaskGroupAt`+this.groupLevel,i=this.cachedCanvases.getCanvas(r,t,n);this.suspendedCtx=this.ctx;let a=this.ctx=i.context;a.setTransform(this.suspendedCtx.getTransform()),co(this.suspendedCtx,a),no(a,this.suspendedCtx),this.setGState(e,[[`BM`,`source-over`]])}endSMaskMode(){if(!this.inSMaskMode)throw Error(`endSMaskMode called while not in smask mode`);this.ctx._removeMirroring(),co(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];let t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,r){let i=r[0],a=r[1],o=r[2]-i,s=r[3]-a;o===0||s===0||(this.genericComposeSMask(t.context,n,o,s,t.subtype,t.backdrop,t.transferMap,i,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation=`source-over`,e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,r,i,a,o,s,c,l,u){let d=e.canvas,f=s-l,p=c-u;if(a)if(f<0||p<0||f+n>d.width||p+r>d.height){let e=this.cachedCanvases.getCanvas(`maskExtension`,n,r),t=e.context;t.drawImage(d,-f,-p),t.globalCompositeOperation=`destination-atop`,t.fillStyle=a,t.fillRect(0,0,n,r),t.globalCompositeOperation=`source-over`,d=e.canvas,f=p=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);let t=new Path2D;t.rect(f,p,n,r),e.clip(t),e.globalCompositeOperation=`destination-atop`,e.fillStyle=a,e.fillRect(f,p,n,r),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),i===`Alpha`&&o?t.filter=this.filterFactory.addAlphaFilter(o):i===`Luminosity`&&(t.filter=this.filterFactory.addLuminosityFilter(o));let m=new Path2D;m.rect(s,c,n,r),t.clip(m),t.globalCompositeOperation=`destination-in`,t.drawImage(d,f,p,n,r,s,c,n,r),t.restore()}save(e){this.inSMaskMode&&co(this.ctx,this.suspendedCtx),this.ctx.save();let t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&co(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,r,i,a,o){this.dependencyTracker?.recordIncrementalData(`transform`,e),this.ctx.transform(t,n,r,i,a,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,r){let[i]=n;if(!r){i||=n[0]=new Path2D,this[t](e,i);return}if(this.dependencyTracker!==null){let n=t===dr.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,r[0]-n,r[2]+n,r[1]-n,r[3]+n).recordDependencies(e,[`transform`])}if(!(i instanceof Path2D)){let e=n[0]=new Path2D;for(let t=0,n=i.length;t<n;)switch(i[t++]){case fr.moveTo:e.moveTo(i[t++],i[t++]);break;case fr.lineTo:e.lineTo(i[t++],i[t++]);break;case fr.curveTo:e.bezierCurveTo(i[t++],i[t++],i[t++],i[t++],i[t++],i[t++]);break;case fr.closePath:e.closePath();break;default:vr(`Unrecognized drawing path operator: ${i[t-1]}`);break}i=e}Z.axialAlignedBoundingBox(r,hi(this.ctx),this.current.minMax),this[t](e,i),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){let r=this.ctx,i=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i==`object`&&i?.getPattern){let n=i.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=i.getPattern(r,this,gi(r),Ia.STROKE,e),n){let e=new Path2D;e.addPath(t,r.getTransform().invertSelf().multiplySelf(n)),t=e}this.rescaleAndStroke(t,!1),r.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Fa.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(Ia.STROKE,hi(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){let r=this.ctx,i=this.current.fillColor,a=this.current.patternFill,o=!1;if(a){let n=i.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(e),r.save(),r.fillStyle=i.getPattern(r,this,gi(r),Ia.FILL,e),n){let e=new Path2D;e.addPath(t,r.getTransform().invertSelf().multiplySelf(n)),t=e}o=!0}let s=this.current.getClippedPathBoundingBox();this.contentVisible&&s!==null&&(this.pendingEOFill?(r.fill(t,`evenodd`),this.pendingEOFill=!1):r.fill(t)),this.dependencyTracker?.recordDependencies(e,Fa.fill),o&&(r.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,s)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Fa.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency(`clipMode`,e),this.pendingClip=mo}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency(`clipMode`,e),this.pendingClip=ho}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData(`sameLineText`).resetIncrementalData(`moveText`,e)}endText(e){let t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){let{dependencyTracker:n}=this;t!==void 0&&n.recordFutureForcedDependency(`textClip`,n.getOpenMarker()).recordFutureForcedDependency(`textClip`,e),n.recordCloseMarker(e)}if(t!==void 0){let e=new Path2D,r=n.getTransform().invertSelf();for(let{transform:n,x:i,y:a,fontSize:o,path:s}of t)s&&e.addPath(s,new DOMMatrix(n).preMultiplySelf(r).translate(i,a).scale(o,-o));n.clip(e)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData(`charSpacing`,e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData(`wordSpacing`,e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData(`hScale`,e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData(`leading`,e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData(`font`,e).recordSimpleDataFromNamed(`fontObj`,t,e);let r=this.commonObjs.get(t),i=this.current;if(!r)throw Error(`Can't find font for ${t}`);if(i.fontMatrix=r.fontMatrix||Qn,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&vr(`Invalid font matrix for font `+t),n<0?(n=-n,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=n,r.isType3Font)return;let a=r.loadedName||`sans-serif`,o=r.systemFontInfo?.css||`"${a}", ${r.fallbackName}`,s=`normal`;r.black?s=`900`:r.bold&&(s=`bold`);let c=r.italic?`italic`:`normal`,l=n;n<Ja?l=Ja:n>Ya&&(l=Ya),this.current.fontSizeScale=n/l,this.ctx.font=`${c} ${s} ${l}px ${o}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData(`textRenderingMode`,e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData(`textRise`,e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData(`sameLineText`).recordIncrementalData(`moveText`,e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.recordSimpleData(`textMatrix`,e);let{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData(`moveText`,this.dependencyTracker.getSimpleIndex(`leading`)??e)}#getScaledPath(e,t,n){let r=new Path2D;return r.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),r}paintChar(e,t,n,r,i,a){let o=this.ctx,s=this.current,c=s.font,l=s.textRenderingMode,u=s.fontSize/s.fontSizeScale,d=l&or.FILL_STROKE_MASK,f=!!(l&or.ADD_TO_PATH_FLAG),p=s.patternFill&&!c.missingFile,m=s.patternStroke&&!c.missingFile,h;if((c.disableFontFace||f||p||m)&&!c.missingFile&&(h=c.getPathGenerator(this.commonObjs,t)),h&&(c.disableFontFace||p||m)){o.save(),o.translate(n,r),o.scale(u,-u),this.dependencyTracker?.recordCharacterBBox(e,o,c);let t;if(d===or.FILL||d===or.FILL_STROKE)if(i){t=o.getTransform(),o.setTransform(...i);let e=this.#getScaledPath(h,t,i);o.fill(e)}else o.fill(h);if(d===or.STROKE||d===or.FILL_STROKE)if(a){t||=o.getTransform(),o.setTransform(...a);let{a:e,b:n,c:r,d:i}=t,s=Z.inverseTransform(a),c=Z.transform([e,n,r,i,0,0],s);Z.singularValueDecompose2dScale(c,eo),o.lineWidth*=Math.max(eo[0],eo[1])/u,o.stroke(this.#getScaledPath(h,t,a))}else o.lineWidth/=u,o.stroke(h);o.restore()}else (d===or.FILL||d===or.FILL_STROKE)&&(o.fillText(t,n,r),this.dependencyTracker?.recordCharacterBBox(e,o,c,u,n,r,()=>o.measureText(t))),(d===or.STROKE||d===or.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,o,c,u,n,r,()=>o.measureText(t)).recordDependencies(e,Fa.stroke),o.strokeText(t,n,r));f&&((this.pendingTextPaths||=[]).push({transform:hi(o),x:n,y:r,fontSize:u,path:h}),this.dependencyTracker?.recordCharacterBBox(e,o,c,u,n,r))}get isFontSubpixelAAEnabled(){let{context:e}=this.cachedCanvases.getCanvas(`isFontSubpixelAAEnabled`,10,10);e.scale(1.5,1),e.fillText(`I`,0,10);let t=e.getImageData(0,0,10,10).data,n=!1;for(let e=3;e<t.length;e+=4)if(t[e]>0&&t[e]<255){n=!0;break}return wr(this,`isFontSubpixelAAEnabled`,n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Fa.showText).resetBBox(e),this.current.textRenderingMode&or.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency(`textClip`,e).inheritPendingDependenciesAsFutureForcedDependencies());let n=this.current,r=n.font;if(r.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}let i=n.fontSize;if(i===0){this.dependencyTracker?.recordOperation(e);return}let a=this.ctx,o=n.fontSizeScale,s=n.charSpacing,c=n.wordSpacing,l=n.fontDirection,u=n.textHScale*l,d=t.length,f=r.vertical,p=f?1:-1,m=r.defaultVMetrics,h=i*n.fontMatrix[0],g=n.textRenderingMode===or.FILL&&!r.disableFontFace&&!n.patternFill;a.save(),n.textMatrix&&a.transform(...n.textMatrix),a.translate(n.x,n.y+n.textRise),l>0?a.scale(u,-1):a.scale(u,1);let _,v;if(n.patternFill){a.save();let t=n.fillColor.getPattern(a,this,gi(a),Ia.FILL,e);_=hi(a),a.restore(),a.fillStyle=t}if(n.patternStroke){a.save();let t=n.strokeColor.getPattern(a,this,gi(a),Ia.STROKE,e);v=hi(a),a.restore(),a.strokeStyle=t}let y=n.lineWidth,b=n.textMatrixScale;if(b===0||y===0){let e=n.textRenderingMode&or.FILL_STROKE_MASK;(e===or.STROKE||e===or.FILL_STROKE)&&(y=this.getSinglePixelWidth())}else y/=b;if(o!==1&&(a.scale(o,o),y/=o),a.lineWidth=y,r.isInvalidPDFjsFont){let r=[],i=0;for(let e of t)r.push(e.unicode),i+=e.width;let o=r.join(``);if(a.fillText(o,0,0),this.dependencyTracker!==null){let t=a.measureText(o);this.dependencyTracker.recordBBox(e,this.ctx,-t.actualBoundingBoxLeft,t.actualBoundingBoxRight,-t.actualBoundingBoxAscent,t.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=i*h*u,a.restore(),this.compose();return}let x=0,S;for(S=0;S<d;++S){let n=t[S];if(typeof n==`number`){x+=p*n*i/1e3;continue}let u=!1,d=(n.isSpace?c:0)+s,y=n.fontChar,b=n.accent,C,w,T=n.width;if(f){let e=n.vmetric||m,t=-(n.vmetric?e[1]:T*.5)*h,r=e[2]*h;T=e?-e[0]:T,C=t/o,w=(x+r)/o}else C=x/o,w=0;let E;if(r.remeasure&&T>0){E=a.measureText(y);let e=E.width*1e3/i*o;if(T<e&&this.isFontSubpixelAAEnabled){let t=T/e;u=!0,a.save(),a.scale(t,1),C/=t}else T!==e&&(C+=(T-e)/2e3*i/o)}if(this.contentVisible&&(n.isInFont||r.missingFile)){if(g&&!b)a.fillText(y,C,w),this.dependencyTracker?.recordCharacterBBox(e,a,E?{bbox:null}:r,i/o,C,w,()=>E??a.measureText(y));else if(this.paintChar(e,y,C,w,_,v),b){let t=C+i*b.offset.x/o,n=w-i*b.offset.y/o;this.paintChar(e,b.fontChar,t,n,_,v)}}let D=f?T*h-d*l:T*h+d*l;x+=D,u&&a.restore()}f?n.y-=x:n.x+=x*u,a.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){let n=this.ctx,r=this.current,i=r.font,a=r.fontSize,o=r.fontDirection,s=i.vertical?1:-1,c=r.charSpacing,l=r.wordSpacing,u=r.textHScale*o,d=r.fontMatrix||Qn,f=t.length,p=r.textRenderingMode===or.INVISIBLE,m,h,g,_;if(p||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),r.textMatrix&&n.transform(...r.textMatrix),n.translate(r.x,r.y+r.textRise),n.scale(u,o);let v=this.dependencyTracker;for(this.dependencyTracker=v?new Pa(v,e):null,m=0;m<f;++m){if(h=t[m],typeof h==`number`){_=s*h*a/1e3,this.ctx.translate(_,0),r.x+=_*u;continue}let e=(h.isSpace?l:0)+c,o=i.charProcOperatorList[h.operatorListId];o?this.contentVisible&&(this.save(),n.scale(a,a),n.transform(...d),this.executeOperatorList(o),this.restore()):vr(`Type3 character "${h.operatorListId}" is not available.`);let f=[h.width,0];Z.applyTransform(f,d),g=f[0]*a+e,n.translate(g,0),r.x+=g*u}n.restore(),v&&(this.dependencyTracker=v)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,r,i,a,o){let s=new Path2D;s.rect(r,i,a-r,o-i),this.ctx.clip(s),this.dependencyTracker?.recordBBox(e,this.ctx,r,a,i,o).recordClipBox(e,this.ctx,r,a,i,o),this.endPath(e)}getColorN_Pattern(t,n){let r;if(n[0]===`TilingPattern`){let t=this.baseTransform||hi(this.ctx);r=new Ka(n,this.ctx,{createCanvasGraphics:(t,n)=>new e(t,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Pa(this.dependencyTracker,n,!0):null)},t)}else r=this._getPattern(t,n[1],n[2]);return r}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData(`strokeColor`,e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData(`fillColor`,e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData(`strokeColor`,e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData(`strokeColor`,e),this.ctx.strokeStyle=this.current.strokeColor=`transparent`,this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData(`fillColor`,e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData(`fillColor`,e),this.ctx.fillStyle=this.current.fillColor=`transparent`,this.current.patternFill=!1}_getPattern(e,t,n=null){let r;return this.cachedPatterns.has(t)?r=this.cachedPatterns.get(t):(r=Wa(this.getObject(e,t)),this.cachedPatterns.set(t,r)),n&&(r.matrix=n),r}shadingFill(e,t){if(!this.contentVisible)return;let n=this.ctx;this.save(e),n.fillStyle=this._getPattern(e,t).getPattern(n,this,gi(n),Ia.SHADING,e);let r=gi(n);if(r){let{width:e,height:t}=n.canvas,i=to.slice();Z.axialAlignedBoundingBox([0,0,e,t],r,i);let[a,o,s,c]=i;this.ctx.fillRect(a,o,s-a,c-o)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Fa.transform).recordDependencies(e,Fa.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){yr(`Should not call beginInlineImage`)}beginImageData(){yr(`Should not call beginImageData`)}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=hi(this.ctx),n)){Z.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);let[t,r,i,a]=n,o=new Path2D;o.rect(t,r,i-t,a-r),this.ctx.clip(o),this.dependencyTracker?.recordClipBox(e,this.ctx,t,i,r,a),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);let n=this.ctx;t.isolated||_r(`TODO: Support non-isolated groups.`),t.knockout&&vr(`Knockout groups not supported.`);let r=hi(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw Error(`Bounding box is required.`);let i=to.slice();Z.axialAlignedBoundingBox(t.bbox,hi(n),i);let a=[0,0,n.canvas.width,n.canvas.height];i=Z.intersect(i,a)||[0,0,0,0];let o=Math.floor(i[0]),s=Math.floor(i[1]),c=Math.max(Math.ceil(i[2])-o,1),l=Math.max(Math.ceil(i[3])-s,1);this.current.startNewPathAndClipBox([0,0,c,l]);let u=`groupAt`+this.groupLevel;t.smask&&(u+=`_smask_`+ this.smaskCounter++%2);let d=this.cachedCanvases.getCanvas(u,c,l),f=d.context;f.translate(-o,-s),f.transform(...r);let p=new Path2D,[m,h,g,_]=t.bbox;if(p.rect(m,h,g-m,_-h),t.matrix){let e=new Path2D;e.addPath(p,new DOMMatrix(t.matrix)),p=e}f.clip(p),t.smask&&this.smaskStack.push({canvas:d.canvas,context:f,offsetX:o,offsetY:s,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(o,s),n.save()),co(n,f),this.ctx=f,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies([`fillAlpha`,`strokeAlpha`,`globalCompositeOperation`]).pushBaseTransform(n),this.setGState(e,[[`BM`,`source-over`],[`ca`,1],[`CA`,1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;let n=this.ctx;if(this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();let t=hi(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...t);let r=to.slice();Z.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],t,r),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,n,r,i,a){if(this.#restoreInitialState(),lo(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){let i=n[2]-n[0],o=n[3]-n[1];if(a&&this.annotationCanvasMap){r=r.slice(),r[4]-=n[0],r[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=i,n[3]=o,Z.singularValueDecompose2dScale(hi(this.ctx),eo);let{viewportScale:e}=this,a=Math.ceil(i*this.outputScaleX*e),s=Math.ceil(o*this.outputScaleY*e);this.annotationCanvas=this.canvasFactory.create(a,s);let{canvas:c,context:l}=this.annotationCanvas;this.annotationCanvasMap.set(t,c),this.annotationCanvas.savedCtx=this.ctx,this.ctx=l,this.ctx.save(),this.ctx.setTransform(eo[0],0,0,-eo[1],0,o*eo[1]),lo(this.ctx)}else{lo(this.ctx),this.endPath(e);let t=new Path2D;t.rect(n[0],n[1],i,o),this.ctx.clip(t)}}this.current=new ao(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...r),this.transform(e,...i)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#drawFilter(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;let n=t.count;t=this.getObject(e,t.data,t),t.count=n;let r=this.ctx,i=this._createMaskCanvas(e,t),a=i.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(a,i.offsetX,i.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,i.offsetX,i.offsetX+a.width,i.offsetY,i.offsetY+a.height).recordOperation(e),r.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,r=0,i=0,a,o){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);let s=this.ctx;s.save();let c=hi(s);s.transform(n,r,i,a,0,0);let l=this._createMaskCanvas(e,t);s.setTransform(1,0,0,1,l.offsetX-c[4],l.offsetY-c[5]),this.dependencyTracker?.resetBBox(e);for(let t=0,u=o.length;t<u;t+=2){let u=Z.transform(c,[n,r,i,a,o[t],o[t+1]]);s.drawImage(l.canvas,u[4],u[5]),this.dependencyTracker?.recordBBox(e,this.ctx,u[4],u[4]+l.canvas.width,u[5],u[5]+l.canvas.height)}s.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;let n=this.ctx,r=this.current.fillColor,i=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Fa.transformAndFill);for(let a of t){let{data:t,width:o,height:s,transform:c}=a,l=this.cachedCanvases.getCanvas(`maskCanvas`,o,s),u=l.context;u.save();let d=this.getObject(e,t,a);so(u,d),u.globalCompositeOperation=`source-in`,u.fillStyle=i?r.getPattern(u,this,gi(n),Ia.FILL,e):r,u.fillRect(0,0,o,s),u.restore(),n.save(),n.transform(...c),n.scale(1,-1),io(n,l.canvas,0,0,o,s,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,o,0,s),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;let n=this.getObject(e,t);if(!n){vr(`Dependent image isn't ready yet`);return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,r,i){if(!this.contentVisible)return;let a=this.getObject(e,t);if(!a){vr(`Dependent image isn't ready yet`);return}let o=a.width,s=a.height,c=[];for(let e=0,t=i.length;e<t;e+=2)c.push({transform:[n,0,0,r,i[e],i[e+1]],x:0,y:0,w:o,h:s});this.paintInlineImageXObjectGroup(e,a,c)}applyTransferMapsToCanvas(e){return this.current.transferMaps!==`none`&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter=`none`),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps===`none`)return e.bitmap;let{bitmap:t,width:n,height:r}=e,i=this.cachedCanvases.getCanvas(`inlineImage`,n,r),a=i.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter=`none`,i.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;let n=t.width,r=t.height,i=this.ctx;this.save(e);let{filter:a}=i;a!==`none`&&a!==``&&(i.filter=`none`),i.scale(1/n,-1/r);let o;if(t.bitmap)o=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement==`function`&&t instanceof HTMLElement||!t.data)o=t;else{let e=this.cachedCanvases.getCanvas(`inlineImage`,n,r).context;oo(e,t),o=this.applyTransferMapsToCanvas(e)}let s=this._scaleImage(o,gi(i));i.imageSmoothingEnabled=uo(hi(i),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,i,0,n,-r,0).recordDependencies(e,Fa.imageXObject).recordOperation(e),io(i,s.img,0,0,s.paintWidth,s.paintHeight,0,-r,n,r),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;let r=this.ctx,i;if(t.bitmap)i=t.bitmap;else{let e=t.width,n=t.height,r=this.cachedCanvases.getCanvas(`inlineImage`,e,n).context;oo(r,t),i=this.applyTransferMapsToCanvas(r)}this.dependencyTracker?.resetBBox(e);for(let t of n)r.save(),r.transform(...t.transform),r.scale(1,-1),io(r,i,t.x,t.y,t.w,t.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Fa.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t===`OC`?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){let r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);let i=this.ctx;this.pendingClip?(r||(this.pendingClip===ho?i.clip(t,`evenodd`):i.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency(`clipPath`,e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){let e=hi(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{let t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),r=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,r)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){let{lineWidth:e}=this.current,{a:t,b:n,c:r,d:i}=this.ctx.getTransform(),a,o;if(n===0&&r===0){let n=Math.abs(t),r=Math.abs(i);if(n===r)if(e===0)a=o=1/n;else{let t=n*e;a=o=t<1?1/t:1}else if(e===0)a=1/n,o=1/r;else{let t=n*e,i=r*e;a=t<1?1/t:1,o=i<1?1/i:1}}else{let s=Math.abs(t*i-n*r),c=Math.hypot(t,n),l=Math.hypot(r,i);if(e===0)a=l/s,o=c/s;else{let t=e*s;a=l>t?l/t:1,o=c>t?c/t:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=o}return this._cachedScaleForStroking}rescaleAndStroke(e,t){let{ctx:n,current:{lineWidth:r}}=this,[i,a]=this.getScaleForStroking();if(i===a){n.lineWidth=(r||1)*i,n.stroke(e);return}let o=n.getLineDash();t&&n.save(),n.scale(i,a),$a.a=1/i,$a.d=1/a;let s=new Path2D;if(s.addPath(e,$a),o.length>0){let e=Math.max(i,a);n.setLineDash(o.map(t=>t/e)),n.lineDashOffset/=e}n.lineWidth=r||1,n.stroke(s),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};for(let e in dr)go.prototype[e]!==void 0&&(go.prototype[dr[e]]=go.prototype[e]);var _o=class e{#buffer;#view;#decoder;static strings=[`fontFamily`,`fontWeight`,`italicAngle`];static write(t){let n=new TextEncoder,r={},i=0;for(let a of e.strings){let e=n.encode(t[a]);r[a]=e,i+=4+e.length}let a=new ArrayBuffer(i),o=new Uint8Array(a),s=new DataView(a),c=0;for(let t of e.strings){let e=r[t],n=e.length;s.setUint32(c,n),o.set(e,c+4),c+=4+n}return br(c===a.byteLength,`CssFontInfo.write: Buffer overflow`),a}constructor(e){this.#buffer=e,this.#view=new DataView(this.#buffer),this.#decoder=new TextDecoder}#readString(t){br(t<e.strings.length,`Invalid string index`);let n=0;for(let e=0;e<t;e++)n+=this.#view.getUint32(n)+4;let r=this.#view.getUint32(n);return this.#decoder.decode(new Uint8Array(this.#buffer,n+4,r))}get fontFamily(){return this.#readString(0)}get fontWeight(){return this.#readString(1)}get italicAngle(){return this.#readString(2)}},vo=class e{#buffer;#view;#decoder;static strings=[`css`,`loadedName`,`baseFontName`,`src`];static write(t){let n=new TextEncoder,r={},i=0;for(let a of e.strings){let e=n.encode(t[a]);r[a]=e,i+=4+e.length}i+=4;let a,o,s=1+i;t.style&&(a=n.encode(t.style.style),o=n.encode(t.style.weight),s+=4+a.length+4+o.length);let c=new ArrayBuffer(s),l=new Uint8Array(c),u=new DataView(c),d=0;u.setUint8(d++,t.guessFallback?1:0),u.setUint32(d,0),d+=4,i=0;for(let t of e.strings){let e=r[t],n=e.length;i+=4+n,u.setUint32(d,n),l.set(e,d+4),d+=4+n}return u.setUint32(d-i-4,i),t.style&&(u.setUint32(d,a.length),l.set(a,d+4),d+=4+a.length,u.setUint32(d,o.length),l.set(o,d+4),d+=4+o.length),br(d<=c.byteLength,`SubstitionInfo.write: Buffer overflow`),c.transferToFixedLength(d)}constructor(e){this.#buffer=e,this.#view=new DataView(this.#buffer),this.#decoder=new TextDecoder}get guessFallback(){return this.#view.getUint8(0)!==0}#readString(t){br(t<e.strings.length,`Invalid string index`);let n=5;for(let e=0;e<t;e++)n+=this.#view.getUint32(n)+4;let r=this.#view.getUint32(n);return this.#decoder.decode(new Uint8Array(this.#buffer,n+4,r))}get css(){return this.#readString(0)}get loadedName(){return this.#readString(1)}get baseFontName(){return this.#readString(2)}get src(){return this.#readString(3)}get style(){let e=1;e+=4+this.#view.getUint32(e);let t=this.#view.getUint32(e),n=this.#decoder.decode(new Uint8Array(this.#buffer,e+4,t));e+=4+t;let r=this.#view.getUint32(e),i=this.#decoder.decode(new Uint8Array(this.#buffer,e+4,r));return{style:n,weight:i}}},yo=class e{static bools=[`black`,`bold`,`disableFontFace`,`fontExtraProperties`,`isInvalidPDFjsFont`,`isType3Font`,`italic`,`missingFile`,`remeasure`,`vertical`];static numbers=[`ascent`,`defaultWidth`,`descent`];static strings=[`fallbackName`,`loadedName`,`mimetype`,`name`];static#OFFSET_NUMBERS=Math.ceil(this.bools.length*2/8);static#OFFSET_BBOX=this.#OFFSET_NUMBERS+this.numbers.length*8;static#OFFSET_FONT_MATRIX=this.#OFFSET_BBOX+1+8;static#OFFSET_DEFAULT_VMETRICS=this.#OFFSET_FONT_MATRIX+1+48;static#OFFSET_STRINGS=this.#OFFSET_DEFAULT_VMETRICS+1+6;#buffer;#decoder;#view;constructor({data:e,extra:t}){this.#buffer=e,this.#decoder=new TextDecoder,this.#view=new DataView(this.#buffer),t&&Object.assign(this,t)}#readBoolean(t){br(t<e.bools.length,`Invalid boolean index`);let n=Math.floor(t/4),r=t*2%8,i=this.#view.getUint8(n)>>r&3;return i===0?void 0:i===2}get black(){return this.#readBoolean(0)}get bold(){return this.#readBoolean(1)}get disableFontFace(){return this.#readBoolean(2)}get fontExtraProperties(){return this.#readBoolean(3)}get isInvalidPDFjsFont(){return this.#readBoolean(4)}get isType3Font(){return this.#readBoolean(5)}get italic(){return this.#readBoolean(6)}get missingFile(){return this.#readBoolean(7)}get remeasure(){return this.#readBoolean(8)}get vertical(){return this.#readBoolean(9)}#readNumber(t){return br(t<e.numbers.length,`Invalid number index`),this.#view.getFloat64(e.#OFFSET_NUMBERS+t*8)}get ascent(){return this.#readNumber(0)}get defaultWidth(){return this.#readNumber(1)}get descent(){return this.#readNumber(2)}get bbox(){let t=e.#OFFSET_BBOX;if(this.#view.getUint8(t)===0)return;t+=1;let n=[];for(let e=0;e<4;e++)n.push(this.#view.getInt16(t,!0)),t+=2;return n}get fontMatrix(){let t=e.#OFFSET_FONT_MATRIX;if(this.#view.getUint8(t)===0)return;t+=1;let n=[];for(let e=0;e<6;e++)n.push(this.#view.getFloat64(t,!0)),t+=8;return n}get defaultVMetrics(){let t=e.#OFFSET_DEFAULT_VMETRICS;if(this.#view.getUint8(t)===0)return;t+=1;let n=[];for(let e=0;e<3;e++)n.push(this.#view.getInt16(t,!0)),t+=2;return n}#readString(t){br(t<e.strings.length,`Invalid string index`);let n=e.#OFFSET_STRINGS+4;for(let e=0;e<t;e++)n+=this.#view.getUint32(n)+4;let r=this.#view.getUint32(n),i=new Uint8Array(r);return i.set(new Uint8Array(this.#buffer,n+4,r)),this.#decoder.decode(i)}get fallbackName(){return this.#readString(0)}get loadedName(){return this.#readString(1)}get mimetype(){return this.#readString(2)}get name(){return this.#readString(3)}get data(){let t=e.#OFFSET_STRINGS,n=this.#view.getUint32(t);t+=4+n;let r=this.#view.getUint32(t);t+=4+r;let i=this.#view.getUint32(t);t+=4+i;let a=this.#view.getUint32(t);if(a!==0)return new Uint8Array(this.#buffer,t+4,a)}clearData(){let t=e.#OFFSET_STRINGS,n=this.#view.getUint32(t);t+=4+n;let r=this.#view.getUint32(t);t+=4+r;let i=this.#view.getUint32(t);t+=4+i;let a=this.#view.getUint32(t);new Uint8Array(this.#buffer,t+4,a).fill(0),this.#view.setUint32(t,0)}get cssFontInfo(){let t=e.#OFFSET_STRINGS,n=this.#view.getUint32(t);t+=4+n;let r=this.#view.getUint32(t);t+=4+r;let i=this.#view.getUint32(t);if(i===0)return null;let a=new Uint8Array(i);return a.set(new Uint8Array(this.#buffer,t+4,i)),new _o(a.buffer)}get systemFontInfo(){let t=e.#OFFSET_STRINGS,n=this.#view.getUint32(t);t+=4+n;let r=this.#view.getUint32(t);if(r===0)return null;let i=new Uint8Array(r);return i.set(new Uint8Array(this.#buffer,t+4,r)),new vo(i.buffer)}static write(t){let n=t.systemFontInfo?vo.write(t.systemFontInfo):null,r=t.cssFontInfo?_o.write(t.cssFontInfo):null,i=new TextEncoder,a={},o=0;for(let n of e.strings)a[n]=i.encode(t[n]),o+=4+a[n].length;let s=e.#OFFSET_STRINGS+4+o+4+(n?n.byteLength:0)+4+(r?r.byteLength:0)+4+(t.data?t.data.length:0),c=new ArrayBuffer(s),l=new Uint8Array(c),u=new DataView(c),d=0,f=e.bools.length,p=0,m=0;for(let n=0;n<f;n++){let r=t[e.bools[n]];p|=(r===void 0?0:r?2:1)<<m,m+=2,(m===8||n===f-1)&&(u.setUint8(d++,p),p=0,m=0)}br(d===e.#OFFSET_NUMBERS,`FontInfo.write: Boolean properties offset mismatch`);for(let n of e.numbers)u.setFloat64(d,t[n]),d+=8;if(br(d===e.#OFFSET_BBOX,`FontInfo.write: Number properties offset mismatch`),t.bbox){u.setUint8(d++,4);for(let e of t.bbox)u.setInt16(d,e,!0),d+=2}else u.setUint8(d++,0),d+=8;if(br(d===e.#OFFSET_FONT_MATRIX,`FontInfo.write: BBox properties offset mismatch`),t.fontMatrix){u.setUint8(d++,6);for(let e of t.fontMatrix)u.setFloat64(d,e,!0),d+=8}else u.setUint8(d++,0),d+=48;if(br(d===e.#OFFSET_DEFAULT_VMETRICS,`FontInfo.write: FontMatrix properties offset mismatch`),t.defaultVMetrics){u.setUint8(d++,1);for(let e of t.defaultVMetrics)u.setInt16(d,e,!0),d+=2}else u.setUint8(d++,0),d+=6;br(d===e.#OFFSET_STRINGS,`FontInfo.write: DefaultVMetrics properties offset mismatch`),u.setUint32(e.#OFFSET_STRINGS,0),d+=4;for(let t of e.strings){let e=a[t],n=e.length;u.setUint32(d,n),l.set(e,d+4),d+=4+n}if(u.setUint32(e.#OFFSET_STRINGS,d-e.#OFFSET_STRINGS-4),!n)u.setUint32(d,0),d+=4;else{let e=n.byteLength;u.setUint32(d,e),br(d+4+e<=c.byteLength,`FontInfo.write: Buffer overflow at systemFontInfo`),l.set(new Uint8Array(n),d+4),d+=4+e}if(!r)u.setUint32(d,0),d+=4;else{let e=r.byteLength;u.setUint32(d,e),br(d+4+e<=c.byteLength,`FontInfo.write: Buffer overflow at cssFontInfo`),l.set(new Uint8Array(r),d+4),d+=4+e}return t.data===void 0?(u.setUint32(d,0),d+=4):(u.setUint32(d,t.data.length),l.set(t.data,d+4),d+=4+t.data.length),br(d<=c.byteLength,`FontInfo.write: Buffer overflow`),c.transferToFixedLength(d)}},bo=class{static#port=null;static#src=``;static get workerPort(){return this.#port}static set workerPort(e){if(!(typeof Worker<`u`&&e instanceof Worker)&&e!==null)throw Error("Invalid `workerPort` type.");this.#port=e}static get workerSrc(){return this.#src}static set workerSrc(e){if(typeof e!=`string`)throw Error("Invalid `workerSrc` type.");this.#src=e}},xo=class{#map;#data;constructor({parsedData:e,rawData:t}){this.#map=e,this.#data=t}getRaw(){return this.#data}get(e){return this.#map.get(e)??null}[Symbol.iterator](){return this.#map.entries()}},So=Symbol(`INTERNAL`),Co=class{#isDisplay=!1;#isPrint=!1;#userSet=!1;#visible=!0;constructor(e,{name:t,intent:n,usage:r,rbGroups:i}){this.#isDisplay=!!(e&er.DISPLAY),this.#isPrint=!!(e&er.PRINT),this.name=t,this.intent=n,this.usage=r,this.rbGroups=i}get visible(){if(this.#userSet)return this.#visible;if(!this.#visible)return!1;let{print:e,view:t}=this.usage;return this.#isDisplay?t?.viewState!==`OFF`:this.#isPrint?e?.printState!==`OFF`:!0}_setVisible(e,t,n=!1){e!==So&&yr("Internal method `_setVisible` called."),this.#userSet=n,this.#visible=t}},wo=class{#cachedGetHash=null;#groups=new Map;#initialHash=null;#order=null;constructor(e,t=er.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#order=e.order;for(let n of e.groups)this.#groups.set(n.id,new Co(t,n));if(e.baseState===`OFF`)for(let e of this.#groups.values())e._setVisible(So,!1);for(let t of e.on)this.#groups.get(t)._setVisible(So,!0);for(let t of e.off)this.#groups.get(t)._setVisible(So,!1);this.#initialHash=this.getHash()}}#evaluateVisibilityExpression(e){let t=e.length;if(t<2)return!0;let n=e[0];for(let r=1;r<t;r++){let t=e[r],i;if(Array.isArray(t))i=this.#evaluateVisibilityExpression(t);else if(this.#groups.has(t))i=this.#groups.get(t).visible;else return vr(`Optional content group not found: ${t}`),!0;switch(n){case`And`:if(!i)return!1;break;case`Or`:if(i)return!0;break;case`Not`:return!i;default:return!0}}return n===`And`}isVisible(e){if(this.#groups.size===0)return!0;if(!e)return _r(`Optional content group not defined.`),!0;if(e.type===`OCG`)return this.#groups.has(e.id)?this.#groups.get(e.id).visible:(vr(`Optional content group not found: ${e.id}`),!0);if(e.type===`OCMD`){if(e.expression)return this.#evaluateVisibilityExpression(e.expression);if(!e.policy||e.policy===`AnyOn`){for(let t of e.ids){if(!this.#groups.has(t))return vr(`Optional content group not found: ${t}`),!0;if(this.#groups.get(t).visible)return!0}return!1}else if(e.policy===`AllOn`){for(let t of e.ids){if(!this.#groups.has(t))return vr(`Optional content group not found: ${t}`),!0;if(!this.#groups.get(t).visible)return!1}return!0}else if(e.policy===`AnyOff`){for(let t of e.ids){if(!this.#groups.has(t))return vr(`Optional content group not found: ${t}`),!0;if(!this.#groups.get(t).visible)return!0}return!1}else if(e.policy===`AllOff`){for(let t of e.ids){if(!this.#groups.has(t))return vr(`Optional content group not found: ${t}`),!0;if(this.#groups.get(t).visible)return!1}return!0}return vr(`Unknown optional content policy ${e.policy}.`),!0}return vr(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){let r=this.#groups.get(e);if(!r){vr(`Optional content group not found: ${e}`);return}if(n&&t&&r.rbGroups.length)for(let t of r.rbGroups)for(let n of t)n!==e&&this.#groups.get(n)?._setVisible(So,!1,!0);r._setVisible(So,!!t,!0),this.#cachedGetHash=null}setOCGState({state:e,preserveRB:t}){let n;for(let r of e){switch(r){case`ON`:case`OFF`:case`Toggle`:n=r;continue}let e=this.#groups.get(r);if(e)switch(n){case`ON`:this.setVisibility(r,!0,t);break;case`OFF`:this.setVisibility(r,!1,t);break;case`Toggle`:this.setVisibility(r,!e.visible,t);break}}this.#cachedGetHash=null}get hasInitialVisibility(){return this.#initialHash===null||this.getHash()===this.#initialHash}getOrder(){return this.#groups.size?this.#order?this.#order.slice():[...this.#groups.keys()]:null}getGroup(e){return this.#groups.get(e)||null}getHash(){if(this.#cachedGetHash!==null)return this.#cachedGetHash;let e=new qi;for(let[t,n]of this.#groups)e.update(`${t}:${n.visible}`);return this.#cachedGetHash=e.hexdigest()}[Symbol.iterator](){return this.#groups.entries()}},To=class{constructor(e,{disableRange:t=!1,disableStream:n=!1}){br(e,`PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.`);let{length:r,initialData:i,progressiveDone:a,contentDispositionFilename:o}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=o,i?.length>0){let e=i instanceof Uint8Array&&i.byteLength===i.buffer.byteLength?i.buffer:new Uint8Array(i).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=r,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),e.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),e.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){let n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{let t=this._rangeReaders.some(function(t){return t._begin===e?(t._enqueue(n),!0):!1});br(t,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){let t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){br(!this._fullRequestReader,`PDFDataTransportStream.getFullReader can only be called once.`);let e=this._queuedChunks;return this._queuedChunks=null,new Eo(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new Do(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}},Eo=class{constructor(e,t,n=!1,r=null){this._stream=e,this._done=n||!1,this._filename=ri(r)?r:null,this._queuedChunks=t||[],this._loaded=0;for(let e of this._queuedChunks)this._loaded+=e.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}},Do=class{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){let e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}};function Oo(e){let t=!0,n=r(`filename\\*`,`i`).exec(e);if(n){n=n[1];let e=s(n);return e=unescape(e),e=c(e),e=l(e),a(e)}if(n=o(e),n){let e=l(n);return a(e)}if(n=r(`filename`,`i`).exec(e),n){n=n[1];let e=s(n);return e=l(e),a(e)}function r(e,t){return RegExp(`(?:^|;)\\s*`+e+`\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)`,t)}function i(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{let r=new TextDecoder(e,{fatal:!0}),i=Nr(n);n=r.decode(i),t=!1}catch{}}return n}function a(e){return t&&/[\x80-\xff]/.test(e)&&(e=i(`utf-8`,e),t&&(e=i(`iso-8859-1`,e))),e}function o(e){let t=[],n,i=r(`filename\\*((?!0\\d)\\d+)(\\*?)`,`ig`);for(;(n=i.exec(e))!==null;){let[,e,r,i]=n;if(e=parseInt(e,10),e in t){if(e===0)break;continue}t[e]=[r,i]}let a=[];for(let e=0;e<t.length&&e in t;++e){let[n,r]=t[e];r=s(r),n&&(r=unescape(r),e===0&&(r=c(r))),a.push(r)}return a.join(``)}function s(e){if(e.startsWith(`"`)){let t=e.slice(1).split(`\\"`);for(let e=0;e<t.length;++e){let n=t[e].indexOf(`"`);n!==-1&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replaceAll(/\\(.)/g,`$1`)}e=t.join(`"`)}return e}function c(e){let t=e.indexOf(`'`);if(t===-1)return e;let n=e.slice(0,t),r=e.slice(t+1).replace(/^[^']*'/,``);return i(n,r)}function l(e){return!e.startsWith(`=?`)||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(e,t,n,r){if(n===`q`||n===`Q`)return r=r.replaceAll(`_`,` `),r=r.replaceAll(/=([0-9a-fA-F]{2})/g,function(e,t){return String.fromCharCode(parseInt(t,16))}),i(t,r);try{r=atob(r)}catch{}return i(t,r)})}return``}function ko(e,t){let n=new Headers;if(!e||!t||typeof t!=`object`)return n;for(let e in t){let r=t[e];r!==void 0&&n.append(e,r)}return n}function Ao(e){return URL.parse(e)?.origin??null}function jo({responseHeaders:e,isHttp:t,rangeChunkSize:n,disableRange:r}){let i={allowRangeRequests:!1,suggestedLength:void 0},a=parseInt(e.get(`Content-Length`),10);return!Number.isInteger(a)||(i.suggestedLength=a,a<=2*n)||r||!t||e.get(`Accept-Ranges`)!==`bytes`||(e.get(`Content-Encoding`)||`identity`)!==`identity`||(i.allowRangeRequests=!0),i}function Mo(e){let t=e.get(`Content-Disposition`);if(t){let e=Oo(t);if(e.includes(`%`))try{e=decodeURIComponent(e)}catch{}if(ri(e))return e}return null}function No(e,t){return new kr(`Unexpected server response (${e}) while retrieving PDF "${t}".`,e,e===404||e===0&&t.startsWith(`file:`))}function Po(e){return e===200||e===206}function Fo(e,t,n){return{method:`GET`,headers:e,signal:n.signal,mode:`cors`,credentials:t?`include`:`same-origin`,redirect:`follow`}}function Io(e){return e instanceof Uint8Array?e.buffer:e instanceof ArrayBuffer?e:(vr(`getArrayBuffer - unexpected data format: ${e}`),new Uint8Array(e).buffer)}var Lo=class{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=ko(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return br(!this._fullRequestReader,`PDFFetchStream.getFullReader can only be called once.`),this._fullRequestReader=new Ro(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new zo(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Ro=class{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;let t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;let n=new Headers(e.headers),r=t.url;fetch(r,Fo(n,this._withCredentials,this._abortController)).then(t=>{if(e._responseOrigin=Ao(t.url),!Po(t.status))throw No(t.status,r);this._reader=t.body.getReader(),this._headersCapability.resolve();let n=t.headers,{allowRangeRequests:i,suggestedLength:a}=jo({responseHeaders:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=i,this._contentLength=a||this._contentLength,this._filename=Mo(n),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new jr(`Streaming is disabled.`))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;let{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Io(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},zo=class{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;let r=e.source;this._withCredentials=r.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!r.disableStream,this._abortController=new AbortController;let i=new Headers(e.headers);i.append(`Range`,`bytes=${t}-${n-1}`);let a=r.url;fetch(a,Fo(i,this._withCredentials,this._abortController)).then(t=>{let n=Ao(t.url);if(n!==e._responseOrigin)throw Error(`Expected range response-origin "${n}" to match "${e._responseOrigin}".`);if(!Po(t.status))throw No(t.status,a);this._readCapability.resolve(),this._reader=t.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;let{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Io(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}},Bo=200,Vo=206;function Ho(e){let t=e.response;return typeof t==`string`?Nr(t).buffer:t}var Uo=class{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=ko(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){let t=new XMLHttpRequest,n=this.currXhrId++,r=this.pendingRequests[n]={xhr:t};t.open(`GET`,this.url),t.withCredentials=this.withCredentials;for(let[e,n]of this.headers)t.setRequestHeader(e,n);return this.isHttp&&`begin`in e&&`end`in e?(t.setRequestHeader(`Range`,`bytes=${e.begin}-${e.end-1}`),r.expectedStatus=Vo):r.expectedStatus=Bo,t.responseType=`arraybuffer`,br(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),r.onHeadersReceived=e.onHeadersReceived,r.onDone=e.onDone,r.onError=e.onError,r.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){let n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){let n=this.pendingRequests[e];if(!n)return;let r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),r.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],r.status===0&&this.isHttp){n.onError(r.status);return}let i=r.status||Bo;if(!(i===Bo&&n.expectedStatus===Vo)&&i!==n.expectedStatus){n.onError(r.status);return}let a=Ho(r);if(i===Vo){let e=r.getResponseHeader(`Content-Range`),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);t?n.onDone({begin:parseInt(t[1],10),chunk:a}):(vr(`Missing or invalid "Content-Range" header.`),n.onError(0))}else a?n.onDone({begin:0,chunk:a}):n.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){let t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}},Wo=class{constructor(e){this._source=e,this._manager=new Uo(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){let t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return br(!this._fullRequestReader,`PDFNetworkStream.getFullReader can only be called once.`),this._fullRequestReader=new Go(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){let n=new Ko(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Go=class{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){let e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Ao(t.responseURL);let n=t.getAllResponseHeaders(),r=new Headers(n?n.trimStart().replace(/[^\S ]+$/,``).split(/[\r\n]+/).map(e=>{let[t,...n]=e.split(`: `);return[t,n.join(`: `)]}):[]),{allowRangeRequests:i,suggestedLength:a}=jo({responseHeaders:r,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=Mo(r),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=No(e,this._url),this._headersCapability.reject(this._storedError);for(let e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}},Ko=class{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){let e=Ao(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){let t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=No(e,this._url);for(let e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){let e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};let e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(let e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}},qo=/^[a-z][a-z0-9\-+.]+:/i;function Jo(e){if(qo.test(e))return new URL(e);let t=process.getBuiltinModule(`url`);return new URL(t.pathToFileURL(e))}var Yo=class{constructor(e){this.source=e,this.url=Jo(e.url),br(this.url.protocol===`file:`,`PDFNodeStream only supports file:// URLs.`),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return br(!this._fullRequestReader,`PDFNodeStream.getFullReader can only be called once.`),this._fullRequestReader=new Xo(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;let n=new Zo(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(let t of this._rangeRequestReaders.slice(0))t.cancel(e)}},Xo=class{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;let t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();let n=process.getBuiltinModule(`fs`);n.promises.lstat(this._url).then(e=>{this._contentLength=e.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},e=>{e.code===`ENOENT`&&(e=No(0,this._url.href)),this._storedError=e,this._headersCapability.reject(e)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on(`readable`,()=>{this._readCapability.resolve()}),e.on(`end`,()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on(`error`,e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new jr(`streaming is disabled`)),this._storedError&&this._readableStream.destroy(this._storedError)}},Zo=class{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!e.source.disableStream;let r=process.getBuiltinModule(`fs`);this._setReadableStream(r.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;let e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on(`readable`,()=>{this._readCapability.resolve()}),e.on(`end`,()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on(`error`,e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}},Qo=Symbol(`INITIAL_DATA`),$o=class{#objs=Object.create(null);#ensureObj(e){return this.#objs[e]||={...Promise.withResolvers(),data:Qo}}get(e,t=null){if(t){let n=this.#ensureObj(e);return n.promise.then(()=>t(n.data)),null}let n=this.#objs[e];if(!n||n.data===Qo)throw Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){let t=this.#objs[e];return!!t&&t.data!==Qo}delete(e){let t=this.#objs[e];return!t||t.data===Qo?!1:(delete this.#objs[e],!0)}resolve(e,t=null){let n=this.#ensureObj(e);n.data=t,n.resolve()}clear(){for(let e in this.#objs){let{data:t}=this.#objs[e];t?.bitmap?.close()}this.#objs=Object.create(null)}*[Symbol.iterator](){for(let e in this.#objs){let{data:t}=this.#objs[e];t!==Qo&&(yield[e,t])}}},es=1e5,ts=30,ns=class e{#capability=Promise.withResolvers();#container=null;#disableProcessItems=!1;#fontInspectorEnabled=!!globalThis.FontInspector?.enabled;#lang=null;#layoutTextParams=null;#pageHeight=0;#pageWidth=0;#reader=null;#rootContainer=null;#rotation=0;#scale=0;#styleCache=Object.create(null);#textContentItemsStr=[];#textContentSource=null;#textDivs=[];#textDivProperties=new WeakMap;#transform=null;static#ascentCache=new Map;static#canvasContexts=new Map;static#canvasCtxFonts=new WeakMap;static#minFontSize=null;static#pendingTextLayers=new Set;constructor({textContentSource:t,container:n,viewport:r}){if(t instanceof ReadableStream)this.#textContentSource=t;else if(typeof t==`object`)this.#textContentSource=new ReadableStream({start(e){e.enqueue(t),e.close()}});else throw Error(`No "textContentSource" parameter specified.`);this.#container=this.#rootContainer=n,this.#scale=r.scale*vi.pixelRatio,this.#rotation=r.rotation,this.#layoutTextParams={div:null,properties:null,ctx:null};let{pageWidth:i,pageHeight:a,pageX:o,pageY:s}=r.rawDims;this.#transform=[1,0,0,-1,-o,s+a],this.#pageWidth=i,this.#pageHeight=a,e.#ensureMinFontSizeComputed(),_i(n,r),this.#capability.promise.finally(()=>{e.#pendingTextLayers.delete(this),this.#layoutTextParams=null,this.#styleCache=null}).catch(()=>{})}static get fontFamilyMap(){let{isWindows:e,isFirefox:t}=Lr.platform;return wr(this,`fontFamilyMap`,new Map([[`sans-serif`,`${e&&t?`Calibri, `:``}sans-serif`],[`monospace`,`${e&&t?`Lucida Console, `:``}monospace`]]))}render(){let t=()=>{this.#reader.read().then(({value:e,done:n})=>{if(n){this.#capability.resolve();return}this.#lang??=e.lang,Object.assign(this.#styleCache,e.styles),this.#processItems(e.items),t()},this.#capability.reject)};return this.#reader=this.#textContentSource.getReader(),e.#pendingTextLayers.add(this),t(),this.#capability.promise}update({viewport:t,onBefore:n=null}){let r=t.scale*vi.pixelRatio,i=t.rotation;if(i!==this.#rotation&&(n?.(),this.#rotation=i,_i(this.#rootContainer,{rotation:i})),r!==this.#scale){n?.(),this.#scale=r;let t={div:null,properties:null,ctx:e.#getCtx(this.#lang)};for(let e of this.#textDivs)t.properties=this.#textDivProperties.get(e),t.div=e,this.#layout(t)}}cancel(){let e=new jr(`TextLayer task cancelled.`);this.#reader?.cancel(e).catch(()=>{}),this.#reader=null,this.#capability.reject(e)}get textDivs(){return this.#textDivs}get textContentItemsStr(){return this.#textContentItemsStr}#processItems(t){if(this.#disableProcessItems)return;this.#layoutTextParams.ctx??=e.#getCtx(this.#lang);let n=this.#textDivs,r=this.#textContentItemsStr;for(let e of t){if(n.length>es){vr(`Ignoring additional textDivs for performance reasons.`),this.#disableProcessItems=!0;return}if(e.str===void 0){if(e.type===`beginMarkedContentProps`||e.type===`beginMarkedContent`){let t=this.#container;this.#container=document.createElement(`span`),this.#container.classList.add(`markedContent`),e.id&&this.#container.setAttribute(`id`,`${e.id}`),t.append(this.#container)}else e.type===`endMarkedContent`&&(this.#container=this.#container.parentNode);continue}r.push(e.str),this.#appendText(e)}}#appendText(t){let n=document.createElement(`span`),r={angle:0,canvasWidth:0,hasText:t.str!==``,hasEOL:t.hasEOL,fontSize:0};this.#textDivs.push(n);let i=Z.transform(this.#transform,t.transform),a=Math.atan2(i[1],i[0]),o=this.#styleCache[t.fontName];o.vertical&&(a+=Math.PI/2);let s=this.#fontInspectorEnabled&&o.fontSubstitution||o.fontFamily;s=e.fontFamilyMap.get(s)||s;let c=Math.hypot(i[2],i[3]),l=c*e.#getAscent(s,o,this.#lang),u,d;a===0?(u=i[4],d=i[5]-l):(u=i[4]+l*Math.sin(a),d=i[5]-l*Math.cos(a));let f=`calc(var(--total-scale-factor) *`,p=n.style;this.#container===this.#rootContainer?(p.left=`${(100*u/this.#pageWidth).toFixed(2)}%`,p.top=`${(100*d/this.#pageHeight).toFixed(2)}%`):(p.left=`${f}${u.toFixed(2)}px)`,p.top=`${f}${d.toFixed(2)}px)`),p.fontSize=`${f}${(e.#minFontSize*c).toFixed(2)}px)`,p.fontFamily=s,r.fontSize=c,n.setAttribute(`role`,`presentation`),n.textContent=t.str,n.dir=t.dir,this.#fontInspectorEnabled&&(n.dataset.fontName=o.fontSubstitutionLoadedName||t.fontName),a!==0&&(r.angle=a*(180/Math.PI));let m=!1;if(t.str.length>1)m=!0;else if(t.str!==` `&&t.transform[0]!==t.transform[3]){let e=Math.abs(t.transform[0]),n=Math.abs(t.transform[3]);e!==n&&Math.max(e,n)/Math.min(e,n)>1.5&&(m=!0)}if(m&&(r.canvasWidth=o.vertical?t.height:t.width),this.#textDivProperties.set(n,r),this.#layoutTextParams.div=n,this.#layoutTextParams.properties=r,this.#layout(this.#layoutTextParams),r.hasText&&this.#container.append(n),r.hasEOL){let e=document.createElement(`br`);e.setAttribute(`role`,`presentation`),this.#container.append(e)}}#layout(t){let{div:n,properties:r,ctx:i}=t,{style:a}=n,o=``;if(e.#minFontSize>1&&(o=`scale(${1/e.#minFontSize})`),r.canvasWidth!==0&&r.hasText){let{fontFamily:t}=a,{canvasWidth:s,fontSize:c}=r;e.#ensureCtxFont(i,c*this.#scale,t);let{width:l}=i.measureText(n.textContent);l>0&&(o=`scaleX(${s*this.#scale/l}) ${o}`)}r.angle!==0&&(o=`rotate(${r.angle}deg) ${o}`),o.length>0&&(a.transform=o)}static cleanup(){if(!(this.#pendingTextLayers.size>0)){this.#ascentCache.clear();for(let{canvas:e}of this.#canvasContexts.values())e.remove();this.#canvasContexts.clear()}}static#getCtx(e=null){let t=this.#canvasContexts.get(e||=``);if(!t){let n=document.createElement(`canvas`);n.className=`hiddenCanvasElement`,n.lang=e,document.body.append(n),t=n.getContext(`2d`,{alpha:!1,willReadFrequently:!0}),this.#canvasContexts.set(e,t),this.#canvasCtxFonts.set(t,{size:0,family:``})}return t}static#ensureCtxFont(e,t,n){let r=this.#canvasCtxFonts.get(e);t===r.size&&n===r.family||(e.font=`${t}px ${n}`,r.size=t,r.family=n)}static#ensureMinFontSizeComputed(){if(this.#minFontSize!==null)return;let e=document.createElement(`div`);e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize=`1px`,e.style.position=`absolute`,e.textContent=`X`,document.body.append(e),this.#minFontSize=e.getBoundingClientRect().height,e.remove()}static#getAscent(e,t,n){let r=this.#ascentCache.get(e);if(r)return r;let i=this.#getCtx(n);i.canvas.width=i.canvas.height=ts,this.#ensureCtxFont(i,ts,e);let a=i.measureText(``),o=a.fontBoundingBoxAscent,s=Math.abs(a.fontBoundingBoxDescent);i.canvas.width=i.canvas.height=0;let c=.8;return o?c=o/(o+s):(Lr.platform.isFirefox&&vr("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?c=t.ascent:t.descent&&(c=1+t.descent)),this.#ascentCache.set(e,c),c}},rs=100;function os(e={}){typeof e==`string`||e instanceof URL?e={url:e}:(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});let t=new ss,{docId:n}=t,r=e.url?$i(e.url):null,i=e.data?ea(e.data):null,a=e.httpHeaders||null,o=e.withCredentials===!0,s=e.password??null,c=e.range instanceof cs?e.range:null,l=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:2**16,u=e.worker instanceof ds?e.worker:null,d=e.verbosity,f=typeof e.docBaseUrl==`string`&&!ni(e.docBaseUrl)?e.docBaseUrl:null,p=ta(e.cMapUrl),m=e.cMapPacked!==!1,h=e.CMapReaderFactory||(Zn?Ca:pa),g=ta(e.iccUrl),_=ta(e.standardFontDataUrl),v=e.StandardFontDataFactory||(Zn?wa:_a),y=ta(e.wasmUrl),b=e.WasmFactory||(Zn?Ta:ya),x=e.stopAtErrors!==!0,S=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,C=e.isEvalSupported!==!1,w=typeof e.isOffscreenCanvasSupported==`boolean`?e.isOffscreenCanvasSupported:!Zn,T=typeof e.isImageDecoderSupported==`boolean`?e.isImageDecoderSupported:!Zn&&(Lr.platform.isFirefox||!globalThis.chrome),E=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,D=typeof e.disableFontFace==`boolean`?e.disableFontFace:Zn,O=e.fontExtraProperties===!0,k=e.enableXfa===!0,A=e.ownerDocument||globalThis.document,j=e.disableRange===!0,M=e.disableStream===!0,N=e.disableAutoFetch===!0,P=e.pdfBug===!0,F=e.CanvasFactory||(Zn?Sa:da),I=e.FilterFactory||(Zn?xa:ha),L=e.enableHWA===!0,R=e.useWasm!==!1,ee=c?c.length:e.length??NaN,te=typeof e.useSystemFonts==`boolean`?e.useSystemFonts:!Zn&&!D,ne=typeof e.useWorkerFetch==`boolean`?e.useWorkerFetch:!!(h===pa&&v===_a&&b===ya&&p&&_&&y&&si(p,document.baseURI)&&si(_,document.baseURI)&&si(y,document.baseURI));hr(d);let re={canvasFactory:new F({ownerDocument:A,enableHWA:L}),filterFactory:new I({docId:n,ownerDocument:A}),cMapReaderFactory:ne?null:new h({baseUrl:p,isCompressed:m}),standardFontDataFactory:ne?null:new v({baseUrl:_}),wasmFactory:ne?null:new b({baseUrl:y})};u||(u=ds.create({verbosity:d,port:bo.workerPort}),t._worker=u);let ie={docId:n,apiVersion:`5.4.296`,data:i,password:s,disableAutoFetch:N,rangeChunkSize:l,length:ee,docBaseUrl:f,enableXfa:k,evaluatorOptions:{maxImageSize:S,disableFontFace:D,ignoreErrors:x,isEvalSupported:C,isOffscreenCanvasSupported:w,isImageDecoderSupported:T,canvasMaxAreaInBytes:E,fontExtraProperties:O,useSystemFonts:te,useWasm:R,useWorkerFetch:ne,cMapUrl:p,iccUrl:g,standardFontDataUrl:_,wasmUrl:y}},ae={ownerDocument:A,pdfBug:P,styleElement:null,loadingParams:{disableAutoFetch:N,enableXfa:k}};return u.promise.then(function(){if(t.destroyed)throw Error(`Loading aborted`);if(u.destroyed)throw Error(`Worker was destroyed`);let e=u.messageHandler.sendWithPromise(`GetDocRequest`,ie,i?[i.buffer]:null),s;if(c)s=new To(c,{disableRange:j,disableStream:M});else if(!i){if(!r)throw Error("getDocument - no `url` parameter provided.");s=new(si(r)?Lo:Zn?Yo:Wo)({url:r,length:ee,httpHeaders:a,withCredentials:o,rangeChunkSize:l,disableRange:j,disableStream:M})}return e.then(e=>{if(t.destroyed)throw Error(`Loading aborted`);if(u.destroyed)throw Error(`Worker was destroyed`);let r=new la(n,e,u.port);t._transport=new fs(r,t,s,ae,re,L),r.send(`Ready`,null)})}).catch(t._capability.reject),t}var ss=class e{static#docId=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${e.#docId++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}},cs=class{#capability=Promise.withResolvers();#progressiveDoneListeners=[];#progressiveReadListeners=[];#progressListeners=[];#rangeListeners=[];constructor(e,t,n=!1,r=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=r}addRangeListener(e){this.#rangeListeners.push(e)}addProgressListener(e){this.#progressListeners.push(e)}addProgressiveReadListener(e){this.#progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this.#progressiveDoneListeners.push(e)}onDataRange(e,t){for(let n of this.#rangeListeners)n(e,t)}onDataProgress(e,t){this.#capability.promise.then(()=>{for(let n of this.#progressListeners)n(e,t)})}onDataProgressiveRead(e){this.#capability.promise.then(()=>{for(let t of this.#progressiveReadListeners)t(e)})}onDataProgressiveDone(){this.#capability.promise.then(()=>{for(let e of this.#progressiveDoneListeners)e()})}transportReady(){this.#capability.resolve()}requestDataRange(e,t){yr(`Abstract method PDFDataRangeTransport.requestDataRange`)}abort(){}},ls=class{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return wr(this,`isPureXfa`,!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e=`display`}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}},us=class{#pendingCleanup=!1;constructor(e,t,n,r=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=r?new oi:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new $o,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:r=0,dontFlip:i=!1}={}){return new ei({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:r,dontFlip:i})}getAnnotations({intent:e=`display`}={}){let{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return wr(this,`isPureXfa`,!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:r=`display`,annotationMode:i=tr.ENABLE,transform:a=null,background:o=null,optionalContentConfigPromise:s=null,annotationCanvasMap:c=null,pageColors:l=null,printAnnotationStorage:u=null,isEditing:d=!1,recordOperations:f=!1,operationsFilter:p=null}){this._stats?.time(`Overall`);let m=this._transport.getRenderingIntent(r,i,u,d),{renderingIntent:h,cacheKey:g}=m;this.#pendingCleanup=!1,s||=this._transport.getOptionalContentConfig(h);let _=this._intentStates.get(g);_||(_=Object.create(null),this._intentStates.set(g,_)),_.streamReaderCancelTimeout&&=(clearTimeout(_.streamReaderCancelTimeout),null);let v=!!(h&er.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time(`Page Request`),this._pumpOperatorList(m));let y=!!(this._pdfBug&&globalThis.StepperManager?.enabled),b=!this.recordedBBoxes&&(f||y),x=e=>{if(_.renderTasks.delete(S),b){let e=S.gfx?.dependencyTracker.take();e&&(S.stepper&&S.stepper.setOperatorBBoxes(e,S.gfx.dependencyTracker.takeDebugMetadata()),f&&(this.recordedBBoxes=e))}v&&(this.#pendingCleanup=!0),this.#tryCleanup(),e?(S.capability.reject(e),this._abortOperatorList({intentState:_,reason:e instanceof Error?e:Error(e)})):S.capability.resolve(),this._stats&&(this._stats.timeEnd(`Rendering`),this._stats.timeEnd(`Overall`),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},S=new ms({callback:x,params:{canvas:t,canvasContext:e,dependencyTracker:b?new Na(t,_.operatorList.length,y):null,viewport:n,transform:a,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:c,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:l,enableHWA:this._transport.enableHWA,operationsFilter:p});(_.renderTasks||=new Set).add(S);let C=S.task;return Promise.all([_.displayReadyCapability.promise,s]).then(([e,t])=>{if(this.destroyed){x();return}if(this._stats?.time(`Rendering`),!(t.renderingIntent&h))throw Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");S.initializeGraphics({transparency:e,optionalContentConfig:t}),S.operatorListChanged()}).catch(x),C}getOperatorList({intent:e=`display`,annotationMode:t=tr.ENABLE,printAnnotationStorage:n=null,isEditing:r=!1}={}){function i(){o.operatorList.lastChunk&&(o.opListReadCapability.resolve(o.operatorList),o.renderTasks.delete(s))}let a=this._transport.getRenderingIntent(e,t,n,r,!0),o=this._intentStates.get(a.cacheKey);o||(o=Object.create(null),this._intentStates.set(a.cacheKey,o));let s;return o.opListReadCapability||(s=Object.create(null),s.operatorListChanged=i,o.opListReadCapability=Promise.withResolvers(),(o.renderTasks||=new Set).add(s),o.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time(`Page Request`),this._pumpOperatorList(a)),o.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream(`GetTextContent`,{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(e){return e.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(e=>Yr.textContent(e));let t=this.streamTextContent(e);return new Promise(function(e,n){function r(){i.read().then(function({value:t,done:n}){if(n){e(a);return}a.lang??=t.lang,Object.assign(a.styles,t.styles),a.items.push(...t.items),r()},n)}let i=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;let e=[];for(let t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:Error(`Page was destroyed.`),force:!0}),!t.opListReadCapability)for(let n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){this.#pendingCleanup=!0;let t=this.#tryCleanup();return e&&t&&(this._stats&&=new oi),t}#tryCleanup(){if(!this.#pendingCleanup||this.destroyed)return!1;for(let{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#pendingCleanup=!1,!0}_startRenderPage(e,t){let n=this._intentStates.get(t);n&&(this._stats?.timeEnd(`Page Request`),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,r=e.length;n<r;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(let e of t.renderTasks)e.operatorListChanged();e.lastChunk&&this.#tryCleanup()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:r}){let{map:i,transfer:a}=n,o=this._transport.messageHandler.sendWithStream(`GetOperatorList`,{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i,modifiedIds:r},a).getReader(),s=this._intentStates.get(t);s.streamReader=o;let c=()=>{o.read().then(({value:e,done:t})=>{if(t){s.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(e,s),c())},e=>{if(s.streamReader=null,!this._transport.destroyed){if(s.operatorList){s.operatorList.lastChunk=!0;for(let e of s.renderTasks)e.operatorListChanged();this.#tryCleanup()}if(s.displayReadyCapability)s.displayReadyCapability.reject(e);else if(s.opListReadCapability)s.opListReadCapability.reject(e);else throw e}})};c()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&=(clearTimeout(e.streamReaderCancelTimeout),null),!n){if(e.renderTasks.size>0)return;if(t instanceof ti){let n=rs;t.extraDelay>0&&t.extraDelay<1e3&&(n+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},n);return}}if(e.streamReader.cancel(new jr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(let[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}},ds=class e{#capability=Promise.withResolvers();#messageHandler=null;#port=null;#webWorker=null;static#fakeWorkerId=0;static#isWorkerDisabled=!1;static#workerPorts=new WeakMap;static{Zn&&(this.#isWorkerDisabled=!0,bo.workerSrc||=`./pdf.worker.mjs`),this._isSameOrigin=(e,t)=>{let n=URL.parse(e);if(!n?.origin||n.origin===`null`)return!1;let r=new URL(t,n);return n.origin===r.origin},this._createCDNWrapper=e=>{let t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:`text/javascript`}))},this.fromPort=e=>{if(ui("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw Error(`PDFWorker.fromPort - invalid method signature.`);return this.create(e)}}constructor({name:t=null,port:n=null,verbosity:r=gr()}={}){if(this.name=t,this.destroyed=!1,this.verbosity=r,n){if(e.#workerPorts.has(n))throw Error(`Cannot use more than one PDFWorker per port.`);e.#workerPorts.set(n,this),this.#initializeFromPort(n)}else this.#initialize()}get promise(){return this.#capability.promise}#resolve(){this.#capability.resolve(),this.#messageHandler.send(`configure`,{verbosity:this.verbosity})}get port(){return this.#port}get messageHandler(){return this.#messageHandler}#initializeFromPort(e){this.#port=e,this.#messageHandler=new la(`main`,`worker`,e),this.#messageHandler.on(`ready`,()=>{}),this.#resolve()}#initialize(){if(e.#isWorkerDisabled||e.#mainThreadWorkerMessageHandler){this.#setupFakeWorker();return}let{workerSrc:t}=e;try{e._isSameOrigin(window.location,t)||(t=e._createCDNWrapper(new URL(t,window.location).href));let n=new Worker(t,{type:`module`}),r=new la(`main`,`worker`,n),i=()=>{a.abort(),r.destroy(),n.terminate(),this.destroyed?this.#capability.reject(Error(`Worker was destroyed`)):this.#setupFakeWorker()},a=new AbortController;n.addEventListener(`error`,()=>{this.#webWorker||i()},{signal:a.signal}),r.on(`test`,e=>{if(a.abort(),this.destroyed||!e){i();return}this.#messageHandler=r,this.#port=n,this.#webWorker=n,this.#resolve()}),r.on(`ready`,e=>{if(a.abort(),this.destroyed){i();return}try{o()}catch{this.#setupFakeWorker()}});let o=()=>{let e=new Uint8Array;r.send(`test`,e,[e.buffer])};o();return}catch{_r(`The worker has been disabled.`)}this.#setupFakeWorker()}#setupFakeWorker(){e.#isWorkerDisabled||=(vr(`Setting up fake worker.`),!0),e._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){this.#capability.reject(Error(`Worker was destroyed`));return}let n=new ia;this.#port=n;let r=`fake${e.#fakeWorkerId++}`,i=new la(r+`_worker`,r,n);t.setup(i,n),this.#messageHandler=new la(r,r+`_worker`,n),this.#resolve()}).catch(e=>{this.#capability.reject(Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this.#webWorker?.terminate(),this.#webWorker=null,e.#workerPorts.delete(this.#port),this.#port=null,this.#messageHandler?.destroy(),this.#messageHandler=null}static create(t){let n=this.#workerPorts.get(t?.port);if(n){if(n._pendingDestroy)throw Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return n}return new e(t)}static get workerSrc(){if(bo.workerSrc)return bo.workerSrc;throw Error(`No "GlobalWorkerOptions.workerSrc" specified.`)}static get#mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return wr(this,`_setupFakeWorkerGlobal`,(async()=>this.#mainThreadWorkerMessageHandler?this.#mainThreadWorkerMessageHandler:(await C(()=>import(this.workerSrc),[])).WorkerMessageHandler)())}},fs=class{#methodPromises=new Map;#pageCache=new Map;#pagePromises=new Map;#pageRefCache=new Map;#passwordCapability=null;constructor(e,t,n,r,i,a){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new $o,this.fontLoader=new Zi({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=i.canvasFactory,this.filterFactory=i.filterFactory,this.cMapReaderFactory=i.cMapReaderFactory,this.standardFontDataFactory=i.standardFontDataFactory,this.wasmFactory=i.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}#cacheSimpleMethod(e,t=null){let n=this.#methodPromises.get(e);if(n)return n;let r=this.messageHandler.sendWithPromise(e,t);return this.#methodPromises.set(e,r),r}get annotationStorage(){return wr(this,`annotationStorage`,new Yi)}getRenderingIntent(e,t=tr.ENABLE,n=null,r=!1,i=!1){let a=er.DISPLAY,o=Ji;switch(e){case`any`:a=er.ANY;break;case`display`:break;case`print`:a=er.PRINT;break;default:vr(`getRenderingIntent - invalid intent: ${e}`)}let s=a&er.PRINT&&n instanceof Xi?n:this.annotationStorage;switch(t){case tr.DISABLE:a+=er.ANNOTATIONS_DISABLE;break;case tr.ENABLE:break;case tr.ENABLE_FORMS:a+=er.ANNOTATIONS_FORMS;break;case tr.ENABLE_STORAGE:a+=er.ANNOTATIONS_STORAGE,o=s.serializable;break;default:vr(`getRenderingIntent - invalid annotationMode: ${t}`)}r&&(a+=er.IS_EDITING),i&&(a+=er.OPLIST);let{ids:c,hash:l}=s.modifiedIds,u=[a,o.hash,l];return{renderingIntent:a,cacheKey:u.join(`_`),annotationStorageSerializable:o,modifiedIds:c}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#passwordCapability?.reject(Error(`Worker was destroyed during onPassword callback`));let e=[];for(let t of this.#pageCache.values())e.push(t._destroy());this.#pageCache.clear(),this.#pagePromises.clear(),this.#pageRefCache.clear(),this.hasOwnProperty(`annotationStorage`)&&this.annotationStorage.resetModified();let t=this.messageHandler.sendWithPromise(`Terminate`,null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#methodPromises.clear(),this.filterFactory.destroy(),ns.cleanup(),this._networkStream?.cancelAllRequests(new jr(`Worker was terminated.`)),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){let{messageHandler:e,loadingTask:t}=this;e.on(`GetReader`,(e,t)=>{br(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then(function({value:e,done:n}){if(n){t.close();return}br(e instanceof ArrayBuffer,`GetReader - expected an ArrayBuffer.`),t.enqueue(new Uint8Array(e),1,[e])}).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on(`ReaderHeadersReady`,async e=>{await this._fullReader.headersReady;let{isStreamingSupported:n,isRangeSupported:r,contentLength:i}=this._fullReader;return(!n||!r)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=e=>{t.onProgress?.({loaded:e.loaded,total:e.total})}),{isStreamingSupported:n,isRangeSupported:r,contentLength:i}}),e.on(`GetRangeReader`,(e,t)=>{br(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");let n=this._networkStream.getRangeReader(e.begin,e.end);if(!n){t.close();return}t.onPull=()=>{n.read().then(function({value:e,done:n}){if(n){t.close();return}br(e instanceof ArrayBuffer,`GetRangeReader - expected an ArrayBuffer.`),t.enqueue(new Uint8Array(e),1,[e])}).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on(`GetDoc`,({pdfInfo:e})=>{this._numPages=e.numPages,this._htmlForXfa=e.htmlForXfa,delete e.htmlForXfa,t._capability.resolve(new ls(e,this))}),e.on(`DocException`,e=>{t._capability.reject(ca(e))}),e.on(`PasswordRequest`,e=>{this.#passwordCapability=Promise.withResolvers();try{if(!t.onPassword)throw ca(e);t.onPassword(e=>{e instanceof Error?this.#passwordCapability.reject(e):this.#passwordCapability.resolve({password:e})},e.code)}catch(e){this.#passwordCapability.reject(e)}return this.#passwordCapability.promise}),e.on(`DataLoaded`,e=>{t.onProgress?.({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on(`StartRenderPage`,e=>{this.destroyed||this.#pageCache.get(e.pageIndex)._startRenderPage(e.transparency,e.cacheKey)}),e.on(`commonobj`,([t,n,r])=>{if(this.destroyed||this.commonObjs.has(t))return null;switch(n){case`Font`:if(`error`in r){let e=r.error;vr(`Error during font loading: ${e}`),this.commonObjs.resolve(t,e);break}let i=new yo(r),a=this._params.pdfBug&&globalThis.FontInspector?.enabled?(e,t)=>globalThis.FontInspector.fontAdded(e,t):null,o=new Qi(i,a,r.extra,r.charProcOperatorList);this.fontLoader.bind(o).catch(()=>e.sendWithPromise(`FontFallback`,{id:t})).finally(()=>{!o.fontExtraProperties&&o.data&&o.clearData(),this.commonObjs.resolve(t,o)});break;case`CopyLocalImage`:let{imageRef:s}=r;br(s,`The imageRef must be defined.`);for(let e of this.#pageCache.values())for(let[,n]of e.objs)if(n?.ref===s)return n.dataLen?(this.commonObjs.resolve(t,structuredClone(n)),n.dataLen):null;break;case`FontPath`:case`Image`:case`Pattern`:this.commonObjs.resolve(t,r);break;default:throw Error(`Got unknown common object type ${n}`)}return null}),e.on(`obj`,([e,t,n,r])=>{if(this.destroyed)return;let i=this.#pageCache.get(t);if(!i.objs.has(e)){if(i._intentStates.size===0){r?.bitmap?.close();return}switch(n){case`Image`:case`Pattern`:i.objs.resolve(e,r);break;default:throw Error(`Got unknown object type ${n}`)}}}),e.on(`DocProgress`,e=>{this.destroyed||t.onProgress?.({loaded:e.loaded,total:e.total})}),e.on(`FetchBinaryData`,async e=>{if(this.destroyed)throw Error(`Worker was destroyed.`);let t=this[e.type];if(!t)throw Error(`${e.type} not initialized, see the \`useWorkerFetch\` parameter.`);return t.fetch(e)})}getData(){return this.messageHandler.sendWithPromise(`GetData`,null)}saveDocument(){this.annotationStorage.size<=0&&vr("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");let{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise(`SaveDocument`,{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(Error(`Invalid page request.`));let t=e-1,n=this.#pagePromises.get(t);if(n)return n;let r=this.messageHandler.sendWithPromise(`GetPage`,{pageIndex:t}).then(n=>{if(this.destroyed)throw Error(`Transport destroyed`);n.refStr&&this.#pageRefCache.set(n.refStr,e);let r=new us(t,n,this,this._params.pdfBug);return this.#pageCache.set(t,r),r});return this.#pagePromises.set(t,r),r}getPageIndex(e){return na(e)?this.messageHandler.sendWithPromise(`GetPageIndex`,{num:e.num,gen:e.gen}):Promise.reject(Error(`Invalid pageIndex request.`))}getAnnotations(e,t){return this.messageHandler.sendWithPromise(`GetAnnotations`,{pageIndex:e,intent:t})}getFieldObjects(){return this.#cacheSimpleMethod(`GetFieldObjects`)}hasJSActions(){return this.#cacheSimpleMethod(`HasJSActions`)}getCalculationOrderIds(){return this.messageHandler.sendWithPromise(`GetCalculationOrderIds`,null)}getDestinations(){return this.messageHandler.sendWithPromise(`GetDestinations`,null)}getDestination(e){return typeof e==`string`?this.messageHandler.sendWithPromise(`GetDestination`,{id:e}):Promise.reject(Error(`Invalid destination request.`))}getPageLabels(){return this.messageHandler.sendWithPromise(`GetPageLabels`,null)}getPageLayout(){return this.messageHandler.sendWithPromise(`GetPageLayout`,null)}getPageMode(){return this.messageHandler.sendWithPromise(`GetPageMode`,null)}getViewerPreferences(){return this.messageHandler.sendWithPromise(`GetViewerPreferences`,null)}getOpenAction(){return this.messageHandler.sendWithPromise(`GetOpenAction`,null)}getAttachments(){return this.messageHandler.sendWithPromise(`GetAttachments`,null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise(`GetAnnotationsByType`,{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#cacheSimpleMethod(`GetDocJSActions`)}getPageJSActions(e){return this.messageHandler.sendWithPromise(`GetPageJSActions`,{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise(`GetStructTree`,{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise(`GetOutline`,null)}getOptionalContentConfig(e){return this.#cacheSimpleMethod(`GetOptionalContentConfig`).then(t=>new wo(t,e))}getPermissions(){return this.messageHandler.sendWithPromise(`GetPermissions`,null)}getMetadata(){let e=`GetMetadata`,t=this.#methodPromises.get(e);if(t)return t;let n=this.messageHandler.sendWithPromise(e,null).then(e=>({info:e[0],metadata:e[1]?new xo(e[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#methodPromises.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise(`GetMarkInfo`,null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise(`Cleanup`,null);for(let e of this.#pageCache.values())if(!e.cleanup())throw Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#methodPromises.clear(),this.filterFactory.destroy(!0),ns.cleanup()}}cachedPageNumber(e){if(!na(e))return null;let t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#pageRefCache.get(t)??null}},ps=class{#internalRenderTask=null;onContinue=null;onError=null;constructor(e){this.#internalRenderTask=e}get promise(){return this.#internalRenderTask.capability.promise}cancel(e=0){this.#internalRenderTask.cancel(null,e)}get separateAnnots(){let{separateAnnots:e}=this.#internalRenderTask.operatorList;if(!e)return!1;let{annotationCanvasMap:t}=this.#internalRenderTask;return e.form||e.canvas&&t?.size>0}},ms=class e{#rAF=null;static#canvasInUse=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:r,annotationCanvasMap:i,operatorList:a,pageIndex:o,canvasFactory:s,filterFactory:c,useRequestAnimationFrame:l=!1,pdfBug:u=!1,pageColors:d=null,enableHWA:f=!1,operationsFilter:p=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=r,this.annotationCanvasMap=i,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=o,this.canvasFactory=s,this.filterFactory=c,this._pdfBug=u,this.pageColors=d,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=l===!0&&typeof window<`u`,this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new ps(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=f,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=p}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:n}){if(this.cancelled)return;if(this._canvas){if(e.#canvasInUse.has(this._canvas))throw Error(`Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.`);e.#canvasInUse.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());let{viewport:r,transform:i,background:a,dependencyTracker:o}=this.params,s=this._canvasContext||this._canvas.getContext(`2d`,{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new go(s,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:n},this.annotationCanvasMap,this.pageColors,o),this.gfx.beginDrawing({transform:i,viewport:r,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,n=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#rAF&&=(window.cancelAnimationFrame(this.#rAF),null),e.#canvasInUse.delete(this._canvas),t||=new ti(`Rendering cancelled, page ${this._pageIndex+1}`,n),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#rAF=window.requestAnimationFrame(()=>{this.#rAF=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),e.#canvasInUse.delete(this._canvas),this.callback())))}},hs=`5.4.296`,gs=`f56dc8601`,_s=class e{#button=null;#buttonSwatch=null;#defaultColor;#dropdown=null;#dropdownWasFromKeyboard=!1;#isMainColorPicker=!1;#editor=null;#eventBus;#openDropdownAC=null;#uiManager=null;static#l10nColor=null;static get _keyboardManager(){return wr(this,`_keyboardManager`,new Ii([[[`Escape`,`mac+Escape`],e.prototype._hideDropdownFromKeyboard],[[` `,`mac+ `],e.prototype._colorSelectFromKeyboard],[[`ArrowDown`,`ArrowRight`,`mac+ArrowDown`,`mac+ArrowRight`],e.prototype._moveToNext],[[`ArrowUp`,`ArrowLeft`,`mac+ArrowUp`,`mac+ArrowLeft`],e.prototype._moveToPrevious],[[`Home`,`mac+Home`],e.prototype._moveToBeginning],[[`End`,`mac+End`],e.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:n=null}){t?(this.#isMainColorPicker=!1,this.#editor=t):this.#isMainColorPicker=!0,this.#uiManager=t?._uiManager||n,this.#eventBus=this.#uiManager._eventBus,this.#defaultColor=t?.color?.toUpperCase()||this.#uiManager?.highlightColors.values().next().value||`#FFFF98`,e.#l10nColor||=Object.freeze({blue:`pdfjs-editor-colorpicker-blue`,green:`pdfjs-editor-colorpicker-green`,pink:`pdfjs-editor-colorpicker-pink`,red:`pdfjs-editor-colorpicker-red`,yellow:`pdfjs-editor-colorpicker-yellow`})}renderButton(){let e=this.#button=document.createElement(`button`);e.className=`colorPicker`,e.tabIndex=`0`,e.setAttribute(`data-l10n-id`,`pdfjs-editor-colorpicker-button`),e.ariaHasPopup=`true`,this.#editor&&(e.ariaControls=`${this.#editor.id}_colorpicker_dropdown`);let t=this.#uiManager._signal;e.addEventListener(`click`,this.#openDropdown.bind(this),{signal:t}),e.addEventListener(`keydown`,this.#keyDown.bind(this),{signal:t});let n=this.#buttonSwatch=document.createElement(`span`);return n.className=`swatch`,n.ariaHidden=`true`,n.style.backgroundColor=this.#defaultColor,e.append(n),e}renderMainDropdown(){let e=this.#dropdown=this.#getDropdownRoot();return e.ariaOrientation=`horizontal`,e.ariaLabelledBy=`highlightColorPickerLabel`,e}#getDropdownRoot(){let t=document.createElement(`div`),n=this.#uiManager._signal;t.addEventListener(`contextmenu`,ci,{signal:n}),t.className=`dropdown`,t.role=`listbox`,t.ariaMultiSelectable=`false`,t.ariaOrientation=`vertical`,t.setAttribute(`data-l10n-id`,`pdfjs-editor-colorpicker-dropdown`),this.#editor&&(t.id=`${this.#editor.id}_colorpicker_dropdown`);for(let[r,i]of this.#uiManager.highlightColors){let a=document.createElement(`button`);a.tabIndex=`0`,a.role=`option`,a.setAttribute(`data-color`,i),a.title=r,a.setAttribute(`data-l10n-id`,e.#l10nColor[r]);let o=document.createElement(`span`);a.append(o),o.className=`swatch`,o.style.backgroundColor=i,a.ariaSelected=i===this.#defaultColor,a.addEventListener(`click`,this.#colorSelect.bind(this,i),{signal:n}),t.append(a)}return t.addEventListener(`keydown`,this.#keyDown.bind(this),{signal:n}),t}#colorSelect(e,t){t.stopPropagation(),this.#eventBus.dispatch(`switchannotationeditorparams`,{source:this,type:ir.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#button){this.#openDropdown(e);return}let t=e.target.getAttribute(`data-color`);t&&this.#colorSelect(t,e)}_moveToNext(e){if(!this.#isDropdownVisible){this.#openDropdown(e);return}if(e.target===this.#button){this.#dropdown.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#dropdown?.firstChild||e.target===this.#button){this.#isDropdownVisible&&this._hideDropdownFromKeyboard();return}this.#isDropdownVisible||this.#openDropdown(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#isDropdownVisible){this.#openDropdown(e);return}this.#dropdown.firstChild?.focus()}_moveToEnd(e){if(!this.#isDropdownVisible){this.#openDropdown(e);return}this.#dropdown.lastChild?.focus()}#keyDown(t){e._keyboardManager.exec(this,t)}#openDropdown(e){if(this.#isDropdownVisible){this.hideDropdown();return}if(this.#dropdownWasFromKeyboard=e.detail===0,this.#openDropdownAC||(this.#openDropdownAC=new AbortController,window.addEventListener(`pointerdown`,this.#pointerDown.bind(this),{signal:this.#uiManager.combinedSignal(this.#openDropdownAC)})),this.#button.ariaExpanded=`true`,this.#dropdown){this.#dropdown.classList.remove(`hidden`);return}let t=this.#dropdown=this.#getDropdownRoot();this.#button.append(t)}#pointerDown(e){this.#dropdown?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#dropdown?.classList.add(`hidden`),this.#button.ariaExpanded=`false`,this.#openDropdownAC?.abort(),this.#openDropdownAC=null}get#isDropdownVisible(){return this.#dropdown&&!this.#dropdown.classList.contains(`hidden`)}_hideDropdownFromKeyboard(){if(!this.#isMainColorPicker){if(!this.#isDropdownVisible){this.#editor?.unselect();return}this.hideDropdown(),this.#button.focus({preventScroll:!0,focusVisible:this.#dropdownWasFromKeyboard})}}updateColor(e){if(this.#buttonSwatch&&(this.#buttonSwatch.style.backgroundColor=e),!this.#dropdown)return;let t=this.#uiManager.highlightColors.values();for(let n of this.#dropdown.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#button?.remove(),this.#button=null,this.#buttonSwatch=null,this.#dropdown?.remove(),this.#dropdown=null}},vs=class e{#input=null;#editor=null;#uiManager=null;static#l10nColor=null;constructor(t){this.#editor=t,this.#uiManager=t._uiManager,e.#l10nColor||=Object.freeze({freetext:`pdfjs-editor-color-picker-free-text-input`,ink:`pdfjs-editor-color-picker-ink-input`})}renderButton(){if(this.#input)return this.#input;let{editorType:t,colorType:n,colorValue:r}=this.#editor,i=this.#input=document.createElement(`input`);return i.type=`color`,i.value=r||`#000000`,i.className=`basicColorPicker`,i.tabIndex=0,i.setAttribute(`data-l10n-id`,e.#l10nColor[t]),i.addEventListener(`input`,()=>{this.#uiManager.updateParams(n,i.value)},{signal:this.#uiManager._signal}),i}update(e){this.#input&&(this.#input.value=e)}destroy(){this.#input?.remove(),this.#input=null}hideDropdown(){}};function ys(e){return Math.floor(Math.max(0,Math.min(1,e))*255).toString(16).padStart(2,`0`)}function bs(e){return Math.max(0,Math.min(255,255*e))}var xs=class{static CMYK_G([e,t,n,r]){return[`G`,1-Math.min(1,.3*e+.59*n+.11*t+r)]}static G_CMYK([e]){return[`CMYK`,0,0,0,1-e]}static G_RGB([e]){return[`RGB`,e,e,e]}static G_rgb([e]){return e=bs(e),[e,e,e]}static G_HTML([e]){let t=ys(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return[`G`,.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(bs)}static RGB_HTML(e){return`#${e.map(ys).join(``)}`}static T_HTML(){return`#00000000`}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,r]){return[`RGB`,1-Math.min(1,e+r),1-Math.min(1,n+r),1-Math.min(1,t+r)]}static CMYK_rgb([e,t,n,r]){return[bs(1-Math.min(1,e+r)),bs(1-Math.min(1,n+r)),bs(1-Math.min(1,t+r))]}static CMYK_HTML(e){let t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){let r=1-e,i=1-t,a=1-n;return[`CMYK`,r,i,a,Math.min(r,i,a)]}},Ss=class{create(e,t,n=!1){if(e<=0||t<=0)throw Error(`Invalid SVG dimensions`);let r=this._createSVG(`svg:svg`);return r.setAttribute(`version`,`1.1`),n||(r.setAttribute(`width`,`${e}px`),r.setAttribute(`height`,`${t}px`)),r.setAttribute(`preserveAspectRatio`,`none`),r.setAttribute(`viewBox`,`0 0 ${e} ${t}`),r}createElement(e){if(typeof e!=`string`)throw Error(`Invalid SVG element type`);return this._createSVG(e)}_createSVG(e){yr("Abstract method `_createSVG` called.")}},Cs=class extends Ss{_createSVG(e){return document.createElementNS(Zr,e)}},ws=9,Ts=new WeakSet,Es=new Date().getTimezoneOffset()*60*1e3,Ds=class{static create(e){switch(e.data.annotationType){case cr.LINK:return new As(e);case cr.TEXT:return new js(e);case cr.WIDGET:switch(e.data.fieldType){case`Tx`:return new Ns(e);case`Btn`:return e.data.radioButton?new Is(e):e.data.checkBox?new Fs(e):new Ls(e);case`Ch`:return new Rs(e);case`Sig`:return new Ps(e)}return new Ms(e);case cr.POPUP:return new zs(e);case cr.FREETEXT:return new Vs(e);case cr.LINE:return new Hs(e);case cr.SQUARE:return new Us(e);case cr.CIRCLE:return new Ws(e);case cr.POLYLINE:return new Gs(e);case cr.CARET:return new qs(e);case cr.INK:return new Js(e);case cr.POLYGON:return new Ks(e);case cr.HIGHLIGHT:return new Ys(e);case cr.UNDERLINE:return new Xs(e);case cr.SQUIGGLY:return new Zs(e);case cr.STRIKEOUT:return new Qs(e);case cr.STAMP:return new $s(e);case cr.FILEATTACHMENT:return new ec(e);default:return new Os(e)}}},Os=class e{#updates=null;#hasBorder=!1;#popupElement=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return e._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){let{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){let e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;let{quadPoints:t,inkLists:n,rect:r}=this.data,i=-1/0,a=-1/0;if(t?.length>=8){for(let e=0;e<t.length;e+=8)t[e+1]>a?(a=t[e+1],i=t[e+2]):t[e+1]===a&&(i=Math.max(i,t[e+2]));return[i,a]}if(n?.length>=1){for(let e of n)for(let t=0,n=e.length;t<n;t+=2)e[t+1]>a?(a=e[t+1],i=e[t]):e[t+1]===a&&(i=Math.max(i,e[t]));if(i!==1/0)return[i,a]}return r?[r[2],r[3]]:null}_normalizePoint(e){let{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:r,pageX:i,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-i)/n,e[1]=100*(e[1]-a)/r,e}get commentText(){let{data:e}=this;return this.annotationStorage.getRawValue(`${nr}${e.id}`)?.popup?.contents||e.contentsObj?.str||``}set commentText(e){let{data:t}=this,n={deleted:!e,contents:e||``};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${nr}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#popupElement?.popup||this.popup)?.remove(),this.#popupElement=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#updates||={rect:this.data.rect.slice(0)});let{rect:t,popup:n}=e;t&&this.#setRectEdited(t);let r=this.#popupElement?.popup||this.popup;!r&&n?.text&&(this._createPopup(n),r=this.#popupElement.popup),r&&(r.updateEdited(e),n?.deleted&&(r.remove(),this.#popupElement=null,this.popup=null))}resetEdited(){this.#updates&&=(this.#setRectEdited(this.#updates.rect),this.#popupElement?.popup.resetEdited(),null)}#setRectEdited(e){let{container:{style:t},data:{rect:n,rotation:r},parent:{viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:o,pageY:s}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-o)/i}%`,t.top=`${100*(a-e[3]+s)/a}%`,r===0?(t.width=`${100*(e[2]-e[0])/i}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(r)}_createContainer(e){let{data:t,parent:{page:n,viewport:r}}=this,i=document.createElement(`section`);i.setAttribute(`data-annotation-id`,t.id),!(this instanceof Ms)&&!(this instanceof As)&&(i.tabIndex=0);let{style:a}=i;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(i.title=t.alternativeText),t.noRotate&&i.classList.add(`norotate`),!t.rect||this instanceof zs){let{rotation:e}=t;return!t.hasOwnCanvas&&e!==0&&this.setRotation(e,i),i}let{width:o,height:s}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;let e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;switch(e>0||n>0?a.borderRadius=`calc(${e}px * var(--total-scale-factor)) / calc(${n}px * var(--total-scale-factor))`:this instanceof Is&&(a.borderRadius=`calc(${o}px * var(--total-scale-factor)) / calc(${s}px * var(--total-scale-factor))`),t.borderStyle.style){case lr.SOLID:a.borderStyle=`solid`;break;case lr.DASHED:a.borderStyle=`dashed`;break;case lr.BEVELED:vr(`Unimplemented border style: beveled`);break;case lr.INSET:vr(`Unimplemented border style: inset`);break;case lr.UNDERLINE:a.borderBottomStyle=`solid`;break;default:break}let r=t.borderColor||null;r?(this.#hasBorder=!0,a.borderColor=Z.makeHexColor(r[0]|0,r[1]|0,r[2]|0)):a.borderWidth=0}let c=Z.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:l,pageHeight:u,pageX:d,pageY:f}=r.rawDims;a.left=`${100*(c[0]-d)/l}%`,a.top=`${100*(c[1]-f)/u}%`;let{rotation:p}=t;return t.hasOwnCanvas||p===0?(a.width=`${100*o/l}%`,a.height=`${100*s/u}%`):this.setRotation(p,i),i}setRotation(e,t=this.container){if(!this.data.rect)return;let{pageWidth:n,pageHeight:r}=this.parent.viewport.rawDims,{width:i,height:a}=this;e%180!=0&&([i,a]=[a,i]),t.style.width=`${100*i/n}%`,t.style.height=`${100*a/r}%`,t.setAttribute(`data-main-rotation`,(360-e)%360)}get _commonActions(){let e=(e,t,n)=>{let r=n.detail[e],i=r[0],a=r.slice(1);n.target.style[t]=xs[`${i}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[t]:xs[`${i}_rgb`](a)})};return wr(this,`_commonActions`,{display:e=>{let{display:t}=e.detail,n=t%2==1;this.container.style.visibility=n?`hidden`:`visible`,this.annotationStorage.setValue(this.data.id,{noView:n,noPrint:t===1||t===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{let{hidden:t}=e.detail;this.container.style.visibility=t?`hidden`:`visible`,this.annotationStorage.setValue(this.data.id,{noPrint:t,noView:t})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:t=>{e(`bgColor`,`backgroundColor`,t)},fillColor:t=>{e(`fillColor`,`backgroundColor`,t)},fgColor:t=>{e(`fgColor`,`color`,t)},textColor:t=>{e(`textColor`,`color`,t)},borderColor:t=>{e(`borderColor`,`borderColor`,t)},strokeColor:t=>{e(`strokeColor`,`borderColor`,t)},rotation:e=>{let t=e.detail.rotation;this.setRotation(t),this.annotationStorage.setValue(this.data.id,{rotation:t})}})}_dispatchEventFromSandbox(e,t){let n=this._commonActions;for(let r of Object.keys(t.detail))(e[r]||n[r])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;let t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;let n=this._commonActions;for(let[r,i]of Object.entries(t)){let a=n[r];a&&(a({detail:{[r]:i},target:e}),delete t[r])}}_createQuadrilaterals(){if(!this.container)return;let{quadPoints:e}=this.data;if(!e)return;let[t,n,r,i]=this.data.rect.map(e=>Math.fround(e));if(e.length===8){let[a,o,s,c]=e.subarray(2,6);if(r===a&&i===o&&t===s&&n===c)return}let{style:a}=this.container,o;if(this.#hasBorder){let{borderColor:e,borderWidth:t}=a;a.borderWidth=0,o=[`url('data:image/svg+xml;utf8,`,`<svg xmlns="http://www.w3.org/2000/svg"`,` preserveAspectRatio="none" viewBox="0 0 1 1">`,`<g fill="transparent" stroke="${e}" stroke-width="${t}">`],this.container.classList.add(`hasBorder`)}let s=r-t,c=i-n,{svgFactory:l}=this,u=l.createElement(`svg`);u.classList.add(`quadrilateralsContainer`),u.setAttribute(`width`,0),u.setAttribute(`height`,0),u.role=`none`;let d=l.createElement(`defs`);u.append(d);let f=l.createElement(`clipPath`),p=`clippath_${this.data.id}`;f.setAttribute(`id`,p),f.setAttribute(`clipPathUnits`,`objectBoundingBox`),d.append(f);for(let n=2,r=e.length;n<r;n+=8){let r=e[n],a=e[n+1],u=e[n+2],d=e[n+3],p=l.createElement(`rect`),m=(u-t)/s,h=(i-a)/c,g=(r-u)/s,_=(a-d)/c;p.setAttribute(`x`,m),p.setAttribute(`y`,h),p.setAttribute(`width`,g),p.setAttribute(`height`,_),f.append(p),o?.push(`<rect vector-effect="non-scaling-stroke" x="${m}" y="${h}" width="${g}" height="${_}"/>`)}this.#hasBorder&&(o.push(`</g></svg>')`),a.backgroundImage=o.join(``)),this.container.append(u),this.container.style.clipPath=`url(#${p})`}_createPopup(e=null){let{data:t}=this,n,r;e?(n={str:e.text},r=e.date):(n=t.contentsObj,r=t.modificationDate);let i=this.#popupElement=new zs({data:{color:t.color,titleObj:t.titleObj,modificationDate:r,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(i.render())}get hasPopupElement(){return!!(this.#popupElement||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#popupElement}render(){yr("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){let n=[];if(this._fieldObjects){let r=this._fieldObjects[e];if(r)for(let{page:e,id:i,exportValues:a}of r){if(e===-1||i===t)continue;let r=typeof a==`string`?a:null,o=document.querySelector(`[data-element-id="${i}"]`);if(o&&!Ts.has(o)){vr(`_getElementsByName - element not allowed: ${i}`);continue}n.push({id:i,exportValue:r,domElement:o})}return n}for(let r of document.getElementsByName(e)){let{exportValue:e}=r,i=r.getAttribute(`data-element-id`);i!==t&&Ts.has(r)&&n.push({id:i,exportValue:e,domElement:r})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){let e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(let t of e)t.classList.add(`highlightArea`);else e.classList.add(`highlightArea`)}_editOnDoubleClick(){if(!this._isEditable)return;let{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener(`dblclick`,()=>{this.linkService.eventBus?.dispatch(`switchannotationeditormode`,{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}},ks=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className=`editorAnnotation`,this.container}createOrUpdatePopup(){let{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}},As=class extends Os{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){let{data:e,linkService:t}=this,n=document.createElement(`a`);n.setAttribute(`data-element-id`,e.id);let r=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),r=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),r=!0):e.attachment?(this.#bindAttachment(n,e.attachment,e.overlaidText,e.attachmentDest),r=!0):e.setOCGState?(this.#bindSetOCGState(n,e.setOCGState,e.overlaidText),r=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),r=!0):(e.actions&&(e.actions.Action||e.actions[`Mouse Up`]||e.actions[`Mouse Down`])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),r=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(n,``),r=!0)),this.container.classList.add(`linkAnnotation`),r&&this.container.append(n),this.container}#setInternalLink(){this.container.setAttribute(`data-internal-link`,``)}_bindLink(e,t,n=``){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t===``)&&this.#setInternalLink(),n&&(e.title=n)}_bindNamedAction(e,t,n=``){e.href=this.linkService.getAnchorUrl(``),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#setInternalLink()}#bindAttachment(e,t,n=``,r=null){e.href=this.linkService.getAnchorUrl(``),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,r),!1),this.#setInternalLink()}#bindSetOCGState(e,t,n=``){e.href=this.linkService.getAnchorUrl(``),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#setInternalLink()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl(``);let n=new Map([[`Action`,`onclick`],[`Mouse Up`,`onmouseup`],[`Mouse Down`,`onmousedown`]]);for(let r of Object.keys(t.actions)){let i=n.get(r);i&&(e[i]=()=>(this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t.id,name:r}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||=()=>!1,this.#setInternalLink()}_bindResetFormAction(e,t){let n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl(``)),this.#setInternalLink(),!this._fieldObjects){vr('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();let{fields:e,refs:r,include:i}=t,a=[];if(e.length!==0||r.length!==0){let t=new Set(r);for(let n of e){let e=this._fieldObjects[n]||[];for(let{id:n}of e)t.add(n)}for(let e of Object.values(this._fieldObjects))for(let n of e)t.has(n.id)===i&&a.push(n)}else for(let e of Object.values(this._fieldObjects))a.push(...e);let o=this.annotationStorage,s=[];for(let e of a){let{id:t}=e;switch(s.push(t),e.type){case`text`:{let n=e.defaultValue||``;o.setValue(t,{value:n});break}case`checkbox`:case`radiobutton`:{let n=e.defaultValue===e.exportValues;o.setValue(t,{value:n});break}case`combobox`:case`listbox`:{let n=e.defaultValue||``;o.setValue(t,{value:n});break}default:continue}let n=document.querySelector(`[data-element-id="${t}"]`);if(n){if(!Ts.has(n)){vr(`_bindResetFormAction - element not allowed: ${t}`);continue}}else continue;n.dispatchEvent(new Event(`resetform`))}return this.enableScripting&&this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:`app`,ids:s,name:`ResetForm`}}),!1}}},js=class extends Os{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add(`textAnnotation`);let e=document.createElement(`img`);return e.src=this.imageResourcesPath+`annotation-`+this.data.name.toLowerCase()+`.svg`,e.setAttribute(`data-l10n-id`,`pdfjs-text-annotation-type`),e.setAttribute(`data-l10n-args`,JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}},Ms=class extends Os{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName===`CANVAS`&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Lr.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,r,i){n.includes(`mouse`)?e.addEventListener(n,e=>{this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:this.data.id,name:r,value:i(e),shift:e.shiftKey,modifier:this._getKeyModifier(e)}})}):e.addEventListener(n,e=>{if(n===`blur`){if(!t.focused||!e.relatedTarget)return;t.focused=!1}else if(n===`focus`){if(t.focused)return;t.focused=!0}i&&this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:this.data.id,name:r,value:i(e)}})})}_setEventListeners(e,t,n,r){for(let[i,a]of n)(a===`Action`||this.data.actions?.[a])&&((a===`Focus`||a===`Blur`)&&(t||={focused:!1}),this._setEventListener(e,t,i,a,r),a===`Focus`&&!this.data.actions?.Blur?this._setEventListener(e,t,`blur`,`Blur`,null):a===`Blur`&&!this.data.actions?.Focus&&this._setEventListener(e,t,`focus`,`Focus`,null))}_setBackgroundColor(e){let t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?`transparent`:Z.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){let t=[`left`,`center`,`right`],{fontColor:n}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||ws,i=e.style,a,o=e=>Math.round(10*e)/10;if(this.data.multiLine){let e=Math.abs(this.data.rect[3]-this.data.rect[1]-2),t=Math.round(e/($n*r))||1,n=e/t;a=Math.min(r,o(n/$n))}else{let e=Math.abs(this.data.rect[3]-this.data.rect[1]-2);a=Math.min(r,o(e/$n))}i.fontSize=`calc(${a}px * var(--total-scale-factor))`,i.color=Z.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(i.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute(`required`,!0):e.removeAttribute(`required`),e.setAttribute(`aria-required`,t)}},Ns=class extends Ms{constructor(e){let t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,r){let i=this.annotationStorage;for(let a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),i.setValue(a.id,{[r]:n})}render(){let e=this.annotationStorage,t=this.data.id;this.container.classList.add(`textWidgetAnnotation`);let n=null;if(this.renderForms){let r=e.getValue(t,{value:this.data.fieldValue}),i=r.value||``,a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&i.length>a&&(i=i.slice(0,a));let o=r.formattedValue||this.data.textContent?.join(`
`)||null;o&&this.data.comb&&(o=o.replaceAll(/\s+/g,``));let s={userValue:i,formattedValue:o,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement(`textarea`),n.textContent=o??i,this.data.doNotScroll&&(n.style.overflowY=`hidden`)):(n=document.createElement(`input`),n.type=this.data.password?`password`:`text`,n.setAttribute(`value`,o??i),this.data.doNotScroll&&(n.style.overflowX=`hidden`)),this.data.hasOwnCanvas&&(n.hidden=!0),Ts.add(n),n.setAttribute(`data-element-id`,t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;let{datetimeFormat:c,datetimeType:l,timeStep:u}=this.data,d=!!l&&this.enableScripting;c&&(n.title=c),this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener(`input`,r=>{e.setValue(t,{value:r.target.value}),this.setPropertyOnSiblings(n,`value`,r.target.value,`value`),s.formattedValue=null}),n.addEventListener(`resetform`,e=>{n.value=s.userValue=this.data.defaultFieldValue??``,s.formattedValue=null});let f=e=>{let{formattedValue:t}=s;t!=null&&(e.target.value=t),e.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener(`focus`,e=>{if(s.focused)return;let{target:t}=e;if(d&&(t.type=l,u&&(t.step=u)),s.userValue){let e=s.userValue;if(d)if(l===`time`){let n=new Date(e);t.value=[n.getHours(),n.getMinutes(),n.getSeconds()].map(e=>e.toString().padStart(2,`0`)).join(`:`)}else t.value=new Date(e-Es).toISOString().split(l===`date`?`T`:`.`,1)[0];else t.value=e}s.lastCommittedValue=t.value,s.commitKey=1,this.data.actions?.Focus||(s.focused=!0)}),n.addEventListener(`updatefromsandbox`,n=>{this.showElementAndHideCanvas(n.target),this._dispatchEventFromSandbox({value(n){s.userValue=n.detail.value??``,d||e.setValue(t,{value:s.userValue.toString()}),n.target.value=s.userValue},formattedValue(n){let{formattedValue:r}=n.detail;s.formattedValue=r,r!=null&&n.target!==document.activeElement&&(n.target.value=r);let i={formattedValue:r};d&&(i.value=r),e.setValue(t,i)},selRange(e){e.target.setSelectionRange(...e.detail.selRange)},charLimit:n=>{let{charLimit:r}=n.detail,{target:i}=n;if(r===0){i.removeAttribute(`maxLength`);return}i.setAttribute(`maxLength`,r);let a=s.userValue;!a||a.length<=r||(a=a.slice(0,r),i.value=s.userValue=a,e.setValue(t,{value:a}),this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t,name:`Keystroke`,value:a,willCommit:!0,commitKey:1,selStart:i.selectionStart,selEnd:i.selectionEnd}}))}},n)}),n.addEventListener(`keydown`,e=>{s.commitKey=1;let n=-1;if(e.key===`Escape`?n=0:e.key===`Enter`&&!this.data.multiLine?n=2:e.key===`Tab`&&(s.commitKey=3),n===-1)return;let{value:r}=e.target;s.lastCommittedValue!==r&&(s.lastCommittedValue=r,s.userValue=r,this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t,name:`Keystroke`,value:r,willCommit:!0,commitKey:n,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}))});let r=f;f=null,n.addEventListener(`blur`,e=>{if(!s.focused||!e.relatedTarget)return;this.data.actions?.Blur||(s.focused=!1);let{target:n}=e,{value:i}=n;if(d){if(i&&l===`time`){let e=i.split(`:`).map(e=>parseInt(e,10));i=new Date(2e3,0,1,e[0],e[1],e[2]||0).valueOf(),n.step=``}else i.includes(`T`)||(i=`${i}T00:00`),i=new Date(i).valueOf();n.type=`text`}s.userValue=i,s.lastCommittedValue!==i&&this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t,name:`Keystroke`,value:i,willCommit:!0,commitKey:s.commitKey,selStart:e.target.selectionStart,selEnd:e.target.selectionEnd}}),r(e)}),this.data.actions?.Keystroke&&n.addEventListener(`beforeinput`,e=>{s.lastCommittedValue=null;let{data:n,target:r}=e,{value:i,selectionStart:a,selectionEnd:o}=r,c=a,l=o;switch(e.inputType){case`deleteWordBackward`:{let e=i.substring(0,a).match(/\w*[^\w]*$/);e&&(c-=e[0].length);break}case`deleteWordForward`:{let e=i.substring(a).match(/^[^\w]*\w*/);e&&(l+=e[0].length);break}case`deleteContentBackward`:a===o&&--c;break;case`deleteContentForward`:a===o&&(l+=1);break}e.preventDefault(),this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t,name:`Keystroke`,value:i,change:n||``,willCommit:!1,selStart:c,selEnd:l}})}),this._setEventListeners(n,s,[[`focus`,`Focus`],[`blur`,`Blur`],[`mousedown`,`Mouse Down`],[`mouseenter`,`Mouse Enter`],[`mouseleave`,`Mouse Exit`],[`mouseup`,`Mouse Up`]],e=>e.target.value)}if(f&&n.addEventListener(`blur`,f),this.data.comb){let e=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add(`comb`),n.style.letterSpacing=`calc(${e}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement(`div`),n.textContent=this.data.fieldValue,n.style.verticalAlign=`middle`,n.style.display=`table-cell`,this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}},Ps=class extends Ms{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}},Fs=class extends Ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof r==`string`&&(r=r!==`Off`,e.setValue(n,{value:r})),this.container.classList.add(`buttonWidgetAnnotation`,`checkBox`);let i=document.createElement(`input`);return Ts.add(i),i.setAttribute(`data-element-id`,n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type=`checkbox`,i.name=t.fieldName,r&&i.setAttribute(`checked`,!0),i.setAttribute(`exportValue`,t.exportValue),i.tabIndex=0,i.addEventListener(`change`,r=>{let{name:i,checked:a}=r.target;for(let r of this._getElementsByName(i,n)){let n=a&&r.exportValue===t.exportValue;r.domElement&&(r.domElement.checked=n),e.setValue(r.id,{value:n})}e.setValue(n,{value:a})}),i.addEventListener(`resetform`,e=>{let n=t.defaultFieldValue||`Off`;e.target.checked=n===t.exportValue}),this.enableScripting&&this.hasJSActions&&(i.addEventListener(`updatefromsandbox`,t=>{this._dispatchEventFromSandbox({value(t){t.target.checked=t.detail.value!==`Off`,e.setValue(n,{value:t.target.checked})}},t)}),this._setEventListeners(i,null,[[`change`,`Validate`],[`change`,`Action`],[`focus`,`Focus`],[`blur`,`Blur`],[`mousedown`,`Mouse Down`],[`mouseenter`,`Mouse Enter`],[`mouseleave`,`Mouse Exit`],[`mouseup`,`Mouse Up`]],e=>e.target.checked)),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},Is=class extends Ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add(`buttonWidgetAnnotation`,`radioButton`);let e=this.annotationStorage,t=this.data,n=t.id,r=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof r==`string`&&(r=r!==t.buttonValue,e.setValue(n,{value:r})),r)for(let r of this._getElementsByName(t.fieldName,n))e.setValue(r.id,{value:!1});let i=document.createElement(`input`);if(Ts.add(i),i.setAttribute(`data-element-id`,n),i.disabled=t.readOnly,this._setRequired(i,this.data.required),i.type=`radio`,i.name=t.fieldName,r&&i.setAttribute(`checked`,!0),i.tabIndex=0,i.addEventListener(`change`,t=>{let{name:r,checked:i}=t.target;for(let t of this._getElementsByName(r,n))e.setValue(t.id,{value:!1});e.setValue(n,{value:i})}),i.addEventListener(`resetform`,e=>{let n=t.defaultFieldValue;e.target.checked=n!=null&&n===t.buttonValue}),this.enableScripting&&this.hasJSActions){let r=t.buttonValue;i.addEventListener(`updatefromsandbox`,t=>{this._dispatchEventFromSandbox({value:t=>{let i=r===t.detail.value;for(let r of this._getElementsByName(t.target.name)){let t=i&&r.id===n;r.domElement&&(r.domElement.checked=t),e.setValue(r.id,{value:t})}}},t)}),this._setEventListeners(i,null,[[`change`,`Validate`],[`change`,`Action`],[`focus`,`Focus`],[`blur`,`Blur`],[`mousedown`,`Mouse Down`],[`mouseenter`,`Mouse Enter`],[`mouseleave`,`Mouse Exit`],[`mouseup`,`Mouse Up`]],e=>e.target.checked)}return this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}},Ls=class extends As{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){let e=super.render();e.classList.add(`buttonWidgetAnnotation`,`pushButton`);let t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener(`updatefromsandbox`,e=>{this._dispatchEventFromSandbox({},e)})),e}},Rs=class extends Ms{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add(`choiceWidgetAnnotation`);let e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),r=document.createElement(`select`);Ts.add(r),r.setAttribute(`data-element-id`,t),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let i=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener(`resetform`,e=>{let t=this.data.defaultFieldValue;for(let e of r.options)e.selected=e.value===t});for(let e of this.data.options){let t=document.createElement(`option`);t.textContent=e.displayValue,t.value=e.exportValue,n.value.includes(e.exportValue)&&(t.setAttribute(`selected`,!0),i=!1),r.append(t)}let a=null;if(i){let e=document.createElement(`option`);e.value=` `,e.setAttribute(`hidden`,!0),e.setAttribute(`selected`,!0),r.prepend(e),a=()=>{e.remove(),r.removeEventListener(`input`,a),a=null},r.addEventListener(`input`,a)}let o=e=>{let t=e?`value`:`textContent`,{options:n,multiple:i}=r;return i?Array.prototype.filter.call(n,e=>e.selected).map(e=>e[t]):n.selectedIndex===-1?null:n[n.selectedIndex][t]},s=o(!1),c=e=>{let t=e.target.options;return Array.prototype.map.call(t,e=>({displayValue:e.textContent,exportValue:e.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener(`updatefromsandbox`,n=>{this._dispatchEventFromSandbox({value(n){a?.();let i=n.detail.value,c=new Set(Array.isArray(i)?i:[i]);for(let e of r.options)e.selected=c.has(e.value);e.setValue(t,{value:o(!0)}),s=o(!1)},multipleSelection(e){r.multiple=!0},remove(n){let i=r.options,a=n.detail.remove;i[a].selected=!1,r.remove(a),i.length>0&&Array.prototype.findIndex.call(i,e=>e.selected)===-1&&(i[0].selected=!0),e.setValue(t,{value:o(!0),items:c(n)}),s=o(!1)},clear(n){for(;r.length!==0;)r.remove(0);e.setValue(t,{value:null,items:[]}),s=o(!1)},insert(n){let{index:i,displayValue:a,exportValue:l}=n.detail.insert,u=r.children[i],d=document.createElement(`option`);d.textContent=a,d.value=l,u?u.before(d):r.append(d),e.setValue(t,{value:o(!0),items:c(n)}),s=o(!1)},items(n){let{items:i}=n.detail;for(;r.length!==0;)r.remove(0);for(let e of i){let{displayValue:t,exportValue:n}=e,i=document.createElement(`option`);i.textContent=t,i.value=n,r.append(i)}r.options.length>0&&(r.options[0].selected=!0),e.setValue(t,{value:o(!0),items:c(n)}),s=o(!1)},indices(n){let r=new Set(n.detail.indices);for(let e of n.target.options)e.selected=r.has(e.index);e.setValue(t,{value:o(!0)}),s=o(!1)},editable(e){e.target.disabled=!e.detail.editable}},n)}),r.addEventListener(`input`,n=>{let r=o(!0),i=o(!1);e.setValue(t,{value:r}),n.preventDefault(),this.linkService.eventBus?.dispatch(`dispatcheventinsandbox`,{source:this,detail:{id:t,name:`Keystroke`,value:s,change:i,changeEx:r,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[[`focus`,`Focus`],[`blur`,`Blur`],[`mousedown`,`Mouse Down`],[`mouseenter`,`Mouse Enter`],[`mouseleave`,`Mouse Exit`],[`mouseup`,`Mouse Up`],[`input`,`Action`],[`input`,`Validate`]],e=>e.target.value)):r.addEventListener(`input`,function(n){e.setValue(t,{value:o(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}},zs=class extends Os{constructor(e){let{data:t,elements:n,parent:r}=e,i=!!r._commentManager;if(super(e,{isRenderable:!i&&Os._hasPopupData(t)}),this.elements=n,i&&Os._hasPopupData(t)){let e=this.popup=this.#createPopup();for(let t of n)t.popup=e}else this.popup=null}#createPopup(){return new Bs({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){let{container:e}=this;e.classList.add(`popupAnnotation`),e.role=`comment`;let t=this.popup=this.#createPopup(),n=[];for(let e of this.elements)e.popup=t,e.container.ariaHasPopup=`dialog`,n.push(e.data.id),e.addHighlightArea();return this.container.setAttribute(`aria-controls`,n.map(e=>`${Wr}${e}`).join(`,`)),this.container}},Bs=class{#commentManager=null;#boundKeyDown=this.#keyDown.bind(this);#boundHide=this.#hide.bind(this);#boundShow=this.#show.bind(this);#boundToggle=this.#toggle.bind(this);#color=null;#container=null;#contentsObj=null;#dateObj=null;#elements=null;#parent=null;#parentRect=null;#pinned=!1;#popup=null;#popupAbortController=null;#position=null;#commentButton=null;#commentButtonPosition=null;#popupPosition=null;#rect=null;#richText=null;#titleObj=null;#updates=null;#wasVisible=!1;#firstElement=null;#commentText=null;constructor({container:e,color:t,elements:n,titleObj:r,modificationDate:i,contentsObj:a,richText:o,parent:s,rect:c,parentRect:l,open:u,commentManager:d=null}){this.#container=e,this.#titleObj=r,this.#contentsObj=a,this.#richText=o,this.#parent=s,this.#color=t,this.#rect=c,this.#parentRect=l,this.#elements=n,this.#commentManager=d,this.#firstElement=n[0],this.#dateObj=di.toDateObject(i),this.trigger=n.flatMap(e=>e.getElementsToTriggerPopup()),d?this.renderCommentButton():(this.#addEventListeners(),this.#container.hidden=!0,u&&this.#toggle())}#addEventListeners(){if(this.#popupAbortController)return;this.#popupAbortController=new AbortController;let{signal:e}=this.#popupAbortController;for(let t of this.trigger)t.addEventListener(`click`,this.#boundToggle,{signal:e}),t.addEventListener(`pointerenter`,this.#boundShow,{signal:e}),t.addEventListener(`pointerleave`,this.#boundHide,{signal:e}),t.classList.add(`popupTriggerArea`);for(let t of this.#elements)t.container?.addEventListener(`keydown`,this.#boundKeyDown,{signal:e})}#setCommentButtonPosition(){let e=this.#elements.find(e=>e.hasCommentButton);e&&(this.#commentButtonPosition=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#commentButton||(this.#commentButtonPosition||this.#setCommentButtonPosition(),!this.#commentButtonPosition))return;let{signal:e}=this.#popupAbortController=new AbortController,t=!!this.#firstElement.extraPopupElement,n=()=>{this.#commentManager.toggleCommentPopup(this,!0,void 0,!t)},r=()=>{this.#commentManager.toggleCommentPopup(this,!1,!0,!t)},i=()=>{this.#commentManager.toggleCommentPopup(this,!1,!1)};if(t){this.#commentButton=this.#firstElement.container;for(let t of this.trigger)t.ariaHasPopup=`dialog`,t.ariaControls=`commentPopup`,t.addEventListener(`keydown`,this.#boundKeyDown,{signal:e}),t.addEventListener(`click`,n,{signal:e}),t.addEventListener(`pointerenter`,r,{signal:e}),t.addEventListener(`pointerleave`,i,{signal:e}),t.classList.add(`popupTriggerArea`)}else{let t=this.#commentButton=document.createElement(`button`);t.className=`annotationCommentButton`;let a=this.#firstElement.container;t.style.zIndex=a.style.zIndex+1,t.tabIndex=0,t.ariaHasPopup=`dialog`,t.ariaControls=`commentPopup`,t.setAttribute(`data-l10n-id`,`pdfjs-show-comment-button`),this.#updateColor(),this.#updateCommentButtonPosition(),t.addEventListener(`keydown`,this.#boundKeyDown,{signal:e}),t.addEventListener(`click`,n,{signal:e}),t.addEventListener(`pointerenter`,r,{signal:e}),t.addEventListener(`pointerleave`,i,{signal:e}),a.after(t)}}#updateCommentButtonPosition(){if(this.#firstElement.extraPopupElement&&!this.#firstElement.editor)return;this.renderCommentButton();let[e,t]=this.#commentButtonPosition,{style:n}=this.#commentButton;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#updateColor(){this.#firstElement.extraPopupElement||(this.renderCommentButton(),this.#commentButton.style.backgroundColor=this.commentButtonColor||``)}get commentButtonColor(){let{color:e,opacity:t}=this.#firstElement.commentData;return e?this.#parent._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#commentButton?.focus()},0)}getData(){let{richText:e,color:t,opacity:n,creationDate:r,modificationDate:i}=this.#firstElement.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:r,modificationDate:i}}get elementBeforePopup(){return this.#commentButton}get comment(){return this.#commentText||=this.#firstElement.commentText,this.#commentText}set comment(e){e!==this.comment&&(this.#firstElement.commentText=this.#commentText=e)}get parentBoundingClientRect(){return this.#firstElement.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#commentButton&&(this.#commentButton.classList.toggle(`selected`,e),this.#commentButton.ariaExpanded=t)}setSelectedCommentButton(e){this.#commentButton.classList.toggle(`selected`,e)}get commentPopupPosition(){if(this.#popupPosition)return this.#popupPosition;let{x:e,y:t,height:n}=this.#commentButton.getBoundingClientRect(),{x:r,y:i,width:a,height:o}=this.#firstElement.layer.getBoundingClientRect();return[(e-r)/a,(t+n-i)/o]}set commentPopupPosition(e){this.#popupPosition=e}hasDefaultPopupPosition(){return this.#popupPosition===null}get commentButtonPosition(){return this.#commentButtonPosition}get commentButtonWidth(){return this.#commentButton.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){let[t,n]=this.#popupPosition||this.commentButtonPosition.map(e=>e/100),r=this.parentBoundingClientRect,{x:i,y:a,width:o,height:s}=r;this.#commentManager.showDialog(null,this,i+t*o,a+n*s,{...e,parentDimensions:r})}render(){if(this.#popup)return;let e=this.#popup=document.createElement(`div`);if(e.className=`popup`,this.#color){let t=e.style.outlineColor=Z.makeHexColor(...this.#color);e.style.backgroundColor=`color-mix(in srgb, ${t} 30%, white)`}let t=document.createElement(`span`);if(t.className=`header`,this.#titleObj?.str){let e=document.createElement(`span`);e.className=`title`,t.append(e),{dir:e.dir,str:e.textContent}=this.#titleObj}if(e.append(t),this.#dateObj){let e=document.createElement(`time`);e.className=`popupDate`,e.setAttribute(`data-l10n-id`,`pdfjs-annotation-date-time-string`),e.setAttribute(`data-l10n-args`,JSON.stringify({dateObj:this.#dateObj.valueOf()})),e.dateTime=this.#dateObj.toISOString(),t.append(e)}ki({html:this.#html||this.#contentsObj.str,dir:this.#contentsObj?.dir,className:`popupContent`},e),this.#container.append(e)}get#html(){let e=this.#richText,t=this.#contentsObj;return e?.str&&(!t?.str||t.str===e.str)&&this.#richText.html||null}get#fontSize(){return this.#html?.attributes?.style?.fontSize||0}get#fontColor(){return this.#html?.attributes?.style?.color||null}#makePopupContent(e){let t=[],n={str:e,html:{name:`div`,attributes:{dir:`auto`},children:[{name:`p`,children:t}]}},r={style:{color:this.#fontColor,fontSize:this.#fontSize?`calc(${this.#fontSize}px * var(--total-scale-factor))`:``}};for(let n of e.split(`
`))t.push({name:`span`,value:n,attributes:r});return n}#keyDown(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key===`Enter`||e.key===`Escape`&&this.#pinned)&&this.#toggle()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#commentManager){n?(this.remove(),this.#commentText=null):t&&(t.deleted?this.remove():(this.#updateColor(),this.#commentText=t.text)),e&&(this.#commentButtonPosition=null,this.#setCommentButtonPosition(),this.#updateCommentButtonPosition());return}if(n||t?.deleted){this.remove();return}this.#addEventListeners(),this.#updates||={contentsObj:this.#contentsObj,richText:this.#richText},e&&(this.#position=null),t&&t.text&&(this.#richText=this.#makePopupContent(t.text),this.#dateObj=di.toDateObject(t.date),this.#contentsObj=null),this.#popup?.remove(),this.#popup=null}resetEdited(){this.#updates&&({contentsObj:this.#contentsObj,richText:this.#richText}=this.#updates,this.#updates=null,this.#popup?.remove(),this.#popup=null,this.#position=null)}remove(){if(this.#popupAbortController?.abort(),this.#popupAbortController=null,this.#popup?.remove(),this.#popup=null,this.#wasVisible=!1,this.#pinned=!1,this.#commentButton?.remove(),this.#commentButton=null,this.trigger)for(let e of this.trigger)e.classList.remove(`popupTriggerArea`)}#setPosition(){if(this.#position!==null)return;let{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:r,pageY:i}}}=this.#parent,a=!!this.#parentRect,o=a?this.#parentRect:this.#rect;for(let e of this.#elements)if(!o||Z.intersect(e.data.rect,o)!==null){o=e.data.rect,a=!0;break}let s=Z.normalizeRect([o[0],e[3]-o[1]+e[1],o[2],e[3]-o[3]+e[1]]),c=a?o[2]-o[0]+5:0,l=s[0]+c,u=s[1];this.#position=[100*(l-r)/t,100*(u-i)/n];let{style:d}=this.#container;d.left=`${this.#position[0]}%`,d.top=`${this.#position[1]}%`}#toggle(){if(this.#commentManager){this.#commentManager.toggleCommentPopup(this,!1);return}this.#pinned=!this.#pinned,this.#pinned?(this.#show(),this.#container.addEventListener(`click`,this.#boundToggle),this.#container.addEventListener(`keydown`,this.#boundKeyDown)):(this.#hide(),this.#container.removeEventListener(`click`,this.#boundToggle),this.#container.removeEventListener(`keydown`,this.#boundKeyDown))}#show(){this.#popup||this.render(),this.isVisible?this.#pinned&&this.#container.classList.add(`focused`):(this.#setPosition(),this.#container.hidden=!1,this.#container.style.zIndex=parseInt(this.#container.style.zIndex)+1e3)}#hide(){this.#container.classList.remove(`focused`),!(this.#pinned||!this.isVisible)&&(this.#container.hidden=!0,this.#container.style.zIndex=parseInt(this.#container.style.zIndex)-1e3)}forceHide(){this.#wasVisible=this.isVisible,this.#wasVisible&&(this.#container.hidden=!0)}maybeShow(){this.#commentManager||(this.#addEventListeners(),this.#wasVisible&&(this.#popup||this.#show(),this.#wasVisible=!1,this.#container.hidden=!1))}get isVisible(){return this.#commentManager?!1:this.#container.hidden===!1}},Vs=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=rr.FREETEXT}render(){if(this.container.classList.add(`freeTextAnnotation`),this.textContent){let e=document.createElement(`div`);e.classList.add(`annotationTextContent`),e.setAttribute(`role`,`comment`);for(let t of this.textContent){let n=document.createElement(`span`);n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},Hs=class extends Os{#line=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add(`lineAnnotation`);let{data:e,width:t,height:n}=this,r=this.svgFactory.create(t,n,!0),i=this.#line=this.svgFactory.createElement(`svg:line`);return i.setAttribute(`x1`,e.rect[2]-e.lineCoordinates[0]),i.setAttribute(`y1`,e.rect[3]-e.lineCoordinates[1]),i.setAttribute(`x2`,e.rect[2]-e.lineCoordinates[2]),i.setAttribute(`y2`,e.rect[3]-e.lineCoordinates[3]),i.setAttribute(`stroke-width`,e.borderStyle.width||1),i.setAttribute(`stroke`,`transparent`),i.setAttribute(`fill`,`transparent`),r.append(i),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#line}addHighlightArea(){this.container.classList.add(`highlightArea`)}},Us=class extends Os{#square=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add(`squareAnnotation`);let{data:e,width:t,height:n}=this,r=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,a=this.#square=this.svgFactory.createElement(`svg:rect`);return a.setAttribute(`x`,i/2),a.setAttribute(`y`,i/2),a.setAttribute(`width`,t-i),a.setAttribute(`height`,n-i),a.setAttribute(`stroke-width`,i||1),a.setAttribute(`stroke`,`transparent`),a.setAttribute(`fill`,`transparent`),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#square}addHighlightArea(){this.container.classList.add(`highlightArea`)}},Ws=class extends Os{#circle=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add(`circleAnnotation`);let{data:e,width:t,height:n}=this,r=this.svgFactory.create(t,n,!0),i=e.borderStyle.width,a=this.#circle=this.svgFactory.createElement(`svg:ellipse`);return a.setAttribute(`cx`,t/2),a.setAttribute(`cy`,n/2),a.setAttribute(`rx`,t/2-i/2),a.setAttribute(`ry`,n/2-i/2),a.setAttribute(`stroke-width`,i||1),a.setAttribute(`stroke`,`transparent`),a.setAttribute(`fill`,`transparent`),r.append(a),this.container.append(r),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#circle}addHighlightArea(){this.container.classList.add(`highlightArea`)}},Gs=class extends Os{#polyline=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName=`polylineAnnotation`,this.svgElementName=`svg:polyline`}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,vertices:t,borderStyle:n,popupRef:r},width:i,height:a}=this;if(!t)return this.container;let o=this.svgFactory.create(i,a,!0),s=[];for(let n=0,r=t.length;n<r;n+=2){let r=t[n]-e[0],i=e[3]-t[n+1];s.push(`${r},${i}`)}s=s.join(` `);let c=this.#polyline=this.svgFactory.createElement(this.svgElementName);return c.setAttribute(`points`,s),c.setAttribute(`stroke-width`,n.width||1),c.setAttribute(`stroke`,`transparent`),c.setAttribute(`fill`,`transparent`),o.append(c),this.container.append(o),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#polyline}addHighlightArea(){this.container.classList.add(`highlightArea`)}},Ks=class extends Gs{constructor(e){super(e),this.containerClassName=`polygonAnnotation`,this.svgElementName=`svg:polygon`}},qs=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add(`caretAnnotation`),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}},Js=class extends Os{#polylinesGroupElement=null;#polylines=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName=`inkAnnotation`,this.svgElementName=`svg:polyline`,this.annotationEditorType=this.data.it===`InkHighlight`?rr.HIGHLIGHT:rr.INK}#getTransform(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);let{data:{rect:e,rotation:t,inkLists:n,borderStyle:r,popupRef:i}}=this,{transform:a,width:o,height:s}=this.#getTransform(t,e),c=this.svgFactory.create(o,s,!0),l=this.#polylinesGroupElement=this.svgFactory.createElement(`svg:g`);c.append(l),l.setAttribute(`stroke-width`,r.width||1),l.setAttribute(`stroke-linecap`,`round`),l.setAttribute(`stroke-linejoin`,`round`),l.setAttribute(`stroke-miterlimit`,10),l.setAttribute(`stroke`,`transparent`),l.setAttribute(`fill`,`transparent`),l.setAttribute(`transform`,a);for(let e=0,t=n.length;e<t;e++){let t=this.svgFactory.createElement(this.svgElementName);this.#polylines.push(t),t.setAttribute(`points`,n[e].join(`,`)),l.append(t)}return!i&&this.hasPopupData&&this._createPopup(),this.container.append(c),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);let{thickness:t,points:n,rect:r}=e,i=this.#polylinesGroupElement;if(t>=0&&i.setAttribute(`stroke-width`,t||1),n)for(let e=0,t=this.#polylines.length;e<t;e++)this.#polylines[e].setAttribute(`points`,n[e].join(`,`));if(r){let{transform:e,width:t,height:n}=this.#getTransform(this.data.rotation,r);i.parentElement.setAttribute(`viewBox`,`0 0 ${t} ${n}`),i.setAttribute(`transform`,e)}}getElementsToTriggerPopup(){return this.#polylines}addHighlightArea(){this.container.classList.add(`highlightArea`)}},Ys=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=rr.HIGHLIGHT}render(){let{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add(`highlightAnnotation`),this._editOnDoubleClick(),e){let t=document.createElement(`mark`);t.classList.add(`overlaidText`),t.textContent=e,this.container.append(t)}return this.container}},Xs=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){let{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add(`underlineAnnotation`),e){let t=document.createElement(`u`);t.classList.add(`overlaidText`),t.textContent=e,this.container.append(t)}return this.container}},Zs=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){let{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add(`squigglyAnnotation`),e){let t=document.createElement(`u`);t.classList.add(`overlaidText`),t.textContent=e,this.container.append(t)}return this.container}},Qs=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){let{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add(`strikeoutAnnotation`),e){let t=document.createElement(`s`);t.classList.add(`overlaidText`),t.textContent=e,this.container.append(t)}return this.container}},$s=class extends Os{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=rr.STAMP}render(){return this.container.classList.add(`stampAnnotation`),this.container.setAttribute(`role`,`img`),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}},ec=class extends Os{#trigger=null;constructor(e){super(e,{isRenderable:!0});let{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch(`fileattachmentannotation`,{source:this,...t})}render(){this.container.classList.add(`fileAttachmentAnnotation`);let{container:e,data:t}=this,n;t.hasAppearance||t.fillAlpha===0?n=document.createElement(`div`):(n=document.createElement(`img`),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?`paperclip`:`pushpin`}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener(`dblclick`,this.#download.bind(this)),this.#trigger=n;let{isMac:r}=Lr.platform;return e.addEventListener(`keydown`,e=>{e.key===`Enter`&&(r?e.metaKey:e.ctrlKey)&&this.#download()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add(`popupTriggerArea`),e.append(n),e}getElementsToTriggerPopup(){return this.#trigger}addHighlightArea(){this.container.classList.add(`highlightArea`)}#download(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}},tc=class e{#accessibilityManager=null;#annotationCanvasMap=null;#annotationStorage=null;#editableAnnotations=new Map;#structTreeLayer=null;#linkService=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:r,page:i,viewport:a,structTreeLayer:o,commentManager:s,linkService:c,annotationStorage:l}){this.div=e,this.#accessibilityManager=t,this.#annotationCanvasMap=n,this.#structTreeLayer=o||null,this.#linkService=c||null,this.#annotationStorage=l||new Yi,this.page=i,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=s||null}hasEditableAnnotations(){return this.#editableAnnotations.size>0}async#appendElement(e,t,n){let r=e.firstChild||e,i=r.id=`${Wr}${t}`,a=await this.#structTreeLayer?.getAriaAttributes(i);if(a)for(let[e,t]of a)r.setAttribute(e,t);n?n.at(-1).container.after(e):(this.div.append(e),this.#accessibilityManager?.moveElementInDOM(this.div,e,r,!1))}async render(e){let{annotations:t}=e,n=this.div;_i(n,this.viewport);let r=new Map,i={data:null,layer:n,linkService:this.#linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||``,renderForms:e.renderForms!==!1,svgFactory:new Cs,annotationStorage:this.#annotationStorage,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(let e of t){if(e.noHTML)continue;let t=e.annotationType===cr.POPUP;if(t){let t=r.get(e.id);if(!t)continue;i.elements=t}else if(e.rect[2]===e.rect[0]||e.rect[3]===e.rect[1])continue;i.data=e;let n=Ds.create(i);if(!n.isRenderable)continue;if(!t&&e.popupRef){let t=r.get(e.popupRef);t?t.push(n):r.set(e.popupRef,[n])}let a=n.render();e.hidden&&(a.style.visibility=`hidden`),await this.#appendElement(a,e.id,i.elements),n.extraPopupElement?.popup?.renderCommentButton(),n._isEditable&&(this.#editableAnnotations.set(n.data.id,n),this._annotationEditorUIManager?.renderAnnotationElement(n))}this.#setAnnotationCanvasMap()}async addLinkAnnotations(t){let n={data:null,layer:this.div,linkService:this.#linkService,svgFactory:new Cs,parent:this};for(let r of t){r.borderStyle||=e._defaultBorderStyle,n.data=r;let t=Ds.create(n);if(!t.isRenderable)continue;let i=t.render();await this.#appendElement(i,r.id,null)}}update({viewport:e}){let t=this.div;this.viewport=e,_i(t,{rotation:e.rotation}),this.#setAnnotationCanvasMap(),t.hidden=!1}#setAnnotationCanvasMap(){if(!this.#annotationCanvasMap)return;let e=this.div;for(let[t,n]of this.#annotationCanvasMap){let r=e.querySelector(`[data-annotation-id="${t}"]`);if(!r)continue;n.className=`annotationContent`;let{firstChild:i}=r;i?i.nodeName===`CANVAS`?i.replaceWith(n):i.classList.contains(`annotationContent`)?i.after(n):i.before(n):r.append(n);let a=this.#editableAnnotations.get(t);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,r.id,n),a._hasNoCanvas=!1):a.canvas=n)}this.#annotationCanvasMap.clear()}getEditableAnnotations(){return Array.from(this.#editableAnnotations.values())}getEditableAnnotation(e){return this.#editableAnnotations.get(e)}addFakeAnnotation(e){let{div:t}=this,{id:n,rotation:r}=e,i=new ks({data:{id:n,rect:e.getPDFRect(),rotation:r},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#linkService,annotationStorage:this.#annotationStorage}),a=i.render();return t.append(a),this.#accessibilityManager?.moveElementInDOM(t,a,a,!1),i.createOrUpdatePopup(),i}static get _defaultBorderStyle(){return wr(this,`_defaultBorderStyle`,Object.freeze({width:1,rawWidth:1,style:lr.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}},nc=/\r\n?|\n/g,rc=class e extends Hi{#content=``;#editorDivId=`${this.id}-editor`;#editModeAC=null;#fontSize;_colorPicker=null;static _freeTextDefaultContent=``;static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){let t=e.prototype,n=e=>e.isEmpty(),r=Ri.TRANSLATE_SMALL,i=Ri.TRANSLATE_BIG;return wr(this,`_keyboardManager`,new Ii([[[`ctrl+s`,`mac+meta+s`,`ctrl+p`,`mac+meta+p`],t.commitOrRemove,{bubbles:!0}],[[`ctrl+Enter`,`mac+meta+Enter`,`Escape`,`mac+Escape`],t.commitOrRemove],[[`ArrowLeft`,`mac+ArrowLeft`],t._translateEmpty,{args:[-r,0],checker:n}],[[`ctrl+ArrowLeft`,`mac+shift+ArrowLeft`],t._translateEmpty,{args:[-i,0],checker:n}],[[`ArrowRight`,`mac+ArrowRight`],t._translateEmpty,{args:[r,0],checker:n}],[[`ctrl+ArrowRight`,`mac+shift+ArrowRight`],t._translateEmpty,{args:[i,0],checker:n}],[[`ArrowUp`,`mac+ArrowUp`],t._translateEmpty,{args:[0,-r],checker:n}],[[`ctrl+ArrowUp`,`mac+shift+ArrowUp`],t._translateEmpty,{args:[0,-i],checker:n}],[[`ArrowDown`,`mac+ArrowDown`],t._translateEmpty,{args:[0,r],checker:n}],[[`ctrl+ArrowDown`,`mac+shift+ArrowDown`],t._translateEmpty,{args:[0,i],checker:n}]]))}static _type=`freetext`;static _editorType=rr.FREETEXT;constructor(t){super({...t,name:`freeTextEditor`}),this.color=t.color||e._defaultColor||Hi._defaultLineColor,this.#fontSize=t.fontSize||e._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-freetext-added-alert`)}static initialize(e,t){Hi.initialize(e,t);let n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue(`--freetext-padding`))}static updateDefaultParams(t,n){switch(t){case ir.FREETEXT_SIZE:e._defaultFontSize=n;break;case ir.FREETEXT_COLOR:e._defaultColor=n;break}}updateParams(e,t){switch(e){case ir.FREETEXT_SIZE:this.#updateFontSize(t);break;case ir.FREETEXT_COLOR:this.#updateColor(t);break}}static get defaultPropertiesToUpdate(){return[[ir.FREETEXT_SIZE,e._defaultFontSize],[ir.FREETEXT_COLOR,e._defaultColor||Hi._defaultLineColor]]}get propertiesToUpdate(){return[[ir.FREETEXT_SIZE,this.#fontSize],[ir.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new vs(this),[[`colorPicker`,this._colorPicker]]}get colorType(){return ir.FREETEXT_COLOR}#updateFontSize(e){let t=e=>{this.editorDiv.style.fontSize=`calc(${e}px * var(--total-scale-factor))`,this.translate(0,-(e-this.#fontSize)*this.parentScale),this.#fontSize=e,this.#setEditorDimensions()},n=this.#fontSize;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ir.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#updateColor(e){let t=e=>{this.color=e,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ir.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){let t=this.parentScale;return[-e._internalPadding*t,-(e._internalPadding+this.#fontSize)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove(`enabled`),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute(`aria-activedescendant`),this.#editModeAC=new AbortController;let e=this._uiManager.combinedSignal(this.#editModeAC);return this.editorDiv.addEventListener(`keydown`,this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener(`focus`,this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener(`blur`,this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener(`input`,this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener(`paste`,this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add(`enabled`),this.editorDiv.contentEditable=!1,this.div.setAttribute(`aria-activedescendant`,this.#editorDivId),this._isDraggable=!0,this.#editModeAC?.abort(),this.#editModeAC=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add(`freetextEditing`),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===``}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add(`freetextEditing`)),super.remove()}#extractText(){let t=[];this.editorDiv.normalize();let n=null;for(let r of this.editorDiv.childNodes)n?.nodeType===Node.TEXT_NODE&&r.nodeName===`BR`||(t.push(e.#getNodeContent(r)),n=r);return t.join(`
`)}#setEditorDimensions(){let[e,t]=this.parentDimensions,n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{let{currentLayer:e,div:t}=this,r=t.style.display,i=t.classList.contains(`hidden`);t.classList.remove(`hidden`),t.style.display=`hidden`,e.div.append(this.div),n=t.getBoundingClientRect(),t.remove(),t.style.display=r,t.classList.toggle(`hidden`,i)}this.rotation%180==this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();let e=this.#content,t=this.#content=this.#extractText().trimEnd();if(e===t)return;let n=e=>{if(this.#content=e,!e){this.remove();return}this.#setContent(),this._uiManager.rebuild(this),this.#setEditorDimensions()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#setEditorDimensions()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key===`Enter`&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(t){e._keyboardManager.exec(this,t)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle(`freetextEditing`,this.isEmpty())}disableEditing(){this.editorDiv.setAttribute(`role`,`comment`),this.editorDiv.removeAttribute(`aria-multiline`)}enableEditing(){this.editorDiv.setAttribute(`role`,`textbox`),this.editorDiv.setAttribute(`aria-multiline`,!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement(`div`),this.editorDiv.className=`internal`,this.editorDiv.setAttribute(`id`,this.#editorDivId),this.editorDiv.setAttribute(`data-l10n-id`,`pdfjs-free-text2`),this.editorDiv.setAttribute(`data-l10n-attrs`,`default-content`),this.enableEditing(),this.editorDiv.contentEditable=!0;let{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#fontSize}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement(`div`),this.overlayDiv.classList.add(`overlay`,`enabled`),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){let[n,r]=this.parentDimensions;if(this.annotationElementId){let{position:i}=this._initialData,[a,o]=this.getInitialTranslation();[a,o]=this.pageTranslationToScreen(a,o);let[s,c]=this.pageDimensions,[l,u]=this.pageTranslation,d,f;switch(this.rotation){case 0:d=e+(i[0]-l)/s,f=t+this.height-(i[1]-u)/c;break;case 90:d=e+(i[0]-l)/s,f=t-(i[1]-u)/c,[a,o]=[o,-a];break;case 180:d=e-this.width+(i[0]-l)/s,f=t-(i[1]-u)/c,[a,o]=[-a,-o];break;case 270:d=e+(i[0]-l-this.height*c)/s,f=t+(i[1]-u-this.width*s)/c,[a,o]=[-o,a];break}this.setAt(d*n,f*r,a,o)}else this._moveAfterPaste(e,t);this.#setContent(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#getNodeContent(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(nc,``)}editorDivPaste(t){let n=t.clipboardData||window.clipboardData,{types:r}=n;if(r.length===1&&r[0]===`text/plain`)return;t.preventDefault();let i=e.#deserializeContent(n.getData(`text`)||``).replaceAll(nc,`
`);if(!i)return;let a=window.getSelection();if(!a.rangeCount)return;this.editorDiv.normalize(),a.deleteFromDocument();let o=a.getRangeAt(0);if(!i.includes(`
`)){o.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),a.collapseToStart();return}let{startContainer:s,startOffset:c}=o,l=[],u=[];if(s.nodeType===Node.TEXT_NODE){let t=s.parentElement;if(u.push(s.nodeValue.slice(c).replaceAll(nc,``)),t!==this.editorDiv){let n=l;for(let r of this.editorDiv.childNodes){if(r===t){n=u;continue}n.push(e.#getNodeContent(r))}}l.push(s.nodeValue.slice(0,c).replaceAll(nc,``))}else if(s===this.editorDiv){let t=l,n=0;for(let r of this.editorDiv.childNodes)n++===c&&(t=u),t.push(e.#getNodeContent(r))}this.#content=`${l.join(`
`)}${i}${u.join(`
`)}`,this.#setContent();let d=new Range,f=Math.sumPrecise(l.map(e=>e.length));for(let{firstChild:e}of this.editorDiv.childNodes)if(e.nodeType===Node.TEXT_NODE){let t=e.nodeValue.length;if(f<=t){d.setStart(e,f),d.setEnd(e,f);break}f-=t}a.removeAllRanges(),a.addRange(d)}#setContent(){if(this.editorDiv.replaceChildren(),this.#content)for(let e of this.#content.split(`
`)){let t=document.createElement(`div`);t.append(e?document.createTextNode(e):document.createElement(`br`)),this.editorDiv.append(t)}}#serializeContent(){return this.#content.replaceAll(`\xA0`,` `)}static#deserializeContent(e){return e.replaceAll(` `,`\xA0`)}get contentDiv(){return this.editorDiv}getPDFRect(){let t=e._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,n,r){let i=null;if(t instanceof Vs){let{data:{defaultAppearanceData:{fontSize:e,fontColor:n},rect:r,rotation:a,id:o,popupRef:s,richText:c,contentsObj:l,creationDate:u,modificationDate:d},textContent:f,textPosition:p,parent:{page:{pageNumber:m}}}=t;if(!f||f.length===0)return null;i=t={annotationType:rr.FREETEXT,color:Array.from(n),fontSize:e,value:f.join(`
`),position:p,pageIndex:m-1,rect:r.slice(0),rotation:a,annotationElementId:o,id:o,deleted:!1,popupRef:s,comment:l?.str||null,richText:c,creationDate:u,modificationDate:d}}let a=await super.deserialize(t,n,r);return a.#fontSize=t.fontSize,a.color=Z.makeHexColor(...t.color),a.#content=e.#deserializeContent(t.value),a._initialData=i,t.comment&&a.setCommentData(t),a}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let t=Hi._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#fontSize,value:this.#serializeContent()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#hasElementChanged(n)?null:(n.id=this.annotationElementId,n)}#hasElementChanged(e){let{value:t,fontSize:n,color:r,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((e,t)=>e!==r[t])||e.pageIndex!==i}renderAnnotationElement(e){let t=super.renderAnnotationElement(e);if(!t)return null;let{style:n}=t;n.fontSize=`calc(${this.#fontSize}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(let e of this.#content.split(`
`)){let n=document.createElement(`div`);n.append(e?document.createTextNode(e):document.createElement(`br`)),t.append(n)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#content}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}},Q=class{static PRECISION=1e-4;toSVGPath(){yr("Abstract method `toSVGPath` must be implemented.")}get box(){yr("Abstract getter `box` must be implemented.")}serialize(e,t){yr("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,r,i,a){a||=new Float32Array(e.length);for(let o=0,s=e.length;o<s;o+=2)a[o]=t+e[o]*r,a[o+1]=n+e[o+1]*i;return a}static _rescaleAndSwap(e,t,n,r,i,a){a||=new Float32Array(e.length);for(let o=0,s=e.length;o<s;o+=2)a[o]=t+e[o+1]*r,a[o+1]=n+e[o]*i;return a}static _translate(e,t,n,r){r||=new Float32Array(e.length);for(let i=0,a=e.length;i<a;i+=2)r[i]=t+e[i],r[i+1]=n+e[i+1];return r}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,r,i){switch(i){case 90:return[1-t/n,e/r];case 180:return[1-e/n,1-t/r];case 270:return[t/n,1-e/r];default:return[e/n,t/r]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,r,i,a){return[(e+5*n)/6,(t+5*r)/6,(5*n+i)/6,(5*r+a)/6,(n+i)/2,(r+a)/2]}},ic=class e{#box;#bottom=[];#innerMargin;#isLTR;#top=[];#last=new Float32Array(18);#lastX;#lastY;#min;#min_dist;#scaleFactor;#thickness;#points=[];static#MIN_DIST=8;static#MIN_DIFF=2;static#MIN=e.#MIN_DIST+e.#MIN_DIFF;constructor({x:t,y:n},r,i,a,o,s=0){this.#box=r,this.#thickness=a*i,this.#isLTR=o,this.#last.set([NaN,NaN,NaN,NaN,t,n],6),this.#innerMargin=s,this.#min_dist=e.#MIN_DIST*i,this.#min=e.#MIN*i,this.#scaleFactor=i,this.#points.push(t,n)}isEmpty(){return isNaN(this.#last[8])}#getLastCoords(){let e=this.#last.subarray(4,6),t=this.#last.subarray(16,18),[n,r,i,a]=this.#box;return[(this.#lastX+(e[0]-t[0])/2-n)/i,(this.#lastY+(e[1]-t[1])/2-r)/a,(this.#lastX+(t[0]-e[0])/2-n)/i,(this.#lastY+(t[1]-e[1])/2-r)/a]}add({x:e,y:t}){this.#lastX=e,this.#lastY=t;let[n,r,i,a]=this.#box,[o,s,c,l]=this.#last.subarray(8,12),u=e-c,d=t-l,f=Math.hypot(u,d);if(f<this.#min)return!1;let p=f-this.#min_dist,m=p/f,h=m*u,g=m*d,_=o,v=s;o=c,s=l,c+=h,l+=g,this.#points?.push(e,t);let y=-g/p,b=h/p,x=y*this.#thickness,S=b*this.#thickness;return this.#last.set(this.#last.subarray(2,8),0),this.#last.set([c+x,l+S],4),this.#last.set(this.#last.subarray(14,18),12),this.#last.set([c-x,l-S],16),isNaN(this.#last[6])?(this.#top.length===0&&(this.#last.set([o+x,s+S],2),this.#top.push(NaN,NaN,NaN,NaN,(o+x-n)/i,(s+S-r)/a),this.#last.set([o-x,s-S],14),this.#bottom.push(NaN,NaN,NaN,NaN,(o-x-n)/i,(s-S-r)/a)),this.#last.set([_,v,o,s,c,l],6),!this.isEmpty()):(this.#last.set([_,v,o,s,c,l],6),Math.abs(Math.atan2(v-s,_-o)-Math.atan2(g,h))<Math.PI/2?([o,s,c,l]=this.#last.subarray(2,6),this.#top.push(NaN,NaN,NaN,NaN,((o+c)/2-n)/i,((s+l)/2-r)/a),[o,s,_,v]=this.#last.subarray(14,18),this.#bottom.push(NaN,NaN,NaN,NaN,((_+o)/2-n)/i,((v+s)/2-r)/a),!0):([_,v,o,s,c,l]=this.#last.subarray(0,6),this.#top.push(((_+5*o)/6-n)/i,((v+5*s)/6-r)/a,((5*o+c)/6-n)/i,((5*s+l)/6-r)/a,((o+c)/2-n)/i,((s+l)/2-r)/a),[c,l,o,s,_,v]=this.#last.subarray(12,18),this.#bottom.push(((_+5*o)/6-n)/i,((v+5*s)/6-r)/a,((5*o+c)/6-n)/i,((5*s+l)/6-r)/a,((o+c)/2-n)/i,((s+l)/2-r)/a),!0))}toSVGPath(){if(this.isEmpty())return``;let e=this.#top,t=this.#bottom;if(isNaN(this.#last[6])&&!this.isEmpty())return this.#toSVGPathTwoPoints();let n=[];n.push(`M${e[4]} ${e[5]}`);for(let t=6;t<e.length;t+=6)isNaN(e[t])?n.push(`L${e[t+4]} ${e[t+5]}`):n.push(`C${e[t]} ${e[t+1]} ${e[t+2]} ${e[t+3]} ${e[t+4]} ${e[t+5]}`);this.#toSVGPathEnd(n);for(let e=t.length-6;e>=6;e-=6)isNaN(t[e])?n.push(`L${t[e+4]} ${t[e+5]}`):n.push(`C${t[e]} ${t[e+1]} ${t[e+2]} ${t[e+3]} ${t[e+4]} ${t[e+5]}`);return this.#toSVGPathStart(n),n.join(` `)}#toSVGPathTwoPoints(){let[e,t,n,r]=this.#box,[i,a,o,s]=this.#getLastCoords();return`M${(this.#last[2]-e)/n} ${(this.#last[3]-t)/r} L${(this.#last[4]-e)/n} ${(this.#last[5]-t)/r} L${i} ${a} L${o} ${s} L${(this.#last[16]-e)/n} ${(this.#last[17]-t)/r} L${(this.#last[14]-e)/n} ${(this.#last[15]-t)/r} Z`}#toSVGPathStart(e){let t=this.#bottom;e.push(`L${t[4]} ${t[5]} Z`)}#toSVGPathEnd(e){let[t,n,r,i]=this.#box,a=this.#last.subarray(4,6),o=this.#last.subarray(16,18),[s,c,l,u]=this.#getLastCoords();e.push(`L${(a[0]-t)/r} ${(a[1]-n)/i} L${s} ${c} L${l} ${u} L${(o[0]-t)/r} ${(o[1]-n)/i}`)}newFreeDrawOutline(e,t,n,r,i,a){return new ac(e,t,n,r,i,a)}getOutlines(){let e=this.#top,t=this.#bottom,n=this.#last,[r,i,a,o]=this.#box,s=new Float32Array((this.#points?.length??0)+2);for(let e=0,t=s.length-2;e<t;e+=2)s[e]=(this.#points[e]-r)/a,s[e+1]=(this.#points[e+1]-i)/o;if(s[s.length-2]=(this.#lastX-r)/a,s[s.length-1]=(this.#lastY-i)/o,isNaN(n[6])&&!this.isEmpty())return this.#getOutlineTwoPoints(s);let c=new Float32Array(this.#top.length+24+this.#bottom.length),l=e.length;for(let t=0;t<l;t+=2){if(isNaN(e[t])){c[t]=c[t+1]=NaN;continue}c[t]=e[t],c[t+1]=e[t+1]}l=this.#getOutlineEnd(c,l);for(let e=t.length-6;e>=6;e-=6)for(let n=0;n<6;n+=2){if(isNaN(t[e+n])){c[l]=c[l+1]=NaN,l+=2;continue}c[l]=t[e+n],c[l+1]=t[e+n+1],l+=2}return this.#getOutlineStart(c,l),this.newFreeDrawOutline(c,s,this.#box,this.#scaleFactor,this.#innerMargin,this.#isLTR)}#getOutlineTwoPoints(e){let t=this.#last,[n,r,i,a]=this.#box,[o,s,c,l]=this.#getLastCoords(),u=new Float32Array(36);return u.set([NaN,NaN,NaN,NaN,(t[2]-n)/i,(t[3]-r)/a,NaN,NaN,NaN,NaN,(t[4]-n)/i,(t[5]-r)/a,NaN,NaN,NaN,NaN,o,s,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,(t[16]-n)/i,(t[17]-r)/a,NaN,NaN,NaN,NaN,(t[14]-n)/i,(t[15]-r)/a],0),this.newFreeDrawOutline(u,e,this.#box,this.#scaleFactor,this.#innerMargin,this.#isLTR)}#getOutlineStart(e,t){let n=this.#bottom;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#getOutlineEnd(e,t){let n=this.#last.subarray(4,6),r=this.#last.subarray(16,18),[i,a,o,s]=this.#box,[c,l,u,d]=this.#getLastCoords();return e.set([NaN,NaN,NaN,NaN,(n[0]-i)/o,(n[1]-a)/s,NaN,NaN,NaN,NaN,c,l,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,(r[0]-i)/o,(r[1]-a)/s],t),t+=24}},ac=class extends Q{#box;#bbox=new Float32Array(4);#innerMargin;#isLTR;#points;#scaleFactor;#outline;constructor(e,t,n,r,i,a){super(),this.#outline=e,this.#points=t,this.#box=n,this.#scaleFactor=r,this.#innerMargin=i,this.#isLTR=a,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#computeMinMax(a);let[o,s,c,l]=this.#bbox;for(let t=0,n=e.length;t<n;t+=2)e[t]=(e[t]-o)/c,e[t+1]=(e[t+1]-s)/l;for(let e=0,n=t.length;e<n;e+=2)t[e]=(t[e]-o)/c,t[e+1]=(t[e+1]-s)/l}toSVGPath(){let e=[`M${this.#outline[4]} ${this.#outline[5]}`];for(let t=6,n=this.#outline.length;t<n;t+=6){if(isNaN(this.#outline[t])){e.push(`L${this.#outline[t+4]} ${this.#outline[t+5]}`);continue}e.push(`C${this.#outline[t]} ${this.#outline[t+1]} ${this.#outline[t+2]} ${this.#outline[t+3]} ${this.#outline[t+4]} ${this.#outline[t+5]}`)}return e.push(`Z`),e.join(` `)}serialize([e,t,n,r],i){let a=n-e,o=r-t,s,c;switch(i){case 0:s=Q._rescale(this.#outline,e,r,a,-o),c=Q._rescale(this.#points,e,r,a,-o);break;case 90:s=Q._rescaleAndSwap(this.#outline,e,t,a,o),c=Q._rescaleAndSwap(this.#points,e,t,a,o);break;case 180:s=Q._rescale(this.#outline,n,t,-a,o),c=Q._rescale(this.#points,n,t,-a,o);break;case 270:s=Q._rescaleAndSwap(this.#outline,n,r,-a,-o),c=Q._rescaleAndSwap(this.#points,n,r,-a,-o);break}return{outline:Array.from(s),points:[Array.from(c)]}}#computeMinMax(e){let t=this.#outline,n=t[4],r=t[5],i=[n,r,n,r],a=n,o=r,s=n,c=r,l=e?Math.max:Math.min,u=new Float32Array(4);for(let e=6,d=t.length;e<d;e+=6){let d=t[e+4],f=t[e+5];isNaN(t[e])?(Z.pointBoundingBox(d,f,i),o>f?(a=d,o=f):o===f&&(a=l(a,d)),c<f?(s=d,c=f):c===f&&(s=l(s,d))):(u[0]=u[1]=1/0,u[2]=u[3]=-1/0,Z.bezierBoundingBox(n,r,...t.slice(e,e+6),u),Z.rectBoundingBox(u[0],u[1],u[2],u[3],i),o>u[1]?(a=u[0],o=u[1]):o===u[1]&&(a=l(a,u[0])),c<u[3]?(s=u[2],c=u[3]):c===u[3]&&(s=l(s,u[2]))),n=d,r=f}let d=this.#bbox;d[0]=i[0]-this.#innerMargin,d[1]=i[1]-this.#innerMargin,d[2]=i[2]-i[0]+2*this.#innerMargin,d[3]=i[3]-i[1]+2*this.#innerMargin,this.firstPoint=[a,o],this.lastPoint=[s,c]}get box(){return this.#bbox}newOutliner(e,t,n,r,i,a=0){return new ic(e,t,n,r,i,a)}getNewOutline(e,t){let[n,r,i,a]=this.#bbox,[o,s,c,l]=this.#box,u=i*c,d=a*l,f=n*c+o,p=r*l+s,m=this.newOutliner({x:this.#points[0]*u+f,y:this.#points[1]*d+p},this.#box,this.#scaleFactor,e,this.#isLTR,t??this.#innerMargin);for(let e=2;e<this.#points.length;e+=2)m.add({x:this.#points[e]*u+f,y:this.#points[e+1]*d+p});return m.getOutlines()}},oc=class{#box;#firstPoint;#lastPoint;#verticalEdges=[];#intervals=[];constructor(e,t=0,n=0,r=!0){let i=[1/0,1/0,-1/0,-1/0],a=10**-4;for(let{x:n,y:r,width:o,height:s}of e){let e=Math.floor((n-t)/a)*a,c=Math.ceil((n+o+t)/a)*a,l=Math.floor((r-t)/a)*a,u=Math.ceil((r+s+t)/a)*a,d=[e,l,u,!0],f=[c,l,u,!1];this.#verticalEdges.push(d,f),Z.rectBoundingBox(e,l,c,u,i)}let o=i[2]-i[0]+2*n,s=i[3]-i[1]+2*n,c=i[0]-n,l=i[1]-n,u=r?-1/0:1/0,d=1/0,f=this.#verticalEdges.at(r?-1:-2),p=[f[0],f[2]];for(let e of this.#verticalEdges){let[t,n,i,a]=e;!a&&r?n<d?(d=n,u=t):n===d&&(u=Math.max(u,t)):a&&!r&&(n<d?(d=n,u=t):n===d&&(u=Math.min(u,t))),e[0]=(t-c)/o,e[1]=(n-l)/s,e[2]=(i-l)/s}this.#box=new Float32Array([c,l,o,s]),this.#firstPoint=[u,d],this.#lastPoint=p}getOutlines(){this.#verticalEdges.sort((e,t)=>e[0]-t[0]||e[1]-t[1]||e[2]-t[2]);let e=[];for(let t of this.#verticalEdges)t[3]?(e.push(...this.#breakEdge(t)),this.#insert(t)):(this.#remove(t),e.push(...this.#breakEdge(t)));return this.#getOutlines(e)}#getOutlines(e){let t=[],n=new Set;for(let n of e){let[e,r,i]=n;t.push([e,r,n],[e,i,n])}t.sort((e,t)=>e[1]-t[1]||e[0]-t[0]);for(let e=0,r=t.length;e<r;e+=2){let r=t[e][2],i=t[e+1][2];r.push(i),i.push(r),n.add(r),n.add(i)}let r=[],i;for(;n.size>0;){let e=n.values().next().value,[t,a,o,s,c]=e;n.delete(e);let l=t,u=a;for(i=[t,o],r.push(i);;){let e;if(n.has(s))e=s;else if(n.has(c))e=c;else break;n.delete(e),[t,a,o,s,c]=e,l!==t&&(i.push(l,u,t,u===a?a:o),l=t),u=u===a?o:a}i.push(l,u)}return new sc(r,this.#box,this.#firstPoint,this.#lastPoint)}#binarySearch(e){let t=this.#intervals,n=0,r=t.length-1;for(;n<=r;){let i=n+r>>1,a=t[i][0];if(a===e)return i;a<e?n=i+1:r=i-1}return r+1}#insert([,e,t]){let n=this.#binarySearch(e);this.#intervals.splice(n,0,[e,t])}#remove([,e,t]){let n=this.#binarySearch(e);for(let r=n;r<this.#intervals.length;r++){let[n,i]=this.#intervals[r];if(n!==e)break;if(n===e&&i===t){this.#intervals.splice(r,1);return}}for(let r=n-1;r>=0;r--){let[n,i]=this.#intervals[r];if(n!==e)break;if(n===e&&i===t){this.#intervals.splice(r,1);return}}}#breakEdge(e){let[t,n,r]=e,i=[[t,n,r]],a=this.#binarySearch(r);for(let e=0;e<a;e++){let[n,r]=this.#intervals[e];for(let e=0,a=i.length;e<a;e++){let[,o,s]=i[e];if(!(r<=o||s<=n)){if(o>=n){if(s>r)i[e][1]=r;else{if(a===1)return[];i.splice(e,1),e--,a--}continue}i[e][2]=n,s>r&&i.push([t,r,s])}}}return i}},sc=class extends Q{#box;#outlines;constructor(e,t,n,r){super(),this.#outlines=e,this.#box=t,this.firstPoint=n,this.lastPoint=r}toSVGPath(){let e=[];for(let t of this.#outlines){let[n,r]=t;e.push(`M${n} ${r}`);for(let i=2;i<t.length;i+=2){let a=t[i],o=t[i+1];a===n?(e.push(`V${o}`),r=o):o===r&&(e.push(`H${a}`),n=a)}e.push(`Z`)}return e.join(` `)}serialize([e,t,n,r],i){let a=[],o=n-e,s=r-t;for(let t of this.#outlines){let n=Array(t.length);for(let i=0;i<t.length;i+=2)n[i]=e+t[i]*o,n[i+1]=r-t[i+1]*s;a.push(n)}return a}get box(){return this.#box}get classNamesForOutlining(){return[`highlightOutline`]}},cc=class extends ic{newFreeDrawOutline(e,t,n,r,i,a){return new lc(e,t,n,r,i,a)}},lc=class extends ac{newOutliner(e,t,n,r,i,a=0){return new cc(e,t,n,r,i,a)}},uc=class e extends Hi{#anchorNode=null;#anchorOffset=0;#boxes;#clipPathId=null;#colorPicker=null;#focusOutlines=null;#focusNode=null;#focusOffset=0;#highlightDiv=null;#highlightOutlines=null;#id=null;#isFreeHighlight=!1;#firstPoint=null;#lastPoint=null;#outlineId=null;#text=``;#thickness;#methodOfCreation=``;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type=`highlight`;static _editorType=rr.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId=``;static get _keyboardManager(){let t=e.prototype;return wr(this,`_keyboardManager`,new Ii([[[`ArrowLeft`,`mac+ArrowLeft`],t._moveCaret,{args:[0]}],[[`ArrowRight`,`mac+ArrowRight`],t._moveCaret,{args:[1]}],[[`ArrowUp`,`mac+ArrowUp`],t._moveCaret,{args:[2]}],[[`ArrowDown`,`mac+ArrowDown`],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:`highlightEditor`}),this.color=t.color||e._defaultColor,this.#thickness=t.thickness||e._defaultThickness,this.opacity=t.opacity||e._defaultOpacity,this.#boxes=t.boxes||null,this.#methodOfCreation=t.methodOfCreation||``,this.#text=t.text||``,this._isDraggable=!1,this.defaultL10nId=`pdfjs-editor-highlight-editor`,t.highlightId>-1?(this.#isFreeHighlight=!0,this.#createFreeOutlines(t),this.#addToDrawLayer()):this.#boxes&&(this.#anchorNode=t.anchorNode,this.#anchorOffset=t.anchorOffset,this.#focusNode=t.focusNode,this.#focusOffset=t.focusOffset,this.#createOutlines(),this.#addToDrawLayer(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-highlight-added-alert`)}get telemetryInitialData(){return{action:`added`,type:this.#isFreeHighlight?`free_highlight`:`highlight`,color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#thickness,methodOfCreation:this.#methodOfCreation}}get telemetryFinalData(){return{type:`highlight`,color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get(`color`).size}}#createOutlines(){this.#highlightOutlines=new oc(this.#boxes,.001).getOutlines(),[this.x,this.y,this.width,this.height]=this.#highlightOutlines.box,this.#focusOutlines=new oc(this.#boxes,.0025,.001,this._uiManager.direction===`ltr`).getOutlines();let{firstPoint:e}=this.#highlightOutlines;this.#firstPoint=[(e[0]-this.x)/this.width,(e[1]-this.y)/this.height];let{lastPoint:t}=this.#focusOutlines;this.#lastPoint=[(t[0]-this.x)/this.width,(t[1]-this.y)/this.height]}#createFreeOutlines({highlightOutlines:t,highlightId:n,clipPathId:r}){if(this.#highlightOutlines=t,this.#focusOutlines=t.getNewOutline(this.#thickness/2+1.5,.0025),n>=0)this.#id=n,this.#clipPathId=r,this.parent.drawLayer.finalizeDraw(n,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#outlineId=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#focusOutlines.box,path:{d:this.#focusOutlines.toSVGPath()}},!0);else if(this.parent){let n=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#id,{bbox:e.#rotateBbox(this.#highlightOutlines.box,(n-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#outlineId,{bbox:e.#rotateBbox(this.#focusOutlines.box,n),path:{d:this.#focusOutlines.toSVGPath()}})}let[i,a,o,s]=t.box;switch(this.rotation){case 0:this.x=i,this.y=a,this.width=o,this.height=s;break;case 90:{let[e,t]=this.parentDimensions;this.x=a,this.y=1-i,this.width=o*t/e,this.height=s*e/t;break}case 180:this.x=1-i,this.y=1-a,this.width=o,this.height=s;break;case 270:{let[e,t]=this.parentDimensions;this.x=1-a,this.y=i,this.width=o*t/e,this.height=s*e/t;break}}let{firstPoint:c}=t;this.#firstPoint=[(c[0]-i)/o,(c[1]-a)/s];let{lastPoint:l}=this.#focusOutlines;this.#lastPoint=[(l[0]-i)/o,(l[1]-a)/s]}static initialize(t,n){Hi.initialize(t,n),e._defaultColor||=n.highlightColors?.values().next().value||`#fff066`}static updateDefaultParams(t,n){switch(t){case ir.HIGHLIGHT_COLOR:e._defaultColor=n;break;case ir.HIGHLIGHT_THICKNESS:e._defaultThickness=n;break}}translateInPage(e,t){}get toolbarPosition(){return this.#lastPoint}get commentButtonPosition(){return this.#firstPoint}updateParams(e,t){switch(e){case ir.HIGHLIGHT_COLOR:this.#updateColor(t);break;case ir.HIGHLIGHT_THICKNESS:this.#updateThickness(t);break}}static get defaultPropertiesToUpdate(){return[[ir.HIGHLIGHT_COLOR,e._defaultColor],[ir.HIGHLIGHT_THICKNESS,e._defaultThickness]]}get propertiesToUpdate(){return[[ir.HIGHLIGHT_COLOR,this.color||e._defaultColor],[ir.HIGHLIGHT_THICKNESS,this.#thickness||e._defaultThickness],[ir.HIGHLIGHT_FREE,this.#isFreeHighlight]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#id,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#colorPicker?.updateColor(this.color),super.onUpdatedColor()}#updateColor(t){let n=(e,t)=>{this.color=e,this.opacity=t,this.onUpdatedColor()},r=this.color,i=this.opacity;this.addCommands({cmd:n.bind(this,t,e._defaultOpacity),undo:n.bind(this,r,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ir.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:`color_changed`,color:this._uiManager.getNonHCMColorName(t)},!0)}#updateThickness(e){let t=this.#thickness,n=e=>{this.#thickness=e,this.#changeThickness(e)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ir.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:`thickness_changed`,thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[[`colorPicker`,this.#colorPicker=new _s({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle(`disabled`,!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle(`disabled`,!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#getRotation())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#getRotation())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#cleanDrawLayer(),this._reportTelemetry({action:`deleted`}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#addToDrawLayer(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#cleanDrawLayer():e&&(this.#addToDrawLayer(e),t=!this.parent&&this.div?.classList.contains(`selectedEditor`)),super.setParent(e),this.show(this._isVisible),t&&this.select()}#changeThickness(e){this.#isFreeHighlight&&(this.#createFreeOutlines({highlightOutlines:this.#highlightOutlines.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#cleanDrawLayer(){this.#id===null||!this.parent||(this.parent.drawLayer.remove(this.#id),this.#id=null,this.parent.drawLayer.remove(this.#outlineId),this.#outlineId=null)}#addToDrawLayer(e=this.parent){this.#id===null&&({id:this.#id,clipPathId:this.#clipPathId}=e.drawLayer.draw({bbox:this.#highlightOutlines.box,root:{viewBox:`0 0 1 1`,fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#isFreeHighlight},path:{d:this.#highlightOutlines.toSVGPath()}},!1,!0),this.#outlineId=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#isFreeHighlight},bbox:this.#focusOutlines.box,path:{d:this.#focusOutlines.toSVGPath()}},this.#isFreeHighlight),this.#highlightDiv&&(this.#highlightDiv.style.clipPath=this.#clipPathId))}static#rotateBbox([e,t,n,r],i){switch(i){case 90:return[1-t-r,e,r,n];case 180:return[1-e-n,1-t-r,n,r];case 270:return[t,1-e-n,r,n]}return[e,t,n,r]}rotate(t){let{drawLayer:n}=this.parent,r;this.#isFreeHighlight?(t=(t-this.rotation+360)%360,r=e.#rotateBbox(this.#highlightOutlines.box,t)):r=e.#rotateBbox([this.x,this.y,this.width,this.height],t),n.updateProperties(this.#id,{bbox:r,root:{"data-main-rotation":t}}),n.updateProperties(this.#outlineId,{bbox:e.#rotateBbox(this.#focusOutlines.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;let e=super.render();this.#text&&(e.setAttribute(`aria-label`,this.#text),e.setAttribute(`role`,`mark`)),this.#isFreeHighlight?e.classList.add(`free`):this.div.addEventListener(`keydown`,this.#keydown.bind(this),{signal:this._uiManager._signal});let t=this.#highlightDiv=document.createElement(`div`);return e.append(t),t.setAttribute(`aria-hidden`,`true`),t.className=`internal`,t.style.clipPath=this.#clipPathId,this.setDims(this.width,this.height),Mi(this,this.#highlightDiv,[`pointerover`,`pointerleave`]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#outlineId,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#outlineId,{rootClass:{hovered:!1}})}#keydown(t){e._keyboardManager.exec(this,t)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#setCaret(!0);break;case 1:case 3:this.#setCaret(!1);break}}#setCaret(e){if(!this.#anchorNode)return;let t=window.getSelection();e?t.setPosition(this.#anchorNode,this.#anchorOffset):t.setPosition(this.#focusNode,this.#focusOffset)}select(){super.select(),this.#outlineId&&this.parent?.drawLayer.updateProperties(this.#outlineId,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#outlineId&&(this.parent?.drawLayer.updateProperties(this.#outlineId,{rootClass:{selected:!1}}),this.#isFreeHighlight||this.#setCaret(!1))}get _mustFixPosition(){return!this.#isFreeHighlight}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#id,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#outlineId,{rootClass:{hidden:!e}}))}#getRotation(){return this.#isFreeHighlight?this.rotation:0}#serializeBoxes(){if(this.#isFreeHighlight)return null;let[e,t]=this.pageDimensions,[n,r]=this.pageTranslation,i=this.#boxes,a=new Float32Array(i.length*8),o=0;for(let{x:s,y:c,width:l,height:u}of i){let i=s*e+n,d=(1-c)*t+r;a[o]=a[o+4]=i,a[o+1]=a[o+3]=d,a[o+2]=a[o+6]=i+l*e,a[o+5]=a[o+7]=d-u*t,o+=8}return a}#serializeOutlines(e){return this.#highlightOutlines.serialize(e,this.#getRotation())}static startHighlighting(e,t,{target:n,x:r,y:i}){let{x:a,y:o,width:s,height:c}=n.getBoundingClientRect(),l=new AbortController,u=e.combinedSignal(l),d=t=>{l.abort(),this.#endHighlight(e,t)};window.addEventListener(`blur`,d,{signal:u}),window.addEventListener(`pointerup`,d,{signal:u}),window.addEventListener(`pointerdown`,li,{capture:!0,passive:!1,signal:u}),window.addEventListener(`contextmenu`,ci,{signal:u}),n.addEventListener(`pointermove`,this.#highlightMove.bind(this,e),{signal:u}),this._freeHighlight=new cc({x:r,y:i},[a,o,s,c],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:`0 0 1 1`,fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#highlightMove(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#endHighlight(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:`main_toolbar`}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=``}static async deserialize(e,t,n){let r=null;if(e instanceof Ys){let{data:{quadPoints:t,rect:n,rotation:i,id:a,color:o,opacity:s,popupRef:c,richText:l,contentsObj:u,creationDate:d,modificationDate:f},parent:{page:{pageNumber:p}}}=e;r=e={annotationType:rr.HIGHLIGHT,color:Array.from(o),opacity:s,quadPoints:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:i,annotationElementId:a,id:a,deleted:!1,popupRef:c,richText:l,comment:u?.str||null,creationDate:d,modificationDate:f}}else if(e instanceof Js){let{data:{inkLists:t,rect:n,rotation:i,id:a,color:o,borderStyle:{rawWidth:s},popupRef:c,richText:l,contentsObj:u,creationDate:d,modificationDate:f},parent:{page:{pageNumber:p}}}=e;r=e={annotationType:rr.HIGHLIGHT,color:Array.from(o),thickness:s,inkLists:t,boxes:null,pageIndex:p-1,rect:n.slice(0),rotation:i,annotationElementId:a,id:a,deleted:!1,popupRef:c,richText:l,comment:u?.str||null,creationDate:d,modificationDate:f}}let{color:i,quadPoints:a,inkLists:o,opacity:s}=e,c=await super.deserialize(e,t,n);c.color=Z.makeHexColor(...i),c.opacity=s||1,o&&(c.#thickness=e.thickness),c._initialData=r,e.comment&&c.setCommentData(e);let[l,u]=c.pageDimensions,[d,f]=c.pageTranslation;if(a){let e=c.#boxes=[];for(let t=0;t<a.length;t+=8)e.push({x:(a[t]-d)/l,y:1-(a[t+1]-f)/u,width:(a[t+2]-a[t])/l,height:(a[t+1]-a[t+5])/u});c.#createOutlines(),c.#addToDrawLayer(),c.rotate(c.rotation)}else if(o){c.#isFreeHighlight=!0;let e=o[0],n={x:e[0]-d,y:u-(e[1]-f)},r=new cc(n,[0,0,l,u],1,c.#thickness/2,!0,.001);for(let t=0,i=e.length;t<i;t+=2)n.x=e[t]-d,n.y=u-(e[t+1]-f),r.add(n);let{id:i,clipPathId:a}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:`0 0 1 1`,fill:c.color,"fill-opacity":c._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:r.toSVGPath()}},!0,!0);c.#createFreeOutlines({highlightOutlines:r.getOutlines(),highlightId:i,clipPathId:a}),c.#addToDrawLayer(),c.rotate(c.parentRotation)}return c}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();let t=Hi._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#thickness,quadPoints:this.#serializeBoxes(),outlines:this.#serializeOutlines(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#hasElementChanged(n)?null:(n.id=this.annotationElementId,n)}#hasElementChanged(e){let{color:t}=this._initialData;return this.hasEditedComment||e.color.some((e,n)=>e!==t[n])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}},dc=class{#svgProperties=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(let[t,n]of Object.entries(e))t.startsWith(`_`)||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#svgProperties[e]=t}toSVGProperties(){let e=this.#svgProperties;return this.#svgProperties=Object.create(null),{root:e}}reset(){this.#svgProperties=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){yr(`Not implemented`)}},fc=class e extends Hi{#drawOutlines=null;#mustBeCommitted;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#currentDraw=null;static#currentDrawingAC=null;static#currentDrawingOptions=null;static#currentPointerId=NaN;static#currentPointerType=null;static#currentPointerIds=null;static#currentMoveTimestamp=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#mustBeCommitted=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#createDrawOutlines(e),this.#addToDrawLayer())}#createDrawOutlines({drawOutlines:e,drawId:t,drawingOptions:n}){this.#drawOutlines=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#createDrawing(e,this.parent),this.#updateBbox(e.box)}#createDrawing(t,n){let{id:r}=n.drawLayer.draw(e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return r}static _mergeSVGProperties(e,t){let n=new Set(Object.keys(e));for(let[r,i]of Object.entries(t))n.has(r)?Object.assign(e[r],i):e[r]=i;return e}static getDefaultDrawingOptions(e){yr(`Not implemented`)}static get typesMap(){yr(`Not implemented`)}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,n){let r=this.typesMap.get(t);r&&this._defaultDrawingOptions.updateProperty(r,n),this._currentParent&&(e.#currentDraw.updateProperty(r,n),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){let n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){let e=[],t=this._defaultDrawingOptions;for(let[n,r]of this.typesMap)e.push([n,t[r]]);return e}get propertiesToUpdate(){let e=[],{_drawingOptions:t}=this;for(let[n,r]of this.constructor.typesMap)e.push([n,t[r]]);return e}_updateProperty(e,t,n){let r=this._drawingOptions,i=r[t],a=n=>{r.updateProperty(t,n);let i=this.#drawOutlines.updateProperty(t,n);i&&this.#updateBbox(i),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(this.#drawOutlines.getPathResizingSVGProperties(this.#convertToDrawSpace()),{bbox:this.#rotateBox()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(this.#drawOutlines.getPathResizedSVGProperties(this.#convertToDrawSpace()),{bbox:this.#rotateBox()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#rotateBox()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties(this.#drawOutlines.getPathTranslatedSVGProperties(this.#convertToDrawSpace(),this.parentDimensions),{bbox:this.#rotateBox()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle(`disabled`,!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle(`disabled`,!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#mustBeCommitted&&(this.#mustBeCommitted=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#cleanDrawLayer(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#addToDrawLayer(),this.#updateBbox(this.#drawOutlines.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#cleanDrawLayer()):e&&(this._uiManager.addShouldRescale(this),this.#addToDrawLayer(e),t=!this.parent&&this.div?.classList.contains(`selectedEditor`)),super.setParent(e),t&&this.select()}#cleanDrawLayer(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#addToDrawLayer(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#createDrawing(this.#drawOutlines,e)}}#convertToParentSpace([e,t,n,r]){let{parentDimensions:[i,a],rotation:o}=this;switch(o){case 90:return[t,1-e,n*(a/i),r*(i/a)];case 180:return[1-e,1-t,n,r];case 270:return[1-t,e,n*(a/i),r*(i/a)];default:return[e,t,n,r]}}#convertToDrawSpace(){let{x:e,y:t,width:n,height:r,parentDimensions:[i,a],rotation:o}=this;switch(o){case 90:return[1-t,e,n*(i/a),r*(a/i)];case 180:return[1-e,1-t,n,r];case 270:return[t,1-e,n*(i/a),r*(a/i)];default:return[e,t,n,r]}}#updateBbox(e){[this.x,this.y,this.width,this.height]=this.#convertToParentSpace(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#rotateBox(){let{x:e,y:t,width:n,height:r,rotation:i,parentRotation:a,parentDimensions:[o,s]}=this;switch((i*4+a)/90){case 1:return[1-t-r,e,r,n];case 2:return[1-e-n,1-t-r,n,r];case 3:return[t,1-e-n,r,n];case 4:return[e,t-n*(o/s),r*(s/o),n*(o/s)];case 5:return[1-t,e,n*(o/s),r*(s/o)];case 6:return[1-e-r*(s/o),1-t,r*(s/o),n*(o/s)];case 7:return[t-n*(o/s),1-e-r*(s/o),n*(o/s),r*(s/o)];case 8:return[e-n,t-r,n,r];case 9:return[1-t,e-n,r,n];case 10:return[1-e,1-t,n,r];case 11:return[t-r,1-e,r,n];case 12:return[e-r*(s/o),t,r*(s/o),n*(o/s)];case 13:return[1-t-n*(o/s),e-r*(s/o),n*(o/s),r*(s/o)];case 14:return[1-e,1-t-n*(o/s),r*(s/o),n*(o/s)];case 15:return[t,1-e,n*(o/s),r*(s/o)];default:return[e,t,n,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,e._mergeSVGProperties({bbox:this.#rotateBox()},this.#drawOutlines.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#updateBbox(this.#drawOutlines.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);let n=super.render();n.classList.add(`draw`);let r=document.createElement(`div`);return n.append(r),r.setAttribute(`aria-hidden`,`true`),r.className=`internal`,this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,r,i){yr(`Not implemented`)}static startDrawing(t,n,r,i){let{target:a,offsetX:o,offsetY:s,pointerId:c,pointerType:l}=i;if(e.#currentPointerType&&e.#currentPointerType!==l)return;let{viewport:{rotation:u}}=t,{width:d,height:f}=a.getBoundingClientRect(),p=e.#currentDrawingAC=new AbortController,m=t.combinedSignal(p);if(e.#currentPointerId||=c,e.#currentPointerType??=l,window.addEventListener(`pointerup`,t=>{e.#currentPointerId===t.pointerId?this._endDraw(t):e.#currentPointerIds?.delete(t.pointerId)},{signal:m}),window.addEventListener(`pointercancel`,t=>{e.#currentPointerId===t.pointerId?this._currentParent.endDrawingSession():e.#currentPointerIds?.delete(t.pointerId)},{signal:m}),window.addEventListener(`pointerdown`,t=>{e.#currentPointerType===t.pointerType&&((e.#currentPointerIds||=new Set).add(t.pointerId),e.#currentDraw.isCancellable()&&(e.#currentDraw.removeLastElement(),e.#currentDraw.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:m}),window.addEventListener(`contextmenu`,ci,{signal:m}),a.addEventListener(`pointermove`,this._drawMove.bind(this),{signal:m}),a.addEventListener(`touchmove`,t=>{t.timeStamp===e.#currentMoveTimestamp&&li(t)},{signal:m}),t.toggleDrawing(),n._editorUndoBar?.hide(),e.#currentDraw){t.drawLayer.updateProperties(this._currentDrawId,e.#currentDraw.startNew(o,s,d,f,u));return}n.updateUIForDefaultProperties(this),e.#currentDraw=this.createDrawerInstance(o,s,d,f,u),e.#currentDrawingOptions=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(e.#currentDrawingOptions.toSVGProperties(),e.#currentDraw.defaultSVGProperties),!0,!1)}static _drawMove(t){if(e.#currentMoveTimestamp=-1,!e.#currentDraw)return;let{offsetX:n,offsetY:r,pointerId:i}=t;if(e.#currentPointerId===i){if(e.#currentPointerIds?.size>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,e.#currentDraw.add(n,r)),e.#currentMoveTimestamp=t.timeStamp,li(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,e.#currentDraw=null,e.#currentDrawingOptions=null,e.#currentPointerType=null,e.#currentMoveTimestamp=NaN),e.#currentDrawingAC&&(e.#currentDrawingAC.abort(),e.#currentDrawingAC=null,e.#currentPointerId=NaN,e.#currentPointerIds=null)}static _endDraw(t){let n=this._currentParent;if(n){if(n.toggleDrawing(!0),this._cleanup(!1),t?.target===n.div&&n.drawLayer.updateProperties(this._currentDrawId,e.#currentDraw.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){let t=e.#currentDraw,r=this._currentDrawId,i=t.getLastElement();n.addCommands({cmd:()=>{n.drawLayer.updateProperties(r,t.setLastElement(i))},undo:()=>{n.drawLayer.updateProperties(r,t.removeLastElement())},mustExec:!1,type:ir.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){let n=this._currentParent;if(!n)return null;if(n.toggleDrawing(!0),n.cleanUndoStack(ir.DRAW_STEP),!e.#currentDraw.isEmpty()){let{pageDimensions:[r,i],scale:a}=n,o=n.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:e.#currentDraw.getOutlines(r*a,i*a,a,this._INNER_MARGIN),drawingOptions:e.#currentDrawingOptions,mustBeCommitted:!t});return this._cleanup(!0),o}return n.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,r,i,a){yr(`Not implemented`)}static async deserialize(e,t,n){let{rawDims:{pageWidth:r,pageHeight:i,pageX:a,pageY:o}}=t.viewport,s=this.deserializeDraw(a,o,r,i,this._INNER_MARGIN,e),c=await super.deserialize(e,t,n);return c.createDrawingOptions(e),c.#createDrawOutlines({drawOutlines:s}),c.#addToDrawLayer(),c.onScaleChanging(),c.rotate(),c}serializeDraw(e){let[t,n]=this.pageTranslation,[r,i]=this.pageDimensions;return this.#drawOutlines.serialize([t,n,r,i],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}},pc=class{#last=new Float64Array(6);#line;#lines;#rotation;#thickness;#points;#lastSVGPath=``;#lastIndex=0;#outlines=new mc;#parentWidth;#parentHeight;constructor(e,t,n,r,i,a){this.#parentWidth=n,this.#parentHeight=r,this.#rotation=i,this.#thickness=a,[e,t]=this.#normalizePoint(e,t);let o=this.#line=[NaN,NaN,NaN,NaN,e,t];this.#points=[e,t],this.#lines=[{line:o,points:this.#points}],this.#last.set(o,0)}updateProperty(e,t){e===`stroke-width`&&(this.#thickness=t)}#normalizePoint(e,t){return Q._normalizePoint(e,t,this.#parentWidth,this.#parentHeight,this.#rotation)}isEmpty(){return!this.#lines||this.#lines.length===0}isCancellable(){return this.#points.length<=10}add(e,t){[e,t]=this.#normalizePoint(e,t);let[n,r,i,a]=this.#last.subarray(2,6),o=e-i,s=t-a;return Math.hypot(this.#parentWidth*o,this.#parentHeight*s)<=2?null:(this.#points.push(e,t),isNaN(n)?(this.#last.set([i,a,e,t],2),this.#line.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#last[0])&&this.#line.splice(6,6),this.#last.set([n,r,i,a,e,t],0),this.#line.push(...Q.createBezierPoints(n,r,i,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){return this.add(e,t)||(this.#points.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,r,i){this.#parentWidth=n,this.#parentHeight=r,this.#rotation=i,[e,t]=this.#normalizePoint(e,t);let a=this.#line=[NaN,NaN,NaN,NaN,e,t];this.#points=[e,t];let o=this.#lines.at(-1);return o&&(o.line=new Float32Array(o.line),o.points=new Float32Array(o.points)),this.#lines.push({line:a,points:this.#points}),this.#last.set(a,0),this.#lastIndex=0,this.toSVGPath(),null}getLastElement(){return this.#lines.at(-1)}setLastElement(e){return this.#lines?(this.#lines.push(e),this.#line=e.line,this.#points=e.points,this.#lastIndex=0,{path:{d:this.toSVGPath()}}):this.#outlines.setLastElement(e)}removeLastElement(){if(!this.#lines)return this.#outlines.removeLastElement();this.#lines.pop(),this.#lastSVGPath=``;for(let e=0,t=this.#lines.length;e<t;e++){let{line:t,points:n}=this.#lines[e];this.#line=t,this.#points=n,this.#lastIndex=0,this.toSVGPath()}return{path:{d:this.#lastSVGPath}}}toSVGPath(){let e=Q.svgRound(this.#line[4]),t=Q.svgRound(this.#line[5]);if(this.#points.length===2)return this.#lastSVGPath=`${this.#lastSVGPath} M ${e} ${t} Z`,this.#lastSVGPath;if(this.#points.length<=6){let n=this.#lastSVGPath.lastIndexOf(`M`);this.#lastSVGPath=`${this.#lastSVGPath.slice(0,n)} M ${e} ${t}`,this.#lastIndex=6}if(this.#points.length===4){let e=Q.svgRound(this.#line[10]),t=Q.svgRound(this.#line[11]);return this.#lastSVGPath=`${this.#lastSVGPath} L ${e} ${t}`,this.#lastIndex=12,this.#lastSVGPath}let n=[];this.#lastIndex===0&&(n.push(`M ${e} ${t}`),this.#lastIndex=6);for(let e=this.#lastIndex,t=this.#line.length;e<t;e+=6){let[t,r,i,a,o,s]=this.#line.slice(e,e+6).map(Q.svgRound);n.push(`C${t} ${r} ${i} ${a} ${o} ${s}`)}return this.#lastSVGPath+=n.join(` `),this.#lastIndex=this.#line.length,this.#lastSVGPath}getOutlines(e,t,n,r){let i=this.#lines.at(-1);return i.line=new Float32Array(i.line),i.points=new Float32Array(i.points),this.#outlines.build(this.#lines,e,t,n,this.#rotation,this.#thickness,r),this.#last=null,this.#line=null,this.#lines=null,this.#lastSVGPath=null,this.#outlines}get defaultSVGProperties(){return{root:{viewBox:`0 0 10000 10000`},rootClass:{draw:!0},bbox:[0,0,1,1]}}},mc=class extends Q{#bbox;#currentRotation=0;#innerMargin;#lines;#parentWidth;#parentHeight;#parentScale;#rotation;#thickness;build(e,t,n,r,i,a,o){this.#parentWidth=t,this.#parentHeight=n,this.#parentScale=r,this.#rotation=i,this.#thickness=a,this.#innerMargin=o??0,this.#lines=e,this.#computeBbox()}get thickness(){return this.#thickness}setLastElement(e){return this.#lines.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#lines.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){let e=[];for(let{line:t}of this.#lines){if(e.push(`M${Q.svgRound(t[4])} ${Q.svgRound(t[5])}`),t.length===6){e.push(`Z`);continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Q.svgRound(t[10])} ${Q.svgRound(t[11])}`);continue}for(let n=6,r=t.length;n<r;n+=6){let[r,i,a,o,s,c]=t.subarray(n,n+6).map(Q.svgRound);e.push(`C${r} ${i} ${a} ${o} ${s} ${c}`)}}return e.join(``)}serialize([e,t,n,r],i){let a=[],o=[],[s,c,l,u]=this.#getBBoxWithNoMargin(),d,f,p,m,h,g,_,v,y;switch(this.#rotation){case 0:y=Q._rescale,d=e,f=t+r,p=n,m=-r,h=e+s*n,g=t+(1-c-u)*r,_=e+(s+l)*n,v=t+(1-c)*r;break;case 90:y=Q._rescaleAndSwap,d=e,f=t,p=n,m=r,h=e+c*n,g=t+s*r,_=e+(c+u)*n,v=t+(s+l)*r;break;case 180:y=Q._rescale,d=e+n,f=t,p=-n,m=r,h=e+(1-s-l)*n,g=t+c*r,_=e+(1-s)*n,v=t+(c+u)*r;break;case 270:y=Q._rescaleAndSwap,d=e+n,f=t+r,p=-n,m=-r,h=e+(1-c-u)*n,g=t+(1-s-l)*r,_=e+(1-c)*n,v=t+(1-s)*r;break}for(let{line:e,points:t}of this.#lines)a.push(y(e,d,f,p,m,i?Array(e.length):null)),o.push(y(t,d,f,p,m,i?Array(t.length):null));return{lines:a,points:o,rect:[h,g,_,v]}}static deserialize(e,t,n,r,i,{paths:{lines:a,points:o},rotation:s,thickness:c}){let l=[],u,d,f,p,m;switch(s){case 0:m=Q._rescale,u=-e/n,d=t/r+1,f=1/n,p=-1/r;break;case 90:m=Q._rescaleAndSwap,u=-t/r,d=-e/n,f=1/r,p=1/n;break;case 180:m=Q._rescale,u=e/n+1,d=-t/r,f=-1/n,p=1/r;break;case 270:m=Q._rescaleAndSwap,u=t/r+1,d=e/n+1,f=-1/r,p=-1/n;break}if(!a){a=[];for(let e of o){let t=e.length;if(t===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1]]));continue}if(t===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,e[0],e[1],NaN,NaN,NaN,NaN,e[2],e[3]]));continue}let n=new Float32Array(3*(t-2));a.push(n);let[r,i,o,s]=e.subarray(0,4);n.set([NaN,NaN,NaN,NaN,r,i],0);for(let a=4;a<t;a+=2){let t=e[a],c=e[a+1];n.set(Q.createBezierPoints(r,i,o,s,t,c),(a-2)*3),[r,i,o,s]=[o,s,t,c]}}}for(let e=0,t=a.length;e<t;e++)l.push({line:m(a[e].map(e=>e??NaN),u,d,f,p),points:m(o[e].map(e=>e??NaN),u,d,f,p)});let h=new this.prototype.constructor;return h.build(l,n,r,1,s,c,i),h}#getMarginComponents(e=this.#thickness){let t=this.#innerMargin+e/2*this.#parentScale;return this.#rotation%180==0?[t/this.#parentWidth,t/this.#parentHeight]:[t/this.#parentHeight,t/this.#parentWidth]}#getBBoxWithNoMargin(){let[e,t,n,r]=this.#bbox,[i,a]=this.#getMarginComponents(0);return[e+i,t+a,n-2*i,r-2*a]}#computeBbox(){let e=this.#bbox=new Float32Array([1/0,1/0,-1/0,-1/0]);for(let{line:t}of this.#lines){if(t.length<=12){for(let n=4,r=t.length;n<r;n+=6)Z.pointBoundingBox(t[n],t[n+1],e);continue}let n=t[4],r=t[5];for(let i=6,a=t.length;i<a;i+=6){let[a,o,s,c,l,u]=t.subarray(i,i+6);Z.bezierBoundingBox(n,r,a,o,s,c,l,u,e),n=l,r=u}}let[t,n]=this.#getMarginComponents();e[0]=Kr(e[0]-t,0,1),e[1]=Kr(e[1]-n,0,1),e[2]=Kr(e[2]+t,0,1),e[3]=Kr(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#bbox}updateProperty(e,t){return e===`stroke-width`?this.#updateThickness(t):null}#updateThickness(e){let[t,n]=this.#getMarginComponents();this.#thickness=e;let[r,i]=this.#getMarginComponents(),[a,o]=[r-t,i-n],s=this.#bbox;return s[0]-=a,s[1]-=o,s[2]+=2*a,s[3]+=2*o,s}updateParentDimensions([e,t],n){let[r,i]=this.#getMarginComponents();this.#parentWidth=e,this.#parentHeight=t,this.#parentScale=n;let[a,o]=this.#getMarginComponents(),s=a-r,c=o-i,l=this.#bbox;return l[0]-=s,l[1]-=c,l[2]+=2*s,l[3]+=2*c,l}updateRotation(e){return this.#currentRotation=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#bbox.map(Q.svgRound).join(` `)}get defaultProperties(){let[e,t]=this.#bbox;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(t)}`}}}get rotationTransform(){let[,,e,t]=this.#bbox,n=0,r=0,i=0,a=0,o=0,s=0;switch(this.#currentRotation){case 90:r=t/e,i=-e/t,o=e;break;case 180:n=-1,a=-1,o=e,s=t;break;case 270:r=-t/e,i=e/t,s=t;break;default:return``}return`matrix(${n} ${r} ${i} ${a} ${Q.svgRound(o)} ${Q.svgRound(s)})`}getPathResizingSVGProperties([e,t,n,r]){let[i,a]=this.#getMarginComponents(),[o,s,c,l]=this.#bbox;if(Math.abs(c-i)<=Q.PRECISION||Math.abs(l-a)<=Q.PRECISION){let i=e+n/2-(o+c/2),a=t+r/2-(s+l/2);return{path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(t)}`,transform:`${this.rotationTransform} translate(${i} ${a})`}}}let u=(n-2*i)/(c-2*i),d=(r-2*a)/(l-2*a),f=c/n,p=l/r;return{path:{"transform-origin":`${Q.svgRound(o)} ${Q.svgRound(s)}`,transform:`${this.rotationTransform} scale(${f} ${p}) translate(${Q.svgRound(i)} ${Q.svgRound(a)}) scale(${u} ${d}) translate(${Q.svgRound(-i)} ${Q.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,n,r]){let[i,a]=this.#getMarginComponents(),o=this.#bbox,[s,c,l,u]=o;if(o[0]=e,o[1]=t,o[2]=n,o[3]=r,Math.abs(l-i)<=Q.PRECISION||Math.abs(u-a)<=Q.PRECISION){let i=e+n/2-(s+l/2),a=t+r/2-(c+u/2);for(let{line:e,points:t}of this.#lines)Q._translate(e,i,a,e),Q._translate(t,i,a,t);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}let d=(n-2*i)/(l-2*i),f=(r-2*a)/(u-2*a),p=-d*(s+i)+e+i,m=-f*(c+a)+t+a;if(d!==1||f!==1||p!==0||m!==0)for(let{line:e,points:t}of this.#lines)Q._rescale(e,p,m,d,f,e),Q._rescale(t,p,m,d,f,t);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){let[r,i]=n,a=this.#bbox,o=e-a[0],s=t-a[1];if(this.#parentWidth===r&&this.#parentHeight===i)for(let{line:e,points:t}of this.#lines)Q._translate(e,o,s,e),Q._translate(t,o,s,t);else{let e=this.#parentWidth/r,t=this.#parentHeight/i;this.#parentWidth=r,this.#parentHeight=i;for(let{line:n,points:r}of this.#lines)Q._rescale(n,o,s,e,t,n),Q._rescale(r,o,s,e,t,r);a[2]*=e,a[3]*=t}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(e)} ${Q.svgRound(t)}`}}}get defaultSVGProperties(){let e=this.#bbox;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Q.svgRound(e[0])} ${Q.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}},hc=class e extends dc{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:`none`,stroke:Hi._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":`round`,"stroke-linejoin":`round`,"stroke-miterlimit":10})}updateSVGProperty(e,t){e===`stroke-width`&&(t??=this[`stroke-width`],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){let t=new e(this._viewParameters);return t.updateAll(this),t}},gc=class e extends fc{static _type=`ink`;static _editorType=rr.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:`inkEditor`}),this._willKeepAspectRatio=!0,this.defaultL10nId=`pdfjs-editor-ink-editor`}static initialize(e,t){Hi.initialize(e,t),this._defaultDrawingOptions=new hc(t.viewParameters)}static getDefaultDrawingOptions(e){let t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return wr(this,`typesMap`,new Map([[ir.INK_THICKNESS,`stroke-width`],[ir.INK_COLOR,`stroke`],[ir.INK_OPACITY,`stroke-opacity`]]))}static createDrawerInstance(e,t,n,r,i){return new pc(e,t,n,r,i,this._defaultDrawingOptions[`stroke-width`])}static deserializeDraw(e,t,n,r,i,a){return mc.deserialize(e,t,n,r,i,a)}static async deserialize(e,t,n){let r=null;if(e instanceof Js){let{data:{inkLists:t,rect:n,rotation:i,id:a,color:o,opacity:s,borderStyle:{rawWidth:c},popupRef:l,richText:u,contentsObj:d,creationDate:f,modificationDate:p},parent:{page:{pageNumber:m}}}=e;r=e={annotationType:rr.INK,color:Array.from(o),thickness:c,opacity:s,paths:{points:t},boxes:null,pageIndex:m-1,rect:n.slice(0),rotation:i,annotationElementId:a,id:a,deleted:!1,popupRef:l,richText:u,comment:d?.str||null,creationDate:f,modificationDate:p}}let i=await super.deserialize(e,t,n);return i._initialData=r,e.comment&&i.setCommentData(e),i}get toolbarButtons(){return this._colorPicker||=new vs(this),[[`colorPicker`,this._colorPicker]]}get colorType(){return ir.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions[`stroke-opacity`]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();let{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty(`stroke-width`),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){let e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty(`stroke-width`),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:n,opacity:r}){this._drawingOptions=e.getDefaultDrawingOptions({stroke:Z.makeHexColor(...t),"stroke-width":n,"stroke-opacity":r})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:r,"stroke-opacity":i,"stroke-width":a}}=this,o=Object.assign(super.serialize(e),{color:Hi._colorManager.convert(r),opacity:i,thickness:a,paths:{lines:t,points:n}});return this.addComment(o),e?(o.isCopy=!0,o):this.annotationElementId&&!this.#hasElementChanged(o)?null:(o.id=this.annotationElementId,o)}#hasElementChanged(e){let{color:t,thickness:n,opacity:r,pageIndex:i}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((e,n)=>e!==t[n])||e.thickness!==n||e.opacity!==r||e.pageIndex!==i}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions[`stroke-width`],points:t,popup:this.comment}),null}},_c=class extends mc{toSVGPath(){let e=super.toSVGPath();return e.endsWith(`Z`)||(e+=`Z`),e}},vc=8,yc=3,bc=class{static#PARAMETERS={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#neighborIndexToId(e,t,n,r){return n-=e,r-=t,n===0?r>0?0:4:n===1?r+6:2-r}static#neighborIdToIndex=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#clockwiseNonZero(e,t,n,r,i,a,o){let s=this.#neighborIndexToId(n,r,i,a);for(let i=0;i<8;i++){let a=(-i+s-o+16)%8,c=this.#neighborIdToIndex[2*a],l=this.#neighborIdToIndex[2*a+1];if(e[(n+c)*t+(r+l)]!==0)return a}return-1}static#counterClockwiseNonZero(e,t,n,r,i,a,o){let s=this.#neighborIndexToId(n,r,i,a);for(let i=0;i<8;i++){let a=(i+s+o+16)%8,c=this.#neighborIdToIndex[2*a],l=this.#neighborIdToIndex[2*a+1];if(e[(n+c)*t+(r+l)]!==0)return a}return-1}static#findContours(e,t,n,r){let i=e.length,a=new Int32Array(i);for(let t=0;t<i;t++)a[t]=e[t]<=r?1:0;for(let e=1;e<n-1;e++)a[e*t]=a[e*t+t-1]=0;for(let e=0;e<t;e++)a[e]=a[t*n-1-e]=0;let o=1,s,c=[];for(let e=1;e<n-1;e++){s=1;for(let n=1;n<t-1;n++){let r=e*t+n,i=a[r];if(i===0)continue;let l=e,u=n;if(i===1&&a[r-1]===0)o+=1,--u;else if(i>=1&&a[r+1]===0)o+=1,u+=1,i>1&&(s=i);else{i!==1&&(s=Math.abs(i));continue}let d=[n,e],f=u===n+1,p={isHole:f,points:d,id:o,parent:0};c.push(p);let m;for(let e of c)if(e.id===s){m=e;break}m?m.isHole?p.parent=f?m.parent:s:p.parent=f?s:m.parent:p.parent=f?s:0;let h=this.#clockwiseNonZero(a,t,e,n,l,u,0);if(h===-1){a[r]=-o,a[r]!==1&&(s=Math.abs(a[r]));continue}let g=this.#neighborIdToIndex[2*h],_=this.#neighborIdToIndex[2*h+1],v=e+g,y=n+_;l=v,u=y;let b=e,x=n;for(;;){let i=this.#counterClockwiseNonZero(a,t,b,x,l,u,1);g=this.#neighborIdToIndex[2*i],_=this.#neighborIdToIndex[2*i+1];let c=b+g,f=x+_;d.push(f,c);let p=b*t+x;if(a[p+1]===0?a[p]=-o:a[p]===1&&(a[p]=o),c===e&&f===n&&b===v&&x===y){a[r]!==1&&(s=Math.abs(a[r]));break}else l=b,u=x,b=c,x=f}}}return c}static#douglasPeuckerHelper(e,t,n,r){if(n-t<=4){for(let i=t;i<n-2;i+=2)r.push(e[i],e[i+1]);return}let i=e[t],a=e[t+1],o=e[n-4]-i,s=e[n-3]-a,c=Math.hypot(o,s),l=o/c,u=s/c,d=l*a-u*i,f=s/o,p=1/c,m=Math.atan(f),h=Math.cos(m),g=Math.sin(m),_=p*(Math.abs(h)+Math.abs(g)),v=p*(1-_+_**2),y=Math.max(Math.atan(Math.abs(g+h)*v),Math.atan(Math.abs(g-h)*v)),b=0,x=t;for(let r=t+2;r<n-2;r+=2){let t=Math.abs(d-l*e[r+1]+u*e[r]);t>b&&(x=r,b=t)}b>(c*y)**2?(this.#douglasPeuckerHelper(e,t,x+2,r),this.#douglasPeuckerHelper(e,x,n,r)):r.push(i,a)}static#douglasPeucker(e){let t=[],n=e.length;return this.#douglasPeuckerHelper(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#bilateralFilter(e,t,n,r,i,a){let o=new Float32Array(a**2),s=-2*r**2,c=a>>1;for(let e=0;e<a;e++){let t=(e-c)**2;for(let n=0;n<a;n++)o[e*a+n]=Math.exp((t+(n-c)**2)/s)}let l=new Float32Array(256),u=-2*i**2;for(let e=0;e<256;e++)l[e]=Math.exp(e**2/u);let d=e.length,f=new Uint8Array(d),p=new Uint32Array(256);for(let r=0;r<n;r++)for(let i=0;i<t;i++){let s=r*t+i,u=e[s],d=0,m=0;for(let s=0;s<a;s++){let f=r+s-c;if(!(f<0||f>=n))for(let n=0;n<a;n++){let r=i+n-c;if(r<0||r>=t)continue;let p=e[f*t+r],h=o[s*a+n]*l[Math.abs(p-u)];d+=p*h,m+=h}}let h=f[s]=Math.round(d/m);p[h]++}return[f,p]}static#getHistogram(e){let t=new Uint32Array(256);for(let n of e)t[n]++;return t}static#toUint8(e){let t=e.length,n=new Uint8ClampedArray(t>>2),r=-1/0,i=1/0;for(let t=0,a=n.length;t<a;t++){let a=n[t]=e[t<<2];r=Math.max(r,a),i=Math.min(i,a)}let a=255/(r-i);for(let e=0,t=n.length;e<t;e++)n[e]=(n[e]-i)*a;return n}static#guessThreshold(e){let t,n=-1/0,r=-1/0,i=e.findIndex(e=>e!==0),a=i,o=i;for(t=i;t<256;t++){let i=e[t];i>n&&(t-a>r&&(r=t-a,o=t-1),n=i,a=t)}for(t=o-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#getGrayPixels(e){let t=e,{width:n,height:r}=e,{maxDim:i}=this.#PARAMETERS,a=n,o=r;if(n>i||r>i){let s=n,c=r,l=Math.log2(Math.max(n,r)/i),u=Math.floor(l);l=l===u?u-1:u;for(let n=0;n<l;n++){a=Math.ceil(s/2),o=Math.ceil(c/2);let n=new OffscreenCanvas(a,o);n.getContext(`2d`).drawImage(e,0,0,s,c,0,0,a,o),s=a,c=o,e!==t&&e.close(),e=n.transferToImageBitmap()}let d=Math.min(i/a,i/o);a=Math.round(a*d),o=Math.round(o*d)}let s=new OffscreenCanvas(a,o).getContext(`2d`,{willReadFrequently:!0});s.fillStyle=`white`,s.fillRect(0,0,a,o),s.filter=`grayscale(1)`,s.drawImage(e,0,0,e.width,e.height,0,0,a,o);let c=s.getImageData(0,0,a,o).data;return[this.#toUint8(c),a,o]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:r},i,a,o,s){let c=new OffscreenCanvas(1,1),l=c.getContext(`2d`,{alpha:!1}),u=l.font=`${n} ${r} 200px ${t}`,{actualBoundingBoxLeft:d,actualBoundingBoxRight:f,actualBoundingBoxAscent:p,actualBoundingBoxDescent:m,fontBoundingBoxAscent:h,fontBoundingBoxDescent:g,width:_}=l.measureText(e),v=1.5,y=Math.ceil(Math.max(Math.abs(d)+Math.abs(f)||0,_)*v),b=Math.ceil(Math.max(Math.abs(p)+Math.abs(m)||200,Math.abs(h)+Math.abs(g)||200)*v);c=new OffscreenCanvas(y,b),l=c.getContext(`2d`,{alpha:!0,willReadFrequently:!0}),l.font=u,l.filter=`grayscale(1)`,l.fillStyle=`white`,l.fillRect(0,0,y,b),l.fillStyle=`black`,l.fillText(e,y*(v-1)/2,b*(3-v)/2);let x=this.#toUint8(l.getImageData(0,0,y,b).data),S=this.#getHistogram(x),C=this.#guessThreshold(S),w=this.#findContours(x,y,b,C);return this.processDrawnLines({lines:{curves:w,width:y,height:b},pageWidth:i,pageHeight:a,rotation:o,innerMargin:s,mustSmooth:!0,areContours:!0})}static process(e,t,n,r,i){let[a,o,s]=this.#getGrayPixels(e),[c,l]=this.#bilateralFilter(a,o,s,Math.hypot(o,s)*this.#PARAMETERS.sigmaSFactor,this.#PARAMETERS.sigmaR,this.#PARAMETERS.kernelSize),u=this.#guessThreshold(l),d=this.#findContours(c,o,s,u);return this.processDrawnLines({lines:{curves:d,width:o,height:s},pageWidth:t,pageHeight:n,rotation:r,innerMargin:i,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:r,innerMargin:i,mustSmooth:a,areContours:o}){r%180!=0&&([t,n]=[n,t]);let{curves:s,width:c,height:l}=e,u=e.thickness??0,d=[],f=Math.min(t/c,n/l),p=f/t,m=f/n,h=[];for(let{points:e}of s){let t=a?this.#douglasPeucker(e):e;if(!t)continue;h.push(t);let n=t.length,r=new Float32Array(n),i=new Float32Array(3*(n===2?2:n-2));if(d.push({line:i,points:r}),n===2){r[0]=t[0]*p,r[1]=t[1]*m,i.set([NaN,NaN,NaN,NaN,r[0],r[1]],0);continue}let[o,s,c,l]=t;o*=p,s*=m,c*=p,l*=m,r.set([o,s,c,l],0),i.set([NaN,NaN,NaN,NaN,o,s],0);for(let e=4;e<n;e+=2){let n=r[e]=t[e]*p,a=r[e+1]=t[e+1]*m;i.set(Q.createBezierPoints(o,s,c,l,n,a),(e-2)*3),[o,s,c,l]=[c,l,n,a]}}if(d.length===0)return null;let g=o?new _c:new mc;return g.build(d,t,n,1,r,o?0:u,i),{outline:g,newCurves:h,areContours:o,thickness:u,width:c,height:l}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:r,height:i}){let a=1/0,o=-1/0,s=0;for(let t of e){s+=t.length;for(let e=2,n=t.length;e<n;e++){let n=t[e]-t[e-2];a=Math.min(a,n),o=Math.max(o,n)}}let c;c=a>=-128&&o<=127?Int8Array:a>=-32768&&o<=32767?Int16Array:Int32Array;let l=e.length,u=vc+yc*l,d=new Uint32Array(u),f=0;d[f++]=u*Uint32Array.BYTES_PER_ELEMENT+(s-2*l)*c.BYTES_PER_ELEMENT,d[f++]=0,d[f++]=r,d[f++]=i,d[f++]=t?0:1,d[f++]=Math.max(0,Math.floor(n??0)),d[f++]=l,d[f++]=c.BYTES_PER_ELEMENT;for(let t of e)d[f++]=t.length-2,d[f++]=t[0],d[f++]=t[1];let p=new CompressionStream(`deflate-raw`),m=p.writable.getWriter();await m.ready,m.write(d);let h=c.prototype.constructor;for(let t of e){let e=new h(t.length-2);for(let n=2,r=t.length;n<r;n++)e[n-2]=t[n]-t[n-2];m.write(e)}m.close();let g=await new Response(p.readable).arrayBuffer(),_=new Uint8Array(g);return qr(_)}static async decompressSignature(e){try{let t=Jr(e),{readable:n,writable:r}=new DecompressionStream(`deflate-raw`),i=r.getWriter();await i.ready,i.write(t).then(async()=>{await i.ready,await i.close()}).catch(()=>{});let a=null,o=0;for await(let e of n)a||=new Uint8Array(new Uint32Array(e.buffer,0,4)[0]),a.set(e,o),o+=e.length;let s=new Uint32Array(a.buffer,0,a.length>>2),c=s[1];if(c!==0)throw Error(`Invalid version: ${c}`);let l=s[2],u=s[3],d=s[4]===0,f=s[5],p=s[6],m=s[7],h=[],g=(vc+yc*p)*Uint32Array.BYTES_PER_ELEMENT,_;switch(m){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(a.buffer,g);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(a.buffer,g);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(a.buffer,g);break}o=0;for(let e=0;e<p;e++){let t=s[yc*e+vc],n=new Float32Array(t+2);h.push(n);for(let t=0;t<yc-1;t++)n[t]=s[yc*e+vc+t+1];for(let e=0;e<t;e++)n[e+2]=n[e]+_[o++]}return{areContours:d,thickness:f,outlines:h,width:l,height:u}}catch(e){return vr(`decompressSignature: ${e}`),null}}},xc=class e extends dc{constructor(){super(),super.updateProperties({fill:Hi._defaultLineColor,"stroke-width":0})}clone(){let t=new e;return t.updateAll(this),t}},Sc=class e extends hc{constructor(e){super(e),super.updateProperties({stroke:Hi._defaultLineColor,"stroke-width":1})}clone(){let t=new e(this._viewParameters);return t.updateAll(this),t}},Cc=class e extends fc{#isExtracted=!1;#description=null;#signatureData=null;#signatureUUID=null;static _type=`signature`;static _editorType=rr.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:`signatureEditor`}),this._willKeepAspectRatio=!0,this.#signatureData=e.signatureData||null,this.#description=null,this.defaultL10nId=`pdfjs-editor-signature-editor1`}static initialize(e,t){Hi.initialize(e,t),this._defaultDrawingOptions=new xc,this._defaultDrawnSignatureOptions=new Sc(t.viewParameters)}static getDefaultDrawingOptions(e){let t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return wr(this,`typesMap`,new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:`signature`,hasDescription:!!this.#description}}static computeTelemetryFinalData(e){let t=e.get(`hasDescription`);return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,n,{_isCopy:r}=this;if(r&&(this._isCopy=!1,t=this.x,n=this.y),super.render(),this._drawId===null)if(this.#signatureData){let{lines:t,mustSmooth:n,areContours:r,description:i,uuid:a,heightInPage:o}=this.#signatureData,{rawDims:{pageWidth:s,pageHeight:c},rotation:l}=this.parent.viewport,u=bc.processDrawnLines({lines:t,pageWidth:s,pageHeight:c,rotation:l,innerMargin:e._INNER_MARGIN,mustSmooth:n,areContours:r});this.addSignature(u,o,i,a)}else this.div.setAttribute(`data-l10n-args`,JSON.stringify({description:``})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute(`data-l10n-args`,JSON.stringify({description:this.#description||``}));return r&&(this._isCopy=!0,this._moveAfterPaste(t,n)),this.div}setUuid(e){this.#signatureUUID=e,this.addEditToolbar()}getUuid(){return this.#signatureUUID}get description(){return this.#description}set description(e){this.#description=e,this.div&&(this.div.setAttribute(`data-l10n-args`,JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){let{newCurves:e,areContours:t,thickness:n,width:r,height:i}=this.#signatureData,a=Math.max(r,i),o=bc.processDrawnLines({lines:{curves:e.map(e=>({points:e})),thickness:n,width:r,height:i},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:o.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[[`editSignature`,this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,n,r,i){let{x:a,y:o}=this,{outline:s}=this.#signatureData=t;this.#isExtracted=s instanceof _c,this.description=r;let c;this.#isExtracted?c=e.getDefaultDrawingOptions():(c=e._defaultDrawnSignatureOptions.clone(),c.updateProperties({"stroke-width":s.thickness})),this._addOutlines({drawOutlines:s,drawingOptions:c});let[,l]=this.pageDimensions,u=n/l;u=u>=1?.5:u,this.width*=u/this.height,this.width>=1&&(u*=.9/this.width,this.width=.9),this.height=u,this.setDims(),this.x=a,this.y=o,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:`pdfjs.signature.inserted`,data:{hasBeenSaved:!!i,hasDescription:!!r}}),this.div.hidden=!1}getFromImage(t){let{rawDims:{pageWidth:n,pageHeight:r},rotation:i}=this.parent.viewport;return bc.process(t,n,r,i,e._INNER_MARGIN)}getFromText(t,n){let{rawDims:{pageWidth:r,pageHeight:i},rotation:a}=this.parent.viewport;return bc.extractContoursFromText(t,n,r,i,a,e._INNER_MARGIN)}getDrawnSignature(t){let{rawDims:{pageWidth:n,pageHeight:r},rotation:i}=this.parent.viewport;return bc.processDrawnLines({lines:t,pageWidth:n,pageHeight:r,rotation:i,innerMargin:e._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:n}){t?this._drawingOptions=e.getDefaultDrawingOptions():(this._drawingOptions=e._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":n}))}serialize(e=!1){if(this.isEmpty())return null;let{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":r}}=this,i=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#isExtracted,color:[0,0,0],thickness:this.#isExtracted?0:r});return this.addComment(i),e?(i.paths={lines:t,points:n},i.uuid=this.#signatureUUID,i.isCopy=!0):i.lines=t,this.#description&&(i.accessibilityData={type:`Figure`,alt:this.#description}),i}static deserializeDraw(e,t,n,r,i,a){return a.areContours?_c.deserialize(e,t,n,r,i,a):mc.deserialize(e,t,n,r,i,a)}static async deserialize(e,t,n){let r=await super.deserialize(e,t,n);return r.#isExtracted=e.areContours,r.description=e.accessibilityData?.alt||``,r.#signatureUUID=e.uuid,r}},wc=class extends Hi{#bitmap=null;#bitmapId=null;#bitmapPromise=null;#bitmapUrl=null;#bitmapFile=null;#bitmapFileName=``;#canvas=null;#missingCanvas=!1;#resizeTimeoutId=null;#isSvg=!1;#hasBeenAddedInUndoStack=!1;static _type=`stamp`;static _editorType=rr.STAMP;constructor(e){super({...e,name:`stampEditor`}),this.#bitmapUrl=e.bitmapUrl,this.#bitmapFile=e.bitmapFile,this.defaultL10nId=`pdfjs-editor-stamp-editor`}static initialize(e,t){Hi.initialize(e,t)}static isHandlingMimeForPasting(e){return yi.includes(e)}static paste(e,t){t.pasteEditor({mode:rr.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:`stamp`,hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){let t=e.get(`hasAltText`);return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#getBitmapFetched(e,t=!1){if(!e){this.remove();return}this.#bitmap=e.bitmap,t||(this.#bitmapId=e.id,this.#isSvg=e.isSvg),e.file&&(this.#bitmapFileName=e.file.name),this.#createCanvas()}#getBitmapDone(){if(this.#bitmapPromise=null,this._uiManager.enableWaiting(!1),this.#canvas){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#bitmap){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#bitmap){this._reportTelemetry({action:`pdfjs.image.image_added`,data:{alt_text_modal:!1,alt_text_type:`empty`}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;let{mlManager:n}=this._uiManager;if(!n)throw Error(`No ML.`);if(!await n.isEnabledFor(`altText`))throw Error(`ML isn't enabled for alt text.`);let{data:r,width:i,height:a}=e||this.copyCanvas(null,null,!0).imageData,o=await n.guess({name:`altText`,request:{data:r,width:i,height:a,channels:r.length/(i*a)}});if(!o)throw Error(`No response from the AI service.`);if(o.error)throw Error(`Error from the AI service.`);if(o.cancel)return null;if(!o.output)throw Error(`No valid response from the AI service.`);let s=o.output;return await this.setGuessedAltText(s),t&&!this.hasAltTextData()&&(this.altTextData={alt:s,decorative:!1}),s}#getBitmap(){if(this.#bitmapId){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#bitmapId).then(e=>this.#getBitmapFetched(e,!0)).finally(()=>this.#getBitmapDone());return}if(this.#bitmapUrl){let e=this.#bitmapUrl;this.#bitmapUrl=null,this._uiManager.enableWaiting(!0),this.#bitmapPromise=this._uiManager.imageManager.getFromUrl(e).then(e=>this.#getBitmapFetched(e)).finally(()=>this.#getBitmapDone());return}if(this.#bitmapFile){let e=this.#bitmapFile;this.#bitmapFile=null,this._uiManager.enableWaiting(!0),this.#bitmapPromise=this._uiManager.imageManager.getFromFile(e).then(e=>this.#getBitmapFetched(e)).finally(()=>this.#getBitmapDone());return}let e=document.createElement(`input`);e.type=`file`,e.accept=yi.join(`,`);let t=this._uiManager._signal;this.#bitmapPromise=new Promise(n=>{e.addEventListener(`change`,async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);let t=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:`pdfjs.image.image_selected`,data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#getBitmapFetched(t)}n()},{signal:t}),e.addEventListener(`cancel`,()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#getBitmapDone()),e.click()}remove(){this.#bitmapId&&(this.#bitmap=null,this._uiManager.imageManager.deleteId(this.#bitmapId),this.#canvas?.remove(),this.#canvas=null,this.#resizeTimeoutId&&=(clearTimeout(this.#resizeTimeoutId),null)),super.remove()}rebuild(){if(!this.parent){this.#bitmapId&&this.#getBitmap();return}super.rebuild(),this.div!==null&&(this.#bitmapId&&this.#canvas===null&&this.#getBitmap(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#bitmapPromise||this.#bitmap||this.#bitmapUrl||this.#bitmapFile||this.#bitmapId||this.#missingCanvas)}get toolbarButtons(){return[[`altText`,this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#missingCanvas||(this.#bitmap?this.#createCanvas():this.#getBitmap()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){let{id:n,bitmap:r}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#bitmapId=n,r&&(this.#bitmap=r),this.#missingCanvas=!1,this.#createCanvas())}_onResized(){this.onScaleChanging()}onScaleChanging(){this.parent&&(this.#resizeTimeoutId!==null&&clearTimeout(this.#resizeTimeoutId),this.#resizeTimeoutId=setTimeout(()=>{this.#resizeTimeoutId=null,this.#drawBitmap()},200))}#createCanvas(){let{div:e}=this,{width:t,height:n}=this.#bitmap,[r,i]=this.pageDimensions,a=.75;if(this.width)t=this.width*r,n=this.height*i;else if(t>a*r||n>a*i){let e=Math.min(a*r/t,a*i/n);t*=e,n*=e}this._uiManager.enableWaiting(!1);let o=this.#canvas=document.createElement(`canvas`);o.setAttribute(`role`,`img`),this.addContainer(o),this.width=t/r,this.height=n/i,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#drawBitmap(),this.#hasBeenAddedInUndoStack||=(this.parent.addUndoableEditor(this),!0),this._reportTelemetry({action:`inserted_image`}),this.#bitmapFileName&&this.div.setAttribute(`aria-description`,this.#bitmapFileName),this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-stamp-added-alert`)}copyCanvas(e,t,n=!1){e||=224;let{width:r,height:i}=this.#bitmap,a=new vi,o=this.#bitmap,s=r,c=i,l=null;if(t){if(r>t||i>t){let e=Math.min(t/r,t/i);s=Math.floor(r*e),c=Math.floor(i*e)}l=document.createElement(`canvas`);let e=l.width=Math.ceil(s*a.sx),n=l.height=Math.ceil(c*a.sy);this.#isSvg||(o=this.#scaleBitmap(e,n));let u=l.getContext(`2d`);u.filter=this._uiManager.hcmFilter;let d=`white`,f=`#cfcfd8`;this._uiManager.hcmFilter===`none`?bi.isDarkMode&&(d=`#8f8f9d`,f=`#42414d`):f=`black`;let p=15*a.sx,m=15*a.sy,h=new OffscreenCanvas(p*2,m*2),g=h.getContext(`2d`);g.fillStyle=d,g.fillRect(0,0,p*2,m*2),g.fillStyle=f,g.fillRect(0,0,p,m),g.fillRect(p,m,p,m),u.fillStyle=u.createPattern(h,`repeat`),u.fillRect(0,0,e,n),u.drawImage(o,0,0,o.width,o.height,0,0,e,n)}let u=null;if(n){let t,n;if(a.symmetric&&o.width<e&&o.height<e)t=o.width,n=o.height;else if(o=this.#bitmap,r>e||i>e){let a=Math.min(e/r,e/i);t=Math.floor(r*a),n=Math.floor(i*a),this.#isSvg||(o=this.#scaleBitmap(t,n))}let s=new OffscreenCanvas(t,n).getContext(`2d`,{willReadFrequently:!0});s.drawImage(o,0,0,o.width,o.height,0,0,t,n),u={width:t,height:n,data:s.getImageData(0,0,t,n).data}}return{canvas:l,width:s,height:c,imageData:u}}#scaleBitmap(e,t){let{width:n,height:r}=this.#bitmap,i=n,a=r,o=this.#bitmap;for(;i>2*e||a>2*t;){let n=i,r=a;i>2*e&&(i=i>=16384?Math.floor(i/2)-1:Math.ceil(i/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));let s=new OffscreenCanvas(i,a);s.getContext(`2d`).drawImage(o,0,0,n,r,0,0,i,a),o=s.transferToImageBitmap()}return o}#drawBitmap(){let[e,t]=this.parentDimensions,{width:n,height:r}=this,i=new vi,a=Math.ceil(n*e*i.sx),o=Math.ceil(r*t*i.sy),s=this.#canvas;if(!s||s.width===a&&s.height===o)return;s.width=a,s.height=o;let c=this.#isSvg?this.#bitmap:this.#scaleBitmap(a,o),l=s.getContext(`2d`);l.filter=this._uiManager.hcmFilter,l.drawImage(c,0,0,c.width,c.height,0,0,a,o)}#serializeBitmap(e){if(e){if(this.#isSvg){let e=this._uiManager.imageManager.getSvgUrl(this.#bitmapId);if(e)return e}let e=document.createElement(`canvas`);return{width:e.width,height:e.height}=this.#bitmap,e.getContext(`2d`).drawImage(this.#bitmap,0,0),e.toDataURL()}if(this.#isSvg){let[e,t]=this.pageDimensions,n=Math.round(this.width*e*Qr.PDF_TO_CSS_UNITS),r=Math.round(this.height*t*Qr.PDF_TO_CSS_UNITS),i=new OffscreenCanvas(n,r);return i.getContext(`2d`).drawImage(this.#bitmap,0,0,this.#bitmap.width,this.#bitmap.height,0,0,n,r),i.transferToImageBitmap()}return structuredClone(this.#bitmap)}static async deserialize(e,t,n){let r=null,i=!1;if(e instanceof $s){let{data:{rect:a,rotation:o,id:s,structParent:c,popupRef:l,richText:u,contentsObj:d,creationDate:f,modificationDate:p},container:m,parent:{page:{pageNumber:h}},canvas:g}=e,_,v;g?(delete e.canvas,{id:_,bitmap:v}=n.imageManager.getFromCanvas(m.id,g),g.remove()):(i=!0,e._hasNoCanvas=!0);let y=(await t._structTree.getAriaAttributes(`${Wr}${s}`))?.get(`aria-label`)||``;r=e={annotationType:rr.STAMP,bitmapId:_,bitmap:v,pageIndex:h-1,rect:a.slice(0),rotation:o,annotationElementId:s,id:s,deleted:!1,accessibilityData:{decorative:!1,altText:y},isSvg:!1,structParent:c,popupRef:l,richText:u,comment:d?.str||null,creationDate:f,modificationDate:p}}let a=await super.deserialize(e,t,n),{rect:o,bitmap:s,bitmapUrl:c,bitmapId:l,isSvg:u,accessibilityData:d}=e;i?(n.addMissingCanvas(e.id,a),a.#missingCanvas=!0):l&&n.imageManager.isValidId(l)?(a.#bitmapId=l,s&&(a.#bitmap=s)):a.#bitmapUrl=c,a.#isSvg=u;let[f,p]=a.pageDimensions;return a.width=(o[2]-o[0])/f,a.height=(o[3]-o[1])/p,d&&(a.altTextData=d),a._initialData=r,e.comment&&a.setCommentData(e),a.#hasBeenAddedInUndoStack=!!r,a}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();let n=Object.assign(super.serialize(e),{bitmapId:this.#bitmapId,isSvg:this.#isSvg});if(this.addComment(n),e)return n.bitmapUrl=this.#serializeBitmap(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;let{decorative:r,altText:i}=this.serializeAltText(!1);if(!r&&i&&(n.accessibilityData={type:`Figure`,alt:i}),this.annotationElementId){let e=this.#hasElementChanged(n);return e.isSame?null:(e.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;let a=this.#isSvg?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#bitmapId))t.stamps.set(this.#bitmapId,{area:a,serialized:n}),n.bitmap=this.#serializeBitmap(!1);else if(this.#isSvg){let e=t.stamps.get(this.#bitmapId);a>e.area&&(e.area=a,e.serialized.bitmap.close(),e.serialized.bitmap=this.#serializeBitmap(!1))}return n}#hasElementChanged(e){let{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,r=e.pageIndex===t,i=(e.accessibilityData?.alt||``)===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&i,isSameAltText:i}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}},Tc=class e{#accessibilityManager;#allowClick=!1;#annotationLayer=null;#clickAC=null;#editorFocusTimeoutId=null;#editors=new Map;#hadPointerDown=!1;#isDisabling=!1;#isEnabling=!1;#drawingAC=null;#focusedElement=null;#textLayer=null;#textSelectionAC=null;#textLayerDblClickAC=null;#lastPointerDownTimestamp=-1;#uiManager;static _initialized=!1;static#editorTypes=new Map([rc,gc,wc,uc,Cc].map(e=>[e._editorType,e]));constructor({uiManager:t,pageIndex:n,div:r,structTreeLayer:i,accessibilityManager:a,annotationLayer:o,drawLayer:s,textLayer:c,viewport:l,l10n:u}){let d=[...e.#editorTypes.values()];if(!e._initialized){e._initialized=!0;for(let e of d)e.initialize(u,t)}t.registerEditorTypes(d),this.#uiManager=t,this.pageIndex=n,this.div=r,this.#accessibilityManager=a,this.#annotationLayer=o,this.viewport=l,this.#textLayer=c,this.drawLayer=s,this._structTree=i,this.#uiManager.addLayer(this)}get isEmpty(){return this.#editors.size===0}get isInvisible(){return this.isEmpty&&this.#uiManager.getMode()===rr.NONE}updateToolbar(e){this.#uiManager.updateToolbar(e)}updateMode(t=this.#uiManager.getMode()){switch(this.#cleanup(),t){case rr.NONE:this.div.classList.toggle(`nonEditing`,!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case rr.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case rr.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);let{classList:n}=this.div;if(n.toggle(`nonEditing`,!1),t===rr.POPUP)n.toggle(`commentEditing`,!0);else{n.toggle(`commentEditing`,!1);for(let r of e.#editorTypes.values())n.toggle(`${r._type}Editing`,t===r._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#textLayer?.div}setEditingState(e){this.#uiManager.setEditingState(e)}addCommands(e){this.#uiManager.addCommands(e)}cleanUndoStack(e){this.#uiManager.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle(`drawing`,!e)}togglePointerEvents(e=!1){this.div.classList.toggle(`disabled`,!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#annotationLayer?.div.classList.toggle(`disabled`,!e)}get#allEditorsIterator(){return this.#editors.size===0?this.#uiManager.getEditors(this.pageIndex):this.#editors.values()}async enable(){this.#isEnabling=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle(`nonEditing`,!1),this.#textLayerDblClickAC?.abort(),this.#textLayerDblClickAC=null;let e=new Set;for(let t of this.#allEditorsIterator)t.enableEditing(),t.show(!0),t.annotationElementId&&(this.#uiManager.removeChangedExistingAnnotation(t),e.add(t.annotationElementId));let t=this.#annotationLayer;if(t)for(let n of t.getEditableAnnotations()){if(n.hide(),this.#uiManager.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;let t=await this.deserialize(n);t&&(this.addOrRebuild(t),t.enableEditing())}this.#isEnabling=!1,this.#uiManager._eventBus.dispatch(`editorsrendered`,{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#isDisabling=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle(`nonEditing`,!0),this.#textLayer&&!this.#textLayerDblClickAC){this.#textLayerDblClickAC=new AbortController;let e=this.#uiManager.combinedSignal(this.#textLayerDblClickAC);this.#textLayer.div.addEventListener(`pointerdown`,e=>{let{clientX:t,clientY:n,timeStamp:r}=e,i=this.#lastPointerDownTimestamp;if(r-i>500){this.#lastPointerDownTimestamp=r;return}this.#lastPointerDownTimestamp=-1;let{classList:a}=this.div;a.toggle(`getElements`,!0);let o=document.elementsFromPoint(t,n);if(a.toggle(`getElements`,!1),!this.div.contains(o[0]))return;let s,c=RegExp(`^${nr}[0-9]+$`);for(let e of o)if(c.test(e.id)){s=e.id;break}if(!s)return;let l=this.#editors.get(s);l?.annotationElementId===null&&(e.stopPropagation(),e.preventDefault(),l.dblclick(e))},{signal:e,capture:!0})}let t=this.#annotationLayer;if(t){let e=new Map,n=new Map;for(let r of this.#allEditorsIterator){if(r.disableEditing(),!r.annotationElementId){r.updateFakeAnnotationElement(t);continue}if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else n.set(r.annotationElementId,r);this.getEditableAnnotation(r.annotationElementId)?.show(),r.remove()}let r=t.getEditableAnnotations();for(let t of r){let{id:r}=t.data;if(this.#uiManager.isDeletedAnnotationElement(r)){t.updateEdited({deleted:!0});continue}let i=n.get(r);if(i){i.resetAnnotationElement(t),i.show(!1),t.show();continue}i=e.get(r),i&&(this.#uiManager.addChangedExistingAnnotation(i),i.renderAnnotationElement(t)&&i.show(!1)),t.show()}}this.#cleanup(),this.isEmpty&&(this.div.hidden=!0);let{classList:n}=this.div;for(let t of e.#editorTypes.values())n.remove(`${t._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#isDisabling=!1}getEditableAnnotation(e){return this.#annotationLayer?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#uiManager.getActive()!==e&&this.#uiManager.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#textLayer?.div&&!this.#textSelectionAC){this.#textSelectionAC=new AbortController;let e=this.#uiManager.combinedSignal(this.#textSelectionAC);this.#textLayer.div.addEventListener(`pointerdown`,this.#textLayerPointerDown.bind(this),{signal:e}),this.#textLayer.div.classList.add(`highlighting`)}}disableTextSelection(){this.div.tabIndex=0,this.#textLayer?.div&&this.#textSelectionAC&&(this.#textSelectionAC.abort(),this.#textSelectionAC=null,this.#textLayer.div.classList.remove(`highlighting`))}#textLayerPointerDown(e){this.#uiManager.unselectAll();let{target:t}=e;if(t===this.#textLayer.div||(t.getAttribute(`role`)===`img`||t.classList.contains(`endOfContent`))&&this.#textLayer.div.contains(t)){let{isMac:t}=Lr.platform;if(e.button!==0||e.ctrlKey&&t)return;this.#uiManager.showAllEditors(`highlight`,!0,!0),this.#textLayer.div.classList.add(`free`),this.toggleDrawing(),uc.startHighlighting(this,this.#uiManager.direction===`ltr`,{target:this.#textLayer.div,x:e.x,y:e.y}),this.#textLayer.div.addEventListener(`pointerup`,()=>{this.#textLayer.div.classList.remove(`free`),this.toggleDrawing(!0)},{once:!0,signal:this.#uiManager._signal}),e.preventDefault()}}enableClick(){if(this.#clickAC)return;this.#clickAC=new AbortController;let e=this.#uiManager.combinedSignal(this.#clickAC);this.div.addEventListener(`pointerdown`,this.pointerdown.bind(this),{signal:e});let t=this.pointerup.bind(this);this.div.addEventListener(`pointerup`,t,{signal:e}),this.div.addEventListener(`pointercancel`,t,{signal:e})}disableClick(){this.#clickAC?.abort(),this.#clickAC=null}attach(e){this.#editors.set(e.id,e);let{annotationElementId:t}=e;t&&this.#uiManager.isDeletedAnnotationElement(t)&&this.#uiManager.removeDeletedAnnotationElement(e)}detach(e){this.#editors.delete(e.id),this.#accessibilityManager?.removePointerInTextLayer(e.contentDiv),!this.#isDisabling&&e.annotationElementId&&this.#uiManager.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#uiManager.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#uiManager.addDeletedAnnotationElement(e.annotationElementId),Hi.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#uiManager.addEditor(e),this.attach(e),!e.isAttachedToDOM){let t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#isEnabling),this.#uiManager.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;let{activeElement:t}=document;e.div.contains(t)&&!this.#editorFocusTimeoutId&&(e._focusEventsAllowed=!1,this.#editorFocusTimeoutId=setTimeout(()=>{this.#editorFocusTimeoutId=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener(`focusin`,()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#uiManager._signal}),t.focus())},0)),e._structTreeParentId=this.#accessibilityManager?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){this.addCommands({cmd:()=>e._uiManager.rebuild(e),undo:()=>{e.remove()},mustExec:!1})}getEditorByUID(e){for(let t of this.#editors.values())if(t.uid===e)return t;return null}getNextId(){return this.#uiManager.getId()}get#currentEditorType(){return e.#editorTypes.get(this.#uiManager.getMode())}combinedSignal(e){return this.#uiManager.combinedSignal(e)}#createNewEditor(e){let t=this.#currentEditorType;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#currentEditorType?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#uiManager.updateMode(e.mode);let{offsetX:n,offsetY:r}=this.#getCenterPoint(),i=this.getNextId(),a=this.#createNewEditor({parent:this,id:i,x:n,y:r,uiManager:this.#uiManager,isCentered:!0,...t});a&&this.add(a)}async deserialize(t){return await e.#editorTypes.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#uiManager)||null}createAndAddNewEditor(e,t,n={}){let r=this.getNextId(),i=this.#createNewEditor({parent:this,id:r,x:e.offsetX,y:e.offsetY,uiManager:this.#uiManager,isCentered:t,...n});return i&&this.add(i),i}get boundingClientRect(){return this.div.getBoundingClientRect()}#getCenterPoint(){let{x:e,y:t,width:n,height:r}=this.boundingClientRect,i=Math.max(0,e),a=Math.max(0,t),o=Math.min(window.innerWidth,e+n),s=Math.min(window.innerHeight,t+r),c=(i+o)/2-e,l=(a+s)/2-t,[u,d]=this.viewport.rotation%180==0?[c,l]:[l,c];return{offsetX:u,offsetY:d}}addNewEditor(e={}){this.createAndAddNewEditor(this.#getCenterPoint(),!0,e)}setSelected(e){this.#uiManager.setSelected(e)}toggleSelected(e){this.#uiManager.toggleSelected(e)}unselect(e){this.#uiManager.unselect(e)}pointerup(e){let{isMac:t}=Lr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#hadPointerDown||(this.#hadPointerDown=!1,this.#currentEditorType?.isDrawer&&this.#currentEditorType.supportMultipleDrawings))return;if(!this.#allowClick){this.#allowClick=!0;return}let n=this.#uiManager.getMode();if(n===rr.STAMP||n===rr.SIGNATURE){this.#uiManager.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#uiManager.getMode()===rr.HIGHLIGHT&&this.enableTextSelection(),this.#hadPointerDown){this.#hadPointerDown=!1;return}let{isMac:t}=Lr.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#hadPointerDown=!0,this.#currentEditorType?.isDrawer){this.startDrawingSession(e);return}let n=this.#uiManager.getActive();this.#allowClick=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#drawingAC){this.#currentEditorType.startDrawing(this,this.#uiManager,!1,e);return}this.#uiManager.setCurrentDrawingSession(this),this.#drawingAC=new AbortController;let t=this.#uiManager.combinedSignal(this.#drawingAC);this.div.addEventListener(`blur`,({relatedTarget:e})=>{e&&!this.div.contains(e)&&(this.#focusedElement=null,this.commitOrRemove())},{signal:t}),this.#currentEditorType.startDrawing(this,this.#uiManager,!1,e)}pause(e){if(e){let{activeElement:e}=document;this.div.contains(e)&&(this.#focusedElement=e);return}this.#focusedElement&&setTimeout(()=>{this.#focusedElement?.focus(),this.#focusedElement=null},0)}endDrawingSession(e=!1){return this.#drawingAC?(this.#uiManager.setCurrentDrawingSession(null),this.#drawingAC.abort(),this.#drawingAC=null,this.#focusedElement=null,this.#currentEditorType.endDrawing(e)):null}findNewParent(e,t,n){let r=this.#uiManager.findParent(t,n);return r===null||r===this?!1:(r.changeParent(e),!0)}commitOrRemove(){return this.#drawingAC?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#drawingAC&&this.#currentEditorType.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#uiManager.getActive()?.parent===this&&(this.#uiManager.commitOrRemove(),this.#uiManager.setActiveEditor(null)),this.#editorFocusTimeoutId&&=(clearTimeout(this.#editorFocusTimeoutId),null);for(let e of this.#editors.values())this.#accessibilityManager?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#editors.clear(),this.#uiManager.removeLayer(this)}#cleanup(){for(let e of this.#editors.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,_i(this.div,e);for(let e of this.#uiManager.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:e}){this.#uiManager.commitOrRemove(),this.#cleanup();let t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,_i(this.div,{rotation:n}),t!==n)for(let e of this.#editors.values())e.rotate(n)}get pageDimensions(){let{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#uiManager.viewParameters.realScale}},Ec=class e{#parent=null;#mapping=new Map;#toUpdate=new Map;static#id=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#parent){this.#parent=e;return}if(this.#parent!==e){if(this.#mapping.size>0)for(let t of this.#mapping.values())t.remove(),e.append(t);this.#parent=e}}static get _svgFactory(){return wr(this,`_svgFactory`,new Cs)}static#setBox(e,[t,n,r,i]){let{style:a}=e;a.top=`${100*n}%`,a.left=`${100*t}%`,a.width=`${100*r}%`,a.height=`${100*i}%`}#createSVG(){let t=e._svgFactory.create(1,1,!0);return this.#parent.append(t),t.setAttribute(`aria-hidden`,!0),t}#createClipPath(t,n){let r=e._svgFactory.createElement(`clipPath`);t.append(r);let i=`clip_${n}`;r.setAttribute(`id`,i),r.setAttribute(`clipPathUnits`,`objectBoundingBox`);let a=e._svgFactory.createElement(`use`);return r.append(a),a.setAttribute(`href`,`#${n}`),a.classList.add(`clip`),i}#updateProperties(e,t){for(let[n,r]of Object.entries(t))r===null?e.removeAttribute(n):e.setAttribute(n,r)}draw(t,n=!1,r=!1){let i=e.#id++,a=this.#createSVG(),o=e._svgFactory.createElement(`defs`);a.append(o);let s=e._svgFactory.createElement(`path`);o.append(s);let c=`path_p${this.pageIndex}_${i}`;s.setAttribute(`id`,c),s.setAttribute(`vector-effect`,`non-scaling-stroke`),n&&this.#toUpdate.set(i,s);let l=r?this.#createClipPath(o,c):null,u=e._svgFactory.createElement(`use`);return a.append(u),u.setAttribute(`href`,`#${c}`),this.updateProperties(a,t),this.#mapping.set(i,a),{id:i,clipPathId:`url(#${l})`}}drawOutline(t,n){let r=e.#id++,i=this.#createSVG(),a=e._svgFactory.createElement(`defs`);i.append(a);let o=e._svgFactory.createElement(`path`);a.append(o);let s=`path_p${this.pageIndex}_${r}`;o.setAttribute(`id`,s),o.setAttribute(`vector-effect`,`non-scaling-stroke`);let c;if(n){let t=e._svgFactory.createElement(`mask`);a.append(t),c=`mask_p${this.pageIndex}_${r}`,t.setAttribute(`id`,c),t.setAttribute(`maskUnits`,`objectBoundingBox`);let n=e._svgFactory.createElement(`rect`);t.append(n),n.setAttribute(`width`,`1`),n.setAttribute(`height`,`1`),n.setAttribute(`fill`,`white`);let i=e._svgFactory.createElement(`use`);t.append(i),i.setAttribute(`href`,`#${s}`),i.setAttribute(`stroke`,`none`),i.setAttribute(`fill`,`black`),i.setAttribute(`fill-rule`,`nonzero`),i.classList.add(`mask`)}let l=e._svgFactory.createElement(`use`);i.append(l),l.setAttribute(`href`,`#${s}`),c&&l.setAttribute(`mask`,`url(#${c})`);let u=l.cloneNode();return i.append(u),l.classList.add(`mainOutline`),u.classList.add(`secondaryOutline`),this.updateProperties(i,t),this.#mapping.set(r,i),r}finalizeDraw(e,t){this.#toUpdate.delete(e),this.updateProperties(e,t)}updateProperties(t,n){if(!n)return;let{root:r,bbox:i,rootClass:a,path:o}=n,s=typeof t==`number`?this.#mapping.get(t):t;if(s){if(r&&this.#updateProperties(s,r),i&&e.#setBox(s,i),a){let{classList:e}=s;for(let[t,n]of Object.entries(a))e.toggle(t,n)}if(o){let e=s.firstChild.firstChild;this.#updateProperties(e,o)}}}updateParent(e,t){if(t===this)return;let n=this.#mapping.get(e);n&&(t.#parent.append(n),this.#mapping.delete(e),t.#mapping.set(e,n))}remove(e){this.#toUpdate.delete(e),this.#parent!==null&&(this.#mapping.get(e).remove(),this.#mapping.delete(e))}destroy(){this.#parent=null;for(let e of this.#mapping.values())e.remove();this.#mapping.clear(),this.#toUpdate.clear()}};globalThis._pdfjsTestingUtils={HighlightOutliner:oc},globalThis.pdfjsLib={AbortException:jr,AnnotationEditorLayer:Tc,AnnotationEditorParamsType:ir,AnnotationEditorType:rr,AnnotationEditorUIManager:Ri,AnnotationLayer:tc,AnnotationMode:tr,AnnotationType:cr,applyOpacity:Si,build:gs,ColorPicker:_s,createValidAbsoluteUrl:Sr,CSSConstants:xi,DOMSVGFactory:Cs,DrawLayer:Ec,FeatureTest:Lr,fetchData:$r,findContrastColor:Oi,getDocument:os,getFilenameFromUrl:ii,getPdfFilenameFromUrl:ai,getRGB:pi,getUuid:Ur,getXfaPageViewport:fi,GlobalWorkerOptions:bo,ImageKind:sr,InvalidPDFException:Or,isDataScheme:ni,isPdfFile:ri,isValidExplicitDest:ra,MathClamp:Kr,noContextMenu:ci,normalizeUnicode:Hr,OPS:dr,OutputScale:vi,PasswordResponses:pr,PDFDataRangeTransport:cs,PDFDateString:di,PDFWorker:ds,PermissionFlag:ar,PixelsPerInch:Qr,RenderingCancelledException:ti,renderRichText:ki,ResponseException:kr,setLayerDimensions:_i,shadow:wr,SignatureExtractor:bc,stopEvent:li,SupportedImageMimeTypes:yi,TextLayer:ns,TouchManager:Vi,updateUrlHash:Cr,Util:Z,VerbosityLevel:ur,version:hs,XfaLayer:Xr};var Dc=o(((e,t)=>{var n=void 0;t.exports=function(e){return e!==n&&e!==null}})),Oc=o(((e,t)=>{var n=Dc(),r={object:!0,function:!0,undefined:!0};t.exports=function(e){return n(e)?hasOwnProperty.call(r,typeof e):!1}})),kc=o(((e,t)=>{var n=Oc();t.exports=function(e){if(!n(e))return!1;try{return e.constructor?e.constructor.prototype===e:!1}catch{return!1}}})),Ac=o(((e,t)=>{var n=kc();t.exports=function(e){if(typeof e!=`function`||!hasOwnProperty.call(e,`length`))return!1;try{if(typeof e.length!=`number`||typeof e.call!=`function`||typeof e.apply!=`function`)return!1}catch{return!1}return!n(e)}})),jc=o(((e,t)=>{var n=Ac(),r=/^\s*class[\s{/}]/,i=Function.prototype.toString;t.exports=function(e){return!(!n(e)||r.test(i.call(e)))}})),Mc=o(((e,t)=>{t.exports=function(){var e=Object.assign,t;return typeof e==`function`?(t={foo:`raz`},e(t,{bar:`dwa`},{trzy:`trzy`}),t.foo+t.bar+t.trzy===`razdwatrzy`):!1}})),Nc=o(((e,t)=>{t.exports=function(){try{return!0}catch{return!1}}})),Pc=o(((e,t)=>{t.exports=function(){}})),Fc=o(((e,t)=>{var n=Pc()();t.exports=function(e){return e!==n&&e!==null}})),Ic=o(((e,t)=>{var n=Fc(),r=Object.keys;t.exports=function(e){return r(n(e)?Object(e):e)}})),Lc=o(((e,t)=>{t.exports=Nc()()?Object.keys:Ic()})),Rc=o(((e,t)=>{var n=Fc();t.exports=function(e){if(!n(e))throw TypeError(`Cannot use null or undefined`);return e}})),zc=o(((e,t)=>{var n=Lc(),r=Rc(),i=Math.max;t.exports=function(e,t){var a,o,s=i(arguments.length,2),c;for(e=Object(r(e)),c=function(n){try{e[n]=t[n]}catch(e){a||=e}},o=1;o<s;++o)t=arguments[o],n(t).forEach(c);if(a!==void 0)throw a;return e}})),Bc=o(((e,t)=>{t.exports=Mc()()?Object.assign:zc()})),Vc=o(((e,t)=>{var n=Fc(),r=Array.prototype.forEach,i=Object.create,a=function(e,t){for(var n in e)t[n]=e[n]};t.exports=function(e){var t=i(null);return r.call(arguments,function(e){n(e)&&a(Object(e),t)}),t}})),Hc=o(((e,t)=>{var n=`razdwatrzy`;t.exports=function(){return typeof n.contains==`function`?n.contains(`dwa`)===!0&&n.contains(`foo`)===!1:!1}})),Uc=o(((e,t)=>{var n=String.prototype.indexOf;t.exports=function(e){return n.call(this,e,arguments[1])>-1}})),Wc=o(((e,t)=>{t.exports=Hc()()?String.prototype.contains:Uc()})),Gc=o(((e,t)=>{var n=Dc(),r=jc(),i=Bc(),a=Vc(),o=Wc(),s=t.exports=function(e,t){var r,s,c,l,u;return arguments.length<2||typeof e!=`string`?(l=t,t=e,e=null):l=arguments[2],n(e)?(r=o.call(e,`c`),s=o.call(e,`e`),c=o.call(e,`w`)):(r=c=!0,s=!1),u={value:t,configurable:r,enumerable:s,writable:c},l?i(a(l),u):u};s.gs=function(e,t,s){var c,l,u,d;return typeof e==`string`?u=arguments[3]:(u=s,s=t,t=e,e=null),n(t)?r(t)?n(s)?r(s)||(u=s,s=void 0):s=void 0:(u=t,t=s=void 0):t=void 0,n(e)?(c=o.call(e,`c`),l=o.call(e,`e`)):(c=!0,l=!1),d={get:t,set:s,configurable:c,enumerable:l},u?i(a(u),d):d}})),Kc=o(((e,t)=>{t.exports=function(e){if(typeof e!=`function`)throw TypeError(e+` is not a function`);return e}})),qc=o(((e,t)=>{var n=Gc(),r=Kc(),i=Function.prototype.apply,a=Function.prototype.call,o=Object.create,s=Object.defineProperty,c=Object.defineProperties,l=Object.prototype.hasOwnProperty,u={configurable:!0,enumerable:!1,writable:!0},d=function(e,t){var n;return r(t),l.call(this,`__ee__`)?n=this.__ee__:(n=u.value=o(null),s(this,`__ee__`,u),u.value=null),n[e]?typeof n[e]==`object`?n[e].push(t):n[e]=[n[e],t]:n[e]=t,this},f=function(e,t){var n,a;return r(t),a=this,d.call(this,e,n=function(){p.call(a,e,n),i.call(t,this,arguments)}),n.__eeOnceListener__=t,this},p=function(e,t){var n,i,a,o;if(r(t),!l.call(this,`__ee__`)||(n=this.__ee__,!n[e]))return this;if(i=n[e],typeof i==`object`)for(o=0;a=i[o];++o)(a===t||a.__eeOnceListener__===t)&&(i.length===2?n[e]=i[o?0:1]:i.splice(o,1));else (i===t||i.__eeOnceListener__===t)&&delete n[e];return this},m=function(e){var t,n,r,o,s;if(l.call(this,`__ee__`)&&(o=this.__ee__[e],o))if(typeof o==`object`){for(n=arguments.length,s=Array(n-1),t=1;t<n;++t)s[t-1]=arguments[t];for(o=o.slice(),t=0;r=o[t];++t)i.call(r,this,s)}else switch(arguments.length){case 1:a.call(o,this);break;case 2:a.call(o,this,arguments[1]);break;case 3:a.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,s=Array(n-1),t=1;t<n;++t)s[t-1]=arguments[t];i.call(o,this,s)}},h={on:d,once:f,off:p,emit:m},g={on:n(d),once:n(f),off:n(p),emit:n(m)},_=c({},g);t.exports=e=function(e){return e==null?o(_):c(Object(e),g)},e.methods=h})),Jc=o((e=>{function t(e,t,n){if(n===void 0&&(n=Array.prototype),e&&typeof n.find==`function`)return n.find.call(e,t);for(var r=0;r<e.length;r++)if(Object.prototype.hasOwnProperty.call(e,r)){var i=e[r];if(t.call(void 0,i,r,e))return i}}function n(e,t){return t===void 0&&(t=Object),t&&typeof t.freeze==`function`?t.freeze(e):e}var r=n({HTML:`text/html`,isHTML:function(e){return e===r.HTML},XML_APPLICATION:`application/xml`,XML_TEXT:`text/xml`,XML_XHTML_APPLICATION:`application/xhtml+xml`,XML_SVG_IMAGE:`image/svg+xml`}),i=n({HTML:`http://www.w3.org/1999/xhtml`,isHTML:function(e){return e===i.HTML},SVG:`http://www.w3.org/2000/svg`,XML:`http://www.w3.org/XML/1998/namespace`,XMLNS:`http://www.w3.org/2000/xmlns/`});e.find=t,e.freeze=n,e.MIME_TYPE=r,e.NAMESPACE=i})),Yc=o((e=>{var t=Jc(),n=t.find,r=t.NAMESPACE;function i(e){return e!==``}function a(e){return e?e.split(/[\t\n\f\r ]+/).filter(i):[]}function o(e,t){return e.hasOwnProperty(t)||(e[t]=!0),e}function s(e){if(!e)return[];var t=a(e);return Object.keys(t.reduce(o,{}))}function c(e){return function(t){return e&&e.indexOf(t)!==-1}}function l(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function u(e,t){var n=e.prototype;if(!(n instanceof t)){function r(){}r.prototype=t.prototype,r=new r,l(n,r),e.prototype=n=r}n.constructor!=e&&(typeof e!=`function`&&console.error(`unknown Class:`+e),n.constructor=e)}var d={},f=d.ELEMENT_NODE=1,p=d.ATTRIBUTE_NODE=2,m=d.TEXT_NODE=3,h=d.CDATA_SECTION_NODE=4,g=d.ENTITY_REFERENCE_NODE=5,_=d.ENTITY_NODE=6,v=d.PROCESSING_INSTRUCTION_NODE=7,y=d.COMMENT_NODE=8,b=d.DOCUMENT_NODE=9,x=d.DOCUMENT_TYPE_NODE=10,S=d.DOCUMENT_FRAGMENT_NODE=11,C=d.NOTATION_NODE=12,w={},T={};w.INDEX_SIZE_ERR=(T[1]=`Index size error`,1),w.DOMSTRING_SIZE_ERR=(T[2]=`DOMString size error`,2);var E=w.HIERARCHY_REQUEST_ERR=(T[3]=`Hierarchy request error`,3);w.WRONG_DOCUMENT_ERR=(T[4]=`Wrong document`,4),w.INVALID_CHARACTER_ERR=(T[5]=`Invalid character`,5),w.NO_DATA_ALLOWED_ERR=(T[6]=`No data allowed`,6),w.NO_MODIFICATION_ALLOWED_ERR=(T[7]=`No modification allowed`,7);var D=w.NOT_FOUND_ERR=(T[8]=`Not found`,8);w.NOT_SUPPORTED_ERR=(T[9]=`Not supported`,9);var O=w.INUSE_ATTRIBUTE_ERR=(T[10]=`Attribute in use`,10);w.INVALID_STATE_ERR=(T[11]=`Invalid state`,11),w.SYNTAX_ERR=(T[12]=`Syntax error`,12),w.INVALID_MODIFICATION_ERR=(T[13]=`Invalid modification`,13),w.NAMESPACE_ERR=(T[14]=`Invalid namespace`,14),w.INVALID_ACCESS_ERR=(T[15]=`Invalid access`,15);function k(e,t){if(t instanceof Error)var n=t;else n=this,Error.call(this,T[e]),this.message=T[e],Error.captureStackTrace&&Error.captureStackTrace(this,k);return n.code=e,t&&(this.message=this.message+`: `+t),n}k.prototype=Error.prototype,l(w,k);function A(){}A.prototype={length:0,item:function(e){return e>=0&&e<this.length?this[e]:null},toString:function(e,t){for(var n=[],r=0;r<this.length;r++)Te(this[r],n,e,t);return n.join(``)},filter:function(e){return Array.prototype.filter.call(this,e)},indexOf:function(e){return Array.prototype.indexOf.call(this,e)}};function j(e,t){this._node=e,this._refresh=t,M(this)}function M(e){var t=e._node._inc||e._node.ownerDocument._inc;if(e._inc!==t){var n=e._refresh(e._node);if(De(e,`length`,n.length),!e.$$length||n.length<e.$$length)for(var r=n.length;r in e;r++)Object.prototype.hasOwnProperty.call(e,r)&&delete e[r];l(n,e),e._inc=t}}j.prototype.item=function(e){return M(this),this[e]||null},u(j,A);function N(){}function P(e,t){for(var n=e.length;n--;)if(e[n]===t)return n}function F(e,t,n,r){if(r?t[P(t,r)]=n:t[t.length++]=n,e){n.ownerElement=e;var i=e.ownerDocument;i&&(r&&ie(i,e,r),re(i,e,n))}}function I(e,t,n){var r=P(t,n);if(r>=0){for(var i=t.length-1;r<i;)t[r]=t[++r];if(t.length=i,e){var a=e.ownerDocument;a&&(ie(a,e,n),n.ownerElement=null)}}else throw new k(D,Error(e.tagName+`@`+n))}N.prototype={length:0,item:A.prototype.item,getNamedItem:function(e){for(var t=this.length;t--;){var n=this[t];if(n.nodeName==e)return n}},setNamedItem:function(e){var t=e.ownerElement;if(t&&t!=this._ownerElement)throw new k(O);var n=this.getNamedItem(e.nodeName);return F(this._ownerElement,this,e,n),n},setNamedItemNS:function(e){var t=e.ownerElement,n;if(t&&t!=this._ownerElement)throw new k(O);return n=this.getNamedItemNS(e.namespaceURI,e.localName),F(this._ownerElement,this,e,n),n},removeNamedItem:function(e){var t=this.getNamedItem(e);return I(this._ownerElement,this,t),t},removeNamedItemNS:function(e,t){var n=this.getNamedItemNS(e,t);return I(this._ownerElement,this,n),n},getNamedItemNS:function(e,t){for(var n=this.length;n--;){var r=this[n];if(r.localName==t&&r.namespaceURI==e)return r}return null}};function L(){}L.prototype={hasFeature:function(e,t){return!0},createDocument:function(e,t,n){var r=new ne;if(r.implementation=this,r.childNodes=new A,r.doctype=n||null,n&&r.appendChild(n),t){var i=r.createElementNS(e,t);r.appendChild(i)}return r},createDocumentType:function(e,t,n){var r=new _e;return r.name=e,r.nodeName=e,r.publicId=t||``,r.systemId=n||``,r}};function R(){}R.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(e,t){return U(this,e,t)},replaceChild:function(e,t){U(this,e,t,H),t&&this.removeChild(t)},removeChild:function(e){return oe(this,e)},appendChild:function(e){return this.insertBefore(e,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(e){return Ee(this.ownerDocument||this,this,e)},normalize:function(){for(var e=this.firstChild;e;){var t=e.nextSibling;t&&t.nodeType==m&&e.nodeType==m?(this.removeChild(t),e.appendData(t.data)):(e.normalize(),e=t)}},isSupported:function(e,t){return this.ownerDocument.implementation.hasFeature(e,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(e){for(var t=this;t;){var n=t._nsMap;if(n){for(var r in n)if(Object.prototype.hasOwnProperty.call(n,r)&&n[r]===e)return r}t=t.nodeType==p?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(e){for(var t=this;t;){var n=t._nsMap;if(n&&e in n&&Object.prototype.hasOwnProperty.call(n,e))return n[e];t=t.nodeType==p?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(e){return this.lookupPrefix(e)==null}};function ee(e){return e==`<`&&`&lt;`||e==`>`&&`&gt;`||e==`&`&&`&amp;`||e==`"`&&`&quot;`||`&#`+e.charCodeAt()+`;`}l(d,R),l(d,R.prototype);function te(e,t){if(t(e))return!0;if(e=e.firstChild)do if(te(e,t))return!0;while(e=e.nextSibling)}function ne(){this.ownerDocument=this}function re(e,t,n){e&&e._inc++,n.namespaceURI===r.XMLNS&&(t._nsMap[n.prefix?n.localName:``]=n.value)}function ie(e,t,n,i){e&&e._inc++,n.namespaceURI===r.XMLNS&&delete t._nsMap[n.prefix?n.localName:``]}function ae(e,t,n){if(e&&e._inc){e._inc++;var r=t.childNodes;if(n)r[r.length++]=n;else{for(var i=t.firstChild,a=0;i;)r[a++]=i,i=i.nextSibling;r.length=a,delete r[r.length]}}}function oe(e,t){var n=t.previousSibling,r=t.nextSibling;return n?n.nextSibling=r:e.firstChild=r,r?r.previousSibling=n:e.lastChild=n,t.parentNode=null,t.previousSibling=null,t.nextSibling=null,ae(e.ownerDocument,e),t}function z(e){return e&&(e.nodeType===R.DOCUMENT_NODE||e.nodeType===R.DOCUMENT_FRAGMENT_NODE||e.nodeType===R.ELEMENT_NODE)}function se(e){return e&&(B(e)||le(e)||ce(e)||e.nodeType===R.DOCUMENT_FRAGMENT_NODE||e.nodeType===R.COMMENT_NODE||e.nodeType===R.PROCESSING_INSTRUCTION_NODE)}function ce(e){return e&&e.nodeType===R.DOCUMENT_TYPE_NODE}function B(e){return e&&e.nodeType===R.ELEMENT_NODE}function le(e){return e&&e.nodeType===R.TEXT_NODE}function ue(e,t){var r=e.childNodes||[];if(n(r,B)||ce(t))return!1;var i=n(r,ce);return!(t&&i&&r.indexOf(i)>r.indexOf(t))}function de(e,t){var r=e.childNodes||[];function i(e){return B(e)&&e!==t}if(n(r,i))return!1;var a=n(r,ce);return!(t&&a&&r.indexOf(a)>r.indexOf(t))}function fe(e,t,n){if(!z(e))throw new k(E,`Unexpected parent node type `+e.nodeType);if(n&&n.parentNode!==e)throw new k(D,`child not in parent`);if(!se(t)||ce(t)&&e.nodeType!==R.DOCUMENT_NODE)throw new k(E,`Unexpected node type `+t.nodeType+` for parent node type `+e.nodeType)}function V(e,t,r){var i=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===R.DOCUMENT_FRAGMENT_NODE){var o=a.filter(B);if(o.length>1||n(a,le))throw new k(E,`More than one element or text in fragment`);if(o.length===1&&!ue(e,r))throw new k(E,`Element in fragment can not be inserted before doctype`)}if(B(t)&&!ue(e,r))throw new k(E,`Only one element can be added and only after doctype`);if(ce(t)){if(n(i,ce))throw new k(E,`Only one doctype is allowed`);var s=n(i,B);if(r&&i.indexOf(s)<i.indexOf(r))throw new k(E,`Doctype can only be inserted before an element`);if(!r&&s)throw new k(E,`Doctype can not be appended since element is present`)}}function H(e,t,r){var i=e.childNodes||[],a=t.childNodes||[];if(t.nodeType===R.DOCUMENT_FRAGMENT_NODE){var o=a.filter(B);if(o.length>1||n(a,le))throw new k(E,`More than one element or text in fragment`);if(o.length===1&&!de(e,r))throw new k(E,`Element in fragment can not be inserted before doctype`)}if(B(t)&&!de(e,r))throw new k(E,`Only one element can be added and only after doctype`);if(ce(t)){function e(e){return ce(e)&&e!==r}if(n(i,e))throw new k(E,`Only one doctype is allowed`);var s=n(i,B);if(r&&i.indexOf(s)<i.indexOf(r))throw new k(E,`Doctype can only be inserted before an element`)}}function U(e,t,n,r){fe(e,t,n),e.nodeType===R.DOCUMENT_NODE&&(r||V)(e,t,n);var i=t.parentNode;if(i&&i.removeChild(t),t.nodeType===S){var a=t.firstChild;if(a==null)return t;var o=t.lastChild}else a=o=t;var s=n?n.previousSibling:e.lastChild;a.previousSibling=s,o.nextSibling=n,s?s.nextSibling=a:e.firstChild=a,n==null?e.lastChild=o:n.previousSibling=o;do a.parentNode=e;while(a!==o&&(a=a.nextSibling));return ae(e.ownerDocument||e,e),t.nodeType==S&&(t.firstChild=t.lastChild=null),t}function pe(e,t){return t.parentNode&&t.parentNode.removeChild(t),t.parentNode=e,t.previousSibling=e.lastChild,t.nextSibling=null,t.previousSibling?t.previousSibling.nextSibling=t:e.firstChild=t,e.lastChild=t,ae(e.ownerDocument,e,t),t}ne.prototype={nodeName:`#document`,nodeType:b,doctype:null,documentElement:null,_inc:1,insertBefore:function(e,t){if(e.nodeType==S){for(var n=e.firstChild;n;){var r=n.nextSibling;this.insertBefore(n,t),n=r}return e}return U(this,e,t),e.ownerDocument=this,this.documentElement===null&&e.nodeType===f&&(this.documentElement=e),e},removeChild:function(e){return this.documentElement==e&&(this.documentElement=null),oe(this,e)},replaceChild:function(e,t){U(this,e,t,H),e.ownerDocument=this,t&&this.removeChild(t),B(e)&&(this.documentElement=e)},importNode:function(e,t){return Y(this,e,t)},getElementById:function(e){var t=null;return te(this.documentElement,function(n){if(n.nodeType==f&&n.getAttribute(`id`)==e)return t=n,!0}),t},getElementsByClassName:function(e){var t=s(e);return new j(this,function(n){var r=[];return t.length>0&&te(n.documentElement,function(i){if(i!==n&&i.nodeType===f){var a=i.getAttribute(`class`);if(a){var o=e===a;if(!o){var l=s(a);o=t.every(c(l))}o&&r.push(i)}}}),r})},createElement:function(e){var t=new me;t.ownerDocument=this,t.nodeName=e,t.tagName=e,t.localName=e,t.childNodes=new A;var n=t.attributes=new N;return n._ownerElement=t,t},createDocumentFragment:function(){var e=new be;return e.ownerDocument=this,e.childNodes=new A,e},createTextNode:function(e){var t=new G;return t.ownerDocument=this,t.appendData(e),t},createComment:function(e){var t=new K;return t.ownerDocument=this,t.appendData(e),t},createCDATASection:function(e){var t=new ge;return t.ownerDocument=this,t.appendData(e),t},createProcessingInstruction:function(e,t){var n=new xe;return n.ownerDocument=this,n.tagName=n.nodeName=n.target=e,n.nodeValue=n.data=t,n},createAttribute:function(e){var t=new W;return t.ownerDocument=this,t.name=e,t.nodeName=e,t.localName=e,t.specified=!0,t},createEntityReference:function(e){var t=new ye;return t.ownerDocument=this,t.nodeName=e,t},createElementNS:function(e,t){var n=new me,r=t.split(`:`),i=n.attributes=new N;return n.childNodes=new A,n.ownerDocument=this,n.nodeName=t,n.tagName=t,n.namespaceURI=e,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=t,i._ownerElement=n,n},createAttributeNS:function(e,t){var n=new W,r=t.split(`:`);return n.ownerDocument=this,n.nodeName=t,n.name=t,n.namespaceURI=e,n.specified=!0,r.length==2?(n.prefix=r[0],n.localName=r[1]):n.localName=t,n}},u(ne,R);function me(){this._nsMap={}}me.prototype={nodeType:f,hasAttribute:function(e){return this.getAttributeNode(e)!=null},getAttribute:function(e){var t=this.getAttributeNode(e);return t&&t.value||``},getAttributeNode:function(e){return this.attributes.getNamedItem(e)},setAttribute:function(e,t){var n=this.ownerDocument.createAttribute(e);n.value=n.nodeValue=``+t,this.setAttributeNode(n)},removeAttribute:function(e){var t=this.getAttributeNode(e);t&&this.removeAttributeNode(t)},appendChild:function(e){return e.nodeType===S?this.insertBefore(e,null):pe(this,e)},setAttributeNode:function(e){return this.attributes.setNamedItem(e)},setAttributeNodeNS:function(e){return this.attributes.setNamedItemNS(e)},removeAttributeNode:function(e){return this.attributes.removeNamedItem(e.nodeName)},removeAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);n&&this.removeAttributeNode(n)},hasAttributeNS:function(e,t){return this.getAttributeNodeNS(e,t)!=null},getAttributeNS:function(e,t){var n=this.getAttributeNodeNS(e,t);return n&&n.value||``},setAttributeNS:function(e,t,n){var r=this.ownerDocument.createAttributeNS(e,t);r.value=r.nodeValue=``+n,this.setAttributeNode(r)},getAttributeNodeNS:function(e,t){return this.attributes.getNamedItemNS(e,t)},getElementsByTagName:function(e){return new j(this,function(t){var n=[];return te(t,function(r){r!==t&&r.nodeType==f&&(e===`*`||r.tagName==e)&&n.push(r)}),n})},getElementsByTagNameNS:function(e,t){return new j(this,function(n){var r=[];return te(n,function(i){i!==n&&i.nodeType===f&&(e===`*`||i.namespaceURI===e)&&(t===`*`||i.localName==t)&&r.push(i)}),r})}},ne.prototype.getElementsByTagName=me.prototype.getElementsByTagName,ne.prototype.getElementsByTagNameNS=me.prototype.getElementsByTagNameNS,u(me,R);function W(){}W.prototype.nodeType=p,u(W,R);function he(){}he.prototype={data:``,substringData:function(e,t){return this.data.substring(e,e+t)},appendData:function(e){e=this.data+e,this.nodeValue=this.data=e,this.length=e.length},insertData:function(e,t){this.replaceData(e,0,t)},appendChild:function(e){throw Error(T[E])},deleteData:function(e,t){this.replaceData(e,t,``)},replaceData:function(e,t,n){var r=this.data.substring(0,e),i=this.data.substring(e+t);n=r+n+i,this.nodeValue=this.data=n,this.length=n.length}},u(he,R);function G(){}G.prototype={nodeName:`#text`,nodeType:m,splitText:function(e){var t=this.data,n=t.substring(e);t=t.substring(0,e),this.data=this.nodeValue=t,this.length=t.length;var r=this.ownerDocument.createTextNode(n);return this.parentNode&&this.parentNode.insertBefore(r,this.nextSibling),r}},u(G,he);function K(){}K.prototype={nodeName:`#comment`,nodeType:y},u(K,he);function ge(){}ge.prototype={nodeName:`#cdata-section`,nodeType:h},u(ge,he);function _e(){}_e.prototype.nodeType=x,u(_e,R);function q(){}q.prototype.nodeType=C,u(q,R);function ve(){}ve.prototype.nodeType=_,u(ve,R);function ye(){}ye.prototype.nodeType=g,u(ye,R);function be(){}be.prototype.nodeName=`#document-fragment`,be.prototype.nodeType=S,u(be,R);function xe(){}xe.prototype.nodeType=v,u(xe,R);function Se(){}Se.prototype.serializeToString=function(e,t,n){return J.call(e,t,n)},R.prototype.toString=J;function J(e,t){var n=[],r=this.nodeType==9&&this.documentElement||this,i=r.prefix,a=r.namespaceURI;if(a&&i==null){var i=r.lookupPrefix(a);if(i==null)var o=[{namespace:a,prefix:null}]}return Te(this,n,e,t,o),n.join(``)}function Ce(e,t,n){var i=e.prefix||``,a=e.namespaceURI;if(!a||i===`xml`&&a===r.XML||a===r.XMLNS)return!1;for(var o=n.length;o--;){var s=n[o];if(s.prefix===i)return s.namespace!==a}return!0}function we(e,t,n){e.push(` `,t,`="`,n.replace(/[<&"]/g,ee),`"`)}function Te(e,t,n,i,a){if(a||=[],i)if(e=i(e),e){if(typeof e==`string`){t.push(e);return}}else return;switch(e.nodeType){case f:var o=e.attributes,s=o.length,c=e.firstChild,l=e.tagName;n=r.isHTML(e.namespaceURI)||n;var u=l;if(!n&&!e.prefix&&e.namespaceURI){for(var d,_=0;_<o.length;_++)if(o.item(_).name===`xmlns`){d=o.item(_).value;break}if(!d)for(var C=a.length-1;C>=0;C--){var w=a[C];if(w.prefix===``&&w.namespace===e.namespaceURI){d=w.namespace;break}}if(d!==e.namespaceURI)for(var C=a.length-1;C>=0;C--){var w=a[C];if(w.namespace===e.namespaceURI){w.prefix&&(u=w.prefix+`:`+l);break}}}t.push(`<`,u);for(var T=0;T<s;T++){var E=o.item(T);E.prefix==`xmlns`?a.push({prefix:E.localName,namespace:E.value}):E.nodeName==`xmlns`&&a.push({prefix:``,namespace:E.value})}for(var T=0;T<s;T++){var E=o.item(T);if(Ce(E,n,a)){var D=E.prefix||``,O=E.namespaceURI;we(t,D?`xmlns:`+D:`xmlns`,O),a.push({prefix:D,namespace:O})}Te(E,t,n,i,a)}if(l===u&&Ce(e,n,a)){var D=e.prefix||``,O=e.namespaceURI;we(t,D?`xmlns:`+D:`xmlns`,O),a.push({prefix:D,namespace:O})}if(c||n&&!/^(?:meta|link|img|br|hr|input)$/i.test(l)){if(t.push(`>`),n&&/^script$/i.test(l))for(;c;)c.data?t.push(c.data):Te(c,t,n,i,a.slice()),c=c.nextSibling;else for(;c;)Te(c,t,n,i,a.slice()),c=c.nextSibling;t.push(`</`,u,`>`)}else t.push(`/>`);return;case b:case S:for(var c=e.firstChild;c;)Te(c,t,n,i,a.slice()),c=c.nextSibling;return;case p:return we(t,e.name,e.value);case m:return t.push(e.data.replace(/[<&]/g,ee).replace(/]]>/g,`]]&gt;`));case h:return t.push(`<![CDATA[`,e.data,`]]>`);case y:return t.push(`<!--`,e.data,`-->`);case x:var k=e.publicId,A=e.systemId;if(t.push(`<!DOCTYPE `,e.name),k)t.push(` PUBLIC `,k),A&&A!=`.`&&t.push(` `,A),t.push(`>`);else if(A&&A!=`.`)t.push(` SYSTEM `,A,`>`);else{var j=e.internalSubset;j&&t.push(` [`,j,`]`),t.push(`>`)}return;case v:return t.push(`<?`,e.target,` `,e.data,`?>`);case g:return t.push(`&`,e.nodeName,`;`);default:t.push(`??`,e.nodeName)}}function Y(e,t,n){var r;switch(t.nodeType){case f:r=t.cloneNode(!1),r.ownerDocument=e;case S:break;case p:n=!0;break}if(r||=t.cloneNode(!1),r.ownerDocument=e,r.parentNode=null,n)for(var i=t.firstChild;i;)r.appendChild(Y(e,i,n)),i=i.nextSibling;return r}function Ee(e,t,n){var r=new t.constructor;for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var a=t[i];typeof a!=`object`&&a!=r[i]&&(r[i]=a)}switch(t.childNodes&&(r.childNodes=new A),r.ownerDocument=e,r.nodeType){case f:var o=t.attributes,s=r.attributes=new N,c=o.length;s._ownerElement=r;for(var l=0;l<c;l++)r.setAttributeNode(Ee(e,o.item(l),!0));break;case p:n=!0}if(n)for(var u=t.firstChild;u;)r.appendChild(Ee(e,u,n)),u=u.nextSibling;return r}function De(e,t,n){e[t]=n}try{if(Object.defineProperty){Object.defineProperty(j.prototype,`length`,{get:function(){return M(this),this.$$length}}),Object.defineProperty(R.prototype,`textContent`,{get:function(){return e(this)},set:function(e){switch(this.nodeType){case f:case S:for(;this.firstChild;)this.removeChild(this.firstChild);(e||String(e))&&this.appendChild(this.ownerDocument.createTextNode(e));break;default:this.data=e,this.value=e,this.nodeValue=e}}});function e(t){switch(t.nodeType){case f:case S:var n=[];for(t=t.firstChild;t;)t.nodeType!==7&&t.nodeType!==8&&n.push(e(t)),t=t.nextSibling;return n.join(``);default:return t.nodeValue}}De=function(e,t,n){e[`$$`+t]=n}}}catch{}e.DocumentType=_e,e.DOMException=k,e.DOMImplementation=L,e.Element=me,e.Node=R,e.NodeList=A,e.XMLSerializer=Se})),Xc=o((e=>{var t=Jc().freeze;e.XML_ENTITIES=t({amp:`&`,apos:`'`,gt:`>`,lt:`<`,quot:`"`}),e.HTML_ENTITIES=t({Aacute:`Á`,aacute:`á`,Abreve:`Ă`,abreve:`ă`,ac:`∾`,acd:`∿`,acE:`∾̳`,Acirc:`Â`,acirc:`â`,acute:`´`,Acy:`А`,acy:`а`,AElig:`Æ`,aelig:`æ`,af:`⁡`,Afr:`𝔄`,afr:`𝔞`,Agrave:`À`,agrave:`à`,alefsym:`ℵ`,aleph:`ℵ`,Alpha:`Α`,alpha:`α`,Amacr:`Ā`,amacr:`ā`,amalg:`⨿`,AMP:`&`,amp:`&`,And:`⩓`,and:`∧`,andand:`⩕`,andd:`⩜`,andslope:`⩘`,andv:`⩚`,ang:`∠`,ange:`⦤`,angle:`∠`,angmsd:`∡`,angmsdaa:`⦨`,angmsdab:`⦩`,angmsdac:`⦪`,angmsdad:`⦫`,angmsdae:`⦬`,angmsdaf:`⦭`,angmsdag:`⦮`,angmsdah:`⦯`,angrt:`∟`,angrtvb:`⊾`,angrtvbd:`⦝`,angsph:`∢`,angst:`Å`,angzarr:`⍼`,Aogon:`Ą`,aogon:`ą`,Aopf:`𝔸`,aopf:`𝕒`,ap:`≈`,apacir:`⩯`,apE:`⩰`,ape:`≊`,apid:`≋`,apos:`'`,ApplyFunction:`⁡`,approx:`≈`,approxeq:`≊`,Aring:`Å`,aring:`å`,Ascr:`𝒜`,ascr:`𝒶`,Assign:`≔`,ast:`*`,asymp:`≈`,asympeq:`≍`,Atilde:`Ã`,atilde:`ã`,Auml:`Ä`,auml:`ä`,awconint:`∳`,awint:`⨑`,backcong:`≌`,backepsilon:`϶`,backprime:`‵`,backsim:`∽`,backsimeq:`⋍`,Backslash:`∖`,Barv:`⫧`,barvee:`⊽`,Barwed:`⌆`,barwed:`⌅`,barwedge:`⌅`,bbrk:`⎵`,bbrktbrk:`⎶`,bcong:`≌`,Bcy:`Б`,bcy:`б`,bdquo:`„`,becaus:`∵`,Because:`∵`,because:`∵`,bemptyv:`⦰`,bepsi:`϶`,bernou:`ℬ`,Bernoullis:`ℬ`,Beta:`Β`,beta:`β`,beth:`ℶ`,between:`≬`,Bfr:`𝔅`,bfr:`𝔟`,bigcap:`⋂`,bigcirc:`◯`,bigcup:`⋃`,bigodot:`⨀`,bigoplus:`⨁`,bigotimes:`⨂`,bigsqcup:`⨆`,bigstar:`★`,bigtriangledown:`▽`,bigtriangleup:`△`,biguplus:`⨄`,bigvee:`⋁`,bigwedge:`⋀`,bkarow:`⤍`,blacklozenge:`⧫`,blacksquare:`▪`,blacktriangle:`▴`,blacktriangledown:`▾`,blacktriangleleft:`◂`,blacktriangleright:`▸`,blank:`␣`,blk12:`▒`,blk14:`░`,blk34:`▓`,block:`█`,bne:`=⃥`,bnequiv:`≡⃥`,bNot:`⫭`,bnot:`⌐`,Bopf:`𝔹`,bopf:`𝕓`,bot:`⊥`,bottom:`⊥`,bowtie:`⋈`,boxbox:`⧉`,boxDL:`╗`,boxDl:`╖`,boxdL:`╕`,boxdl:`┐`,boxDR:`╔`,boxDr:`╓`,boxdR:`╒`,boxdr:`┌`,boxH:`═`,boxh:`─`,boxHD:`╦`,boxHd:`╤`,boxhD:`╥`,boxhd:`┬`,boxHU:`╩`,boxHu:`╧`,boxhU:`╨`,boxhu:`┴`,boxminus:`⊟`,boxplus:`⊞`,boxtimes:`⊠`,boxUL:`╝`,boxUl:`╜`,boxuL:`╛`,boxul:`┘`,boxUR:`╚`,boxUr:`╙`,boxuR:`╘`,boxur:`└`,boxV:`║`,boxv:`│`,boxVH:`╬`,boxVh:`╫`,boxvH:`╪`,boxvh:`┼`,boxVL:`╣`,boxVl:`╢`,boxvL:`╡`,boxvl:`┤`,boxVR:`╠`,boxVr:`╟`,boxvR:`╞`,boxvr:`├`,bprime:`‵`,Breve:`˘`,breve:`˘`,brvbar:`¦`,Bscr:`ℬ`,bscr:`𝒷`,bsemi:`⁏`,bsim:`∽`,bsime:`⋍`,bsol:`\\`,bsolb:`⧅`,bsolhsub:`⟈`,bull:`•`,bullet:`•`,bump:`≎`,bumpE:`⪮`,bumpe:`≏`,Bumpeq:`≎`,bumpeq:`≏`,Cacute:`Ć`,cacute:`ć`,Cap:`⋒`,cap:`∩`,capand:`⩄`,capbrcup:`⩉`,capcap:`⩋`,capcup:`⩇`,capdot:`⩀`,CapitalDifferentialD:`ⅅ`,caps:`∩︀`,caret:`⁁`,caron:`ˇ`,Cayleys:`ℭ`,ccaps:`⩍`,Ccaron:`Č`,ccaron:`č`,Ccedil:`Ç`,ccedil:`ç`,Ccirc:`Ĉ`,ccirc:`ĉ`,Cconint:`∰`,ccups:`⩌`,ccupssm:`⩐`,Cdot:`Ċ`,cdot:`ċ`,cedil:`¸`,Cedilla:`¸`,cemptyv:`⦲`,cent:`¢`,CenterDot:`·`,centerdot:`·`,Cfr:`ℭ`,cfr:`𝔠`,CHcy:`Ч`,chcy:`ч`,check:`✓`,checkmark:`✓`,Chi:`Χ`,chi:`χ`,cir:`○`,circ:`ˆ`,circeq:`≗`,circlearrowleft:`↺`,circlearrowright:`↻`,circledast:`⊛`,circledcirc:`⊚`,circleddash:`⊝`,CircleDot:`⊙`,circledR:`®`,circledS:`Ⓢ`,CircleMinus:`⊖`,CirclePlus:`⊕`,CircleTimes:`⊗`,cirE:`⧃`,cire:`≗`,cirfnint:`⨐`,cirmid:`⫯`,cirscir:`⧂`,ClockwiseContourIntegral:`∲`,CloseCurlyDoubleQuote:`”`,CloseCurlyQuote:`’`,clubs:`♣`,clubsuit:`♣`,Colon:`∷`,colon:`:`,Colone:`⩴`,colone:`≔`,coloneq:`≔`,comma:`,`,commat:`@`,comp:`∁`,compfn:`∘`,complement:`∁`,complexes:`ℂ`,cong:`≅`,congdot:`⩭`,Congruent:`≡`,Conint:`∯`,conint:`∮`,ContourIntegral:`∮`,Copf:`ℂ`,copf:`𝕔`,coprod:`∐`,Coproduct:`∐`,COPY:`©`,copy:`©`,copysr:`℗`,CounterClockwiseContourIntegral:`∳`,crarr:`↵`,Cross:`⨯`,cross:`✗`,Cscr:`𝒞`,cscr:`𝒸`,csub:`⫏`,csube:`⫑`,csup:`⫐`,csupe:`⫒`,ctdot:`⋯`,cudarrl:`⤸`,cudarrr:`⤵`,cuepr:`⋞`,cuesc:`⋟`,cularr:`↶`,cularrp:`⤽`,Cup:`⋓`,cup:`∪`,cupbrcap:`⩈`,CupCap:`≍`,cupcap:`⩆`,cupcup:`⩊`,cupdot:`⊍`,cupor:`⩅`,cups:`∪︀`,curarr:`↷`,curarrm:`⤼`,curlyeqprec:`⋞`,curlyeqsucc:`⋟`,curlyvee:`⋎`,curlywedge:`⋏`,curren:`¤`,curvearrowleft:`↶`,curvearrowright:`↷`,cuvee:`⋎`,cuwed:`⋏`,cwconint:`∲`,cwint:`∱`,cylcty:`⌭`,Dagger:`‡`,dagger:`†`,daleth:`ℸ`,Darr:`↡`,dArr:`⇓`,darr:`↓`,dash:`‐`,Dashv:`⫤`,dashv:`⊣`,dbkarow:`⤏`,dblac:`˝`,Dcaron:`Ď`,dcaron:`ď`,Dcy:`Д`,dcy:`д`,DD:`ⅅ`,dd:`ⅆ`,ddagger:`‡`,ddarr:`⇊`,DDotrahd:`⤑`,ddotseq:`⩷`,deg:`°`,Del:`∇`,Delta:`Δ`,delta:`δ`,demptyv:`⦱`,dfisht:`⥿`,Dfr:`𝔇`,dfr:`𝔡`,dHar:`⥥`,dharl:`⇃`,dharr:`⇂`,DiacriticalAcute:`´`,DiacriticalDot:`˙`,DiacriticalDoubleAcute:`˝`,DiacriticalGrave:"`",DiacriticalTilde:`˜`,diam:`⋄`,Diamond:`⋄`,diamond:`⋄`,diamondsuit:`♦`,diams:`♦`,die:`¨`,DifferentialD:`ⅆ`,digamma:`ϝ`,disin:`⋲`,div:`÷`,divide:`÷`,divideontimes:`⋇`,divonx:`⋇`,DJcy:`Ђ`,djcy:`ђ`,dlcorn:`⌞`,dlcrop:`⌍`,dollar:`$`,Dopf:`𝔻`,dopf:`𝕕`,Dot:`¨`,dot:`˙`,DotDot:`⃜`,doteq:`≐`,doteqdot:`≑`,DotEqual:`≐`,dotminus:`∸`,dotplus:`∔`,dotsquare:`⊡`,doublebarwedge:`⌆`,DoubleContourIntegral:`∯`,DoubleDot:`¨`,DoubleDownArrow:`⇓`,DoubleLeftArrow:`⇐`,DoubleLeftRightArrow:`⇔`,DoubleLeftTee:`⫤`,DoubleLongLeftArrow:`⟸`,DoubleLongLeftRightArrow:`⟺`,DoubleLongRightArrow:`⟹`,DoubleRightArrow:`⇒`,DoubleRightTee:`⊨`,DoubleUpArrow:`⇑`,DoubleUpDownArrow:`⇕`,DoubleVerticalBar:`∥`,DownArrow:`↓`,Downarrow:`⇓`,downarrow:`↓`,DownArrowBar:`⤓`,DownArrowUpArrow:`⇵`,DownBreve:`̑`,downdownarrows:`⇊`,downharpoonleft:`⇃`,downharpoonright:`⇂`,DownLeftRightVector:`⥐`,DownLeftTeeVector:`⥞`,DownLeftVector:`↽`,DownLeftVectorBar:`⥖`,DownRightTeeVector:`⥟`,DownRightVector:`⇁`,DownRightVectorBar:`⥗`,DownTee:`⊤`,DownTeeArrow:`↧`,drbkarow:`⤐`,drcorn:`⌟`,drcrop:`⌌`,Dscr:`𝒟`,dscr:`𝒹`,DScy:`Ѕ`,dscy:`ѕ`,dsol:`⧶`,Dstrok:`Đ`,dstrok:`đ`,dtdot:`⋱`,dtri:`▿`,dtrif:`▾`,duarr:`⇵`,duhar:`⥯`,dwangle:`⦦`,DZcy:`Џ`,dzcy:`џ`,dzigrarr:`⟿`,Eacute:`É`,eacute:`é`,easter:`⩮`,Ecaron:`Ě`,ecaron:`ě`,ecir:`≖`,Ecirc:`Ê`,ecirc:`ê`,ecolon:`≕`,Ecy:`Э`,ecy:`э`,eDDot:`⩷`,Edot:`Ė`,eDot:`≑`,edot:`ė`,ee:`ⅇ`,efDot:`≒`,Efr:`𝔈`,efr:`𝔢`,eg:`⪚`,Egrave:`È`,egrave:`è`,egs:`⪖`,egsdot:`⪘`,el:`⪙`,Element:`∈`,elinters:`⏧`,ell:`ℓ`,els:`⪕`,elsdot:`⪗`,Emacr:`Ē`,emacr:`ē`,empty:`∅`,emptyset:`∅`,EmptySmallSquare:`◻`,emptyv:`∅`,EmptyVerySmallSquare:`▫`,emsp:` `,emsp13:` `,emsp14:` `,ENG:`Ŋ`,eng:`ŋ`,ensp:` `,Eogon:`Ę`,eogon:`ę`,Eopf:`𝔼`,eopf:`𝕖`,epar:`⋕`,eparsl:`⧣`,eplus:`⩱`,epsi:`ε`,Epsilon:`Ε`,epsilon:`ε`,epsiv:`ϵ`,eqcirc:`≖`,eqcolon:`≕`,eqsim:`≂`,eqslantgtr:`⪖`,eqslantless:`⪕`,Equal:`⩵`,equals:`=`,EqualTilde:`≂`,equest:`≟`,Equilibrium:`⇌`,equiv:`≡`,equivDD:`⩸`,eqvparsl:`⧥`,erarr:`⥱`,erDot:`≓`,Escr:`ℰ`,escr:`ℯ`,esdot:`≐`,Esim:`⩳`,esim:`≂`,Eta:`Η`,eta:`η`,ETH:`Ð`,eth:`ð`,Euml:`Ë`,euml:`ë`,euro:`€`,excl:`!`,exist:`∃`,Exists:`∃`,expectation:`ℰ`,ExponentialE:`ⅇ`,exponentiale:`ⅇ`,fallingdotseq:`≒`,Fcy:`Ф`,fcy:`ф`,female:`♀`,ffilig:`ﬃ`,fflig:`ﬀ`,ffllig:`ﬄ`,Ffr:`𝔉`,ffr:`𝔣`,filig:`ﬁ`,FilledSmallSquare:`◼`,FilledVerySmallSquare:`▪`,fjlig:`fj`,flat:`♭`,fllig:`ﬂ`,fltns:`▱`,fnof:`ƒ`,Fopf:`𝔽`,fopf:`𝕗`,ForAll:`∀`,forall:`∀`,fork:`⋔`,forkv:`⫙`,Fouriertrf:`ℱ`,fpartint:`⨍`,frac12:`½`,frac13:`⅓`,frac14:`¼`,frac15:`⅕`,frac16:`⅙`,frac18:`⅛`,frac23:`⅔`,frac25:`⅖`,frac34:`¾`,frac35:`⅗`,frac38:`⅜`,frac45:`⅘`,frac56:`⅚`,frac58:`⅝`,frac78:`⅞`,frasl:`⁄`,frown:`⌢`,Fscr:`ℱ`,fscr:`𝒻`,gacute:`ǵ`,Gamma:`Γ`,gamma:`γ`,Gammad:`Ϝ`,gammad:`ϝ`,gap:`⪆`,Gbreve:`Ğ`,gbreve:`ğ`,Gcedil:`Ģ`,Gcirc:`Ĝ`,gcirc:`ĝ`,Gcy:`Г`,gcy:`г`,Gdot:`Ġ`,gdot:`ġ`,gE:`≧`,ge:`≥`,gEl:`⪌`,gel:`⋛`,geq:`≥`,geqq:`≧`,geqslant:`⩾`,ges:`⩾`,gescc:`⪩`,gesdot:`⪀`,gesdoto:`⪂`,gesdotol:`⪄`,gesl:`⋛︀`,gesles:`⪔`,Gfr:`𝔊`,gfr:`𝔤`,Gg:`⋙`,gg:`≫`,ggg:`⋙`,gimel:`ℷ`,GJcy:`Ѓ`,gjcy:`ѓ`,gl:`≷`,gla:`⪥`,glE:`⪒`,glj:`⪤`,gnap:`⪊`,gnapprox:`⪊`,gnE:`≩`,gne:`⪈`,gneq:`⪈`,gneqq:`≩`,gnsim:`⋧`,Gopf:`𝔾`,gopf:`𝕘`,grave:"`",GreaterEqual:`≥`,GreaterEqualLess:`⋛`,GreaterFullEqual:`≧`,GreaterGreater:`⪢`,GreaterLess:`≷`,GreaterSlantEqual:`⩾`,GreaterTilde:`≳`,Gscr:`𝒢`,gscr:`ℊ`,gsim:`≳`,gsime:`⪎`,gsiml:`⪐`,Gt:`≫`,GT:`>`,gt:`>`,gtcc:`⪧`,gtcir:`⩺`,gtdot:`⋗`,gtlPar:`⦕`,gtquest:`⩼`,gtrapprox:`⪆`,gtrarr:`⥸`,gtrdot:`⋗`,gtreqless:`⋛`,gtreqqless:`⪌`,gtrless:`≷`,gtrsim:`≳`,gvertneqq:`≩︀`,gvnE:`≩︀`,Hacek:`ˇ`,hairsp:` `,half:`½`,hamilt:`ℋ`,HARDcy:`Ъ`,hardcy:`ъ`,hArr:`⇔`,harr:`↔`,harrcir:`⥈`,harrw:`↭`,Hat:`^`,hbar:`ℏ`,Hcirc:`Ĥ`,hcirc:`ĥ`,hearts:`♥`,heartsuit:`♥`,hellip:`…`,hercon:`⊹`,Hfr:`ℌ`,hfr:`𝔥`,HilbertSpace:`ℋ`,hksearow:`⤥`,hkswarow:`⤦`,hoarr:`⇿`,homtht:`∻`,hookleftarrow:`↩`,hookrightarrow:`↪`,Hopf:`ℍ`,hopf:`𝕙`,horbar:`―`,HorizontalLine:`─`,Hscr:`ℋ`,hscr:`𝒽`,hslash:`ℏ`,Hstrok:`Ħ`,hstrok:`ħ`,HumpDownHump:`≎`,HumpEqual:`≏`,hybull:`⁃`,hyphen:`‐`,Iacute:`Í`,iacute:`í`,ic:`⁣`,Icirc:`Î`,icirc:`î`,Icy:`И`,icy:`и`,Idot:`İ`,IEcy:`Е`,iecy:`е`,iexcl:`¡`,iff:`⇔`,Ifr:`ℑ`,ifr:`𝔦`,Igrave:`Ì`,igrave:`ì`,ii:`ⅈ`,iiiint:`⨌`,iiint:`∭`,iinfin:`⧜`,iiota:`℩`,IJlig:`Ĳ`,ijlig:`ĳ`,Im:`ℑ`,Imacr:`Ī`,imacr:`ī`,image:`ℑ`,ImaginaryI:`ⅈ`,imagline:`ℐ`,imagpart:`ℑ`,imath:`ı`,imof:`⊷`,imped:`Ƶ`,Implies:`⇒`,in:`∈`,incare:`℅`,infin:`∞`,infintie:`⧝`,inodot:`ı`,Int:`∬`,int:`∫`,intcal:`⊺`,integers:`ℤ`,Integral:`∫`,intercal:`⊺`,Intersection:`⋂`,intlarhk:`⨗`,intprod:`⨼`,InvisibleComma:`⁣`,InvisibleTimes:`⁢`,IOcy:`Ё`,iocy:`ё`,Iogon:`Į`,iogon:`į`,Iopf:`𝕀`,iopf:`𝕚`,Iota:`Ι`,iota:`ι`,iprod:`⨼`,iquest:`¿`,Iscr:`ℐ`,iscr:`𝒾`,isin:`∈`,isindot:`⋵`,isinE:`⋹`,isins:`⋴`,isinsv:`⋳`,isinv:`∈`,it:`⁢`,Itilde:`Ĩ`,itilde:`ĩ`,Iukcy:`І`,iukcy:`і`,Iuml:`Ï`,iuml:`ï`,Jcirc:`Ĵ`,jcirc:`ĵ`,Jcy:`Й`,jcy:`й`,Jfr:`𝔍`,jfr:`𝔧`,jmath:`ȷ`,Jopf:`𝕁`,jopf:`𝕛`,Jscr:`𝒥`,jscr:`𝒿`,Jsercy:`Ј`,jsercy:`ј`,Jukcy:`Є`,jukcy:`є`,Kappa:`Κ`,kappa:`κ`,kappav:`ϰ`,Kcedil:`Ķ`,kcedil:`ķ`,Kcy:`К`,kcy:`к`,Kfr:`𝔎`,kfr:`𝔨`,kgreen:`ĸ`,KHcy:`Х`,khcy:`х`,KJcy:`Ќ`,kjcy:`ќ`,Kopf:`𝕂`,kopf:`𝕜`,Kscr:`𝒦`,kscr:`𝓀`,lAarr:`⇚`,Lacute:`Ĺ`,lacute:`ĺ`,laemptyv:`⦴`,lagran:`ℒ`,Lambda:`Λ`,lambda:`λ`,Lang:`⟪`,lang:`⟨`,langd:`⦑`,langle:`⟨`,lap:`⪅`,Laplacetrf:`ℒ`,laquo:`«`,Larr:`↞`,lArr:`⇐`,larr:`←`,larrb:`⇤`,larrbfs:`⤟`,larrfs:`⤝`,larrhk:`↩`,larrlp:`↫`,larrpl:`⤹`,larrsim:`⥳`,larrtl:`↢`,lat:`⪫`,lAtail:`⤛`,latail:`⤙`,late:`⪭`,lates:`⪭︀`,lBarr:`⤎`,lbarr:`⤌`,lbbrk:`❲`,lbrace:`{`,lbrack:`[`,lbrke:`⦋`,lbrksld:`⦏`,lbrkslu:`⦍`,Lcaron:`Ľ`,lcaron:`ľ`,Lcedil:`Ļ`,lcedil:`ļ`,lceil:`⌈`,lcub:`{`,Lcy:`Л`,lcy:`л`,ldca:`⤶`,ldquo:`“`,ldquor:`„`,ldrdhar:`⥧`,ldrushar:`⥋`,ldsh:`↲`,lE:`≦`,le:`≤`,LeftAngleBracket:`⟨`,LeftArrow:`←`,Leftarrow:`⇐`,leftarrow:`←`,LeftArrowBar:`⇤`,LeftArrowRightArrow:`⇆`,leftarrowtail:`↢`,LeftCeiling:`⌈`,LeftDoubleBracket:`⟦`,LeftDownTeeVector:`⥡`,LeftDownVector:`⇃`,LeftDownVectorBar:`⥙`,LeftFloor:`⌊`,leftharpoondown:`↽`,leftharpoonup:`↼`,leftleftarrows:`⇇`,LeftRightArrow:`↔`,Leftrightarrow:`⇔`,leftrightarrow:`↔`,leftrightarrows:`⇆`,leftrightharpoons:`⇋`,leftrightsquigarrow:`↭`,LeftRightVector:`⥎`,LeftTee:`⊣`,LeftTeeArrow:`↤`,LeftTeeVector:`⥚`,leftthreetimes:`⋋`,LeftTriangle:`⊲`,LeftTriangleBar:`⧏`,LeftTriangleEqual:`⊴`,LeftUpDownVector:`⥑`,LeftUpTeeVector:`⥠`,LeftUpVector:`↿`,LeftUpVectorBar:`⥘`,LeftVector:`↼`,LeftVectorBar:`⥒`,lEg:`⪋`,leg:`⋚`,leq:`≤`,leqq:`≦`,leqslant:`⩽`,les:`⩽`,lescc:`⪨`,lesdot:`⩿`,lesdoto:`⪁`,lesdotor:`⪃`,lesg:`⋚︀`,lesges:`⪓`,lessapprox:`⪅`,lessdot:`⋖`,lesseqgtr:`⋚`,lesseqqgtr:`⪋`,LessEqualGreater:`⋚`,LessFullEqual:`≦`,LessGreater:`≶`,lessgtr:`≶`,LessLess:`⪡`,lesssim:`≲`,LessSlantEqual:`⩽`,LessTilde:`≲`,lfisht:`⥼`,lfloor:`⌊`,Lfr:`𝔏`,lfr:`𝔩`,lg:`≶`,lgE:`⪑`,lHar:`⥢`,lhard:`↽`,lharu:`↼`,lharul:`⥪`,lhblk:`▄`,LJcy:`Љ`,ljcy:`љ`,Ll:`⋘`,ll:`≪`,llarr:`⇇`,llcorner:`⌞`,Lleftarrow:`⇚`,llhard:`⥫`,lltri:`◺`,Lmidot:`Ŀ`,lmidot:`ŀ`,lmoust:`⎰`,lmoustache:`⎰`,lnap:`⪉`,lnapprox:`⪉`,lnE:`≨`,lne:`⪇`,lneq:`⪇`,lneqq:`≨`,lnsim:`⋦`,loang:`⟬`,loarr:`⇽`,lobrk:`⟦`,LongLeftArrow:`⟵`,Longleftarrow:`⟸`,longleftarrow:`⟵`,LongLeftRightArrow:`⟷`,Longleftrightarrow:`⟺`,longleftrightarrow:`⟷`,longmapsto:`⟼`,LongRightArrow:`⟶`,Longrightarrow:`⟹`,longrightarrow:`⟶`,looparrowleft:`↫`,looparrowright:`↬`,lopar:`⦅`,Lopf:`𝕃`,lopf:`𝕝`,loplus:`⨭`,lotimes:`⨴`,lowast:`∗`,lowbar:`_`,LowerLeftArrow:`↙`,LowerRightArrow:`↘`,loz:`◊`,lozenge:`◊`,lozf:`⧫`,lpar:`(`,lparlt:`⦓`,lrarr:`⇆`,lrcorner:`⌟`,lrhar:`⇋`,lrhard:`⥭`,lrm:`‎`,lrtri:`⊿`,lsaquo:`‹`,Lscr:`ℒ`,lscr:`𝓁`,Lsh:`↰`,lsh:`↰`,lsim:`≲`,lsime:`⪍`,lsimg:`⪏`,lsqb:`[`,lsquo:`‘`,lsquor:`‚`,Lstrok:`Ł`,lstrok:`ł`,Lt:`≪`,LT:`<`,lt:`<`,ltcc:`⪦`,ltcir:`⩹`,ltdot:`⋖`,lthree:`⋋`,ltimes:`⋉`,ltlarr:`⥶`,ltquest:`⩻`,ltri:`◃`,ltrie:`⊴`,ltrif:`◂`,ltrPar:`⦖`,lurdshar:`⥊`,luruhar:`⥦`,lvertneqq:`≨︀`,lvnE:`≨︀`,macr:`¯`,male:`♂`,malt:`✠`,maltese:`✠`,Map:`⤅`,map:`↦`,mapsto:`↦`,mapstodown:`↧`,mapstoleft:`↤`,mapstoup:`↥`,marker:`▮`,mcomma:`⨩`,Mcy:`М`,mcy:`м`,mdash:`—`,mDDot:`∺`,measuredangle:`∡`,MediumSpace:` `,Mellintrf:`ℳ`,Mfr:`𝔐`,mfr:`𝔪`,mho:`℧`,micro:`µ`,mid:`∣`,midast:`*`,midcir:`⫰`,middot:`·`,minus:`−`,minusb:`⊟`,minusd:`∸`,minusdu:`⨪`,MinusPlus:`∓`,mlcp:`⫛`,mldr:`…`,mnplus:`∓`,models:`⊧`,Mopf:`𝕄`,mopf:`𝕞`,mp:`∓`,Mscr:`ℳ`,mscr:`𝓂`,mstpos:`∾`,Mu:`Μ`,mu:`μ`,multimap:`⊸`,mumap:`⊸`,nabla:`∇`,Nacute:`Ń`,nacute:`ń`,nang:`∠⃒`,nap:`≉`,napE:`⩰̸`,napid:`≋̸`,napos:`ŉ`,napprox:`≉`,natur:`♮`,natural:`♮`,naturals:`ℕ`,nbsp:`\xA0`,nbump:`≎̸`,nbumpe:`≏̸`,ncap:`⩃`,Ncaron:`Ň`,ncaron:`ň`,Ncedil:`Ņ`,ncedil:`ņ`,ncong:`≇`,ncongdot:`⩭̸`,ncup:`⩂`,Ncy:`Н`,ncy:`н`,ndash:`–`,ne:`≠`,nearhk:`⤤`,neArr:`⇗`,nearr:`↗`,nearrow:`↗`,nedot:`≐̸`,NegativeMediumSpace:`​`,NegativeThickSpace:`​`,NegativeThinSpace:`​`,NegativeVeryThinSpace:`​`,nequiv:`≢`,nesear:`⤨`,nesim:`≂̸`,NestedGreaterGreater:`≫`,NestedLessLess:`≪`,NewLine:`
`,nexist:`∄`,nexists:`∄`,Nfr:`𝔑`,nfr:`𝔫`,ngE:`≧̸`,nge:`≱`,ngeq:`≱`,ngeqq:`≧̸`,ngeqslant:`⩾̸`,nges:`⩾̸`,nGg:`⋙̸`,ngsim:`≵`,nGt:`≫⃒`,ngt:`≯`,ngtr:`≯`,nGtv:`≫̸`,nhArr:`⇎`,nharr:`↮`,nhpar:`⫲`,ni:`∋`,nis:`⋼`,nisd:`⋺`,niv:`∋`,NJcy:`Њ`,njcy:`њ`,nlArr:`⇍`,nlarr:`↚`,nldr:`‥`,nlE:`≦̸`,nle:`≰`,nLeftarrow:`⇍`,nleftarrow:`↚`,nLeftrightarrow:`⇎`,nleftrightarrow:`↮`,nleq:`≰`,nleqq:`≦̸`,nleqslant:`⩽̸`,nles:`⩽̸`,nless:`≮`,nLl:`⋘̸`,nlsim:`≴`,nLt:`≪⃒`,nlt:`≮`,nltri:`⋪`,nltrie:`⋬`,nLtv:`≪̸`,nmid:`∤`,NoBreak:`⁠`,NonBreakingSpace:`\xA0`,Nopf:`ℕ`,nopf:`𝕟`,Not:`⫬`,not:`¬`,NotCongruent:`≢`,NotCupCap:`≭`,NotDoubleVerticalBar:`∦`,NotElement:`∉`,NotEqual:`≠`,NotEqualTilde:`≂̸`,NotExists:`∄`,NotGreater:`≯`,NotGreaterEqual:`≱`,NotGreaterFullEqual:`≧̸`,NotGreaterGreater:`≫̸`,NotGreaterLess:`≹`,NotGreaterSlantEqual:`⩾̸`,NotGreaterTilde:`≵`,NotHumpDownHump:`≎̸`,NotHumpEqual:`≏̸`,notin:`∉`,notindot:`⋵̸`,notinE:`⋹̸`,notinva:`∉`,notinvb:`⋷`,notinvc:`⋶`,NotLeftTriangle:`⋪`,NotLeftTriangleBar:`⧏̸`,NotLeftTriangleEqual:`⋬`,NotLess:`≮`,NotLessEqual:`≰`,NotLessGreater:`≸`,NotLessLess:`≪̸`,NotLessSlantEqual:`⩽̸`,NotLessTilde:`≴`,NotNestedGreaterGreater:`⪢̸`,NotNestedLessLess:`⪡̸`,notni:`∌`,notniva:`∌`,notnivb:`⋾`,notnivc:`⋽`,NotPrecedes:`⊀`,NotPrecedesEqual:`⪯̸`,NotPrecedesSlantEqual:`⋠`,NotReverseElement:`∌`,NotRightTriangle:`⋫`,NotRightTriangleBar:`⧐̸`,NotRightTriangleEqual:`⋭`,NotSquareSubset:`⊏̸`,NotSquareSubsetEqual:`⋢`,NotSquareSuperset:`⊐̸`,NotSquareSupersetEqual:`⋣`,NotSubset:`⊂⃒`,NotSubsetEqual:`⊈`,NotSucceeds:`⊁`,NotSucceedsEqual:`⪰̸`,NotSucceedsSlantEqual:`⋡`,NotSucceedsTilde:`≿̸`,NotSuperset:`⊃⃒`,NotSupersetEqual:`⊉`,NotTilde:`≁`,NotTildeEqual:`≄`,NotTildeFullEqual:`≇`,NotTildeTilde:`≉`,NotVerticalBar:`∤`,npar:`∦`,nparallel:`∦`,nparsl:`⫽⃥`,npart:`∂̸`,npolint:`⨔`,npr:`⊀`,nprcue:`⋠`,npre:`⪯̸`,nprec:`⊀`,npreceq:`⪯̸`,nrArr:`⇏`,nrarr:`↛`,nrarrc:`⤳̸`,nrarrw:`↝̸`,nRightarrow:`⇏`,nrightarrow:`↛`,nrtri:`⋫`,nrtrie:`⋭`,nsc:`⊁`,nsccue:`⋡`,nsce:`⪰̸`,Nscr:`𝒩`,nscr:`𝓃`,nshortmid:`∤`,nshortparallel:`∦`,nsim:`≁`,nsime:`≄`,nsimeq:`≄`,nsmid:`∤`,nspar:`∦`,nsqsube:`⋢`,nsqsupe:`⋣`,nsub:`⊄`,nsubE:`⫅̸`,nsube:`⊈`,nsubset:`⊂⃒`,nsubseteq:`⊈`,nsubseteqq:`⫅̸`,nsucc:`⊁`,nsucceq:`⪰̸`,nsup:`⊅`,nsupE:`⫆̸`,nsupe:`⊉`,nsupset:`⊃⃒`,nsupseteq:`⊉`,nsupseteqq:`⫆̸`,ntgl:`≹`,Ntilde:`Ñ`,ntilde:`ñ`,ntlg:`≸`,ntriangleleft:`⋪`,ntrianglelefteq:`⋬`,ntriangleright:`⋫`,ntrianglerighteq:`⋭`,Nu:`Ν`,nu:`ν`,num:`#`,numero:`№`,numsp:` `,nvap:`≍⃒`,nVDash:`⊯`,nVdash:`⊮`,nvDash:`⊭`,nvdash:`⊬`,nvge:`≥⃒`,nvgt:`>⃒`,nvHarr:`⤄`,nvinfin:`⧞`,nvlArr:`⤂`,nvle:`≤⃒`,nvlt:`<⃒`,nvltrie:`⊴⃒`,nvrArr:`⤃`,nvrtrie:`⊵⃒`,nvsim:`∼⃒`,nwarhk:`⤣`,nwArr:`⇖`,nwarr:`↖`,nwarrow:`↖`,nwnear:`⤧`,Oacute:`Ó`,oacute:`ó`,oast:`⊛`,ocir:`⊚`,Ocirc:`Ô`,ocirc:`ô`,Ocy:`О`,ocy:`о`,odash:`⊝`,Odblac:`Ő`,odblac:`ő`,odiv:`⨸`,odot:`⊙`,odsold:`⦼`,OElig:`Œ`,oelig:`œ`,ofcir:`⦿`,Ofr:`𝔒`,ofr:`𝔬`,ogon:`˛`,Ograve:`Ò`,ograve:`ò`,ogt:`⧁`,ohbar:`⦵`,ohm:`Ω`,oint:`∮`,olarr:`↺`,olcir:`⦾`,olcross:`⦻`,oline:`‾`,olt:`⧀`,Omacr:`Ō`,omacr:`ō`,Omega:`Ω`,omega:`ω`,Omicron:`Ο`,omicron:`ο`,omid:`⦶`,ominus:`⊖`,Oopf:`𝕆`,oopf:`𝕠`,opar:`⦷`,OpenCurlyDoubleQuote:`“`,OpenCurlyQuote:`‘`,operp:`⦹`,oplus:`⊕`,Or:`⩔`,or:`∨`,orarr:`↻`,ord:`⩝`,order:`ℴ`,orderof:`ℴ`,ordf:`ª`,ordm:`º`,origof:`⊶`,oror:`⩖`,orslope:`⩗`,orv:`⩛`,oS:`Ⓢ`,Oscr:`𝒪`,oscr:`ℴ`,Oslash:`Ø`,oslash:`ø`,osol:`⊘`,Otilde:`Õ`,otilde:`õ`,Otimes:`⨷`,otimes:`⊗`,otimesas:`⨶`,Ouml:`Ö`,ouml:`ö`,ovbar:`⌽`,OverBar:`‾`,OverBrace:`⏞`,OverBracket:`⎴`,OverParenthesis:`⏜`,par:`∥`,para:`¶`,parallel:`∥`,parsim:`⫳`,parsl:`⫽`,part:`∂`,PartialD:`∂`,Pcy:`П`,pcy:`п`,percnt:`%`,period:`.`,permil:`‰`,perp:`⊥`,pertenk:`‱`,Pfr:`𝔓`,pfr:`𝔭`,Phi:`Φ`,phi:`φ`,phiv:`ϕ`,phmmat:`ℳ`,phone:`☎`,Pi:`Π`,pi:`π`,pitchfork:`⋔`,piv:`ϖ`,planck:`ℏ`,planckh:`ℎ`,plankv:`ℏ`,plus:`+`,plusacir:`⨣`,plusb:`⊞`,pluscir:`⨢`,plusdo:`∔`,plusdu:`⨥`,pluse:`⩲`,PlusMinus:`±`,plusmn:`±`,plussim:`⨦`,plustwo:`⨧`,pm:`±`,Poincareplane:`ℌ`,pointint:`⨕`,Popf:`ℙ`,popf:`𝕡`,pound:`£`,Pr:`⪻`,pr:`≺`,prap:`⪷`,prcue:`≼`,prE:`⪳`,pre:`⪯`,prec:`≺`,precapprox:`⪷`,preccurlyeq:`≼`,Precedes:`≺`,PrecedesEqual:`⪯`,PrecedesSlantEqual:`≼`,PrecedesTilde:`≾`,preceq:`⪯`,precnapprox:`⪹`,precneqq:`⪵`,precnsim:`⋨`,precsim:`≾`,Prime:`″`,prime:`′`,primes:`ℙ`,prnap:`⪹`,prnE:`⪵`,prnsim:`⋨`,prod:`∏`,Product:`∏`,profalar:`⌮`,profline:`⌒`,profsurf:`⌓`,prop:`∝`,Proportion:`∷`,Proportional:`∝`,propto:`∝`,prsim:`≾`,prurel:`⊰`,Pscr:`𝒫`,pscr:`𝓅`,Psi:`Ψ`,psi:`ψ`,puncsp:` `,Qfr:`𝔔`,qfr:`𝔮`,qint:`⨌`,Qopf:`ℚ`,qopf:`𝕢`,qprime:`⁗`,Qscr:`𝒬`,qscr:`𝓆`,quaternions:`ℍ`,quatint:`⨖`,quest:`?`,questeq:`≟`,QUOT:`"`,quot:`"`,rAarr:`⇛`,race:`∽̱`,Racute:`Ŕ`,racute:`ŕ`,radic:`√`,raemptyv:`⦳`,Rang:`⟫`,rang:`⟩`,rangd:`⦒`,range:`⦥`,rangle:`⟩`,raquo:`»`,Rarr:`↠`,rArr:`⇒`,rarr:`→`,rarrap:`⥵`,rarrb:`⇥`,rarrbfs:`⤠`,rarrc:`⤳`,rarrfs:`⤞`,rarrhk:`↪`,rarrlp:`↬`,rarrpl:`⥅`,rarrsim:`⥴`,Rarrtl:`⤖`,rarrtl:`↣`,rarrw:`↝`,rAtail:`⤜`,ratail:`⤚`,ratio:`∶`,rationals:`ℚ`,RBarr:`⤐`,rBarr:`⤏`,rbarr:`⤍`,rbbrk:`❳`,rbrace:`}`,rbrack:`]`,rbrke:`⦌`,rbrksld:`⦎`,rbrkslu:`⦐`,Rcaron:`Ř`,rcaron:`ř`,Rcedil:`Ŗ`,rcedil:`ŗ`,rceil:`⌉`,rcub:`}`,Rcy:`Р`,rcy:`р`,rdca:`⤷`,rdldhar:`⥩`,rdquo:`”`,rdquor:`”`,rdsh:`↳`,Re:`ℜ`,real:`ℜ`,realine:`ℛ`,realpart:`ℜ`,reals:`ℝ`,rect:`▭`,REG:`®`,reg:`®`,ReverseElement:`∋`,ReverseEquilibrium:`⇋`,ReverseUpEquilibrium:`⥯`,rfisht:`⥽`,rfloor:`⌋`,Rfr:`ℜ`,rfr:`𝔯`,rHar:`⥤`,rhard:`⇁`,rharu:`⇀`,rharul:`⥬`,Rho:`Ρ`,rho:`ρ`,rhov:`ϱ`,RightAngleBracket:`⟩`,RightArrow:`→`,Rightarrow:`⇒`,rightarrow:`→`,RightArrowBar:`⇥`,RightArrowLeftArrow:`⇄`,rightarrowtail:`↣`,RightCeiling:`⌉`,RightDoubleBracket:`⟧`,RightDownTeeVector:`⥝`,RightDownVector:`⇂`,RightDownVectorBar:`⥕`,RightFloor:`⌋`,rightharpoondown:`⇁`,rightharpoonup:`⇀`,rightleftarrows:`⇄`,rightleftharpoons:`⇌`,rightrightarrows:`⇉`,rightsquigarrow:`↝`,RightTee:`⊢`,RightTeeArrow:`↦`,RightTeeVector:`⥛`,rightthreetimes:`⋌`,RightTriangle:`⊳`,RightTriangleBar:`⧐`,RightTriangleEqual:`⊵`,RightUpDownVector:`⥏`,RightUpTeeVector:`⥜`,RightUpVector:`↾`,RightUpVectorBar:`⥔`,RightVector:`⇀`,RightVectorBar:`⥓`,ring:`˚`,risingdotseq:`≓`,rlarr:`⇄`,rlhar:`⇌`,rlm:`‏`,rmoust:`⎱`,rmoustache:`⎱`,rnmid:`⫮`,roang:`⟭`,roarr:`⇾`,robrk:`⟧`,ropar:`⦆`,Ropf:`ℝ`,ropf:`𝕣`,roplus:`⨮`,rotimes:`⨵`,RoundImplies:`⥰`,rpar:`)`,rpargt:`⦔`,rppolint:`⨒`,rrarr:`⇉`,Rrightarrow:`⇛`,rsaquo:`›`,Rscr:`ℛ`,rscr:`𝓇`,Rsh:`↱`,rsh:`↱`,rsqb:`]`,rsquo:`’`,rsquor:`’`,rthree:`⋌`,rtimes:`⋊`,rtri:`▹`,rtrie:`⊵`,rtrif:`▸`,rtriltri:`⧎`,RuleDelayed:`⧴`,ruluhar:`⥨`,rx:`℞`,Sacute:`Ś`,sacute:`ś`,sbquo:`‚`,Sc:`⪼`,sc:`≻`,scap:`⪸`,Scaron:`Š`,scaron:`š`,sccue:`≽`,scE:`⪴`,sce:`⪰`,Scedil:`Ş`,scedil:`ş`,Scirc:`Ŝ`,scirc:`ŝ`,scnap:`⪺`,scnE:`⪶`,scnsim:`⋩`,scpolint:`⨓`,scsim:`≿`,Scy:`С`,scy:`с`,sdot:`⋅`,sdotb:`⊡`,sdote:`⩦`,searhk:`⤥`,seArr:`⇘`,searr:`↘`,searrow:`↘`,sect:`§`,semi:`;`,seswar:`⤩`,setminus:`∖`,setmn:`∖`,sext:`✶`,Sfr:`𝔖`,sfr:`𝔰`,sfrown:`⌢`,sharp:`♯`,SHCHcy:`Щ`,shchcy:`щ`,SHcy:`Ш`,shcy:`ш`,ShortDownArrow:`↓`,ShortLeftArrow:`←`,shortmid:`∣`,shortparallel:`∥`,ShortRightArrow:`→`,ShortUpArrow:`↑`,shy:`­`,Sigma:`Σ`,sigma:`σ`,sigmaf:`ς`,sigmav:`ς`,sim:`∼`,simdot:`⩪`,sime:`≃`,simeq:`≃`,simg:`⪞`,simgE:`⪠`,siml:`⪝`,simlE:`⪟`,simne:`≆`,simplus:`⨤`,simrarr:`⥲`,slarr:`←`,SmallCircle:`∘`,smallsetminus:`∖`,smashp:`⨳`,smeparsl:`⧤`,smid:`∣`,smile:`⌣`,smt:`⪪`,smte:`⪬`,smtes:`⪬︀`,SOFTcy:`Ь`,softcy:`ь`,sol:`/`,solb:`⧄`,solbar:`⌿`,Sopf:`𝕊`,sopf:`𝕤`,spades:`♠`,spadesuit:`♠`,spar:`∥`,sqcap:`⊓`,sqcaps:`⊓︀`,sqcup:`⊔`,sqcups:`⊔︀`,Sqrt:`√`,sqsub:`⊏`,sqsube:`⊑`,sqsubset:`⊏`,sqsubseteq:`⊑`,sqsup:`⊐`,sqsupe:`⊒`,sqsupset:`⊐`,sqsupseteq:`⊒`,squ:`□`,Square:`□`,square:`□`,SquareIntersection:`⊓`,SquareSubset:`⊏`,SquareSubsetEqual:`⊑`,SquareSuperset:`⊐`,SquareSupersetEqual:`⊒`,SquareUnion:`⊔`,squarf:`▪`,squf:`▪`,srarr:`→`,Sscr:`𝒮`,sscr:`𝓈`,ssetmn:`∖`,ssmile:`⌣`,sstarf:`⋆`,Star:`⋆`,star:`☆`,starf:`★`,straightepsilon:`ϵ`,straightphi:`ϕ`,strns:`¯`,Sub:`⋐`,sub:`⊂`,subdot:`⪽`,subE:`⫅`,sube:`⊆`,subedot:`⫃`,submult:`⫁`,subnE:`⫋`,subne:`⊊`,subplus:`⪿`,subrarr:`⥹`,Subset:`⋐`,subset:`⊂`,subseteq:`⊆`,subseteqq:`⫅`,SubsetEqual:`⊆`,subsetneq:`⊊`,subsetneqq:`⫋`,subsim:`⫇`,subsub:`⫕`,subsup:`⫓`,succ:`≻`,succapprox:`⪸`,succcurlyeq:`≽`,Succeeds:`≻`,SucceedsEqual:`⪰`,SucceedsSlantEqual:`≽`,SucceedsTilde:`≿`,succeq:`⪰`,succnapprox:`⪺`,succneqq:`⪶`,succnsim:`⋩`,succsim:`≿`,SuchThat:`∋`,Sum:`∑`,sum:`∑`,sung:`♪`,Sup:`⋑`,sup:`⊃`,sup1:`¹`,sup2:`²`,sup3:`³`,supdot:`⪾`,supdsub:`⫘`,supE:`⫆`,supe:`⊇`,supedot:`⫄`,Superset:`⊃`,SupersetEqual:`⊇`,suphsol:`⟉`,suphsub:`⫗`,suplarr:`⥻`,supmult:`⫂`,supnE:`⫌`,supne:`⊋`,supplus:`⫀`,Supset:`⋑`,supset:`⊃`,supseteq:`⊇`,supseteqq:`⫆`,supsetneq:`⊋`,supsetneqq:`⫌`,supsim:`⫈`,supsub:`⫔`,supsup:`⫖`,swarhk:`⤦`,swArr:`⇙`,swarr:`↙`,swarrow:`↙`,swnwar:`⤪`,szlig:`ß`,Tab:`	`,target:`⌖`,Tau:`Τ`,tau:`τ`,tbrk:`⎴`,Tcaron:`Ť`,tcaron:`ť`,Tcedil:`Ţ`,tcedil:`ţ`,Tcy:`Т`,tcy:`т`,tdot:`⃛`,telrec:`⌕`,Tfr:`𝔗`,tfr:`𝔱`,there4:`∴`,Therefore:`∴`,therefore:`∴`,Theta:`Θ`,theta:`θ`,thetasym:`ϑ`,thetav:`ϑ`,thickapprox:`≈`,thicksim:`∼`,ThickSpace:`  `,thinsp:` `,ThinSpace:` `,thkap:`≈`,thksim:`∼`,THORN:`Þ`,thorn:`þ`,Tilde:`∼`,tilde:`˜`,TildeEqual:`≃`,TildeFullEqual:`≅`,TildeTilde:`≈`,times:`×`,timesb:`⊠`,timesbar:`⨱`,timesd:`⨰`,tint:`∭`,toea:`⤨`,top:`⊤`,topbot:`⌶`,topcir:`⫱`,Topf:`𝕋`,topf:`𝕥`,topfork:`⫚`,tosa:`⤩`,tprime:`‴`,TRADE:`™`,trade:`™`,triangle:`▵`,triangledown:`▿`,triangleleft:`◃`,trianglelefteq:`⊴`,triangleq:`≜`,triangleright:`▹`,trianglerighteq:`⊵`,tridot:`◬`,trie:`≜`,triminus:`⨺`,TripleDot:`⃛`,triplus:`⨹`,trisb:`⧍`,tritime:`⨻`,trpezium:`⏢`,Tscr:`𝒯`,tscr:`𝓉`,TScy:`Ц`,tscy:`ц`,TSHcy:`Ћ`,tshcy:`ћ`,Tstrok:`Ŧ`,tstrok:`ŧ`,twixt:`≬`,twoheadleftarrow:`↞`,twoheadrightarrow:`↠`,Uacute:`Ú`,uacute:`ú`,Uarr:`↟`,uArr:`⇑`,uarr:`↑`,Uarrocir:`⥉`,Ubrcy:`Ў`,ubrcy:`ў`,Ubreve:`Ŭ`,ubreve:`ŭ`,Ucirc:`Û`,ucirc:`û`,Ucy:`У`,ucy:`у`,udarr:`⇅`,Udblac:`Ű`,udblac:`ű`,udhar:`⥮`,ufisht:`⥾`,Ufr:`𝔘`,ufr:`𝔲`,Ugrave:`Ù`,ugrave:`ù`,uHar:`⥣`,uharl:`↿`,uharr:`↾`,uhblk:`▀`,ulcorn:`⌜`,ulcorner:`⌜`,ulcrop:`⌏`,ultri:`◸`,Umacr:`Ū`,umacr:`ū`,uml:`¨`,UnderBar:`_`,UnderBrace:`⏟`,UnderBracket:`⎵`,UnderParenthesis:`⏝`,Union:`⋃`,UnionPlus:`⊎`,Uogon:`Ų`,uogon:`ų`,Uopf:`𝕌`,uopf:`𝕦`,UpArrow:`↑`,Uparrow:`⇑`,uparrow:`↑`,UpArrowBar:`⤒`,UpArrowDownArrow:`⇅`,UpDownArrow:`↕`,Updownarrow:`⇕`,updownarrow:`↕`,UpEquilibrium:`⥮`,upharpoonleft:`↿`,upharpoonright:`↾`,uplus:`⊎`,UpperLeftArrow:`↖`,UpperRightArrow:`↗`,Upsi:`ϒ`,upsi:`υ`,upsih:`ϒ`,Upsilon:`Υ`,upsilon:`υ`,UpTee:`⊥`,UpTeeArrow:`↥`,upuparrows:`⇈`,urcorn:`⌝`,urcorner:`⌝`,urcrop:`⌎`,Uring:`Ů`,uring:`ů`,urtri:`◹`,Uscr:`𝒰`,uscr:`𝓊`,utdot:`⋰`,Utilde:`Ũ`,utilde:`ũ`,utri:`▵`,utrif:`▴`,uuarr:`⇈`,Uuml:`Ü`,uuml:`ü`,uwangle:`⦧`,vangrt:`⦜`,varepsilon:`ϵ`,varkappa:`ϰ`,varnothing:`∅`,varphi:`ϕ`,varpi:`ϖ`,varpropto:`∝`,vArr:`⇕`,varr:`↕`,varrho:`ϱ`,varsigma:`ς`,varsubsetneq:`⊊︀`,varsubsetneqq:`⫋︀`,varsupsetneq:`⊋︀`,varsupsetneqq:`⫌︀`,vartheta:`ϑ`,vartriangleleft:`⊲`,vartriangleright:`⊳`,Vbar:`⫫`,vBar:`⫨`,vBarv:`⫩`,Vcy:`В`,vcy:`в`,VDash:`⊫`,Vdash:`⊩`,vDash:`⊨`,vdash:`⊢`,Vdashl:`⫦`,Vee:`⋁`,vee:`∨`,veebar:`⊻`,veeeq:`≚`,vellip:`⋮`,Verbar:`‖`,verbar:`|`,Vert:`‖`,vert:`|`,VerticalBar:`∣`,VerticalLine:`|`,VerticalSeparator:`❘`,VerticalTilde:`≀`,VeryThinSpace:` `,Vfr:`𝔙`,vfr:`𝔳`,vltri:`⊲`,vnsub:`⊂⃒`,vnsup:`⊃⃒`,Vopf:`𝕍`,vopf:`𝕧`,vprop:`∝`,vrtri:`⊳`,Vscr:`𝒱`,vscr:`𝓋`,vsubnE:`⫋︀`,vsubne:`⊊︀`,vsupnE:`⫌︀`,vsupne:`⊋︀`,Vvdash:`⊪`,vzigzag:`⦚`,Wcirc:`Ŵ`,wcirc:`ŵ`,wedbar:`⩟`,Wedge:`⋀`,wedge:`∧`,wedgeq:`≙`,weierp:`℘`,Wfr:`𝔚`,wfr:`𝔴`,Wopf:`𝕎`,wopf:`𝕨`,wp:`℘`,wr:`≀`,wreath:`≀`,Wscr:`𝒲`,wscr:`𝓌`,xcap:`⋂`,xcirc:`◯`,xcup:`⋃`,xdtri:`▽`,Xfr:`𝔛`,xfr:`𝔵`,xhArr:`⟺`,xharr:`⟷`,Xi:`Ξ`,xi:`ξ`,xlArr:`⟸`,xlarr:`⟵`,xmap:`⟼`,xnis:`⋻`,xodot:`⨀`,Xopf:`𝕏`,xopf:`𝕩`,xoplus:`⨁`,xotime:`⨂`,xrArr:`⟹`,xrarr:`⟶`,Xscr:`𝒳`,xscr:`𝓍`,xsqcup:`⨆`,xuplus:`⨄`,xutri:`△`,xvee:`⋁`,xwedge:`⋀`,Yacute:`Ý`,yacute:`ý`,YAcy:`Я`,yacy:`я`,Ycirc:`Ŷ`,ycirc:`ŷ`,Ycy:`Ы`,ycy:`ы`,yen:`¥`,Yfr:`𝔜`,yfr:`𝔶`,YIcy:`Ї`,yicy:`ї`,Yopf:`𝕐`,yopf:`𝕪`,Yscr:`𝒴`,yscr:`𝓎`,YUcy:`Ю`,yucy:`ю`,Yuml:`Ÿ`,yuml:`ÿ`,Zacute:`Ź`,zacute:`ź`,Zcaron:`Ž`,zcaron:`ž`,Zcy:`З`,zcy:`з`,Zdot:`Ż`,zdot:`ż`,zeetrf:`ℨ`,ZeroWidthSpace:`​`,Zeta:`Ζ`,zeta:`ζ`,Zfr:`ℨ`,zfr:`𝔷`,ZHcy:`Ж`,zhcy:`ж`,zigrarr:`⇝`,Zopf:`ℤ`,zopf:`𝕫`,Zscr:`𝒵`,zscr:`𝓏`,zwj:`‍`,zwnj:`‌`}),e.entityMap=e.HTML_ENTITIES})),Zc=o((e=>{var t=Jc().NAMESPACE,n=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,r=RegExp(`[\\-\\.0-9`+n.source.slice(1,-1)+`\\u00B7\\u0300-\\u036F\\u203F-\\u2040]`),i=RegExp(`^`+n.source+r.source+`*(?::`+n.source+r.source+`*)?$`),a=0,o=1,s=2,c=3,l=4,u=5,d=6,f=7;function p(e,t){this.message=e,this.locator=t,Error.captureStackTrace&&Error.captureStackTrace(this,p)}p.prototype=Error(),p.prototype.name=p.name;function m(){}m.prototype={parse:function(e,t,n){var r=this.domBuilder;r.startDocument(),x(t,t={}),h(e,t,n,r,this.errorHandler),r.endDocument()}};function h(e,n,r,i,a){function o(e){if(e>65535){e-=65536;var t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}else return String.fromCharCode(e)}function s(e){var t=e.slice(1,-1);return t in r?r[t]:t.charAt(0)===`#`?o(parseInt(t.substr(1).replace(`x`,`0x`))):(a.error(`entity not found:`+e),e)}function c(t){if(t>T){var n=e.substring(T,t).replace(/&#?\w+;/g,s);m&&l(T),i.characters(n,0,t-T),T=t}}function l(t,n){for(;t>=d&&(n=f.exec(e));)u=n.index,d=u+n[0].length,m.lineNumber++;m.columnNumber=t-u+1}for(var u=0,d=0,f=/.*(?:\r\n?|\n)|.*$/g,m=i.locator,h=[{currentNSMap:n}],x={},T=0;;){try{var E=e.indexOf(`<`,T);if(E<0){if(!e.substr(T).match(/^\s*$/)){var D=i.doc,O=D.createTextNode(e.substr(T));D.appendChild(O),i.currentElement=O}return}switch(E>T&&c(E),e.charAt(E+1)){case`/`:var k=e.indexOf(`>`,E+3),A=e.substring(E+2,k).replace(/[ \t\n\r]+$/g,``),j=h.pop();k<0?(A=e.substring(E+2).replace(/[\s<].*/,``),a.error(`end tag name: `+A+` is not complete:`+j.tagName),k=E+1+A.length):A.match(/\s</)&&(A=A.replace(/[\s<].*/,``),a.error(`end tag name: `+A+` maybe not complete`),k=E+1+A.length);var M=j.localNSMap,N=j.tagName==A;if(N||j.tagName&&j.tagName.toLowerCase()==A.toLowerCase()){if(i.endElement(j.uri,j.localName,A),M)for(var P in M)Object.prototype.hasOwnProperty.call(M,P)&&i.endPrefixMapping(P);N||a.fatalError(`end tag name: `+A+` is not match the current start tagName:`+j.tagName)}else h.push(j);k++;break;case`?`:m&&l(E),k=C(e,E,i);break;case`!`:m&&l(E),k=S(e,E,i,a);break;default:m&&l(E);var F=new w,I=h[h.length-1].currentNSMap,k=_(e,E,F,I,s,a),L=F.length;if(!F.closed&&b(e,k,F.tagName,x)&&(F.closed=!0,r.nbsp||a.warning(`unclosed xml attribute`)),m&&L){for(var R=g(m,{}),ee=0;ee<L;ee++){var te=F[ee];l(te.offset),te.locator=g(m,{})}i.locator=R,v(F,i,I)&&h.push(F),i.locator=m}else v(F,i,I)&&h.push(F);t.isHTML(F.uri)&&!F.closed?k=y(e,k,F.tagName,s,i):k++}}catch(e){if(e instanceof p)throw e;a.error(`element parse error: `+e),k=-1}k>T?T=k:c(Math.max(E,T)+1)}}function g(e,t){return t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber,t}function _(e,n,r,i,p,m){function h(e,t,n){r.attributeNames.hasOwnProperty(e)&&m.fatalError(`Attribute `+e+` redefined`),r.addValue(e,t,n)}for(var g,_,v=++n,y=a;;){var b=e.charAt(v);switch(b){case`=`:if(y===o)g=e.slice(n,v),y=c;else if(y===s)y=c;else throw Error(`attribute equal must after attrName`);break;case`'`:case`"`:if(y===c||y===o)if(y===o&&(m.warning(`attribute value must after "="`),g=e.slice(n,v)),n=v+1,v=e.indexOf(b,n),v>0)_=e.slice(n,v).replace(/&#?\w+;/g,p),h(g,_,n-1),y=u;else throw Error(`attribute value no end '`+b+`' match`);else if(y==l)_=e.slice(n,v).replace(/&#?\w+;/g,p),h(g,_,n),m.warning(`attribute "`+g+`" missed start quot(`+b+`)!!`),n=v+1,y=u;else throw Error(`attribute value must after "="`);break;case`/`:switch(y){case a:r.setTagName(e.slice(n,v));case u:case d:case f:y=f,r.closed=!0;case l:case o:break;case s:r.closed=!0;break;default:throw Error(`attribute invalid close char('/')`)}break;case``:return m.error(`unexpected end of input`),y==a&&r.setTagName(e.slice(n,v)),v;case`>`:switch(y){case a:r.setTagName(e.slice(n,v));case u:case d:case f:break;case l:case o:_=e.slice(n,v),_.slice(-1)===`/`&&(r.closed=!0,_=_.slice(0,-1));case s:y===s&&(_=g),y==l?(m.warning(`attribute "`+_+`" missed quot(")!`),h(g,_.replace(/&#?\w+;/g,p),n)):((!t.isHTML(i[``])||!_.match(/^(?:disabled|checked|selected)$/i))&&m.warning(`attribute "`+_+`" missed value!! "`+_+`" instead!!`),h(_,_,n));break;case c:throw Error(`attribute value missed!!`)}return v;case``:b=` `;default:if(b<=` `)switch(y){case a:r.setTagName(e.slice(n,v)),y=d;break;case o:g=e.slice(n,v),y=s;break;case l:var _=e.slice(n,v).replace(/&#?\w+;/g,p);m.warning(`attribute "`+_+`" missed quot(")!!`),h(g,_,n);case u:y=d;break}else switch(y){case s:r.tagName,(!t.isHTML(i[``])||!g.match(/^(?:disabled|checked|selected)$/i))&&m.warning(`attribute "`+g+`" missed value!! "`+g+`" instead2!!`),h(g,g,n),n=v,y=o;break;case u:m.warning(`attribute space is required"`+g+`"!!`);case d:y=o,n=v;break;case c:y=l,n=v;break;case f:throw Error(`elements closed character '/' and '>' must be connected to`)}}v++}}function v(e,n,r){for(var i=e.tagName,a=null,o=e.length;o--;){var s=e[o],c=s.qName,l=s.value,u=c.indexOf(`:`);if(u>0)var d=s.prefix=c.slice(0,u),f=c.slice(u+1),p=d===`xmlns`&&f;else f=c,d=null,p=c===`xmlns`&&``;s.localName=f,p!==!1&&(a??(a={},x(r,r={})),r[p]=a[p]=l,s.uri=t.XMLNS,n.startPrefixMapping(p,l))}for(var o=e.length;o--;){s=e[o];var d=s.prefix;d&&(d===`xml`&&(s.uri=t.XML),d!==`xmlns`&&(s.uri=r[d||``]))}var u=i.indexOf(`:`);u>0?(d=e.prefix=i.slice(0,u),f=e.localName=i.slice(u+1)):(d=null,f=e.localName=i);var m=e.uri=r[d||``];if(n.startElement(m,f,i,e),e.closed){if(n.endElement(m,f,i),a)for(d in a)Object.prototype.hasOwnProperty.call(a,d)&&n.endPrefixMapping(d)}else return e.currentNSMap=r,e.localNSMap=a,!0}function y(e,t,n,r,i){if(/^(?:script|textarea)$/i.test(n)){var a=e.indexOf(`</`+n+`>`,t),o=e.substring(t+1,a);if(/[&<]/.test(o))return/^script$/i.test(n)?(i.characters(o,0,o.length),a):(o=o.replace(/&#?\w+;/g,r),i.characters(o,0,o.length),a)}return t+1}function b(e,t,n,r){var i=r[n];return i??(i=e.lastIndexOf(`</`+n+`>`),i<t&&(i=e.lastIndexOf(`</`+n)),r[n]=i),i<t}function x(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}function S(e,t,n,r){switch(e.charAt(t+2)){case`-`:if(e.charAt(t+3)===`-`){var i=e.indexOf(`-->`,t+4);return i>t?(n.comment(e,t+4,i-t-4),i+3):(r.error(`Unclosed comment`),-1)}else return-1;default:if(e.substr(t+3,6)==`CDATA[`){var i=e.indexOf(`]]>`,t+9);return n.startCDATA(),n.characters(e,t+9,i-t-9),n.endCDATA(),i+3}var a=T(e,t),o=a.length;if(o>1&&/!doctype/i.test(a[0][0])){var s=a[1][0],c=!1,l=!1;o>3&&(/^public$/i.test(a[2][0])?(c=a[3][0],l=o>4&&a[4][0]):/^system$/i.test(a[2][0])&&(l=a[3][0]));var u=a[o-1];return n.startDTD(s,c,l),n.endDTD(),u.index+u[0].length}}return-1}function C(e,t,n){var r=e.indexOf(`?>`,t);if(r){var i=e.substring(t,r).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);return i?(i[0].length,n.processingInstruction(i[1],i[2]),r+2):-1}return-1}function w(){this.attributeNames={}}w.prototype={setTagName:function(e){if(!i.test(e))throw Error(`invalid tagName:`+e);this.tagName=e},addValue:function(e,t,n){if(!i.test(e))throw Error(`invalid attribute:`+e);this.attributeNames[e]=this.length,this[this.length++]={qName:e,value:t,offset:n}},length:0,getLocalName:function(e){return this[e].localName},getLocator:function(e){return this[e].locator},getQName:function(e){return this[e].qName},getURI:function(e){return this[e].uri},getValue:function(e){return this[e].value}};function T(e,t){var n,r=[],i=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(i.lastIndex=t,i.exec(e);n=i.exec(e);)if(r.push(n),n[1])return r}e.XMLReader=m,e.ParseError=p})),Qc=o((e=>{var t=Jc(),n=Yc(),r=Xc(),i=Zc(),a=n.DOMImplementation,o=t.NAMESPACE,s=i.ParseError,c=i.XMLReader;function l(e){this.options=e||{locator:{}}}l.prototype.parseFromString=function(e,t){var n=this.options,i=new c,a=n.domBuilder||new d,s=n.errorHandler,l=n.locator,f=n.xmlns||{},p=/\/x?html?$/.test(t),m=p?r.HTML_ENTITIES:r.XML_ENTITIES;return l&&a.setDocumentLocator(l),i.errorHandler=u(s,a,l),i.domBuilder=n.domBuilder||a,p&&(f[``]=o.HTML),f.xml=f.xml||o.XML,e&&typeof e==`string`?i.parse(e,f,m):i.errorHandler.error(`invalid doc source`),a.doc};function u(e,t,n){if(!e){if(t instanceof d)return t;e=t}var r={},i=e instanceof Function;n||={};function a(t){var a=e[t];!a&&i&&(a=e.length==2?function(n){e(t,n)}:e),r[t]=a&&function(e){a(`[xmldom `+t+`]	`+e+p(n))}||function(){}}return a(`warning`),a(`error`),a(`fatalError`),r}function d(){this.cdata=!1}function f(e,t){t.lineNumber=e.lineNumber,t.columnNumber=e.columnNumber}d.prototype={startDocument:function(){this.doc=new a().createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(e,t,n,r){var i=this.doc,a=i.createElementNS(e,n||t),o=r.length;h(this,a),this.currentElement=a,this.locator&&f(this.locator,a);for(var s=0;s<o;s++){var e=r.getURI(s),c=r.getValue(s),n=r.getQName(s),l=i.createAttributeNS(e,n);this.locator&&f(r.getLocator(s),l),l.value=l.nodeValue=c,a.setAttributeNode(l)}},endElement:function(e,t,n){var r=this.currentElement;r.tagName,this.currentElement=r.parentNode},startPrefixMapping:function(e,t){},endPrefixMapping:function(e){},processingInstruction:function(e,t){var n=this.doc.createProcessingInstruction(e,t);this.locator&&f(this.locator,n),h(this,n)},ignorableWhitespace:function(e,t,n){},characters:function(e,t,n){if(e=m.apply(this,arguments),e){if(this.cdata)var r=this.doc.createCDATASection(e);else var r=this.doc.createTextNode(e);this.currentElement?this.currentElement.appendChild(r):/^\s*$/.test(e)&&this.doc.appendChild(r),this.locator&&f(this.locator,r)}},skippedEntity:function(e){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(e){(this.locator=e)&&(e.lineNumber=0)},comment:function(e,t,n){e=m.apply(this,arguments);var r=this.doc.createComment(e);this.locator&&f(this.locator,r),h(this,r)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(e,t,n){var r=this.doc.implementation;if(r&&r.createDocumentType){var i=r.createDocumentType(e,t,n);this.locator&&f(this.locator,i),h(this,i),this.doc.doctype=i}},warning:function(e){console.warn(`[xmldom warning]	`+e,p(this.locator))},error:function(e){console.error(`[xmldom error]	`+e,p(this.locator))},fatalError:function(e){throw new s(e,this.locator)}};function p(e){if(e)return`
@`+(e.systemId||``)+`#[line:`+e.lineNumber+`,col:`+e.columnNumber+`]`}function m(e,t,n){return typeof e==`string`?e.substr(t,n):e.length>=t+n||t?new java.lang.String(e,t,n)+``:e}`endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl`.replace(/\w+/g,function(e){d.prototype[e]=function(){return null}});function h(e,t){e.currentElement?e.currentElement.appendChild(t):e.doc.appendChild(t)}e.__DOMHandler=d,e.DOMParser=l,e.DOMImplementation=n.DOMImplementation,e.XMLSerializer=n.XMLSerializer})),$c=o((e=>{var t=Yc();e.DOMImplementation=t.DOMImplementation,e.XMLSerializer=t.XMLSerializer,e.DOMParser=Qc().DOMParser})),el=l(qc()),tl=s({RangeObject:()=>Gl,blob2base64:()=>Rl,borders:()=>yl,bounds:()=>vl,createBase64Url:()=>kl,createBlob:()=>El,createBlobUrl:()=>Dl,defaults:()=>pl,defer:()=>zl,documentHeight:()=>cl,extend:()=>ml,filterChildren:()=>Ul,findChildren:()=>Vl,getParentByTagName:()=>Wl,indexOfElementNode:()=>wl,indexOfNode:()=>Sl,indexOfSorted:()=>_l,indexOfTextNode:()=>Cl,insert:()=>hl,isElement:()=>ll,isFloat:()=>dl,isNumber:()=>ul,isXml:()=>Tl,locationOf:()=>gl,nodeBounds:()=>bl,parents:()=>Hl,parse:()=>jl,prefixed:()=>fl,qs:()=>Ml,qsa:()=>Nl,qsp:()=>Pl,querySelectorByType:()=>Bl,requestAnimationFrame:()=>rl,revokeBlobUrl:()=>Ol,sprint:()=>Fl,treeWalker:()=>Il,type:()=>Al,uuid:()=>sl,walk:()=>Ll,windowBounds:()=>xl}),nl=l($c());const rl=typeof window<`u`?window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame:!1;var il=1,al=3,ol=typeof URL<`u`?URL:typeof window<`u`?window.URL||window.webkitURL||window.mozURL:void 0;function sl(){var e=new Date().getTime();return`xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx`.replace(/[xy]/g,function(t){var n=(e+Math.random()*16)%16|0;return e=Math.floor(e/16),(t==`x`?n:n&7|8).toString(16)})}function cl(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function ll(e){return!!(e&&e.nodeType==1)}function ul(e){return!isNaN(parseFloat(e))&&isFinite(e)}function dl(e){let t=parseFloat(e);return ul(e)===!1?!1:typeof e==`string`&&e.indexOf(`.`)>-1?!0:Math.floor(t)!==t}function fl(e){var t=[`Webkit`,`webkit`,`Moz`,`O`,`ms`],n=[`-webkit-`,`-webkit-`,`-moz-`,`-o-`,`-ms-`],r=e.toLowerCase(),i=t.length;if(typeof document>`u`||document.body.style[r]!==void 0)return e;for(var a=0;a<i;a++)if(document.body.style[n[a]+r]!==void 0)return n[a]+r;return e}function pl(e){for(var t=1,n=arguments.length;t<n;t++){var r=arguments[t];for(var i in r)e[i]===void 0&&(e[i]=r[i])}return e}function ml(e){return[].slice.call(arguments,1).forEach(function(t){t&&Object.getOwnPropertyNames(t).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}),e}function hl(e,t,n){var r=gl(e,t,n);return t.splice(r,0,e),r}function gl(e,t,n,r,i){var a=r||0,o=i||t.length,s=parseInt(a+(o-a)/2),c;return n||=function(e,t){if(e>t)return 1;if(e<t)return-1;if(e==t)return 0},o-a<=0?s:(c=n(t[s],e),o-a===1?c>=0?s:s+1:c===0?s:c===-1?gl(e,t,n,s,o):gl(e,t,n,a,s))}function _l(e,t,n,r,i){var a=r||0,o=i||t.length,s=parseInt(a+(o-a)/2),c;return n||=function(e,t){if(e>t)return 1;if(e<t)return-1;if(e==t)return 0},o-a<=0?-1:(c=n(t[s],e),o-a===1?c===0?s:-1:c===0?s:c===-1?_l(e,t,n,s,o):_l(e,t,n,a,s))}function vl(e){var t=window.getComputedStyle(e),n=[`width`,`paddingRight`,`paddingLeft`,`marginRight`,`marginLeft`,`borderRightWidth`,`borderLeftWidth`],r=[`height`,`paddingTop`,`paddingBottom`,`marginTop`,`marginBottom`,`borderTopWidth`,`borderBottomWidth`],i=0,a=0;return n.forEach(function(e){i+=parseFloat(t[e])||0}),r.forEach(function(e){a+=parseFloat(t[e])||0}),{height:a,width:i}}function yl(e){var t=window.getComputedStyle(e),n=[`paddingRight`,`paddingLeft`,`marginRight`,`marginLeft`,`borderRightWidth`,`borderLeftWidth`],r=[`paddingTop`,`paddingBottom`,`marginTop`,`marginBottom`,`borderTopWidth`,`borderBottomWidth`],i=0,a=0;return n.forEach(function(e){i+=parseFloat(t[e])||0}),r.forEach(function(e){a+=parseFloat(t[e])||0}),{height:a,width:i}}function bl(e){let t,n=e.ownerDocument;if(e.nodeType==Node.TEXT_NODE){let r=n.createRange();r.selectNodeContents(e),t=r.getBoundingClientRect()}else t=e.getBoundingClientRect();return t}function xl(){var e=window.innerWidth,t=window.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function Sl(e,t){for(var n=e.parentNode.childNodes,r,i=-1,a=0;a<n.length&&(r=n[a],r.nodeType===t&&i++,r!=e);a++);return i}function Cl(e){return Sl(e,al)}function wl(e){return Sl(e,il)}function Tl(e){return[`xml`,`opf`,`ncx`].indexOf(e)>-1}function El(e,t){return new Blob([e],{type:t})}function Dl(e,t){var n,r=El(e,t);return n=ol.createObjectURL(r),n}function Ol(e){return ol.revokeObjectURL(e)}function kl(e,t){var n,r;if(typeof e==`string`)return n=btoa(e),r=`data:`+t+`;base64,`+n,r}function Al(e){return Object.prototype.toString.call(e).slice(8,-1)}function jl(e,t,n){var r,i=typeof DOMParser>`u`||n?nl.DOMParser:DOMParser;return e.charCodeAt(0)===65279&&(e=e.slice(1)),r=new i().parseFromString(e,t),r}function Ml(e,t){var n;if(!e)throw Error(`No Element Provided`);if(e.querySelector!==void 0)return e.querySelector(t);if(n=e.getElementsByTagName(t),n.length)return n[0]}function Nl(e,t){return e.querySelector===void 0?e.getElementsByTagName(t):e.querySelectorAll(t)}function Pl(e,t,n){var r,i;if(e.querySelector!==void 0){for(var a in t+=`[`,n)t+=a+`~='`+n[a]+`'`;return t+=`]`,e.querySelector(t)}else if(r=e.getElementsByTagName(t),i=Array.prototype.slice.call(r,0).filter(function(e){for(var t in n)if(e.getAttribute(t)===n[t])return!0;return!1}),i)return i[0]}function Fl(e,t){(e.ownerDocument||e).createTreeWalker===void 0?Ll(e,function(e){e&&e.nodeType===3&&t(e)},!0):Il(e,t,NodeFilter.SHOW_TEXT)}function Il(e,t,n){var r=document.createTreeWalker(e,n,null,!1);let i;for(;i=r.nextNode();)t(i)}function Ll(e,t){if(t(e))return!0;if(e=e.firstChild,e)do{if(Ll(e,t))return!0;e=e.nextSibling}while(e)}function Rl(e){return new Promise(function(t,n){var r=new FileReader;r.readAsDataURL(e),r.onloadend=function(){t(r.result)}})}function zl(){this.resolve=null,this.reject=null,this.id=sl(),this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),Object.freeze(this)}function Bl(e,t,n){var r;if(e.querySelector!==void 0&&(r=e.querySelector(`${t}[*|type="${n}"]`)),!r||r.length===0){r=Nl(e,t);for(var i=0;i<r.length;i++)if(r[i].getAttributeNS(`http://www.idpf.org/2007/ops`,`type`)===n||r[i].getAttribute(`epub:type`)===n)return r[i]}else return r}function Vl(e){for(var t=[],n=e.childNodes,r=0;r<n.length;r++){let e=n[r];e.nodeType===1&&t.push(e)}return t}function Hl(e){for(var t=[e];e;e=e.parentNode)t.unshift(e);return t}function Ul(e,t,n){for(var r=[],i=e.childNodes,a=0;a<i.length;a++){let e=i[a];if(e.nodeType===1&&e.nodeName.toLowerCase()===t){if(n)return e;r.push(e)}}if(!n)return r}function Wl(e,t){let n;if(!(e===null||t===``))for(n=e.parentNode;n.nodeType===1;){if(n.tagName.toLowerCase()===t)return n;n=n.parentNode}}var Gl=class{constructor(){this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}setStart(e,t){this.startContainer=e,this.startOffset=t,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}setEnd(e,t){this.endContainer=e,this.endOffset=t,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}collapse(e){this.collapsed=!0,e?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}selectNode(e){let t=e.parentNode,n=Array.prototype.indexOf.call(t.childNodes,e);this.setStart(t,n),this.setEnd(t,n+1)}selectNodeContents(e){e.childNodes[e.childNodes-1];let t=e.nodeType===3?e.textContent.length:parent.childNodes.length;this.setStart(e,0),this.setEnd(e,t)}_commonAncestorContainer(e,t){var n=Hl(e||this.startContainer),r=Hl(t||this.endContainer);if(n[0]==r[0]){for(var i=0;i<n.length;i++)if(n[i]!=r[i])return n[i-1]}}_checkCollapsed(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}toString(){}},Kl=o(((e,t)=>{if(!n)var n={cwd:function(){return`/`}};function r(e){if(typeof e!=`string`)throw TypeError(`Path must be a string. Received `+e)}function i(e,t){for(var n=``,r=-1,i=0,a,o=0;o<=e.length;++o){if(o<e.length)a=e.charCodeAt(o);else if(a===47)break;else a=47;if(a===47){if(!(r===o-1||i===1))if(r!==o-1&&i===2){if(n.length<2||n.charCodeAt(n.length-1)!==46||n.charCodeAt(n.length-2)!==46){if(n.length>2){for(var s=n.length-1,c=s;c>=0&&n.charCodeAt(c)!==47;--c);if(c!==s){n=c===-1?``:n.slice(0,c),r=o,i=0;continue}}else if(n.length===2||n.length===1){n=``,r=o,i=0;continue}}t&&(n.length>0?n+=`/..`:n=`..`)}else n.length>0?n+=`/`+e.slice(r+1,o):n=e.slice(r+1,o);r=o,i=0}else a===46&&i!==-1?++i:i=-1}return n}function a(e,t){var n=t.dir||t.root,r=t.base||(t.name||``)+(t.ext||``);return n?n===t.root?n+r:n+e+r:r}var o={resolve:function(){for(var e=``,t=!1,a,o=arguments.length-1;o>=-1&&!t;o--){var s;o>=0?s=arguments[o]:(a===void 0&&(a=n.cwd()),s=a),r(s),s.length!==0&&(e=s+`/`+e,t=s.charCodeAt(0)===47)}return e=i(e,!t),t?e.length>0?`/`+e:`/`:e.length>0?e:`.`},normalize:function(e){if(r(e),e.length===0)return`.`;var t=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=i(e,!t),e.length===0&&!t&&(e=`.`),e.length>0&&n&&(e+=`/`),t?`/`+e:e},isAbsolute:function(e){return r(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return`.`;for(var e,t=0;t<arguments.length;++t){var n=arguments[t];r(n),n.length>0&&(e===void 0?e=n:e+=`/`+n)}return e===void 0?`.`:o.normalize(e)},relative:function(e,t){if(r(e),r(t),e===t||(e=o.resolve(e),t=o.resolve(t),e===t))return``;for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,a=i-n,s=1;s<t.length&&t.charCodeAt(s)===47;++s);for(var c=t.length-s,l=a<c?a:c,u=-1,d=0;d<=l;++d){if(d===l){if(c>l){if(t.charCodeAt(s+d)===47)return t.slice(s+d+1);if(d===0)return t.slice(s+d)}else a>l&&(e.charCodeAt(n+d)===47?u=d:d===0&&(u=0));break}var f=e.charCodeAt(n+d),p=t.charCodeAt(s+d);if(f!==p)break;f===47&&(u=d)}var m=``;for(d=n+u+1;d<=i;++d)(d===i||e.charCodeAt(d)===47)&&(m.length===0?m+=`..`:m+=`/..`);return m.length>0?m+t.slice(s+u):(s+=u,t.charCodeAt(s)===47&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(r(e),e.length===0)return`.`;for(var t=e.charCodeAt(0),n=t===47,i=-1,a=!0,o=e.length-1;o>=1;--o)if(t=e.charCodeAt(o),t===47){if(!a){i=o;break}}else a=!1;return i===-1?n?`/`:`.`:n&&i===1?`//`:e.slice(0,i)},basename:function(e,t){if(t!==void 0&&typeof t!=`string`)throw TypeError(`"ext" argument must be a string`);r(e);var n=0,i=-1,a=!0,o;if(t!==void 0&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return``;var s=t.length-1,c=-1;for(o=e.length-1;o>=0;--o){var l=e.charCodeAt(o);if(l===47){if(!a){n=o+1;break}}else c===-1&&(a=!1,c=o+1),s>=0&&(l===t.charCodeAt(s)?--s===-1&&(i=o):(s=-1,i=c))}return n===i?i=c:i===-1&&(i=e.length),e.slice(n,i)}else{for(o=e.length-1;o>=0;--o)if(e.charCodeAt(o)===47){if(!a){n=o+1;break}}else i===-1&&(a=!1,i=o+1);return i===-1?``:e.slice(n,i)}},extname:function(e){r(e);for(var t=-1,n=0,i=-1,a=!0,o=0,s=e.length-1;s>=0;--s){var c=e.charCodeAt(s);if(c===47){if(!a){n=s+1;break}continue}i===-1&&(a=!1,i=s+1),c===46?t===-1?t=s:o!==1&&(o=1):t!==-1&&(o=-1)}return t===-1||i===-1||o===0||o===1&&t===i-1&&t===n+1?``:e.slice(t,i)},format:function(e){if(typeof e!=`object`||!e)throw TypeError(`Parameter "pathObject" must be an object, not `+typeof e);return a(`/`,e)},parse:function(e){r(e);var t={root:``,dir:``,base:``,ext:``,name:``};if(e.length===0)return t;var n=e.charCodeAt(0),i=n===47,a;i?(t.root=`/`,a=1):a=0;for(var o=-1,s=0,c=-1,l=!0,u=e.length-1,d=0;u>=a;--u){if(n=e.charCodeAt(u),n===47){if(!l){s=u+1;break}continue}c===-1&&(l=!1,c=u+1),n===46?o===-1?o=u:d!==1&&(d=1):o!==-1&&(d=-1)}return o===-1||c===-1||d===0||d===1&&o===c-1&&o===s+1?c!==-1&&(s===0&&i?t.base=t.name=e.slice(1,c):t.base=t.name=e.slice(s,c)):(s===0&&i?(t.name=e.slice(1,o),t.base=e.slice(1,c)):(t.name=e.slice(s,o),t.base=e.slice(s,c)),t.ext=e.slice(o,c)),s>0?t.dir=e.slice(0,s-1):i&&(t.dir=`/`),t},sep:`/`,delimiter:`:`,posix:null};t.exports=o})),ql=l(Kl()),Jl=class{constructor(e){var t=e.indexOf(`://`),n;t>-1&&(e=new URL(e).pathname),n=this.parse(e),this.path=e,this.isDirectory(e)?this.directory=e:this.directory=n.dir+`/`,this.filename=n.base,this.extension=n.ext.slice(1)}parse(e){return ql.default.parse(e)}isAbsolute(e){return ql.default.isAbsolute(e||this.path)}isDirectory(e){return e.charAt(e.length-1)===`/`}resolve(e){return ql.default.resolve(this.directory,e)}relative(e){return e&&e.indexOf(`://`)>-1?e:ql.default.relative(this.directory,e)}splitPath(e){return this.splitPathRe.exec(e).slice(1)}toString(){return this.path}},Yl=l(Kl()),Xl=class{constructor(e,t){var n=e.indexOf(`://`)>-1,r=e,i;if(this.Url=void 0,this.href=e,this.protocol=``,this.origin=``,this.hash=``,this.hash=``,this.search=``,this.base=t,!n&&t!==!1&&typeof t!=`string`&&window&&window.location&&(this.base=window.location.href),n||this.base)try{this.base?this.Url=new URL(e,this.base):this.Url=new URL(e),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,r=this.Url.pathname+(this.Url.search?this.Url.search:``)}catch{this.Url=void 0,this.base&&(i=new Jl(this.base),r=i.resolve(r))}this.Path=new Jl(r),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}path(){return this.Path}resolve(e){var t=e.indexOf(`://`)>-1,n;return t?e:(n=Yl.default.resolve(this.directory,e),this.origin+n)}relative(e){return Yl.default.relative(e,this.directory)}toString(){return this.href}},Zl=1,Ql=3,$l=9,eu=class e{constructor(t,n,r){var i;if(this.str=``,this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof e))return new e(t,n,r);if(typeof n==`string`?this.base=this.parseComponent(n):typeof n==`object`&&n.steps&&(this.base=n),i=this.checkType(t),i===`string`)return this.str=t,ml(this,this.parse(t));if(i===`range`)return ml(this,this.fromRange(t,this.base,r));if(i===`node`)return ml(this,this.fromNode(t,this.base,r));if(i===`EpubCFI`&&t.path)return t;if(t)throw TypeError(`not a valid argument for EpubCFI`);return this}checkType(t){return this.isCfiString(t)?`string`:t&&typeof t==`object`&&(Al(t)===`Range`||t.startContainer!==void 0)?`range`:t&&typeof t==`object`&&t.nodeType!==void 0?`node`:t&&typeof t==`object`&&t instanceof e?`EpubCFI`:!1}parse(e){var t={spinePos:-1,range:!1,base:{},path:{},start:null,end:null},n,r,i;return typeof e!=`string`||(e.indexOf(`epubcfi(`)===0&&e[e.length-1]===`)`&&(e=e.slice(8,e.length-1)),n=this.getChapterComponent(e),!n)?{spinePos:-1}:(t.base=this.parseComponent(n),r=this.getPathComponent(e),t.path=this.parseComponent(r),i=this.getRange(e),i&&(t.range=!0,t.start=this.parseComponent(i[0]),t.end=this.parseComponent(i[1])),t.spinePos=t.base.steps[1].index,t)}parseComponent(e){var t={steps:[],terminal:{offset:null,assertion:null}},n=e.split(`:`),r=n[0].split(`/`),i;return n.length>1&&(i=n[1],t.terminal=this.parseTerminal(i)),r[0]===``&&r.shift(),t.steps=r.map(function(e){return this.parseStep(e)}.bind(this)),t}parseStep(e){var t,n,r,i=e.match(/\[(.*)\]/),a;if(i&&i[1]&&(a=i[1]),n=parseInt(e),!isNaN(n))return n%2==0?(t=`element`,r=n/2-1):(t=`text`,r=(n-1)/2),{type:t,index:r,id:a||null}}parseTerminal(e){var t,n,r=e.match(/\[(.*)\]/);return r&&r[1]?(t=parseInt(e.split(`[`)[0]),n=r[1]):t=parseInt(e),ul(t)||(t=null),{offset:t,assertion:n}}getChapterComponent(e){return e.split(`!`)[0]}getPathComponent(e){var t=e.split(`!`);if(t[1])return t[1].split(`,`)[0]}getRange(e){var t=e.split(`,`);return t.length===3?[t[1],t[2]]:!1}getCharecterOffsetComponent(e){return e.split(`:`)[1]||``}joinSteps(e){return e?e.map(function(e){var t=``;return e.type===`element`&&(t+=(e.index+1)*2),e.type===`text`&&(t+=1+2*e.index),e.id&&(t+=`[`+e.id+`]`),t}).join(`/`):``}segmentString(e){var t=`/`;return t+=this.joinSteps(e.steps),e.terminal&&e.terminal.offset!=null&&(t+=`:`+e.terminal.offset),e.terminal&&e.terminal.assertion!=null&&(t+=`[`+e.terminal.assertion+`]`),t}toString(){var e=`epubcfi(`;return e+=this.segmentString(this.base),e+=`!`,e+=this.segmentString(this.path),this.range&&this.start&&(e+=`,`,e+=this.segmentString(this.start)),this.range&&this.end&&(e+=`,`,e+=this.segmentString(this.end)),e+=`)`,e}compare(t,n){var r,i,a,o;if(typeof t==`string`&&(t=new e(t)),typeof n==`string`&&(n=new e(n)),t.spinePos>n.spinePos)return 1;if(t.spinePos<n.spinePos)return-1;t.range?(r=t.path.steps.concat(t.start.steps),a=t.start.terminal):(r=t.path.steps,a=t.path.terminal),n.range?(i=n.path.steps.concat(n.start.steps),o=n.start.terminal):(i=n.path.steps,o=n.path.terminal);for(var s=0;s<r.length;s++){if(!r[s])return-1;if(!i[s]||r[s].index>i[s].index)return 1;if(r[s].index<i[s].index)return-1}return r.length<i.length?-1:a.offset>o.offset?1:a.offset<o.offset?-1:0}step(e){var t=e.nodeType===Ql?`text`:`element`;return{id:e.id,tagName:e.tagName,type:t,index:this.position(e)}}filteredStep(e,t){var n=this.filter(e,t),r;if(n)return r=n.nodeType===Ql?`text`:`element`,{id:n.id,tagName:n.tagName,type:r,index:this.filteredPosition(n,t)}}pathTo(e,t,n){for(var r={steps:[],terminal:{offset:null,assertion:null}},i=e,a;i&&i.parentNode&&i.parentNode.nodeType!=$l;)a=n?this.filteredStep(i,n):this.step(i),a&&r.steps.unshift(a),i=i.parentNode;return t!=null&&t>=0&&(r.terminal.offset=t,r.steps[r.steps.length-1].type!=`text`&&r.steps.push({type:`text`,index:0})),r}equalStep(e,t){return!e||!t?!1:e.index===t.index&&e.id===t.id&&e.type===t.type}fromRange(e,t,n){var r={range:!1,base:{},path:{},start:null,end:null},i=e.startContainer,a=e.endContainer,o=e.startOffset,s=e.endOffset,c=!1;if(n&&(c=i.ownerDocument.querySelector(`.`+n)!=null),typeof t==`string`?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):typeof t==`object`&&(r.base=t),e.collapsed)c&&(o=this.patchOffset(i,o,n)),r.path=this.pathTo(i,o,n);else{r.range=!0,c&&(o=this.patchOffset(i,o,n)),r.start=this.pathTo(i,o,n),c&&(s=this.patchOffset(a,s,n)),r.end=this.pathTo(a,s,n),r.path={steps:[],terminal:null};var l=r.start.steps.length,u;for(u=0;u<l&&this.equalStep(r.start.steps[u],r.end.steps[u]);u++)u===l-1?r.start.terminal===r.end.terminal&&(r.path.steps.push(r.start.steps[u]),r.range=!1):r.path.steps.push(r.start.steps[u]);r.start.steps=r.start.steps.slice(r.path.steps.length),r.end.steps=r.end.steps.slice(r.path.steps.length)}return r}fromNode(e,t,n){var r={range:!1,base:{},path:{},start:null,end:null};return typeof t==`string`?(r.base=this.parseComponent(t),r.spinePos=r.base.steps[1].index):typeof t==`object`&&(r.base=t),r.path=this.pathTo(e,null,n),r}filter(e,t){var n,r,i,a,o,s=!1;return e.nodeType===Ql?(s=!0,i=e.parentNode,n=e.parentNode.classList.contains(t)):(s=!1,n=e.classList.contains(t)),n&&s?(a=i.previousSibling,o=i.nextSibling,a&&a.nodeType===Ql?r=a:o&&o.nodeType===Ql&&(r=o),r||e):n&&!s?!1:e}patchOffset(e,t,n){if(e.nodeType!=Ql)throw Error(`Anchor must be a text node`);var r=e,i=t;for(e.parentNode.classList.contains(n)&&(r=e.parentNode);r.previousSibling;){if(r.previousSibling.nodeType===Zl)if(r.previousSibling.classList.contains(n))i+=r.previousSibling.textContent.length;else break;else i+=r.previousSibling.textContent.length;r=r.previousSibling}return i}normalizedMap(e,t,n){var r={},i=-1,a,o=e.length,s,c;for(a=0;a<o;a++)s=e[a].nodeType,s===Zl&&e[a].classList.contains(n)&&(s=Ql),a>0&&s===Ql&&c===Ql?r[a]=i:t===s&&(i+=1,r[a]=i),c=s;return r}position(e){var t,n;return e.nodeType===Zl?(t=e.parentNode.children,t||=Vl(e.parentNode),n=Array.prototype.indexOf.call(t,e)):(t=this.textNodes(e.parentNode),n=t.indexOf(e)),n}filteredPosition(e,t){var n,r,i;return e.nodeType===Zl?(n=e.parentNode.children,i=this.normalizedMap(n,Zl,t)):(n=e.parentNode.childNodes,e.parentNode.classList.contains(t)&&(e=e.parentNode,n=e.parentNode.childNodes),i=this.normalizedMap(n,Ql,t)),r=Array.prototype.indexOf.call(n,e),i[r]}stepsToXpath(e){var t=[`.`,`*`];return e.forEach(function(e){var n=e.index+1;e.id?t.push(`*[position()=`+n+` and @id='`+e.id+`']`):e.type===`text`?t.push(`text()[`+n+`]`):t.push(`*[`+n+`]`)}),t.join(`/`)}stepsToQuerySelector(e){var t=[`html`];return e.forEach(function(e){var n=e.index+1;e.id?t.push(`#`+e.id):e.type===`text`||t.push(`*:nth-child(`+n+`)`)}),t.join(`>`)}textNodes(e,t){return Array.prototype.slice.call(e.childNodes).filter(function(e){return e.nodeType===Ql?!0:!!(t&&e.classList.contains(t))})}walkToNode(e,t,n){var r=t||document,i=r.documentElement,a,o,s=e.length,c;for(c=0;c<s&&(o=e[c],o.type===`element`?o.id?i=r.getElementById(o.id):(a=i.children||Vl(i),i=a[o.index]):o.type===`text`&&(i=this.textNodes(i,n)[o.index]),i);c++);return i}findNode(e,t,n){var r=t||document,i,a;return!n&&r.evaluate!==void 0?(a=this.stepsToXpath(e),i=r.evaluate(a,r,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue):i=n?this.walkToNode(e,r,n):this.walkToNode(e,r),i}fixMiss(e,t,n,r){var i=this.findNode(e.slice(0,-1),n,r),a=i.childNodes,o=this.normalizedMap(a,Ql,r),s,c,l=e[e.length-1].index;for(let e in o){if(!o.hasOwnProperty(e))return;if(o[e]===l)if(s=a[e],c=s.textContent.length,t>c)t-=c;else{i=s.nodeType===Zl?s.childNodes[0]:s;break}}return{container:i,offset:t}}toRange(e,t){var n=e||document,r,i,a,o,s,c=this,l,u,d=t?n.querySelector(`.`+t)!=null:!1,f;if(r=n.createRange===void 0?new Gl:n.createRange(),c.range?(i=c.start,l=c.path.steps.concat(i.steps),o=this.findNode(l,n,d?t:null),a=c.end,u=c.path.steps.concat(a.steps),s=this.findNode(u,n,d?t:null)):(i=c.path,l=c.path.steps,o=this.findNode(c.path.steps,n,d?t:null)),o)try{i.terminal.offset==null?r.setStart(o,0):r.setStart(o,i.terminal.offset)}catch{f=this.fixMiss(l,i.terminal.offset,n,d?t:null),r.setStart(f.container,f.offset)}else return console.log(`No startContainer found for`,this.toString()),null;if(s)try{a.terminal.offset==null?r.setEnd(s,0):r.setEnd(s,a.terminal.offset)}catch{f=this.fixMiss(u,c.end.terminal.offset,n,d?t:null),r.setEnd(f.container,f.offset)}return r}isCfiString(e){return typeof e==`string`&&e.indexOf(`epubcfi(`)===0&&e[e.length-1]===`)`}generateChapterComponent(e,t,n){var r=parseInt(t),i=`/`+(e+1)*2+`/`;return i+=(r+1)*2,n&&(i+=`[`+n+`]`),i}collapse(e){this.range&&(this.range=!1,e?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}},tu=class{constructor(e){this.context=e||this,this.hooks=[]}register(){for(var e=0;e<arguments.length;++e)if(typeof arguments[e]==`function`)this.hooks.push(arguments[e]);else for(var t=0;t<arguments[e].length;++t)this.hooks.push(arguments[e][t])}deregister(e){let t;for(let n=0;n<this.hooks.length;n++)if(t=this.hooks[n],t===e){this.hooks.splice(n,1);break}}trigger(){var e=arguments,t=this.context,n=[];return this.hooks.forEach(function(r){try{var i=r.apply(t,e)}catch(e){console.log(e)}i&&typeof i.then==`function`&&n.push(i)}),Promise.all(n)}list(){return this.hooks}clear(){return this.hooks=[]}};function nu(e,t){var n,r,i=t.url,a=i.indexOf(`://`)>-1;e&&(r=Ml(e,`head`),n=Ml(r,`base`),n||(n=e.createElement(`base`),r.insertBefore(n,r.firstChild)),!a&&window&&window.location&&(i=window.location.origin+i),n.setAttribute(`href`,i))}function ru(e,t){var n,r,i=t.canonical;e&&(n=Ml(e,`head`),r=Ml(n,`link[rel='canonical']`),r?r.setAttribute(`href`,i):(r=e.createElement(`link`),r.setAttribute(`rel`,`canonical`),r.setAttribute(`href`,i),n.appendChild(r)))}function iu(e,t){var n,r,i=t.idref;e&&(n=Ml(e,`head`),r=Ml(n,`link[property='dc.identifier']`),r?r.setAttribute(`content`,i):(r=e.createElement(`meta`),r.setAttribute(`name`,`dc.identifier`),r.setAttribute(`content`,i),n.appendChild(r)))}function au(e,t){var n=e.querySelectorAll(`a[href]`);if(n.length)for(var r=Ml(e.ownerDocument,`base`),i=r?r.getAttribute(`href`):void 0,a=function(e){var n=e.getAttribute(`href`);if(n.indexOf(`mailto:`)!==0)if(n.indexOf(`://`)>-1)e.setAttribute(`target`,`_blank`);else{var r;try{r=new Xl(n,i)}catch{}e.onclick=function(){return r&&r.hash?t(r.Path.path+r.hash):t(r?r.Path.path:n),!1}}}.bind(this),o=0;o<n.length;o++)a(n[o])}function ou(e,t,n){return t.forEach(function(t,r){t&&n[r]&&(t=t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,`\\$&`),e=e.replace(new RegExp(t,`g`),n[r]))}),e}function su(e,t,n,r){var i=typeof window<`u`?window.URL:!1,a=i?`blob`:`arraybuffer`,o=new zl,s=new XMLHttpRequest,c=XMLHttpRequest.prototype,l;for(l in`overrideMimeType`in c||Object.defineProperty(c,`overrideMimeType`,{value:function(){}}),n&&(s.withCredentials=!0),s.onreadystatechange=d,s.onerror=u,s.open(`GET`,e,!0),r)s.setRequestHeader(l,r[l]);t==`json`&&s.setRequestHeader(`Accept`,`application/json`),t||=new Jl(e).extension,t==`blob`&&(s.responseType=a),Tl(t)&&s.overrideMimeType(`text/xml`),t==`binary`&&(s.responseType=`arraybuffer`),s.send();function u(e){o.reject(e)}function d(){if(this.readyState===XMLHttpRequest.DONE){var e=!1;if((this.responseType===``||this.responseType===`document`)&&(e=this.responseXML),this.status===200||this.status===0||e){var n;if(!this.response&&!e)return o.reject({status:this.status,message:`Empty Response`,stack:Error().stack}),o.promise;if(this.status===403)return o.reject({status:this.status,response:this.response,message:`Forbidden`,stack:Error().stack}),o.promise;n=e?this.responseXML:Tl(t)?jl(this.response,`text/xml`):t==`xhtml`?jl(this.response,`application/xhtml+xml`):t==`html`||t==`htm`?jl(this.response,`text/html`):t==`json`?JSON.parse(this.response):t==`blob`?i?this.response:new Blob([this.response]):this.response,o.resolve(n)}else o.reject({status:this.status,message:this.response,stack:Error().stack})}}return o.promise}var cu=su,lu=l($c()),uu=class{constructor(e,t){this.idref=e.idref,this.linear=e.linear===`yes`,this.properties=e.properties,this.index=e.index,this.href=e.href,this.url=e.url,this.canonical=e.canonical,this.next=e.next,this.prev=e.prev,this.cfiBase=e.cfiBase,t?this.hooks=t:(this.hooks={},this.hooks.serialize=new tu(this),this.hooks.content=new tu(this)),this.document=void 0,this.contents=void 0,this.output=void 0}load(e){var t=e||this.request||cu,n=new zl,r=n.promise;return this.contents?n.resolve(this.contents):t(this.url).then(function(e){return this.document=e,this.contents=e.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){n.resolve(this.contents)}.bind(this)).catch(function(e){n.reject(e)}),r}base(){return nu(this.document,this)}render(e){var t=new zl,n=t.promise;return this.output,this.load(e).then(function(e){var t=(typeof navigator<`u`&&navigator.userAgent||``).indexOf(`Trident`)>=0;return this.output=new(typeof XMLSerializer>`u`||t?lu.DOMParser:XMLSerializer)().serializeToString(e),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){t.resolve(this.output)}.bind(this)).catch(function(e){t.reject(e)}),n}find(e){var t=this,n=[],r=e.toLowerCase(),i=function(e){for(var i=e.textContent.toLowerCase(),a=t.document.createRange(),o,s,c=-1,l,u=150;s!=-1;)s=i.indexOf(r,c+1),s!=-1&&(a=t.document.createRange(),a.setStart(e,s),a.setEnd(e,s+r.length),o=t.cfiFromRange(a),e.textContent.length<u?l=e.textContent:(l=e.textContent.substring(s-u/2,s+u/2),l=`...`+l+`...`),n.push({cfi:o,excerpt:l})),c=s};return Fl(t.document,function(e){i(e)}),n}search(e,t=5){if(document.createTreeWalker===void 0)return this.find(e);let n=[],r=this,i=e.toLowerCase(),a=function(e){let t=e.reduce((e,t)=>e+t.textContent,``).toLowerCase().indexOf(i);if(t!=-1){let a=t+i.length,o=0,s=0;if(t<e[0].length){let i;for(;o<e.length-1&&(s+=e[o].length,!(a<=s));)o+=1;let c=e[0],l=e[o],u=r.document.createRange();u.setStart(c,t);let d=e.slice(0,o).reduce((e,t)=>e+t.textContent.length,0);u.setEnd(l,d>a?a:a-d),i=r.cfiFromRange(u);let f=e.slice(0,o+1).reduce((e,t)=>e+t.textContent,``);f.length>150&&(f=f.substring(t-150/2,t+150/2),f=`...`+f+`...`),n.push({cfi:i,excerpt:f})}}},o=document.createTreeWalker(r.document,NodeFilter.SHOW_TEXT,null,!1),s,c=[];for(;s=o.nextNode();)c.push(s),c.length==t&&(a(c.slice(0,t)),c=c.slice(1,t));return c.length>0&&a(c),n}reconcileLayoutSettings(e){var t={layout:e.layout,spread:e.spread,orientation:e.orientation};return this.properties.forEach(function(e){var n=e.replace(`rendition:`,``),r=n.indexOf(`-`),i,a;r!=-1&&(i=n.slice(0,r),a=n.slice(r+1),t[i]=a)}),t}cfiFromRange(e){return new eu(e,this.cfiBase).toString()}cfiFromElement(e){return new eu(e,this.cfiBase).toString()}unload(){this.document=void 0,this.contents=void 0,this.output=void 0}destroy(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}},du=class{constructor(){this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new tu,this.hooks.content=new tu,this.hooks.content.register(nu),this.hooks.content.register(ru),this.hooks.content.register(iu),this.epubcfi=new eu,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}unpack(e,t,n){this.items=e.spine,this.manifest=e.manifest,this.spineNodeIndex=e.spineNodeIndex,this.baseUrl=e.baseUrl||e.basePath||``,this.length=this.items.length,this.items.forEach((e,r)=>{var i=this.manifest[e.idref],a;e.index=r,e.cfiBase=this.epubcfi.generateChapterComponent(this.spineNodeIndex,e.index,e.id),e.href&&(e.url=t(e.href,!0),e.canonical=n(e.href)),i&&(e.href=i.href,e.url=t(e.href,!0),e.canonical=n(e.href),i.properties.length&&e.properties.push.apply(e.properties,i.properties)),e.linear===`yes`?(e.prev=function(){let t=e.index;for(;t>0;){let e=this.get(t-1);if(e&&e.linear)return e;--t}}.bind(this),e.next=function(){let t=e.index;for(;t<this.spineItems.length-1;){let e=this.get(t+1);if(e&&e.linear)return e;t+=1}}.bind(this)):(e.prev=function(){},e.next=function(){}),a=new uu(e,this.hooks),this.append(a)}),this.loaded=!0}get(e){var t=0;if(e===void 0)for(;t<this.spineItems.length;){let e=this.spineItems[t];if(e&&e.linear)break;t+=1}else this.epubcfi.isCfiString(e)?t=new eu(e).spinePos:typeof e==`number`||isNaN(e)===!1?t=e:typeof e==`string`&&e.indexOf(`#`)===0?t=this.spineById[e.substring(1)]:typeof e==`string`&&(e=e.split(`#`)[0],t=this.spineByHref[e]||this.spineByHref[encodeURI(e)]);return this.spineItems[t]||null}append(e){var t=this.spineItems.length;return e.index=t,this.spineItems.push(e),this.spineByHref[decodeURI(e.href)]=t,this.spineByHref[encodeURI(e.href)]=t,this.spineByHref[e.href]=t,this.spineById[e.idref]=t,t}prepend(e){return this.spineByHref[e.href]=0,this.spineById[e.idref]=0,this.spineItems.forEach(function(e,t){e.index=t}),0}remove(e){var t=this.spineItems.indexOf(e);if(t>-1)return delete this.spineByHref[e.href],delete this.spineById[e.idref],this.spineItems.splice(t,1)}each(){return this.spineItems.forEach.apply(this.spineItems,arguments)}first(){let e=0;do{let t=this.get(e);if(t&&t.linear)return t;e+=1}while(e<this.spineItems.length)}last(){let e=this.spineItems.length-1;do{let t=this.get(e);if(t&&t.linear)return t;--e}while(e>=0)}destroy(){this.each(e=>e.destroy()),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}},fu=class{constructor(e){this._q=[],this.context=e,this.tick=rl,this.running=!1,this.paused=!1}enqueue(){var e,t,n,r=[].shift.call(arguments),i=arguments;if(!r)throw Error(`No Task Provided`);return typeof r==`function`?(e=new zl,t=e.promise,n={task:r,args:i,deferred:e,promise:t}):n={promise:r},this._q.push(n),this.paused==0&&!this.running&&this.run(),n.promise}dequeue(){var e,t,n;if(this._q.length&&!this.paused){if(e=this._q.shift(),t=e.task,t)return n=t.apply(this.context,e.args),n&&typeof n.then==`function`?n.then(function(){e.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){e.deferred.reject.apply(this.context,arguments)}.bind(this)):(e.deferred.resolve.apply(this.context,n),e.promise);if(e.promise)return e.promise}else return e=new zl,e.deferred.resolve(),e.promise}dump(){for(;this._q.length;)this.dequeue()}run(){return this.running||(this.running=!0,this.defered=new zl),this.tick.call(window,()=>{this._q.length?this.dequeue().then(function(){this.run()}.bind(this)):(this.defered.resolve(),this.running=void 0)}),this.paused==1&&(this.paused=!1),this.defered.promise}flush(){if(this.running)return this.running;if(this._q.length)return this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running}clear(){this._q=[]}length(){return this._q.length}pause(){this.paused=!0}stop(){this._q=[],this.running=!1,this.paused=!0}};const pu=[`keydown`,`keyup`,`keypressed`,`mouseup`,`mousedown`,`mousemove`,`click`,`touchend`,`touchstart`,`touchmove`],$={BOOK:{OPEN_FAILED:`openFailed`},CONTENTS:{EXPAND:`expand`,RESIZE:`resize`,SELECTED:`selected`,SELECTED_RANGE:`selectedRange`,LINK_CLICKED:`linkClicked`},LOCATIONS:{CHANGED:`changed`},MANAGERS:{RESIZE:`resize`,RESIZED:`resized`,ORIENTATION_CHANGE:`orientationchange`,ADDED:`added`,SCROLL:`scroll`,SCROLLED:`scrolled`,REMOVED:`removed`},VIEWS:{AXIS:`axis`,WRITING_MODE:`writingMode`,LOAD_ERROR:`loaderror`,RENDERED:`rendered`,RESIZED:`resized`,DISPLAYED:`displayed`,SHOWN:`shown`,HIDDEN:`hidden`,MARK_CLICKED:`markClicked`},RENDITION:{STARTED:`started`,ATTACHED:`attached`,DISPLAYED:`displayed`,DISPLAY_ERROR:`displayerror`,RENDERED:`rendered`,REMOVED:`removed`,RESIZED:`resized`,ORIENTATION_CHANGE:`orientationchange`,LOCATION_CHANGED:`locationChanged`,RELOCATED:`relocated`,MARK_CLICKED:`markClicked`,SELECTED:`selected`,LAYOUT:`layout`},LAYOUT:{UPDATED:`updated`},ANNOTATION:{ATTACH:`attach`,DETACH:`detach`}};var mu=class{constructor(e,t,n){this.spine=e,this.request=t,this.pause=n||100,this.q=new fu(this),this.epubcfi=new eu,this._locations=[],this._locationsWords=[],this.total=0,this.break=150,this._current=0,this._wordCounter=0,this.currentLocation=``,this._currentCfi=``,this.processingTimeout=void 0}generate(e){return e&&(this.break=e),this.q.pause(),this.spine.each(function(e){e.linear&&this.q.enqueue(this.process.bind(this),e)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}createRange(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}process(e){return e.load(this.request).then(function(t){var n=new zl,r=this.parse(t,e.cfiBase);return this._locations=this._locations.concat(r),e.unload(),this.processingTimeout=setTimeout(()=>n.resolve(r),this.pause),n.promise}.bind(this))}parse(e,t,n){var r=[],i,a=e.ownerDocument,o=Ml(a,`body`),s=0,c,l=n||this.break;if(Fl(o,function(e){var n=e.length,a,o=0;if(e.textContent.trim().length===0)return!1;for(s==0&&(i=this.createRange(),i.startContainer=e,i.startOffset=0),a=l-s,a>n&&(s+=n,o=n);o<n;)if(a=l-s,s===0&&(o+=1,i=this.createRange(),i.startContainer=e,i.startOffset=o),o+a>=n)s+=n-o,o=n;else{o+=a,i.endContainer=e,i.endOffset=o;let n=new eu(i,t).toString();r.push(n),s=0}c=e}.bind(this)),i&&i.startContainer&&c){i.endContainer=c,i.endOffset=c.length;let e=new eu(i,t).toString();r.push(e),s=0}return r}generateFromWords(e,t,n){var r=e?new eu(e):void 0;return this.q.pause(),this._locationsWords=[],this._wordCounter=0,this.spine.each(function(e){e.linear&&(r?e.index>=r.spinePos&&this.q.enqueue(this.processWords.bind(this),e,t,r,n):this.q.enqueue(this.processWords.bind(this),e,t,r,n))}.bind(this)),this.q.run().then(function(){return this._currentCfi&&(this.currentLocation=this._currentCfi),this._locationsWords}.bind(this))}processWords(e,t,n,r){return r&&this._locationsWords.length>=r?Promise.resolve():e.load(this.request).then(function(i){var a=new zl,o=this.parseWords(i,e,t,n),s=r-this._locationsWords.length;return this._locationsWords=this._locationsWords.concat(o.length>=r?o.slice(0,s):o),e.unload(),this.processingTimeout=setTimeout(()=>a.resolve(o),this.pause),a.promise}.bind(this))}countWords(e){return e=e.replace(/(^\s*)|(\s*$)/gi,``),e=e.replace(/[ ]{2,}/gi,` `),e=e.replace(/\n /,`
`),e.split(` `).length}parseWords(e,t,n,r){var i=t.cfiBase,a=[],o=e.ownerDocument,s=Ml(o,`body`),c=n,l=r?r.spinePos!==t.index:!0,u;return r&&t.index===r.spinePos&&(u=r.findNode(r.range?r.path.steps.concat(r.start.steps):r.path.steps,e.ownerDocument)),Fl(s,function(e){if(!l)if(e===u)l=!0;else return!1;if(e.textContent.length<10&&e.textContent.trim().length===0)return!1;var t=this.countWords(e.textContent),n,r=0;if(t===0)return!1;for(n=c-this._wordCounter,n>t&&(this._wordCounter+=t,r=t);r<t;)if(n=c-this._wordCounter,r+n>=t)this._wordCounter+=t-r,r=t;else{r+=n;let t=new eu(e,i);a.push({cfi:t.toString(),wordCount:this._wordCounter}),this._wordCounter=0}}.bind(this)),a}locationFromCfi(e){let t;return eu.prototype.isCfiString(e)&&(e=new eu(e)),this._locations.length===0?-1:(t=gl(e,this._locations,this.epubcfi.compare),t>this.total?this.total:t)}percentageFromCfi(e){if(this._locations.length===0)return null;var t=this.locationFromCfi(e);return this.percentageFromLocation(t)}percentageFromLocation(e){return!e||!this.total?0:e/this.total}cfiFromLocation(e){var t=-1;return typeof e!=`number`&&(e=parseInt(e)),e>=0&&e<this._locations.length&&(t=this._locations[e]),t}cfiFromPercentage(e){let t;if(e>1&&console.warn(`Normalize cfiFromPercentage value to between 0 - 1`),e>=1){let e=new eu(this._locations[this.total]);return e.collapse(),e.toString()}return t=Math.ceil(this.total*e),this.cfiFromLocation(t)}load(e){return typeof e==`string`?this._locations=JSON.parse(e):this._locations=e,this.total=this._locations.length-1,this._locations}save(){return JSON.stringify(this._locations)}getCurrent(){return this._current}setCurrent(e){var t;if(typeof e==`string`)this._currentCfi=e;else if(typeof e==`number`)this._current=e;else return;this._locations.length!==0&&(typeof e==`string`?(t=this.locationFromCfi(e),this._current=t):t=e,this.emit($.LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(t)}))}get currentLocation(){return this._current}set currentLocation(e){this.setCurrent(e)}length(){return this._locations.length}destroy(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}};(0,el.default)(mu.prototype);var hu=mu,gu=l(Kl()),_u=class{constructor(e){this.packagePath=``,this.directory=``,this.encoding=``,e&&this.parse(e)}parse(e){var t;if(!e)throw Error(`Container File Not Found`);if(t=Ml(e,`rootfile`),!t)throw Error(`No RootFile Found`);this.packagePath=t.getAttribute(`full-path`),this.directory=gu.default.dirname(this.packagePath),this.encoding=e.xmlEncoding}destroy(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}},vu=class{constructor(e){this.manifest={},this.navPath=``,this.ncxPath=``,this.coverPath=``,this.spineNodeIndex=0,this.spine=[],this.metadata={},e&&this.parse(e)}parse(e){var t,n,r;if(!e)throw Error(`Package File Not Found`);if(t=Ml(e,`metadata`),!t)throw Error(`No Metadata Found`);if(n=Ml(e,`manifest`),!n)throw Error(`No Manifest Found`);if(r=Ml(e,`spine`),!r)throw Error(`No Spine Found`);return this.manifest=this.parseManifest(n),this.navPath=this.findNavPath(n),this.ncxPath=this.findNcxPath(n,r),this.coverPath=this.findCoverPath(e),this.spineNodeIndex=wl(r),this.spine=this.parseSpine(r,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(e),this.metadata=this.parseMetadata(t),this.metadata.direction=r.getAttribute(`page-progression-direction`),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}parseMetadata(e){var t={};return t.title=this.getElementText(e,`title`),t.creator=this.getElementText(e,`creator`),t.description=this.getElementText(e,`description`),t.pubdate=this.getElementText(e,`date`),t.publisher=this.getElementText(e,`publisher`),t.identifier=this.getElementText(e,`identifier`),t.language=this.getElementText(e,`language`),t.rights=this.getElementText(e,`rights`),t.modified_date=this.getPropertyText(e,`dcterms:modified`),t.layout=this.getPropertyText(e,`rendition:layout`),t.orientation=this.getPropertyText(e,`rendition:orientation`),t.flow=this.getPropertyText(e,`rendition:flow`),t.viewport=this.getPropertyText(e,`rendition:viewport`),t.media_active_class=this.getPropertyText(e,`media:active-class`),t.spread=this.getPropertyText(e,`rendition:spread`),t}parseManifest(e){var t={},n=Nl(e,`item`);return Array.prototype.slice.call(n).forEach(function(e){var n=e.getAttribute(`id`),r=e.getAttribute(`href`)||``,i=e.getAttribute(`media-type`)||``,a=e.getAttribute(`media-overlay`)||``,o=e.getAttribute(`properties`)||``;t[n]={href:r,type:i,overlay:a,properties:o.length?o.split(` `):[]}}),t}parseSpine(e,t){var n=[],r=Nl(e,`itemref`);return Array.prototype.slice.call(r).forEach(function(e,t){var r=e.getAttribute(`idref`),i=e.getAttribute(`properties`)||``,a=i.length?i.split(` `):[],o={id:e.getAttribute(`id`),idref:r,linear:e.getAttribute(`linear`)||`yes`,properties:a,index:t};n.push(o)}),n}findUniqueIdentifier(e){var t=e.documentElement.getAttribute(`unique-identifier`);if(!t)return``;var n=e.getElementById(t);return n&&n.localName===`identifier`&&n.namespaceURI===`http://purl.org/dc/elements/1.1/`&&n.childNodes.length>0?n.childNodes[0].nodeValue.trim():``}findNavPath(e){var t=Pl(e,`item`,{properties:`nav`});return t?t.getAttribute(`href`):!1}findNcxPath(e,t){var n=Pl(e,`item`,{"media-type":`application/x-dtbncx+xml`}),r;return n||(r=t.getAttribute(`toc`),r&&(n=e.querySelector(`#${r}`))),n?n.getAttribute(`href`):!1}findCoverPath(e){Ml(e,`package`).getAttribute(`version`);var t=Pl(e,`item`,{properties:`cover-image`});if(t)return t.getAttribute(`href`);var n=Pl(e,`meta`,{name:`cover`});if(n){var r=n.getAttribute(`content`),i=e.getElementById(r);return i?i.getAttribute(`href`):``}else return!1}getElementText(e,t){var n=e.getElementsByTagNameNS(`http://purl.org/dc/elements/1.1/`,t),r;return!n||n.length===0?``:(r=n[0],r.childNodes.length?r.childNodes[0].nodeValue:``)}getPropertyText(e,t){var n=Pl(e,`meta`,{property:t});return n&&n.childNodes.length?n.childNodes[0].nodeValue:``}load(e){return this.metadata=e.metadata,this.spine=(e.readingOrder||e.spine).map((e,t)=>(e.index=t,e.linear=e.linear||`yes`,e)),e.resources.forEach((e,t)=>{this.manifest[t]=e,e.rel&&e.rel[0]===`cover`&&(this.coverPath=e.href)}),this.spineNodeIndex=0,this.toc=e.toc.map((e,t)=>(e.label=e.title,e)),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}destroy(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}},yu=class{constructor(e){this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,e&&this.parse(e)}parse(e){let t=e.nodeType,n,r;t&&(n=Ml(e,`html`),r=Ml(e,`ncx`)),t?n?(this.toc=this.parseNav(e),this.landmarks=this.parseLandmarks(e)):r&&(this.toc=this.parseNcx(e)):this.toc=this.load(e),this.length=0,this.unpack(this.toc)}unpack(e){for(var t,n=0;n<e.length;n++)t=e[n],t.href&&(this.tocByHref[t.href]=n),t.id&&(this.tocById[t.id]=n),this.length++,t.subitems.length&&this.unpack(t.subitems)}get(e){var t;return e?(e.indexOf(`#`)===0?t=this.tocById[e.substring(1)]:e in this.tocByHref&&(t=this.tocByHref[e]),this.getByIndex(e,t,this.toc)):this.toc}getByIndex(e,t,n){if(n.length===0)return;let r=n[t];if(r&&(e===r.id||e===r.href))return r;{let r;for(let i=0;i<n.length&&(r=this.getByIndex(e,t,n[i].subitems),!r);++i);return r}}landmark(e){var t;return e?(t=this.landmarksByType[e],this.landmarks[t]):this.landmarks}parseNav(e){var t=Bl(e,`nav`,`toc`),n=[];if(!t)return n;let r=Ul(t,`ol`,!0);return r&&(n=this.parseNavList(r)),n}parseNavList(e,t){let n=[];if(!e||!e.children)return n;for(let r=0;r<e.children.length;r++){let i=this.navItem(e.children[r],t);i&&n.push(i)}return n}navItem(e,t){let n=e.getAttribute(`id`)||void 0,r=Ul(e,`a`,!0)||Ul(e,`span`,!0);if(!r)return;let i=r.getAttribute(`href`)||``;n||=i;let a=r.textContent||``,o=[],s=Ul(e,`ol`,!0);return s&&(o=this.parseNavList(s,n)),{id:n,href:i,label:a,subitems:o,parent:t}}parseLandmarks(e){var t=Bl(e,`nav`,`landmarks`),n=t?Nl(t,`li`):[],r=n.length,i,a=[],o;if(!n||r===0)return a;for(i=0;i<r;++i)o=this.landmarkItem(n[i]),o&&(a.push(o),this.landmarksByType[o.type]=i);return a}landmarkItem(e){let t=Ul(e,`a`,!0);if(!t)return;let n=t.getAttributeNS(`http://www.idpf.org/2007/ops`,`type`)||void 0,r=t.getAttribute(`href`)||``,i=t.textContent||``;return{href:r,label:i,type:n}}parseNcx(e){var t=Nl(e,`navPoint`),n=t.length,r,i={},a=[],o,s;if(!t||n===0)return a;for(r=0;r<n;++r)o=this.ncxItem(t[r]),i[o.id]=o,o.parent?(s=i[o.parent],s.subitems.push(o)):a.push(o);return a}ncxItem(e){var t=e.getAttribute(`id`)||!1,n=Ml(e,`content`).getAttribute(`src`),r=Ml(e,`navLabel`),i=r.textContent?r.textContent:``,a=[],o=e.parentNode,s;return o&&(o.nodeName===`navPoint`||o.nodeName.split(`:`).slice(-1)[0]===`navPoint`)&&(s=o.getAttribute(`id`)),{id:t,href:n,label:i,subitems:a,parent:s}}load(e){return e.map(e=>(e.label=e.title,e.subitems=e.children?this.load(e.children):[],e))}forEach(e){return this.toc.forEach(e)}},bu={application:{ecmascript:[`es`,`ecma`],javascript:`js`,ogg:`ogx`,pdf:`pdf`,postscript:[`ps`,`ai`,`eps`,`epsi`,`epsf`,`eps2`,`eps3`],"rdf+xml":`rdf`,smil:[`smi`,`smil`],"xhtml+xml":[`xhtml`,`xht`],xml:[`xml`,`xsl`,`xsd`,`opf`,`ncx`],zip:`zip`,"x-httpd-eruby":`rhtml`,"x-latex":`latex`,"x-maker":[`frm`,`maker`,`frame`,`fm`,`fb`,`book`,`fbdoc`],"x-object":`o`,"x-shockwave-flash":[`swf`,`swfl`],"x-silverlight":`scr`,"epub+zip":`epub`,"font-tdpfr":`pfr`,"inkml+xml":[`ink`,`inkml`],json:`json`,"jsonml+json":`jsonml`,"mathml+xml":`mathml`,"metalink+xml":`metalink`,mp4:`mp4s`,"omdoc+xml":`omdoc`,oxps:`oxps`,"vnd.amazon.ebook":`azw`,widget:`wgt`,"x-dtbook+xml":`dtb`,"x-dtbresource+xml":`res`,"x-font-bdf":`bdf`,"x-font-ghostscript":`gsf`,"x-font-linux-psf":`psf`,"x-font-otf":`otf`,"x-font-pcf":`pcf`,"x-font-snf":`snf`,"x-font-ttf":[`ttf`,`ttc`],"x-font-type1":[`pfa`,`pfb`,`pfm`,`afm`],"x-font-woff":`woff`,"x-mobipocket-ebook":[`prc`,`mobi`],"x-mspublisher":`pub`,"x-nzb":`nzb`,"x-tgif":`obj`,"xaml+xml":`xaml`,"xml-dtd":`dtd`,"xproc+xml":`xpl`,"xslt+xml":`xslt`,"internet-property-stream":`acx`,"x-compress":`z`,"x-compressed":`tgz`,"x-gzip":`gz`},audio:{flac:`flac`,midi:[`mid`,`midi`,`kar`,`rmi`],mpeg:[`mpga`,`mpega`,`mp2`,`mp3`,`m4a`,`mp2a`,`m2a`,`m3a`],mpegurl:`m3u`,ogg:[`oga`,`ogg`,`spx`],"x-aiff":[`aif`,`aiff`,`aifc`],"x-ms-wma":`wma`,"x-wav":`wav`,adpcm:`adp`,mp4:`mp4a`,webm:`weba`,"x-aac":`aac`,"x-caf":`caf`,"x-matroska":`mka`,"x-pn-realaudio-plugin":`rmp`,xm:`xm`,mid:[`mid`,`rmi`]},image:{gif:`gif`,ief:`ief`,jpeg:[`jpeg`,`jpg`,`jpe`],pcx:`pcx`,png:`png`,"svg+xml":[`svg`,`svgz`],tiff:[`tiff`,`tif`],"x-icon":`ico`,bmp:`bmp`,webp:`webp`,"x-pict":[`pic`,`pct`],"x-tga":`tga`,"cis-cod":`cod`},text:{"cache-manifest":[`manifest`,`appcache`],css:`css`,csv:`csv`,html:[`html`,`htm`,`shtml`,`stm`],mathml:`mml`,plain:[`txt`,`text`,`brf`,`conf`,`def`,`list`,`log`,`in`,`bas`],richtext:`rtx`,"tab-separated-values":`tsv`,"x-bibtex":`bib`},video:{mpeg:[`mpeg`,`mpg`,`mpe`,`m1v`,`m2v`,`mp2`,`mpa`,`mpv2`],mp4:[`mp4`,`mp4v`,`mpg4`],quicktime:[`qt`,`mov`],ogg:`ogv`,"vnd.mpegurl":[`mxu`,`m4u`],"x-flv":`flv`,"x-la-asf":[`lsf`,`lsx`],"x-mng":`mng`,"x-ms-asf":[`asf`,`asx`,`asr`],"x-ms-wm":`wm`,"x-ms-wmv":`wmv`,"x-ms-wmx":`wmx`,"x-ms-wvx":`wvx`,"x-msvideo":`avi`,"x-sgi-movie":`movie`,"x-matroska":[`mpv`,`mkv`,`mk3d`,`mks`],"3gpp2":`3g2`,h261:`h261`,h263:`h263`,h264:`h264`,jpeg:`jpgv`,jpm:[`jpm`,`jpgm`],mj2:[`mj2`,`mjp2`],"vnd.ms-playready.media.pyv":`pyv`,"vnd.uvvu.mp4":[`uvu`,`uvvu`],"vnd.vivo":`viv`,webm:`webm`,"x-f4v":`f4v`,"x-m4v":`m4v`,"x-ms-vob":`vob`,"x-smv":`smv`}},xu=(function(){var e,t,n,r,i={};for(e in bu)if(bu.hasOwnProperty(e)){for(t in bu[e])if(bu[e].hasOwnProperty(t))if(n=bu[e][t],typeof n==`string`)i[n]=e+`/`+t;else for(r=0;r<n.length;r++)i[n[r]]=e+`/`+t}return i})(),Su=`text/plain`;function Cu(e){return e&&xu[e.split(`.`).pop().toLowerCase()]||Su}var wu={lookup:Cu},Tu=l(Kl()),Eu=class{constructor(e,t){this.settings={replacements:t&&t.replacements||`base64`,archive:t&&t.archive,resolver:t&&t.resolver,request:t&&t.request},this.process(e)}process(e){this.manifest=e,this.resources=Object.keys(e).map(function(t){return e[t]}),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}split(){this.html=this.resources.filter(function(e){if(e.type===`application/xhtml+xml`||e.type===`text/html`)return!0}),this.assets=this.resources.filter(function(e){if(e.type!==`application/xhtml+xml`&&e.type!==`text/html`)return!0}),this.css=this.resources.filter(function(e){if(e.type===`text/css`)return!0})}splitUrls(){this.urls=this.assets.map(function(e){return e.href}.bind(this)),this.cssUrls=this.css.map(function(e){return e.href})}createUrl(e){var t=new Xl(e),n=wu.lookup(t.filename);return this.settings.archive?this.settings.archive.createUrl(e,{base64:this.settings.replacements===`base64`}):this.settings.replacements===`base64`?this.settings.request(e,`blob`).then(e=>Rl(e)).then(e=>kl(e,n)):this.settings.request(e,`blob`).then(e=>Dl(e,n))}replacements(){if(this.settings.replacements===`none`)return new Promise(function(e){e(this.urls)}.bind(this));var e=this.urls.map(e=>{var t=this.settings.resolver(e);return this.createUrl(t).catch(e=>(console.error(e),null))});return Promise.all(e).then(e=>(this.replacementUrls=e.filter(e=>typeof e==`string`),e))}replaceCss(e,t){var n=[];return e||=this.settings.archive,t||=this.settings.resolver,this.cssUrls.forEach(function(r){var i=this.createCssFile(r,e,t).then(function(e){var t=this.urls.indexOf(r);t>-1&&(this.replacementUrls[t]=e)}.bind(this));n.push(i)}.bind(this)),Promise.all(n)}createCssFile(e){var t;if(Tu.default.isAbsolute(e))return new Promise(function(e){e()});var n=this.settings.resolver(e),r=this.settings.archive?this.settings.archive.getText(n):this.settings.request(n,`text`),i=this.urls.map(e=>{var t=this.settings.resolver(e);return new Jl(n).relative(t)});return r?r.then(e=>(e=ou(e,i,this.replacementUrls),t=this.settings.replacements===`base64`?kl(e,`text/css`):Dl(e,`text/css`),t),e=>new Promise(function(e){e()})):new Promise(function(e){e()})}relativeTo(e,t){return t||=this.settings.resolver,this.urls.map(function(n){var r=t(n);return new Jl(e).relative(r)}.bind(this))}get(e){var t=this.urls.indexOf(e);if(t!==-1)return this.replacementUrls.length?new Promise(function(e,n){e(this.replacementUrls[t])}.bind(this)):this.createUrl(e)}substitute(e,t){var n=t?this.relativeTo(t):this.urls;return ou(e,n,this.replacementUrls)}destroy(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}},Du=class{constructor(e){this.pages=[],this.locations=[],this.epubcfi=new eu,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,e&&(this.pageList=this.parse(e)),this.pageList&&this.pageList.length&&this.process(this.pageList)}parse(e){var t=Ml(e,`html`),n=Ml(e,`ncx`);if(t)return this.parseNav(e);if(n)return this.parseNcx(e)}parseNav(e){var t=Bl(e,`nav`,`page-list`),n=t?Nl(t,`li`):[],r=n.length,i,a=[],o;if(!n||r===0)return a;for(i=0;i<r;++i)o=this.item(n[i]),a.push(o);return a}parseNcx(e){var t=[],n=0,r,i,a,o=0;if(i=Ml(e,`pageList`),!i||(a=Nl(i,`pageTarget`),o=a.length,!a||a.length===0))return t;for(n=0;n<o;++n)r=this.ncxItem(a[n]),t.push(r);return t}ncxItem(e){var t=Ml(e,`navLabel`),n=Ml(t,`text`).textContent;return{href:Ml(e,`content`).getAttribute(`src`),page:parseInt(n,10)}}item(e){var t=Ml(e,`a`),n=t.getAttribute(`href`)||``,r=t.textContent||``,i=parseInt(r),a=n.indexOf(`epubcfi`),o,s,c;return a==-1?{href:n,page:i}:(o=n.split(`#`),s=o[0],c=o.length>1?o[1]:!1,{cfi:c,href:n,packageUrl:s,page:i})}process(e){e.forEach(function(e){this.pages.push(e.page),e.cfi&&this.locations.push(e.cfi)},this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}pageFromCfi(e){var t=-1;if(this.locations.length===0)return-1;var n=_l(e,this.locations,this.epubcfi.compare);return n==-1?(n=gl(e,this.locations,this.epubcfi.compare),t=n-1>=0?this.pages[n-1]:this.pages[0],t!==void 0||(t=-1)):t=this.pages[n],t}cfiFromPage(e){var t=-1;typeof e!=`number`&&(e=parseInt(e));var n=this.pages.indexOf(e);return n!=-1&&(t=this.locations[n]),t}pageFromPercentage(e){return Math.round(this.totalPages*e)}percentageFromPage(e){var t=(e-this.firstPage)/this.totalPages;return Math.round(t*1e3)/1e3}percentageFromCfi(e){var t=this.pageFromCfi(e);return this.percentageFromPage(t)}destroy(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}},Ou=l(qc()),ku=class{constructor(e){this.settings=e,this.name=e.layout||`reflowable`,this._spread=e.spread!==`none`,this._minSpreadWidth=e.minSpreadWidth||800,this._evenSpreads=e.evenSpreads||!1,e.flow===`scrolled`||e.flow===`scrolled-continuous`||e.flow===`scrolled-doc`?this._flow=`scrolled`:this._flow=`paginated`,this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}flow(e){return e!==void 0&&(e===`scrolled`||e===`scrolled-continuous`||e===`scrolled-doc`?this._flow=`scrolled`:this._flow=`paginated`,this.update({flow:this._flow})),this._flow}spread(e,t){return e&&(this._spread=e!==`none`,this.update({spread:this._spread})),t>=0&&(this._minSpreadWidth=t),this._spread}calculate(e,t,n){var r=1,i=n||0,a=e,o=t,s=Math.floor(a/12),c,l,u,d;r=this._spread&&a>=this._minSpreadWidth?2:1,this.name===`reflowable`&&this._flow===`paginated`&&!(n>=0)&&(i=s%2==0?s:s-1),this.name===`pre-paginated`&&(i=0),r>1?(c=a/r-i,u=c+i):(c=a,u=a),this.name===`pre-paginated`&&r>1&&(a=c),l=c*r+i,d=a,this.width=a,this.height=o,this.spreadWidth=l,this.pageWidth=u,this.delta=d,this.columnWidth=c,this.gap=i,this.divisor=r,this.update({width:a,height:o,spreadWidth:l,pageWidth:u,delta:d,columnWidth:c,gap:i,divisor:r})}format(e,t,n){return this.name===`pre-paginated`?e.fit(this.columnWidth,this.height,t):this._flow===`paginated`?e.columns(this.width,this.height,this.columnWidth,this.gap,this.settings.direction):n&&n===`horizontal`?e.size(null,this.height):e.size(this.width,null)}count(e,t){let n,r;return this.name===`pre-paginated`?(n=1,r=1):this._flow===`paginated`?(t||=this.delta,n=Math.ceil(e/t),r=n*this.divisor):(t||=this.height,n=Math.ceil(e/t),r=n),{spreads:n,pages:r}}update(e){if(Object.keys(e).forEach(t=>{this.props[t]===e[t]&&delete e[t]}),Object.keys(e).length>0){let t=ml(this.props,e);this.emit($.LAYOUT.UPDATED,t,e)}}};(0,Ou.default)(ku.prototype);var Au=ku,ju=class{constructor(e){this.rendition=e,this._themes={default:{rules:{},url:``,serialized:``}},this._overrides={},this._current=`default`,this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}register(){if(arguments.length!==0){if(arguments.length===1&&typeof arguments[0]==`object`)return this.registerThemes(arguments[0]);if(arguments.length===1&&typeof arguments[0]==`string`)return this.default(arguments[0]);if(arguments.length===2&&typeof arguments[1]==`string`)return this.registerUrl(arguments[0],arguments[1]);if(arguments.length===2&&typeof arguments[1]==`object`)return this.registerRules(arguments[0],arguments[1])}}default(e){if(e){if(typeof e==`string`)return this.registerUrl(`default`,e);if(typeof e==`object`)return this.registerRules(`default`,e)}}registerThemes(e){for(var t in e)e.hasOwnProperty(t)&&(typeof e[t]==`string`?this.registerUrl(t,e[t]):this.registerRules(t,e[t]))}registerCss(e,t){this._themes[e]={serialized:t},(this._injected[e]||e==`default`)&&this.update(e)}registerUrl(e,t){var n=new Xl(t);this._themes[e]={url:n.toString()},(this._injected[e]||e==`default`)&&this.update(e)}registerRules(e,t){this._themes[e]={rules:t},(this._injected[e]||e==`default`)&&this.update(e)}select(e){var t=this._current,n;this._current=e,this.update(e),n=this.rendition.getContents(),n.forEach(n=>{n.removeClass(t),n.addClass(e)})}update(e){this.rendition.getContents().forEach(t=>{this.add(e,t)})}inject(e){var t=[],n=this._themes,r;for(var i in n)n.hasOwnProperty(i)&&(i===this._current||i===`default`)&&(r=n[i],(r.rules&&Object.keys(r.rules).length>0||r.url&&t.indexOf(r.url)===-1)&&this.add(i,e),this._injected.push(i));this._current!=`default`&&e.addClass(this._current)}add(e,t){var n=this._themes[e];!n||!t||(n.url?t.addStylesheet(n.url):n.serialized?(t.addStylesheetCss(n.serialized,e),n.injected=!0):n.rules&&(t.addStylesheetRules(n.rules,e),n.injected=!0))}override(e,t,n){var r=this.rendition.getContents();this._overrides[e]={value:t,priority:n===!0},r.forEach(t=>{t.css(e,this._overrides[e].value,this._overrides[e].priority)})}removeOverride(e){var t=this.rendition.getContents();delete this._overrides[e],t.forEach(t=>{t.css(e)})}overrides(e){var t=this._overrides;for(var n in t)t.hasOwnProperty(n)&&e.css(n,t[n].value,t[n].priority)}fontSize(e){this.override(`font-size`,e)}font(e){this.override(`font-family`,e,!0)}destroy(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}},Mu=class{constructor(e,t,n,r=!1){this.layout=e,this.horizontal=n===`horizontal`,this.direction=t||`ltr`,this._dev=r}section(e){var t=this.findRanges(e);return this.rangeListToCfiList(e.section.cfiBase,t)}page(e,t,n,r){var i=e&&e.document?e.document.body:!1,a;if(i){if(a=this.rangePairToCfiPair(t,{start:this.findStart(i,n,r),end:this.findEnd(i,n,r)}),this._dev===!0){let t=e.document,n=new eu(a.start).toRange(t),r=new eu(a.end).toRange(t),i=t.defaultView.getSelection(),o=t.createRange();i.removeAllRanges(),o.setStart(n.startContainer,n.startOffset),o.setEnd(r.endContainer,r.endOffset),i.addRange(o)}return a}}walk(e,t){if(!(e&&e.nodeType===Node.TEXT_NODE)){var n={acceptNode:function(e){return e.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}},r=n.acceptNode;r.acceptNode=n.acceptNode;for(var i=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,r,!1),a,o;(a=i.nextNode())&&(o=t(a),!o););return o}}findRanges(e){for(var t=[],n=e.contents.scrollWidth(),r=Math.ceil(n/this.layout.spreadWidth)*this.layout.divisor,i=this.layout.columnWidth,a=this.layout.gap,o,s,c=0;c<r.pages;c++)o=(i+a)*c,s=i*(c+1)+a*c,t.push({start:this.findStart(e.document.body,o,s),end:this.findEnd(e.document.body,o,s)});return t}findStart(e,t,n){for(var r=[e],i,a,o=e;r.length;)if(i=r.shift(),a=this.walk(i,e=>{var i,a,s,c,l=bl(e);if(this.horizontal&&this.direction===`ltr`){if(i=this.horizontal?l.left:l.top,a=this.horizontal?l.right:l.bottom,i>=t&&i<=n||a>t)return e;o=e,r.push(e)}else if(this.horizontal&&this.direction===`rtl`){if(i=l.left,a=l.right,a<=n&&a>=t||i<n)return e;o=e,r.push(e)}else{if(s=l.top,c=l.bottom,s>=t&&s<=n||c>t)return e;o=e,r.push(e)}}),a)return this.findTextStartRange(a,t,n);return this.findTextStartRange(o,t,n)}findEnd(e,t,n){for(var r=[e],i,a=e,o;r.length;)if(i=r.shift(),o=this.walk(i,e=>{var i,o,s,c,l=bl(e);if(this.horizontal&&this.direction===`ltr`){if(i=Math.round(l.left),o=Math.round(l.right),i>n&&a)return a;if(o>n)return e;a=e,r.push(e)}else if(this.horizontal&&this.direction===`rtl`){if(i=Math.round(this.horizontal?l.left:l.top),o=Math.round(this.horizontal?l.right:l.bottom),o<t&&a)return a;if(i<t)return e;a=e,r.push(e)}else{if(s=Math.round(l.top),c=Math.round(l.bottom),s>n&&a)return a;if(c>n)return e;a=e,r.push(e)}}),o)return this.findTextEndRange(o,t,n);return this.findTextEndRange(a,t,n)}findTextStartRange(e,t,n){for(var r=this.splitTextNodeIntoRanges(e),i,a,o,s,c,l=0;l<r.length;l++)if(i=r[l],a=i.getBoundingClientRect(),this.horizontal&&this.direction===`ltr`){if(o=a.left,o>=t)return i}else if(this.horizontal&&this.direction===`rtl`){if(c=a.right,c<=n)return i}else if(s=a.top,s>=t)return i;return r[0]}findTextEndRange(e,t,n){for(var r=this.splitTextNodeIntoRanges(e),i,a,o,s,c,l,u,d=0;d<r.length;d++){if(a=r[d],o=a.getBoundingClientRect(),this.horizontal&&this.direction===`ltr`){if(s=o.left,c=o.right,s>n&&i)return i;if(c>n)return a}else if(this.horizontal&&this.direction===`rtl`){if(s=o.left,c=o.right,c<t&&i)return i;if(s<t)return a}else{if(l=o.top,u=o.bottom,l>n&&i)return i;if(u>n)return a}i=a}return r[r.length-1]}splitTextNodeIntoRanges(e,t){var n=[],r=(e.textContent||``).trim(),i,a=e.ownerDocument,o=t||` `,s=r.indexOf(o);if(s===-1||e.nodeType!=Node.TEXT_NODE)return i=a.createRange(),i.selectNodeContents(e),[i];for(i=a.createRange(),i.setStart(e,0),i.setEnd(e,s),n.push(i),i=!1;s!=-1;)s=r.indexOf(o,s+1),s>0&&(i&&(i.setEnd(e,s),n.push(i)),i=a.createRange(),i.setStart(e,s+1));return i&&(i.setEnd(e,r.length),n.push(i)),n}rangePairToCfiPair(e,t){var n=t.start,r=t.end;n.collapse(!0),r.collapse(!1);let i=new eu(n,e).toString(),a=new eu(r,e).toString();return{start:i,end:a}}rangeListToCfiList(e,t){for(var n=[],r,i=0;i<t.length;i++)r=this.rangePairToCfiPair(e,t[i]),n.push(r);return n}axis(e){return e&&(this.horizontal=e===`horizontal`),this.horizontal}},Nu=l(qc()),Pu=typeof navigator<`u`,Fu=Pu&&/Chrome/.test(navigator.userAgent),Iu=Pu&&!Fu&&/AppleWebKit/.test(navigator.userAgent),Lu=1,Ru=class{constructor(e,t,n,r){this.epubcfi=new eu,this.document=e,this.documentElement=this.document.documentElement,this.content=t||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=r||0,this.cfiBase=n||``,this.epubReadingSystem(`epub.js`,`0.3`),this.called=0,this.active=!0,this.listeners()}static get listenedEvents(){return pu}width(e){var t=this.content;return e&&ul(e)&&(e+=`px`),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}height(e){var t=this.content;return e&&ul(e)&&(e+=`px`),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}contentWidth(e){var t=this.content||this.document.body;return e&&ul(e)&&(e+=`px`),e&&(t.style.width=e),parseInt(this.window.getComputedStyle(t).width)}contentHeight(e){var t=this.content||this.document.body;return e&&ul(e)&&(e+=`px`),e&&(t.style.height=e),parseInt(this.window.getComputedStyle(t).height)}textWidth(){let e,t,n=this.document.createRange(),r=this.content||this.document.body,i=yl(r);return n.selectNodeContents(r),e=n.getBoundingClientRect(),t=e.width,i&&i.width&&(t+=i.width),Math.round(t)}textHeight(){let e,t,n=this.document.createRange(),r=this.content||this.document.body;return n.selectNodeContents(r),e=n.getBoundingClientRect(),t=e.bottom,Math.round(t)}scrollWidth(){return this.documentElement.scrollWidth}scrollHeight(){return this.documentElement.scrollHeight}overflow(e){return e&&(this.documentElement.style.overflow=e),this.window.getComputedStyle(this.documentElement).overflow}overflowX(e){return e&&(this.documentElement.style.overflowX=e),this.window.getComputedStyle(this.documentElement).overflowX}overflowY(e){return e&&(this.documentElement.style.overflowY=e),this.window.getComputedStyle(this.documentElement).overflowY}css(e,t,n){var r=this.content||this.document.body;return t?r.style.setProperty(e,t,n?`important`:``):r.style.removeProperty(e),this.window.getComputedStyle(r)[e]}viewport(e){var t=this.document.querySelector(`meta[name='viewport']`),n={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},r=[],i={};if(t&&t.hasAttribute(`content`)){let e=t.getAttribute(`content`),r=e.match(/width\s*=\s*([^,]*)/),i=e.match(/height\s*=\s*([^,]*)/),a=e.match(/initial-scale\s*=\s*([^,]*)/),o=e.match(/minimum-scale\s*=\s*([^,]*)/),s=e.match(/maximum-scale\s*=\s*([^,]*)/),c=e.match(/user-scalable\s*=\s*([^,]*)/);r&&r.length&&r[1]!==void 0&&(n.width=r[1]),i&&i.length&&i[1]!==void 0&&(n.height=i[1]),a&&a.length&&a[1]!==void 0&&(n.scale=a[1]),o&&o.length&&o[1]!==void 0&&(n.minimum=o[1]),s&&s.length&&s[1]!==void 0&&(n.maximum=s[1]),c&&c.length&&c[1]!==void 0&&(n.scalable=c[1])}return i=pl(e||{},n),e&&(i.width&&r.push(`width=`+i.width),i.height&&r.push(`height=`+i.height),i.scale&&r.push(`initial-scale=`+i.scale),i.scalable===`no`?(r.push(`minimum-scale=`+i.scale),r.push(`maximum-scale=`+i.scale),r.push(`user-scalable=`+i.scalable)):(i.scalable&&r.push(`user-scalable=`+i.scalable),i.minimum&&r.push(`minimum-scale=`+i.minimum),i.maximum&&r.push(`minimum-scale=`+i.maximum)),t||(t=this.document.createElement(`meta`),t.setAttribute(`name`,`viewport`),this.document.querySelector(`head`).appendChild(t)),t.setAttribute(`content`,r.join(`, `)),this.window.scrollTo(0,0)),i}expand(){this.emit($.CONTENTS.EXPAND)}listeners(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),typeof ResizeObserver>`u`?(this.resizeListeners(),this.visibilityListeners()):this.resizeObservers(),this.linksHandler()}removeListeners(){this.removeEventListeners(),this.removeSelectionListeners(),this.observer&&this.observer.disconnect(),clearTimeout(this.expanding)}resizeCheck(){let e=this.textWidth(),t=this.textHeight();(e!=this._size.width||t!=this._size.height)&&(this._size={width:e,height:t},this.onResize&&this.onResize(this._size),this.emit($.CONTENTS.RESIZE,this._size))}resizeListeners(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}visibilityListeners(){document.addEventListener(`visibilitychange`,()=>{document.visibilityState===`visible`&&this.active===!1?(this.active=!0,this.resizeListeners()):(this.active=!1,clearTimeout(this.expanding))})}transitionListeners(){let e=this.content;e.style.transitionProperty=`font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height`,e.style.transitionDuration=`0.001ms`,e.style.transitionTimingFunction=`linear`,e.style.transitionDelay=`0`,this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener(`transitionend`,this._resizeCheck)}mediaQueryListeners(){for(var e=this.document.styleSheets,t=function(e){e.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),n=0;n<e.length;n+=1){var r;try{r=e[n].cssRules}catch{return}if(!r)return;for(var i=0;i<r.length;i+=1)r[i].media&&this.window.matchMedia(r[i].media.mediaText).addListener(t)}}resizeObservers(){this.observer=new ResizeObserver(e=>{requestAnimationFrame(this.resizeCheck.bind(this))}),this.observer.observe(this.document.documentElement)}mutationObservers(){this.observer=new MutationObserver(e=>{this.resizeCheck()}),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}imageLoadListeners(){for(var e=this.document.querySelectorAll(`img`),t,n=0;n<e.length;n++)t=e[n],t.naturalWidth!==void 0&&t.naturalWidth===0&&(t.onload=this.expand.bind(this))}fontLoadListeners(){!this.document||!this.document.fonts||this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}root(){return this.document?this.document.documentElement:null}locationOf(e,t){var n,r={left:0,top:0};if(!this.document)return r;if(this.epubcfi.isCfiString(e)){let i=new eu(e).toRange(this.document,t);if(i){try{if(!i.endContainer||i.startContainer==i.endContainer&&i.startOffset==i.endOffset){let e=i.startContainer.textContent.indexOf(` `,i.startOffset);e==-1&&(e=i.startContainer.textContent.length),i.setEnd(i.startContainer,e)}}catch(e){console.error(`setting end offset to start container length failed`,e)}if(i.startContainer.nodeType===Node.ELEMENT_NODE)n=i.startContainer.getBoundingClientRect(),r.left=n.left,r.top=n.top;else if(Iu){let e=i.startContainer,t=new Range;try{e.nodeType===Lu?n=e.getBoundingClientRect():i.startOffset+2<e.length?(t.setStart(e,i.startOffset),t.setEnd(e,i.startOffset+2),n=t.getBoundingClientRect()):i.startOffset-2>0?(t.setStart(e,i.startOffset-2),t.setEnd(e,i.startOffset),n=t.getBoundingClientRect()):n=e.parentNode.getBoundingClientRect()}catch(e){console.error(e,e.stack)}}else n=i.getBoundingClientRect()}}else if(typeof e==`string`&&e.indexOf(`#`)>-1){let t=e.substring(e.indexOf(`#`)+1),r=this.document.getElementById(t);if(r)if(Iu){let e=new Range;e.selectNode(r),n=e.getBoundingClientRect()}else n=r.getBoundingClientRect()}return n&&(r.left=n.left,r.top=n.top),r}addStylesheet(e){return new Promise(function(t,n){var r,i=!1;if(!this.document){t(!1);return}if(r=this.document.querySelector(`link[href='`+e+`']`),r){t(!0);return}r=this.document.createElement(`link`),r.type=`text/css`,r.rel=`stylesheet`,r.href=e,r.onload=r.onreadystatechange=function(){!i&&(!this.readyState||this.readyState==`complete`)&&(i=!0,setTimeout(()=>{t(!0)},1))},this.document.head.appendChild(r)}.bind(this))}_getStylesheetNode(e){var t;return e=`epubjs-inserted-css-`+(e||``),this.document?(t=this.document.getElementById(e),t||(t=this.document.createElement(`style`),t.id=e,this.document.head.appendChild(t)),t):!1}addStylesheetCss(e,t){if(!this.document||!e)return!1;var n=this._getStylesheetNode(t);return n.innerHTML=e,!0}addStylesheetRules(e,t){var n;if(!(!this.document||!e||e.length===0))if(n=this._getStylesheetNode(t).sheet,Object.prototype.toString.call(e)===`[object Array]`)for(var r=0,i=e.length;r<i;r++){var a=1,o=e[r],s=e[r][0],c=``;Object.prototype.toString.call(o[1][0])===`[object Array]`&&(o=o[1],a=0);for(var l=o.length;a<l;a++){var u=o[a];c+=u[0]+`:`+u[1]+(u[2]?` !important`:``)+`;
`}n.insertRule(s+`{`+c+`}`,n.cssRules.length)}else Object.keys(e).forEach(t=>{let r=e[t];if(Array.isArray(r))r.forEach(e=>{let r=Object.keys(e).map(t=>`${t}:${e[t]}`).join(`;`);n.insertRule(`${t}{${r}}`,n.cssRules.length)});else{let e=Object.keys(r).map(e=>`${e}:${r[e]}`).join(`;`);n.insertRule(`${t}{${e}}`,n.cssRules.length)}})}addScript(e){return new Promise(function(t,n){var r,i=!1;if(!this.document){t(!1);return}r=this.document.createElement(`script`),r.type=`text/javascript`,r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){!i&&(!this.readyState||this.readyState==`complete`)&&(i=!0,setTimeout(function(){t(!0)},1))},this.document.head.appendChild(r)}.bind(this))}addClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.add(e))}removeClass(e){var t;this.document&&(t=this.content||this.document.body,t&&t.classList.remove(e))}addEventListeners(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),pu.forEach(function(e){this.document.addEventListener(e,this._triggerEvent,{passive:!0})},this))}removeEventListeners(){this.document&&(pu.forEach(function(e){this.document.removeEventListener(e,this._triggerEvent,{passive:!0})},this),this._triggerEvent=void 0)}triggerEvent(e){this.emit(e.type,e)}addSelectionListeners(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener(`selectionchange`,this._onSelectionChange,{passive:!0}))}removeSelectionListeners(){this.document&&(this.document.removeEventListener(`selectionchange`,this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}onSelectionChange(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var e=this.window.getSelection();this.triggerSelectedEvent(e)}.bind(this),250)}triggerSelectedEvent(e){var t,n;e&&e.rangeCount>0&&(t=e.getRangeAt(0),t.collapsed||(n=new eu(t,this.cfiBase).toString(),this.emit($.CONTENTS.SELECTED,n),this.emit($.CONTENTS.SELECTED_RANGE,t)))}range(e,t){return new eu(e).toRange(this.document,t)}cfiFromRange(e,t){return new eu(e,this.cfiBase,t).toString()}cfiFromNode(e,t){return new eu(e,this.cfiBase,t).toString()}map(e){return new Mu(e).section()}size(e,t){var n={scale:1,scalable:`no`};this.layoutStyle(`scrolling`),e>=0&&(this.width(e),n.width=e,this.css(`padding`,`0 `+e/12+`px`)),t>=0&&(this.height(t),n.height=t),this.css(`margin`,`0`),this.css(`box-sizing`,`border-box`),this.viewport(n)}columns(e,t,n,r,i){let a=fl(`column-axis`),o=fl(`column-gap`),s=fl(`column-width`),c=fl(`column-fill`),l=this.writingMode().indexOf(`vertical`)===0?`vertical`:`horizontal`;this.layoutStyle(`paginated`),i===`rtl`&&l===`horizontal`&&this.direction(i),this.width(e),this.height(t),this.viewport({width:e,height:t,scale:1,scalable:`no`}),this.css(`overflow-y`,`hidden`),this.css(`margin`,`0`,!0),l===`vertical`?(this.css(`padding-top`,r/2+`px`,!0),this.css(`padding-bottom`,r/2+`px`,!0),this.css(`padding-left`,`20px`),this.css(`padding-right`,`20px`),this.css(a,`vertical`)):(this.css(`padding-top`,`20px`),this.css(`padding-bottom`,`20px`),this.css(`padding-left`,r/2+`px`,!0),this.css(`padding-right`,r/2+`px`,!0),this.css(a,`horizontal`)),this.css(`box-sizing`,`border-box`),this.css(`max-width`,`inherit`),this.css(c,`auto`),this.css(o,r+`px`),this.css(s,n+`px`),this.css(`-webkit-line-box-contain`,`block glyphs replaced`)}scaler(e,t,n){var r=`scale(`+e+`)`,i=``;this.css(`transform-origin`,`top left`),(t>=0||n>=0)&&(i=` translate(`+(t||0)+`px, `+(n||0)+`px )`),this.css(`transform`,r+i)}fit(e,t,n){var r=this.viewport(),i=parseInt(r.width),a=parseInt(r.height),o=e/i,s=t/a,c=o<s?o:s;if(this.layoutStyle(`paginated`),this.width(i),this.height(a),this.overflow(`hidden`),this.scaler(c,0,0),this.css(`background-size`,i*c+`px `+a*c+`px`),this.css(`background-color`,`transparent`),n&&n.properties.includes(`page-spread-left`)){var l=e-i*c;this.css(`margin-left`,l+`px`)}}direction(e){this.documentElement&&(this.documentElement.style.direction=e)}mapPage(e,t,n,r,i){return new Mu(t,i).page(this,e,n,r)}linksHandler(){au(this.content,e=>{this.emit($.CONTENTS.LINK_CLICKED,e)})}writingMode(e){let t=fl(`writing-mode`);return e&&this.documentElement&&(this.documentElement.style[t]=e),this.window.getComputedStyle(this.documentElement)[t]||``}layoutStyle(e){return e&&(this._layoutStyle=e,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||`paginated`}epubReadingSystem(e,t){return navigator.epubReadingSystem={name:e,version:t,layoutStyle:this.layoutStyle(),hasFeature:function(e){switch(e){case`dom-manipulation`:return!0;case`layout-changes`:return!0;case`touch-events`:return!0;case`mouse-events`:return!0;case`keyboard-events`:return!0;case`spine-scripting`:return!1;default:return!1}}},navigator.epubReadingSystem}destroy(){this.removeListeners()}};(0,Nu.default)(Ru.prototype);var zu=Ru,Bu=l(qc()),Vu=class{constructor(e){this.rendition=e,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}add(e,t,n,r,i,a){let o=encodeURI(t+e),s=new eu(t).spinePos,c=new Hu({type:e,cfiRange:t,data:n,sectionIndex:s,cb:r,className:i,styles:a});return this._annotations[o]=c,s in this._annotationsBySectionIndex?this._annotationsBySectionIndex[s].push(o):this._annotationsBySectionIndex[s]=[o],this.rendition.views().forEach(e=>{c.sectionIndex===e.index&&c.attach(e)}),c}remove(e,t){let n=encodeURI(e+t);if(n in this._annotations){let e=this._annotations[n];if(t&&e.type!==t)return;this.rendition.views().forEach(t=>{this._removeFromAnnotationBySectionIndex(e.sectionIndex,n),e.sectionIndex===t.index&&e.detach(t)}),delete this._annotations[n]}}_removeFromAnnotationBySectionIndex(e,t){this._annotationsBySectionIndex[e]=this._annotationsAt(e).filter(e=>e!==t)}_annotationsAt(e){return this._annotationsBySectionIndex[e]}highlight(e,t,n,r,i){return this.add(`highlight`,e,t,n,r,i)}underline(e,t,n,r,i){return this.add(`underline`,e,t,n,r,i)}mark(e,t,n){return this.add(`mark`,e,t,n)}each(){return this._annotations.forEach.apply(this._annotations,arguments)}inject(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].attach(e)})}clear(e){let t=e.index;t in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[t].forEach(t=>{this._annotations[t].detach(e)})}show(){}hide(){}},Hu=class{constructor({type:e,cfiRange:t,data:n,sectionIndex:r,cb:i,className:a,styles:o}){this.type=e,this.cfiRange=t,this.data=n,this.sectionIndex=r,this.mark=void 0,this.cb=i,this.className=a,this.styles=o}update(e){this.data=e}attach(e){let{cfiRange:t,data:n,type:r,mark:i,cb:a,className:o,styles:s}=this,c;return r===`highlight`?c=e.highlight(t,n,a,o,s):r===`underline`?c=e.underline(t,n,a,o,s):r===`mark`&&(c=e.mark(t,n,a)),this.mark=c,this.emit($.ANNOTATION.ATTACH,c),c}detach(e){let{cfiRange:t,type:n}=this,r;return e&&(n===`highlight`?r=e.unhighlight(t):n===`underline`?r=e.ununderline(t):n===`mark`&&(r=e.unmark(t))),this.mark=void 0,this.emit($.ANNOTATION.DETACH,r),r}text(){}};(0,Bu.default)(Hu.prototype);var Uu=Vu,Wu=o((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.createElement=t;function t(e){return document.createElementNS(`http://www.w3.org/2000/svg`,e)}e.default={createElement:t}})),Gu=o((e=>{Object.defineProperty(e,`__esModule`,{value:!0}),e.proxyMouse=t,e.clone=n,e.default={proxyMouse:t};function t(e,t){function i(i){for(var a=t.length-1;a>=0;a--){var o=t[a],s=i.clientX,c=i.clientY;if(i.touches&&i.touches.length&&(s=i.touches[0].clientX,c=i.touches[0].clientY),r(o,e,s,c)){o.dispatchEvent(n(i));break}}}if(e.nodeName===`iframe`||e.nodeName===`IFRAME`)try{this.target=e.contentDocument}catch{this.target=e}else this.target=e;for(var a=[`mouseup`,`mousedown`,`click`,`touchstart`],o=0;o<a.length;o++){var s=a[o];this.target.addEventListener(s,function(e){return i(e)},!1)}}function n(e){var t=Object.assign({},e,{bubbles:!1});try{return new MouseEvent(e.type,t)}catch{var n=document.createEvent(`MouseEvents`);return n.initMouseEvent(e.type,!1,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),n}}function r(e,t,n,r){var i=t.getBoundingClientRect();function a(e,t,n){var r=e.top-i.top,a=e.left-i.left,o=r+e.height,s=a+e.width;return r<=n&&a<=t&&o>n&&s>t}var o=e.getBoundingClientRect();if(!a(o,n,r))return!1;for(var s=e.getClientRects(),c=0,l=s.length;c<l;c++)if(a(s[c],n,r))return!0;return!1}})),Ku=o((e=>{Object.defineProperty(e,`__esModule`,{value:!0});var t=function e(t,n,r){t===null&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(i===void 0){var a=Object.getPrototypeOf(t);return a===null?void 0:e(a,n,r)}else if(`value`in i)return i.value;else{var o=i.get;return o===void 0?void 0:o.call(r)}},n=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,`value`in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),r=Wu(),i=s(r),a=Gu(),o=s(a);function s(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!e)throw ReferenceError(`this hasn't been initialised - super() hasn't been called`);return t&&(typeof t==`object`||typeof t==`function`)?t:e}function l(e,t){if(typeof t!=`function`&&t!==null)throw TypeError(`Super expression must either be null or a function, not `+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}e.Pane=function(){function e(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document.body;u(this,e),this.target=t,this.element=i.default.createElement(`svg`),this.marks=[],this.element.style.position=`absolute`,this.element.setAttribute(`pointer-events`,`none`),o.default.proxyMouse(this.target,this.marks),this.container=n,this.container.appendChild(this.element),this.render()}return n(e,[{key:`addMark`,value:function(e){var t=i.default.createElement(`g`);return this.element.appendChild(t),e.bind(t,this.container),this.marks.push(e),e.render(),e}},{key:`removeMark`,value:function(e){var t=this.marks.indexOf(e);if(t!==-1){var n=e.unbind();this.element.removeChild(n),this.marks.splice(t,1)}}},{key:`render`,value:function(){f(this.element,d(this.target,this.container));var e=!0,t=!1,n=void 0;try{for(var r=this.marks[Symbol.iterator](),i;!(e=(i=r.next()).done);e=!0)i.value.render()}catch(e){t=!0,n=e}finally{try{!e&&r.return&&r.return()}finally{if(t)throw n}}}}]),e}(),e.Underline=function(e){l(t,e);function t(e,n,r,i){return u(this,t),c(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,r,i))}return n(t,[{key:`render`,value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),r=this.container.getBoundingClientRect(),a=0,o=t.length;a<o;a++){var s=t[a],c=i.default.createElement(`rect`);c.setAttribute(`x`,s.left-n.left+r.left),c.setAttribute(`y`,s.top-n.top+r.top),c.setAttribute(`height`,s.height),c.setAttribute(`width`,s.width),c.setAttribute(`fill`,`none`);var l=i.default.createElement(`line`);l.setAttribute(`x1`,s.left-n.left+r.left),l.setAttribute(`x2`,s.left-n.left+r.left+s.width),l.setAttribute(`y1`,s.top-n.top+r.top+s.height-1),l.setAttribute(`y2`,s.top-n.top+r.top+s.height-1),l.setAttribute(`stroke-width`,1),l.setAttribute(`stroke`,`black`),l.setAttribute(`stroke-linecap`,`square`),e.appendChild(c),e.appendChild(l)}this.element.appendChild(e)}}]),t}(e.Highlight=function(e){l(r,e);function r(e,t,n,i){u(this,r);var a=c(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return a.range=e,a.className=t,a.data=n||{},a.attributes=i||{},a}return n(r,[{key:`bind`,value:function(e,n){for(var i in t(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),`bind`,this).call(this,e,n),this.data)this.data.hasOwnProperty(i)&&(this.element.dataset[i]=this.data[i]);for(var i in this.attributes)this.attributes.hasOwnProperty(i)&&this.element.setAttribute(i,this.attributes[i]);this.className&&this.element.classList.add(this.className)}},{key:`render`,value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var e=this.element.ownerDocument.createDocumentFragment(),t=this.filteredRanges(),n=this.element.getBoundingClientRect(),r=this.container.getBoundingClientRect(),a=0,o=t.length;a<o;a++){var s=t[a],c=i.default.createElement(`rect`);c.setAttribute(`x`,s.left-n.left+r.left),c.setAttribute(`y`,s.top-n.top+r.top),c.setAttribute(`height`,s.height),c.setAttribute(`width`,s.width),e.appendChild(c)}this.element.appendChild(e)}}]),r}(e.Mark=function(){function e(){u(this,e),this.element=null}return n(e,[{key:`bind`,value:function(e,t){this.element=e,this.container=t}},{key:`unbind`,value:function(){var e=this.element;return this.element=null,e}},{key:`render`,value:function(){}},{key:`dispatchEvent`,value:function(e){this.element&&this.element.dispatchEvent(e)}},{key:`getBoundingClientRect`,value:function(){return this.element.getBoundingClientRect()}},{key:`getClientRects`,value:function(){for(var e=[],t=this.element.firstChild;t;)e.push(t.getBoundingClientRect()),t=t.nextSibling;return e}},{key:`filteredRanges`,value:function(){var e=Array.from(this.range.getClientRects());return e.filter(function(t){for(var n=0;n<e.length;n++){if(e[n]===t)return!0;if(p(e[n],t))return!1}return!0})}}]),e}()));function d(e,t){var n=t.getBoundingClientRect(),r=e.getBoundingClientRect();return{top:r.top-n.top,left:r.left-n.left,height:e.scrollHeight,width:e.scrollWidth}}function f(e,t){e.style.setProperty(`top`,t.top+`px`,`important`),e.style.setProperty(`left`,t.left+`px`,`important`),e.style.setProperty(`height`,t.height+`px`,`important`),e.style.setProperty(`width`,t.width+`px`,`important`)}function p(e,t){return t.right<=e.right&&t.left>=e.left&&t.top>=e.top&&t.bottom<=e.bottom}})),qu=l(qc()),Ju=l(Ku()),Yu=class{constructor(e,t){this.settings=ml({ignoreClass:``,axis:void 0,direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0,forceRight:!1,allowScriptedContent:!1,allowPopups:!1},t||{}),this.id=`epubjs-view-`+sl(),this.section=e,this.index=e.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new eu,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}container(e){var t=document.createElement(`div`);return t.classList.add(`epub-view`),t.style.height=`0px`,t.style.width=`0px`,t.style.overflow=`hidden`,t.style.position=`relative`,t.style.display=`block`,e&&e==`horizontal`?t.style.flex=`none`:t.style.flex=`initial`,t}create(){return this.iframe?this.iframe:(this.element||=this.createContainer(),this.iframe=document.createElement(`iframe`),this.iframe.id=this.id,this.iframe.scrolling=`no`,this.iframe.style.overflow=`hidden`,this.iframe.seamless=`seamless`,this.iframe.style.border=`none`,this.iframe.sandbox=`allow-same-origin`,this.settings.allowScriptedContent&&(this.iframe.sandbox+=` allow-scripts`),this.settings.allowPopups&&(this.iframe.sandbox+=` allow-popups`),this.iframe.setAttribute(`enable-annotation`,`true`),this.resizing=!0,this.element.style.visibility=`hidden`,this.iframe.style.visibility=`hidden`,this.iframe.style.width=`0`,this.iframe.style.height=`0`,this._width=0,this._height=0,this.element.setAttribute(`ref`,this.index),this.added=!0,this.elementBounds=vl(this.element),`srcdoc`in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?`srcdoc`:`write`),this.iframe)}render(e,t){return this.create(),this.size(),this.sectionRender||=this.section.render(e),this.sectionRender.then(function(e){return this.load(e)}.bind(this)).then(function(){let e=this.contents.writingMode(),t;return t=this.settings.flow===`scrolled`?e.indexOf(`vertical`)===0?`horizontal`:`vertical`:e.indexOf(`vertical`)===0?`vertical`:`horizontal`,e.indexOf(`vertical`)===0&&this.settings.flow===`paginated`&&(this.layout.delta=this.layout.height),this.setAxis(t),this.emit($.VIEWS.AXIS,t),this.setWritingMode(e),this.emit($.VIEWS.WRITING_MODE,e),this.layout.format(this.contents,this.section,this.axis),this.addListeners(),new Promise((e,t)=>{this.expand(),this.settings.forceRight&&(this.element.style.marginLeft=this.width()+`px`),e()})}.bind(this),function(e){return this.emit($.VIEWS.LOAD_ERROR,e),new Promise((t,n)=>{n(e)})}.bind(this)).then(function(){this.emit($.VIEWS.RENDERED,this.section)}.bind(this))}reset(){this.iframe&&(this.iframe.style.width=`0`,this.iframe.style.height=`0`,this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}size(e,t){var n=e||this.settings.width,r=t||this.settings.height;this.layout.name===`pre-paginated`?this.lock(`both`,n,r):this.settings.axis===`horizontal`?this.lock(`height`,n,r):this.lock(`width`,n,r),this.settings.width=n,this.settings.height=r}lock(e,t,n){var r=yl(this.element),i=this.iframe?yl(this.iframe):{width:0,height:0};e==`width`&&ul(t)&&(this.lockedWidth=t-r.width-i.width),e==`height`&&ul(n)&&(this.lockedHeight=n-r.height-i.height),e===`both`&&ul(t)&&ul(n)&&(this.lockedWidth=t-r.width-i.width,this.lockedHeight=n-r.height-i.height),this.displayed&&this.iframe&&this.expand()}expand(e){var t=this.lockedWidth,n=this.lockedHeight,r;!this.iframe||this._expanding||(this._expanding=!0,this.layout.name===`pre-paginated`?(t=this.layout.columnWidth,n=this.layout.height):this.settings.axis===`horizontal`?(t=this.contents.textWidth(),t%this.layout.pageWidth>0&&(t=Math.ceil(t/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(r=t/this.layout.pageWidth,this.layout.divisor>1&&this.layout.name===`reflowable`&&r%2>0&&(t+=this.layout.pageWidth))):this.settings.axis===`vertical`&&(n=this.contents.textHeight(),this.settings.flow===`paginated`&&n%this.layout.height>0&&(n=Math.ceil(n/this.layout.height)*this.layout.height)),(this._needsReframe||t!=this._width||n!=this._height)&&this.reframe(t,n),this._expanding=!1)}reframe(e,t){var n;ul(e)&&(this.element.style.width=e+`px`,this.iframe.style.width=e+`px`,this._width=e),ul(t)&&(this.element.style.height=t+`px`,this.iframe.style.height=t+`px`,this._height=t);let r=this.prevBounds?e-this.prevBounds.width:e,i=this.prevBounds?t-this.prevBounds.height:t;n={width:e,height:t,widthDelta:r,heightDelta:i},this.pane&&this.pane.render(),requestAnimationFrame(()=>{let e;for(let t in this.marks)this.marks.hasOwnProperty(t)&&(e=this.marks[t],this.placeMark(e.element,e.range))}),this.onResize(this,n),this.emit($.VIEWS.RESIZED,n),this.prevBounds=n,this.elementBounds=vl(this.element)}load(e){var t=new zl,n=t.promise;if(!this.iframe)return t.reject(Error(`No Iframe Available`)),n;if(this.iframe.onload=function(e){this.onLoad(e,t)}.bind(this),this.settings.method===`blobUrl`)this.blobUrl=Dl(e,`application/xhtml+xml`),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if(this.settings.method===`srcdoc`)this.iframe.srcdoc=e,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return t.reject(Error(`No Document Available`)),n;if(this.iframe.contentDocument.open(),window.MSApp&&MSApp.execUnsafeLocalFunction){var r=this;MSApp.execUnsafeLocalFunction(function(){r.iframe.contentDocument.write(e)})}else this.iframe.contentDocument.write(e);this.iframe.contentDocument.close()}return n}onLoad(e,t){this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new zu(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var n=this.document.querySelector(`link[rel='canonical']`);n?n.setAttribute(`href`,this.section.canonical):(n=this.document.createElement(`link`),n.setAttribute(`rel`,`canonical`),n.setAttribute(`href`,this.section.canonical),this.document.querySelector(`head`).appendChild(n)),this.contents.on($.CONTENTS.EXPAND,()=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),this.contents.on($.CONTENTS.RESIZE,e=>{this.displayed&&this.iframe&&(this.expand(),this.contents&&this.layout.format(this.contents))}),t.resolve(this.contents)}setLayout(e){this.layout=e,this.contents&&(this.layout.format(this.contents),this.expand())}setAxis(e){this.settings.axis=e,e==`horizontal`?this.element.style.flex=`none`:this.element.style.flex=`initial`,this.size()}setWritingMode(e){this.writingMode=e}addListeners(){}removeListeners(e){}display(e){var t=new zl;return this.displayed?t.resolve(this):this.render(e).then(function(){this.emit($.VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,t.resolve(this)}.bind(this),function(e){t.reject(e,this)}),t.promise}show(){this.element.style.visibility=`visible`,this.iframe&&(this.iframe.style.visibility=`visible`,this.iframe.style.transform=`translateZ(0)`,this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit($.VIEWS.SHOWN,this)}hide(){this.element.style.visibility=`hidden`,this.iframe.style.visibility=`hidden`,this.stopExpanding=!0,this.emit($.VIEWS.HIDDEN,this)}offset(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}width(){return this._width}height(){return this._height}position(){return this.element.getBoundingClientRect()}locationOf(e){this.iframe.getBoundingClientRect();var t=this.contents.locationOf(e,this.settings.ignoreClass);return{left:t.left,top:t.top}}onDisplayed(e){}onResize(e,t){}bounds(e){return(e||!this.elementBounds)&&(this.elementBounds=vl(this.element)),this.elementBounds}highlight(e,t={},n,r=`epubjs-hl`,i={}){if(!this.contents)return;let a=Object.assign({fill:`yellow`,"fill-opacity":`0.3`,"mix-blend-mode":`multiply`},i),o=this.contents.range(e),s=()=>{this.emit($.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||=new Ju.Pane(this.iframe,this.element);let c=new Ju.Highlight(o,r,t,a),l=this.pane.addMark(c);return this.highlights[e]={mark:l,element:l.element,listeners:[s,n]},l.element.setAttribute(`ref`,r),l.element.addEventListener(`click`,s),l.element.addEventListener(`touchstart`,s),n&&(l.element.addEventListener(`click`,n),l.element.addEventListener(`touchstart`,n)),l}underline(e,t={},n,r=`epubjs-ul`,i={}){if(!this.contents)return;let a=Object.assign({stroke:`black`,"stroke-opacity":`0.3`,"mix-blend-mode":`multiply`},i),o=this.contents.range(e),s=()=>{this.emit($.VIEWS.MARK_CLICKED,e,t)};t.epubcfi=e,this.pane||=new Ju.Pane(this.iframe,this.element);let c=new Ju.Underline(o,r,t,a),l=this.pane.addMark(c);return this.underlines[e]={mark:l,element:l.element,listeners:[s,n]},l.element.setAttribute(`ref`,r),l.element.addEventListener(`click`,s),l.element.addEventListener(`touchstart`,s),n&&(l.element.addEventListener(`click`,n),l.element.addEventListener(`touchstart`,n)),l}mark(e,t={},n){if(!this.contents)return;if(e in this.marks)return this.marks[e];let r=this.contents.range(e);if(!r)return;let i=r.commonAncestorContainer,a=i.nodeType===1?i:i.parentNode,o=n=>{this.emit($.VIEWS.MARK_CLICKED,e,t)};r.collapsed&&i.nodeType===1?(r=new Range,r.selectNodeContents(i)):r.collapsed&&(r=new Range,r.selectNodeContents(a));let s=this.document.createElement(`a`);return s.setAttribute(`ref`,`epubjs-mk`),s.style.position=`absolute`,s.dataset.epubcfi=e,t&&Object.keys(t).forEach(e=>{s.dataset[e]=t[e]}),n&&(s.addEventListener(`click`,n),s.addEventListener(`touchstart`,n)),s.addEventListener(`click`,o),s.addEventListener(`touchstart`,o),this.placeMark(s,r),this.element.appendChild(s),this.marks[e]={element:s,range:r,listeners:[o,n]},a}placeMark(e,t){let n,r,i;if(this.layout.name===`pre-paginated`||this.settings.axis!==`horizontal`){let e=t.getBoundingClientRect();n=e.top,r=e.right}else{let e=t.getClientRects(),o;for(var a=0;a!=e.length;a++)o=e[a],(!i||o.left<i)&&(i=o.left,r=Math.ceil(i/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,n=o.top)}e.style.top=`${n}px`,e.style.left=`${r}px`}unhighlight(e){let t;e in this.highlights&&(t=this.highlights[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener(`click`,e),t.element.removeEventListener(`touchstart`,e))}),delete this.highlights[e])}ununderline(e){let t;e in this.underlines&&(t=this.underlines[e],this.pane.removeMark(t.mark),t.listeners.forEach(e=>{e&&(t.element.removeEventListener(`click`,e),t.element.removeEventListener(`touchstart`,e))}),delete this.underlines[e])}unmark(e){let t;e in this.marks&&(t=this.marks[e],this.element.removeChild(t.element),t.listeners.forEach(e=>{e&&(t.element.removeEventListener(`click`,e),t.element.removeEventListener(`touchstart`,e))}),delete this.marks[e])}destroy(){for(let e in this.highlights)this.unhighlight(e);for(let e in this.underlines)this.ununderline(e);for(let e in this.marks)this.unmark(e);this.blobUrl&&Ol(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.pane&&=(this.pane.element.remove(),void 0),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}};(0,qu.default)(Yu.prototype);var Xu=Yu;function Zu(){var e=`reverse`,t=Qu();return document.body.appendChild(t),t.scrollLeft>0?e=`default`:typeof Element<`u`&&Element.prototype.scrollIntoView?(t.children[0].children[1].scrollIntoView(),t.scrollLeft<0&&(e=`negative`)):(t.scrollLeft=1,t.scrollLeft===0&&(e=`negative`)),document.body.removeChild(t),e}function Qu(){var e=document.createElement(`div`);e.dir=`rtl`,e.style.position=`fixed`,e.style.width=`1px`,e.style.height=`1px`,e.style.top=`0px`,e.style.left=`0px`,e.style.overflow=`hidden`;var t=document.createElement(`div`);t.style.width=`2px`;var n=document.createElement(`span`);n.style.width=`1px`,n.style.display=`inline-block`;var r=document.createElement(`span`);return r.style.width=`1px`,r.style.display=`inline-block`,t.appendChild(n),t.appendChild(r),e.appendChild(t),e}var $u=o(((e,t)=>{function n(e){var t=typeof e;return e!=null&&(t==`object`||t==`function`)}t.exports=n})),ed=o(((e,t)=>{t.exports=typeof global==`object`&&global&&global.Object===Object&&global})),td=o(((e,t)=>{var n=ed(),r=typeof self==`object`&&self&&self.Object===Object&&self;t.exports=n||r||Function(`return this`)()})),nd=o(((e,t)=>{var n=td();t.exports=function(){return n.Date.now()}})),rd=o(((e,t)=>{var n=/\s/;function r(e){for(var t=e.length;t--&&n.test(e.charAt(t)););return t}t.exports=r})),id=o(((e,t)=>{var n=rd(),r=/^\s+/;function i(e){return e&&e.slice(0,n(e)+1).replace(r,``)}t.exports=i})),ad=o(((e,t)=>{t.exports=td().Symbol})),od=o(((e,t)=>{var n=ad(),r=Object.prototype,i=r.hasOwnProperty,a=r.toString,o=n?n.toStringTag:void 0;function s(e){var t=i.call(e,o),n=e[o];try{e[o]=void 0;var r=!0}catch{}var s=a.call(e);return r&&(t?e[o]=n:delete e[o]),s}t.exports=s})),sd=o(((e,t)=>{var n=Object.prototype.toString;function r(e){return n.call(e)}t.exports=r})),cd=o(((e,t)=>{var n=ad(),r=od(),i=sd(),a=`[object Null]`,o=`[object Undefined]`,s=n?n.toStringTag:void 0;function c(e){return e==null?e===void 0?o:a:s&&s in Object(e)?r(e):i(e)}t.exports=c})),ld=o(((e,t)=>{function n(e){return typeof e==`object`&&!!e}t.exports=n})),ud=o(((e,t)=>{var n=cd(),r=ld(),i=`[object Symbol]`;function a(e){return typeof e==`symbol`||r(e)&&n(e)==i}t.exports=a})),dd=o(((e,t)=>{var n=id(),r=$u(),i=ud(),a=NaN,o=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,c=/^0o[0-7]+$/i,l=parseInt;function u(e){if(typeof e==`number`)return e;if(i(e))return a;if(r(e)){var t=typeof e.valueOf==`function`?e.valueOf():e;e=r(t)?t+``:t}if(typeof e!=`string`)return e===0?e:+e;e=n(e);var u=s.test(e);return u||c.test(e)?l(e.slice(2),u?2:8):o.test(e)?a:+e}t.exports=u})),fd=o(((e,t)=>{var n=$u(),r=nd(),i=dd(),a=`Expected a function`,o=Math.max,s=Math.min;function c(e,t,c){var l,u,d,f,p,m,h=0,g=!1,_=!1,v=!0;if(typeof e!=`function`)throw TypeError(a);t=i(t)||0,n(c)&&(g=!!c.leading,_=`maxWait`in c,d=_?o(i(c.maxWait)||0,t):d,v=`trailing`in c?!!c.trailing:v);function y(t){var n=l,r=u;return l=u=void 0,h=t,f=e.apply(r,n),f}function b(e){return h=e,p=setTimeout(C,t),g?y(e):f}function x(e){var n=e-m,r=e-h,i=t-n;return _?s(i,d-r):i}function S(e){var n=e-m,r=e-h;return m===void 0||n>=t||n<0||_&&r>=d}function C(){var e=r();if(S(e))return w(e);p=setTimeout(C,x(e))}function w(e){return p=void 0,v&&l?y(e):(l=u=void 0,f)}function T(){p!==void 0&&clearTimeout(p),h=0,l=m=u=p=void 0}function E(){return p===void 0?f:w(r())}function D(){var e=r(),n=S(e);if(l=arguments,u=this,m=e,n){if(p===void 0)return b(m);if(_)return clearTimeout(p),p=setTimeout(C,t),y(m)}return p===void 0&&(p=setTimeout(C,t)),f}return D.cancel=T,D.flush=E,D}t.exports=c})),pd=l(o(((e,t)=>{var n=fd(),r=$u(),i=`Expected a function`;function a(e,t,a){var o=!0,s=!0;if(typeof e!=`function`)throw TypeError(i);return r(a)&&(o=`leading`in a?!!a.leading:o,s=`trailing`in a?!!a.trailing:s),n(e,t,{leading:o,maxWait:t,trailing:s})}t.exports=a}))()),md=class{constructor(e){this.settings=e||{},this.id=`epubjs-container-`+sl(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}create(e){let t=e.height,n=e.width,r=e.overflow||!1,i=e.axis||`vertical`,a=e.direction;ml(this.settings,e),e.height&&ul(e.height)&&(t=e.height+`px`),e.width&&ul(e.width)&&(n=e.width+`px`);let o=document.createElement(`div`);return o.id=this.id,o.classList.add(`epub-container`),o.style.wordSpacing=`0`,o.style.lineHeight=`0`,o.style.verticalAlign=`top`,o.style.position=`relative`,i===`horizontal`&&(o.style.display=`flex`,o.style.flexDirection=`row`,o.style.flexWrap=`nowrap`),n&&(o.style.width=n),t&&(o.style.height=t),r&&(r===`scroll`&&i===`vertical`?(o.style[`overflow-y`]=r,o.style[`overflow-x`]=`hidden`):r===`scroll`&&i===`horizontal`?(o.style[`overflow-y`]=`hidden`,o.style[`overflow-x`]=r):o.style.overflow=r),a&&(o.dir=a,o.style.direction=a),a&&this.settings.fullsize&&(document.body.style.direction=a),o}wrap(e){var t=document.createElement(`div`);return t.style.visibility=`hidden`,t.style.overflow=`hidden`,t.style.width=`0`,t.style.height=`0`,t.appendChild(e),t}getElement(e){var t;if(ll(e)?t=e:typeof e==`string`&&(t=document.getElementById(e)),!t)throw Error(`Not an Element`);return t}attachTo(e){var t=this.getElement(e),n;if(t)return n=this.settings.hidden?this.wrapper:this.container,t.appendChild(n),this.element=t,t}getContainer(){return this.container}onResize(e){(!ul(this.settings.width)||!ul(this.settings.height))&&(this.resizeFunc=(0,pd.default)(e,50),window.addEventListener(`resize`,this.resizeFunc,!1))}onOrientationChange(e){this.orientationChangeFunc=e,window.addEventListener(`orientationchange`,this.orientationChangeFunc,!1)}size(e,t){var n;let r=e||this.settings.width,i=t||this.settings.height;e===null?(n=this.element.getBoundingClientRect(),n.width&&(e=Math.floor(n.width),this.container.style.width=e+`px`)):ul(e)?this.container.style.width=e+`px`:this.container.style.width=e,t===null?(n||=this.element.getBoundingClientRect(),n.height&&(t=n.height,this.container.style.height=t+`px`)):ul(t)?this.container.style.height=t+`px`:this.container.style.height=t,ul(e)||(e=this.container.clientWidth),ul(t)||(t=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles[`padding-left`])||0,right:parseFloat(this.containerStyles[`padding-right`])||0,top:parseFloat(this.containerStyles[`padding-top`])||0,bottom:parseFloat(this.containerStyles[`padding-bottom`])||0};let a=xl(),o=window.getComputedStyle(document.body),s={left:parseFloat(o[`padding-left`])||0,right:parseFloat(o[`padding-right`])||0,top:parseFloat(o[`padding-top`])||0,bottom:parseFloat(o[`padding-bottom`])||0};return r||(e=a.width-s.left-s.right),(this.settings.fullsize&&!i||!i)&&(t=a.height-s.top-s.bottom),{width:e-this.containerPadding.left-this.containerPadding.right,height:t-this.containerPadding.top-this.containerPadding.bottom}}bounds(){let e;return this.container.style.overflow!==`visible`&&(e=this.container&&this.container.getBoundingClientRect()),!e||!e.width||!e.height?xl():e}getSheet(){var e=document.createElement(`style`);return e.appendChild(document.createTextNode(``)),document.head.appendChild(e),e.sheet}addStyleRules(e,t){var n=`#`+this.id+` `,r=``;this.sheet||=this.getSheet(),t.forEach(function(e){for(var t in e)e.hasOwnProperty(t)&&(r+=t+`:`+e[t]+`;`)}),this.sheet.insertRule(n+e+` {`+r+`}`,0)}axis(e){e===`horizontal`?(this.container.style.display=`flex`,this.container.style.flexDirection=`row`,this.container.style.flexWrap=`nowrap`):this.container.style.display=`block`,this.settings.axis=e}direction(e){this.container&&(this.container.dir=e,this.container.style.direction=e),this.settings.fullsize&&(document.body.style.direction=e),this.settings.dir=e}overflow(e){this.container&&(e===`scroll`&&this.settings.axis===`vertical`?(this.container.style[`overflow-y`]=e,this.container.style[`overflow-x`]=`hidden`):e===`scroll`&&this.settings.axis===`horizontal`?(this.container.style[`overflow-y`]=`hidden`,this.container.style[`overflow-x`]=e):this.container.style.overflow=e),this.settings.overflow=e}destroy(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener(`resize`,this.resizeFunc),window.removeEventListener(`orientationChange`,this.orientationChangeFunc))}},hd=class{constructor(e){this.container=e,this._views=[],this.length=0,this.hidden=!1}all(){return this._views}first(){return this._views[0]}last(){return this._views[this._views.length-1]}indexOf(e){return this._views.indexOf(e)}slice(){return this._views.slice.apply(this._views,arguments)}get(e){return this._views[e]}append(e){return this._views.push(e),this.container&&this.container.appendChild(e.element),this.length++,e}prepend(e){return this._views.unshift(e),this.container&&this.container.insertBefore(e.element,this.container.firstChild),this.length++,e}insert(e,t){return this._views.splice(t,0,e),this.container&&(t<this.container.children.length?this.container.insertBefore(e.element,this.container.children[t]):this.container.appendChild(e.element)),this.length++,e}remove(e){var t=this._views.indexOf(e);t>-1&&this._views.splice(t,1),this.destroy(e),this.length--}destroy(e){e.displayed&&e.destroy(),this.container&&this.container.removeChild(e.element),e=null}forEach(){return this._views.forEach.apply(this._views,arguments)}clear(){var e,t=this.length;if(this.length){for(var n=0;n<t;n++)e=this._views[n],this.destroy(e);this._views=[],this.length=0}}find(e){for(var t,n=this.length,r=0;r<n;r++)if(t=this._views[r],t.displayed&&t.section.index==e.index)return t}displayed(){for(var e=[],t,n=this.length,r=0;r<n;r++)t=this._views[r],t.displayed&&e.push(t);return e}show(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.show();this.hidden=!1}hide(){for(var e,t=this.length,n=0;n<t;n++)e=this._views[n],e.displayed&&e.hide();this.hidden=!0}},gd=l(qc()),_d=class{constructor(e){this.name=`default`,this.optsSettings=e.settings,this.View=e.view,this.request=e.request,this.renditionQueue=e.queue,this.q=new fu(this),this.settings=ml(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,writingMode:void 0,flow:`scrolled`,ignoreClass:``,fullsize:void 0,allowScriptedContent:!1,allowPopups:!1}),ml(this.settings,e.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.rendered=!1}render(e,t){let n=e.tagName;this.settings.fullsize===void 0&&n&&(n.toLowerCase()==`body`||n.toLowerCase()==`html`)&&(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow=`visible`,this.overflow=this.settings.overflow),this.settings.size=t,this.settings.rtlScrollType=Zu(),this.stage=new md({width:t.width,height:t.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(e),this.container=this.stage.getContainer(),this.views=new hd(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}addEventListeners(){var e;window.addEventListener(`unload`,function(e){this.destroy()}.bind(this)),e=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),e.addEventListener(`scroll`,this._onScroll)}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener(`scroll`,this._onScroll),this._onScroll=void 0}destroy(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}onOrientationChange(e){let{orientation:t}=window;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit($.MANAGERS.ORIENTATION_CHANGE,t)}.bind(this),500)}onResized(e){this.resize()}resize(e,t,n){let r=this.stage.size(e,t);if(this.winBounds=xl(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height){this._stageSize=void 0;return}this._stageSize&&this._stageSize.width===r.width&&this._stageSize.height===r.height||(this._stageSize=r,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit($.MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height},n))}createView(e,t){return new this.View(e,ml(this.viewSettings,{forceRight:t}))}handleNextPrePaginated(e,t,n){let r;if(this.layout.name===`pre-paginated`&&this.layout.divisor>1){if(e||t.index===0)return;if(r=t.next(),r&&!r.properties.includes(`page-spread-left`))return n.call(this,r)}}display(e,t){var n=new zl,r=n.promise;(t===e.href||ul(t))&&(t=void 0);var i=this.views.find(e);if(i&&e&&this.layout.name!==`pre-paginated`){let e=i.offset();if(this.settings.direction===`ltr`)this.scrollTo(e.left,e.top,!0);else{let t=i.width();this.scrollTo(e.left+t,e.top,!0)}if(t){let e=i.locationOf(t),n=i.width();this.moveTo(e,n)}return n.resolve(),r}this.clear();let a=!1;return this.layout.name===`pre-paginated`&&this.layout.divisor===2&&e.properties.includes(`page-spread-right`)&&(a=!0),this.add(e,a).then(function(e){if(t){let n=e.locationOf(t),r=e.width();this.moveTo(n,r)}}.bind(this),e=>{n.reject(e)}).then(function(){return this.handleNextPrePaginated(a,e,this.add)}.bind(this)).then(function(){this.views.show(),n.resolve()}.bind(this)),r}afterDisplayed(e){this.emit($.MANAGERS.ADDED,e)}afterResized(e){this.emit($.MANAGERS.RESIZE,e.section)}moveTo(e,t){var n=0,r=0;this.isPaginated?(n=Math.floor(e.left/this.layout.delta)*this.layout.delta,n+this.layout.delta>this.container.scrollWidth&&(n=this.container.scrollWidth-this.layout.delta),r=Math.floor(e.top/this.layout.delta)*this.layout.delta,r+this.layout.delta>this.container.scrollHeight&&(r=this.container.scrollHeight-this.layout.delta)):r=e.top,this.settings.direction===`rtl`&&(n+=this.layout.delta,n-=t),this.scrollTo(n,r,!0)}add(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}append(e,t){var n=this.createView(e,t);return this.views.append(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}prepend(e,t){var n=this.createView(e,t);return n.on($.VIEWS.RESIZED,e=>{this.counter(e)}),this.views.prepend(n),n.onDisplayed=this.afterDisplayed.bind(this),n.onResize=this.afterResized.bind(this),n.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),n.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),n.display(this.request)}counter(e){this.settings.axis===`vertical`?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}next(){var e,t;let n=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis===`horizontal`&&(!n||n===`ltr`)?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft+this.container.offsetWidth+this.layout.delta,t<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):this.isPaginated&&this.settings.axis===`horizontal`&&n===`rtl`?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType===`default`?(t=this.container.scrollLeft,t>0?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next()):(t=this.container.scrollLeft+this.layout.delta*-1,t>this.container.scrollWidth*-1?this.scrollBy(this.layout.delta,0,!0):e=this.views.last().section.next())):this.isPaginated&&this.settings.axis===`vertical`?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):e=this.views.last().section.next()):e=this.views.last().section.next(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name===`pre-paginated`&&this.layout.divisor===2&&e.properties.includes(`page-spread-right`)&&(t=!0),this.append(e,t).then(function(){return this.handleNextPrePaginated(t,e,this.append)}.bind(this),e=>e).then(function(){!this.isPaginated&&this.settings.axis===`horizontal`&&this.settings.direction===`rtl`&&this.settings.rtlScrollType===`default`&&this.scrollTo(this.container.scrollWidth,0,!0),this.views.show()}.bind(this))}}prev(){var e,t;let n=this.settings.direction;if(this.views.length&&(this.isPaginated&&this.settings.axis===`horizontal`&&(!n||n===`ltr`)?(this.scrollLeft=this.container.scrollLeft,t=this.container.scrollLeft,t>0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):this.isPaginated&&this.settings.axis===`horizontal`&&n===`rtl`?(this.scrollLeft=this.container.scrollLeft,this.settings.rtlScrollType===`default`?(t=this.container.scrollLeft+this.container.offsetWidth,t<this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev()):(t=this.container.scrollLeft,t<0?this.scrollBy(-this.layout.delta,0,!0):e=this.views.first().section.prev())):this.isPaginated&&this.settings.axis===`vertical`?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):e=this.views.first().section.prev()):e=this.views.first().section.prev(),e)){this.clear(),this.updateLayout();let t=!1;return this.layout.name===`pre-paginated`&&this.layout.divisor===2&&typeof e.prev()!=`object`&&(t=!0),this.prepend(e,t).then(function(){var t;if(this.layout.name===`pre-paginated`&&this.layout.divisor>1&&(t=e.prev(),t))return this.prepend(t)}.bind(this),e=>e).then(function(){this.isPaginated&&this.settings.axis===`horizontal`&&(this.settings.direction===`rtl`?this.settings.rtlScrollType===`default`?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth*-1+this.layout.delta,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))}}current(){var e=this.visible();return e.length?e[e.length-1]:null}clear(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}currentLocation(){return this.updateLayout(),this.isPaginated&&this.settings.axis===`horizontal`?this.location=this.paginatedLocation():this.location=this.scrolledLocation(),this.location}scrolledLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=t.height<window.innerHeight?t.height:window.innerHeight,r=t.width<window.innerWidth?t.width:window.innerWidth,i=this.settings.axis===`vertical`;this.settings.direction;let a=0;return this.settings.fullsize&&(a=i?window.scrollY:window.scrollX),e.map(e=>{let{index:o,href:s}=e.section,c=e.position(),l=e.width(),u=e.height(),d,f,p,m;i?(d=a+t.top-c.top+0,f=d+n-0,m=this.layout.count(u,n).pages,p=n):(d=a+t.left-c.left+0,f=d+r-0,m=this.layout.count(l,r).pages,p=r);let h=Math.ceil(d/p),g=[],_=Math.ceil(f/p);if(this.settings.direction===`rtl`&&!i){let e=h;h=m-_,_=m-e}g=[];for(var v=h;v<=_;v++){let e=v+1;g.push(e)}let y=this.mapping.page(e.contents,e.section.cfiBase,d,f);return{index:o,href:s,pages:g,totalPages:m,mapping:y}})}paginatedLocation(){let e=this.visible(),t=this.container.getBoundingClientRect(),n=0,r=0;return this.settings.fullsize&&(n=window.scrollX),e.map(e=>{let{index:i,href:a}=e.section,o,s=e.position(),c=e.width(),l,u,d;this.settings.direction===`rtl`?(o=t.right-n,d=Math.min(Math.abs(o-s.left),this.layout.width)-r,u=s.width-(s.right-o)-r,l=u-d):(o=t.left+n,d=Math.min(s.right-o,this.layout.width)-r,l=o-s.left+r,u=l+d),r+=d;let f=this.mapping.page(e.contents,e.section.cfiBase,l,u),p=this.layout.count(c).pages,m=Math.floor(l/this.layout.pageWidth),h=[],g=Math.floor(u/this.layout.pageWidth);if(m<0&&(m=0,g+=1),this.settings.direction===`rtl`){let e=m;m=p-g,g=p-e}for(var _=m+1;_<=g;_++){let e=_;h.push(e)}return{index:i,href:a,pages:h,totalPages:p,mapping:f}})}isVisible(e,t,n,r){var i=e.position(),a=r||this.bounds();return this.settings.axis===`horizontal`&&i.right>a.left-t&&i.left<a.right+n?!0:this.settings.axis===`vertical`&&i.bottom>a.top-t&&i.top<a.bottom+n}visible(){for(var e=this.bounds(),t=this.views.displayed(),n=t.length,r=[],i,a,o=0;o<n;o++)a=t[o],i=this.isVisible(a,0,0,e),i===!0&&r.push(a);return r}scrollBy(e,t,n){let r=this.settings.direction===`rtl`?-1:1;n&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(e*r,t*r):(e&&(this.container.scrollLeft+=e*r),t&&(this.container.scrollTop+=t)),this.scrolled=!0}scrollTo(e,t,n){n&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(e,t):(this.container.scrollLeft=e,this.container.scrollTop=t),this.scrolled=!0}onScroll(){let e,t;this.settings.fullsize?(e=window.scrollY,t=window.scrollX):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:(this.emit($.MANAGERS.SCROLL,{top:e,left:t}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit($.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}bounds(){return this.stage.bounds()}applyLayout(e){this.layout=e,this.updateLayout(),this.views&&this.views.length>0&&this.layout.name===`pre-paginated`&&this.display(this.views.first().section)}updateLayout(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta/this.layout.divisor):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}setLayout(e){this.viewSettings.layout=e,this.mapping=new Mu(e.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach(function(t){t&&t.setLayout(e)})}updateWritingMode(e){this.writingMode=e}updateAxis(e,t){!t&&e===this.settings.axis||(this.settings.axis=e,this.stage&&this.stage.axis(e),this.viewSettings.axis=e,this.mapping&&=new Mu(this.layout.props,this.settings.direction,this.settings.axis),this.layout&&(e===`vertical`?this.layout.spread(`none`):this.layout.spread(this.layout.settings.spread)))}updateFlow(e,t=`auto`){let n=e===`paginated`||e===`auto`;this.isPaginated=n,e===`scrolled-doc`||e===`scrolled-continuous`||e===`scrolled`?this.updateAxis(`vertical`):this.updateAxis(`horizontal`),this.viewSettings.flow=e,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=n?`hidden`:t,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}getContents(){var e=[];return this.views&&this.views.forEach(function(t){let n=t&&t.contents;n&&e.push(n)}),e}direction(e=`ltr`){this.settings.direction=e,this.stage&&this.stage.direction(e),this.viewSettings.direction=e,this.updateLayout()}isRendered(){return this.rendered}};(0,gd.default)(_d.prototype);var vd=_d,yd=l(qc()),bd=Math.PI/2,xd={easeOutSine:function(e){return Math.sin(e*bd)},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInOutQuint:function(e){return(e/=.5)<1?.5*e**5:.5*((e-2)**5+2)},easeInCubic:function(e){return e**3}},Sd=class{constructor(e,t){this.settings=ml({duration:80,minVelocity:.2,minDistance:10,easing:xd.easeInCubic},t||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(e)}setup(e){this.manager=e,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling=`touch`),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=this.settings.duration*2,this.isVertical=this.manager.settings.axis===`vertical`,!(!this.manager.isPaginated||this.isVertical)&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}supportsTouch(){return!!(`ontouchstart`in window||window.DocumentTouch&&document instanceof DocumentTouch)}disableScroll(){this.element.style.overflow=`hidden`}enableScroll(){this.element.style.overflow=``}addListeners(){this._onResize=this.onResize.bind(this),window.addEventListener(`resize`,this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener(`scroll`,this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener(`touchstart`,this._onTouchStart,{passive:!0}),this.on(`touchstart`,this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener(`touchmove`,this._onTouchMove,{passive:!0}),this.on(`touchmove`,this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener(`touchend`,this._onTouchEnd,{passive:!0}),this.on(`touchend`,this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on($.MANAGERS.ADDED,this._afterDisplayed)}removeListeners(){window.removeEventListener(`resize`,this._onResize),this._onResize=void 0,this.scroller.removeEventListener(`scroll`,this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener(`touchstart`,this._onTouchStart,{passive:!0}),this.off(`touchstart`,this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener(`touchmove`,this._onTouchMove,{passive:!0}),this.off(`touchmove`,this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener(`touchend`,this._onTouchEnd,{passive:!0}),this.off(`touchend`,this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off($.MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}afterDisplayed(e){let t=e.contents;[`touchstart`,`touchmove`,`touchend`].forEach(e=>{t.on(e,e=>this.triggerViewEvent(e,t))})}triggerViewEvent(e,t){this.emit(e.type,e,t)}onScroll(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}onResize(e){this.resizeCanceler=!0}onTouchStart(e){let{screenX:t,screenY:n}=e.touches[0];this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=t,this.startTouchY=n,this.startTime=this.now()),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchMove(e){let{screenX:t,screenY:n}=e.touches[0],r=Math.abs(n-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&r<10&&(this.element.scrollLeft-=t-this.endTouchX),this.endTouchX=t,this.endTouchY=n,this.endTime=this.now()}onTouchEnd(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;let t=this.wasSwiped();t===0?this.snap():this.snap(t),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}wasSwiped(){let e=this.layout.pageWidth*this.layout.divisor,t=this.endTouchX-this.startTouchX,n=Math.abs(t),r=this.endTime-this.startTime,i=t/r,a=this.settings.minVelocity;if(n<=this.settings.minDistance||n>=e)return 0;if(i>a)return-1;if(i<-a)return 1}needsSnap(){let e=this.scrollLeft,t=this.layout.pageWidth*this.layout.divisor;return e%t!==0}snap(e=0){let t=this.scrollLeft,n=this.layout.pageWidth*this.layout.divisor,r=Math.round(t/n)*n;return e&&(r+=e*n),this.smoothScrollTo(r)}smoothScrollTo(e){let t=new zl,n=this.scrollLeft,r=this.now(),i=this.settings.duration,a=this.settings.easing;this.snapping=!0;function o(){let s=this.now(),c=Math.min(1,(s-r)/i);if(a(c),this.touchCanceler||this.resizeCanceler){this.resizeCanceler=!1,this.snapping=!1,t.resolve();return}c<1?(window.requestAnimationFrame(o.bind(this)),this.scrollTo(n+(e-n)*c,0)):(this.scrollTo(e,0),this.snapping=!1,t.resolve())}return o.call(this),t.promise}scrollTo(e=0,t=0){this.fullsize?window.scroll(e,t):(this.scroller.scrollLeft=e,this.scroller.scrollTop=t)}now(){return`now`in window.performance?performance.now():new Date().getTime()}destroy(){this.scroller&&=(this.fullsize&&this.enableScroll(),this.removeListeners(),void 0)}};(0,yd.default)(Sd.prototype);var Cd=Sd,wd=l(fd()),Td=class extends vd{constructor(e){super(e),this.name=`continuous`,this.settings=ml(this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,writingMode:void 0,flow:`scrolled`,offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10,allowScriptedContent:!1,allowPopups:!1}),ml(this.settings,e.settings||{}),e.settings.gap!=`undefined`&&e.settings.gap===0&&(this.settings.gap=e.settings.gap),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,width:0,height:0,forceEvenPages:!1,allowScriptedContent:this.settings.allowScriptedContent,allowPopups:this.settings.allowPopups},this.scrollTop=0,this.scrollLeft=0}display(e,t){return vd.prototype.display.call(this,e,t).then(function(){return this.fill()}.bind(this))}fill(e){var t=e||new zl;return this.q.enqueue(()=>this.check()).then(e=>{e?this.fill(t):t.resolve()}),t.promise}moveTo(e){var t=0,n=0;this.isPaginated?(t=Math.floor(e.left/this.layout.delta)*this.layout.delta,t+this.settings.offsetDelta):(n=e.top,e.top+this.settings.offsetDelta),(t>0||n>0)&&this.scrollBy(t,n,!0)}afterResized(e){this.emit($.MANAGERS.RESIZE,e.section)}removeShownListeners(e){e.onDisplayed=function(){}}add(e){var t=this.createView(e);return this.views.append(t),t.on($.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),t.onDisplayed=this.afterDisplayed.bind(this),t.onResize=this.afterResized.bind(this),t.display(this.request)}append(e){var t=this.createView(e);return t.on($.VIEWS.RESIZED,e=>{t.expanded=!0}),t.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.append(t),t.onDisplayed=this.afterDisplayed.bind(this),t}prepend(e){var t=this.createView(e);return t.on($.VIEWS.RESIZED,e=>{this.counter(e),t.expanded=!0}),t.on($.VIEWS.AXIS,e=>{this.updateAxis(e)}),t.on($.VIEWS.WRITING_MODE,e=>{this.updateWritingMode(e)}),this.views.prepend(t),t.onDisplayed=this.afterDisplayed.bind(this),t}counter(e){this.settings.axis===`vertical`?this.scrollBy(0,e.heightDelta,!0):this.scrollBy(e.widthDelta,0,!0)}update(e){for(var t=this.bounds(),n=this.views.all(),r=n.length,i=[],a=e===void 0?this.settings.offset||0:e,o,s,c=new zl,l=[],u=0;u<r;u++)if(s=n[u],o=this.isVisible(s,a,a,t),o===!0){if(s.displayed)s.show();else{let e=s.display(this.request).then(function(e){e.show()},e=>{s.hide()});l.push(e)}i.push(s)}else this.q.enqueue(s.destroy.bind(s)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return l.length?Promise.all(l).catch(e=>{c.reject(e)}):(c.resolve(),c.promise)}check(e,t){var n=new zl,r=[],i=this.settings.axis===`horizontal`,a=this.settings.offset||0;e&&i&&(a=e),t&&!i&&(a=t);var o=this._bounds;let s=i?this.scrollLeft:this.scrollTop,c=i?Math.floor(o.width):o.height,l=i?this.container.scrollWidth:this.container.scrollHeight,u=this.writingMode&&this.writingMode.indexOf(`vertical`)===0?`vertical`:`horizontal`,d=this.settings.rtlScrollType,f=this.settings.direction===`rtl`;this.settings.fullsize?(i&&f&&d===`negative`||!i&&f&&d===`default`)&&(s*=-1):(f&&d===`default`&&u===`horizontal`&&(s=l-c-s),f&&d===`negative`&&u===`horizontal`&&(s*=-1));let p=()=>{let e=this.views.first(),t=e&&e.section.prev();t&&r.push(this.prepend(t))},m=()=>{let e=this.views.last(),t=e&&e.section.next();t&&r.push(this.append(t))},h=s+c+a,g=s-a;h>=l&&m(),g<0&&p();let _=r.map(e=>e.display(this.request));return r.length?Promise.all(_).then(()=>this.check()).then(()=>this.update(a),e=>e):(this.q.enqueue(function(){this.update()}.bind(this)),n.resolve(!1),n.promise)}trim(){for(var e=new zl,t=this.views.displayed(),n=t[0],r=t[t.length-1],i=this.views.indexOf(n),a=this.views.indexOf(r),o=this.views.slice(0,i),s=this.views.slice(a+1),c=0;c<o.length-1;c++)this.erase(o[c],o);for(var l=1;l<s.length;l++)this.erase(s[l]);return e.resolve(),e.promise}erase(e,t){var n,r;this.settings.fullsize?(n=window.scrollY,r=window.scrollX):(n=this.container.scrollTop,r=this.container.scrollLeft);var i=e.bounds();this.views.remove(e),t&&(this.settings.axis===`vertical`?this.scrollTo(0,n-i.height,!0):this.settings.direction===`rtl`?this.settings.fullsize?this.scrollTo(r+Math.floor(i.width),0,!0):this.scrollTo(r,0,!0):this.scrollTo(r-Math.floor(i.width),0,!0))}addEventListeners(e){window.addEventListener(`unload`,function(e){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new Cd(this,this.settings.snap&&typeof this.settings.snap==`object`&&this.settings.snap))}addScrollListeners(){var e;this.tick=rl;let t=this.settings.direction===`rtl`&&this.settings.rtlScrollType===`default`?-1:1;this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(e=window,this.scrollTop=window.scrollY*t,this.scrollLeft=window.scrollX*t):(e=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),e.addEventListener(`scroll`,this._onScroll),this._scrolled=(0,wd.default)(this.scrolled.bind(this),30),this.didScroll=!1}removeEventListeners(){(this.settings.fullsize?window:this.container).removeEventListener(`scroll`,this._onScroll),this._onScroll=void 0}onScroll(){let e,t,n=this.settings.direction===`rtl`&&this.settings.rtlScrollType===`default`?-1:1;this.settings.fullsize?(e=window.scrollY*n,t=window.scrollX*n):(e=this.container.scrollTop,t=this.container.scrollLeft),this.scrollTop=e,this.scrollLeft=t,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(e-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(t-this.prevScrollLeft),this.prevScrollTop=e,this.prevScrollLeft=t,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}scrolled(){this.q.enqueue(function(){return this.check()}.bind(this)),this.emit($.MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit($.MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}next(){let e=this.layout.props.name===`pre-paginated`&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis===`horizontal`?this.scrollBy(e,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}prev(){let e=this.layout.props.name===`pre-paginated`&&this.layout.props.spread?this.layout.props.delta*2:this.layout.props.delta;this.views.length&&(this.isPaginated&&this.settings.axis===`horizontal`?this.scrollBy(-e,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){return this.check()}.bind(this)))}updateFlow(e){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),super.updateFlow(e,`scroll`),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new Cd(this,this.settings.snap&&typeof this.settings.snap==`object`&&this.settings.snap))}destroy(){super.destroy(),this.snapper&&this.snapper.destroy()}},Ed=l(qc()),Dd=class{constructor(e,t){this.settings=ml(this.settings||{},{width:null,height:null,ignoreClass:``,manager:`default`,view:`iframe`,flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1,defaultDirection:`ltr`,allowScriptedContent:!1,allowPopups:!1}),ml(this.settings,t),typeof this.settings.manager==`object`&&(this.manager=this.settings.manager),this.book=e,this.hooks={},this.hooks.display=new tu(this),this.hooks.serialize=new tu(this),this.hooks.content=new tu(this),this.hooks.unloaded=new tu(this),this.hooks.layout=new tu(this),this.hooks.render=new tu(this),this.hooks.show=new tu(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new ju(this),this.annotations=new Uu(this),this.epubcfi=new eu,this.q=new fu(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new zl,this.started=this.starting.promise,this.q.enqueue(this.start)}setManager(e){this.manager=e}requireManager(e){return typeof e==`string`&&e===`default`?vd:typeof e==`string`&&e===`continuous`?Td:e}requireView(e){return typeof e==`string`&&e===`iframe`?Xu:e}start(){switch(!this.settings.layout&&(this.book.package.metadata.layout===`pre-paginated`||this.book.displayOptions.fixedLayout===`true`)&&(this.settings.layout=`pre-paginated`),this.book.package.metadata.spread){case`none`:this.settings.spread=`none`;break;case`both`:this.settings.spread=!0;break}this.manager||=(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction||this.settings.defaultDirection),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on($.MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on($.MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on($.MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on($.MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on($.MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit($.RENDITION.STARTED),this.starting.resolve()}attachTo(e){return this.q.enqueue(function(){this.manager.render(e,{width:this.settings.width,height:this.settings.height}),this.emit($.RENDITION.ATTACHED)}.bind(this))}display(e){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,e)}_display(e){if(this.book){this.epubcfi.isCfiString(e);var t=new zl,n=t.promise,r;return this.displaying=t,this.book.locations.length()&&dl(e)&&(e=this.book.locations.cfiFromPercentage(parseFloat(e))),r=this.book.spine.get(e),r?(this.manager.display(r,e).then(()=>{t.resolve(r),this.displaying=void 0,this.emit($.RENDITION.DISPLAYED,r),this.reportLocation()},e=>{this.emit($.RENDITION.DISPLAY_ERROR,e)}),n):(t.reject(Error(`No Section Found`)),n)}}afterDisplayed(e){e.on($.VIEWS.MARK_CLICKED,(t,n)=>this.triggerMarkEvent(t,n,e.contents)),this.hooks.render.trigger(e,this).then(()=>{e.contents?this.hooks.content.trigger(e.contents,this).then(()=>{this.emit($.RENDITION.RENDERED,e.section,e)}):this.emit($.RENDITION.RENDERED,e.section,e)})}afterRemoved(e){this.hooks.unloaded.trigger(e,this).then(()=>{this.emit($.RENDITION.REMOVED,e.section,e)})}onResized(e,t){this.emit($.RENDITION.RESIZED,{width:e.width,height:e.height},t),this.location&&this.location.start&&this.display(t||this.location.start.cfi)}onOrientationChange(e){this.emit($.RENDITION.ORIENTATION_CHANGE,e)}moveTo(e){this.manager.moveTo(e)}resize(e,t,n){e&&(this.settings.width=e),t&&(this.settings.height=t),this.manager.resize(e,t,n)}clear(){this.manager.clear()}next(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}prev(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}determineLayoutProperties(e){var t,n=this.settings.layout||e.layout||`reflowable`,r=this.settings.spread||e.spread||`auto`,i=this.settings.orientation||e.orientation||`auto`,a=this.settings.flow||e.flow||`auto`,o=e.viewport||``,s=this.settings.minSpreadWidth||e.minSpreadWidth||800,c=this.settings.direction||e.direction||`ltr`;return(this.settings.width===0||this.settings.width>0)&&(this.settings.height===0||this.settings.height),t={layout:n,spread:r,orientation:i,flow:a,viewport:o,minSpreadWidth:s,direction:c},t}flow(e){var t=e;(e===`scrolled`||e===`scrolled-doc`||e===`scrolled-continuous`)&&(t=`scrolled`),(e===`auto`||e===`paginated`)&&(t=`paginated`),this.settings.flow=e,this._layout&&this._layout.flow(t),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(t),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}layout(e){return e&&(this._layout=new Au(e),this._layout.spread(e.spread,this.settings.minSpreadWidth),this._layout.on($.LAYOUT.UPDATED,(e,t)=>{this.emit($.RENDITION.LAYOUT,e,t)})),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}spread(e,t){this.settings.spread=e,t&&(this.settings.minSpreadWidth=t),this._layout&&this._layout.spread(e,t),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}direction(e){this.settings.direction=e||`ltr`,this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}reportLocation(){return this.q.enqueue(function(){requestAnimationFrame(function(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then==`function`)e.then(function(e){let t=this.located(e);!t||!t.start||!t.end||(this.location=t,this.emit($.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit($.RENDITION.RELOCATED,this.location))}.bind(this));else if(e){let t=this.located(e);if(!t||!t.start||!t.end)return;this.location=t,this.emit($.RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit($.RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}currentLocation(){var e=this.manager.currentLocation();if(e&&e.then&&typeof e.then==`function`)e.then(function(e){return this.located(e)}.bind(this));else if(e)return this.located(e)}located(e){if(!e.length)return{};let t=e[0],n=e[e.length-1],r={start:{index:t.index,href:t.href,cfi:t.mapping.start,displayed:{page:t.pages[0]||1,total:t.totalPages}},end:{index:n.index,href:n.href,cfi:n.mapping.end,displayed:{page:n.pages[n.pages.length-1]||1,total:n.totalPages}}},i=this.book.locations.locationFromCfi(t.mapping.start),a=this.book.locations.locationFromCfi(n.mapping.end);i!=null&&(r.start.location=i,r.start.percentage=this.book.locations.percentageFromLocation(i)),a!=null&&(r.end.location=a,r.end.percentage=this.book.locations.percentageFromLocation(a));let o=this.book.pageList.pageFromCfi(t.mapping.start),s=this.book.pageList.pageFromCfi(n.mapping.end);return o!=-1&&(r.start.page=o),s!=-1&&(r.end.page=s),n.index===this.book.spine.last().index&&r.end.displayed.page>=r.end.displayed.total&&(r.atEnd=!0),t.index===this.book.spine.first().index&&r.start.displayed.page===1&&(r.atStart=!0),r}destroy(){this.manager&&this.manager.destroy(),this.book=void 0}passEvents(e){pu.forEach(t=>{e.on(t,t=>this.triggerViewEvent(t,e))}),e.on($.CONTENTS.SELECTED,t=>this.triggerSelectedEvent(t,e))}triggerViewEvent(e,t){this.emit(e.type,e,t)}triggerSelectedEvent(e,t){this.emit($.RENDITION.SELECTED,e,t)}triggerMarkEvent(e,t,n){this.emit($.RENDITION.MARK_CLICKED,e,t,n)}getRange(e,t){var n=new eu(e),r=this.manager.visible().filter(function(e){if(n.spinePos===e.index)return!0});if(r.length)return r[0].contents.range(n,t)}adjustImages(e){if(this._layout.name===`pre-paginated`)return new Promise(function(e){e()});let t=e.window.getComputedStyle(e.content,null),n=(e.content.offsetHeight-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)))*.95,r=parseFloat(t.paddingLeft)+parseFloat(t.paddingRight);return e.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+`px`:`100%`)+`!important`,"max-height":n+`px!important`,"object-fit":`contain`,"page-break-inside":`avoid`,"break-inside":`avoid`,"box-sizing":`border-box`},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-r+`px`:`100%`)+`!important`,"max-height":n+`px!important`,"page-break-inside":`avoid`,"break-inside":`avoid`}}),new Promise(function(e,t){setTimeout(function(){e()},1)})}getContents(){return this.manager?this.manager.getContents():[]}views(){return(this.manager?this.manager.views:void 0)||[]}handleLinks(e){e&&e.on($.CONTENTS.LINK_CLICKED,e=>{let t=this.book.path.relative(e);this.display(t)})}injectStylesheet(e,t){let n=e.createElement(`link`);n.setAttribute(`type`,`text/css`),n.setAttribute(`rel`,`stylesheet`),n.setAttribute(`href`,this.settings.stylesheet),e.getElementsByTagName(`head`)[0].appendChild(n)}injectScript(e,t){let n=e.createElement(`script`);n.setAttribute(`type`,`text/javascript`),n.setAttribute(`src`,this.settings.script),n.textContent=` `,e.getElementsByTagName(`head`)[0].appendChild(n)}injectIdentifier(e,t){let n=this.book.packaging.metadata.identifier,r=e.createElement(`meta`);r.setAttribute(`name`,`dc.relation.ispartof`),n&&r.setAttribute(`content`,n),e.getElementsByTagName(`head`)[0].appendChild(r)}};(0,Ed.default)(Dd.prototype);var Od=Dd,kd=l(o(((e,t)=>{
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/
(function(n){if(typeof e==`object`&&t!==void 0)t.exports=n();else if(typeof define==`function`&&define.amd)define([],n);else{var r=typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:this;r.JSZip=n()}})(function(){return(function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var c=typeof u==`function`&&u;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var l=Error(`Cannot find module '`+o+`'`);throw l.code=`MODULE_NOT_FOUND`,l}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return i(n||e)},d,d.exports,e,t,n,r)}return n[o].exports}for(var a=typeof u==`function`&&u,o=0;o<r.length;o++)i(r[o]);return i})({1:[function(e,t,n){var r=e(`./utils`),i=e(`./support`),a=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=`;n.encode=function(e){for(var t=[],n,i,o,s,c,l,u,d=0,f=e.length,p=f,m=r.getTypeOf(e)!==`string`;d<e.length;)p=f-d,m?(n=e[d++],i=d<f?e[d++]:0,o=d<f?e[d++]:0):(n=e.charCodeAt(d++),i=d<f?e.charCodeAt(d++):0,o=d<f?e.charCodeAt(d++):0),s=n>>2,c=(n&3)<<4|i>>4,l=p>1?(i&15)<<2|o>>6:64,u=p>2?o&63:64,t.push(a.charAt(s)+a.charAt(c)+a.charAt(l)+a.charAt(u));return t.join(``)},n.decode=function(e){var t,n,r,o,s,c,l,u=0,d=0,f=`data:`;if(e.substr(0,f.length)===f)throw Error(`Invalid base64 input, it looks like a data url.`);e=e.replace(/[^A-Za-z0-9+/=]/g,``);var p=e.length*3/4;if(e.charAt(e.length-1)===a.charAt(64)&&p--,e.charAt(e.length-2)===a.charAt(64)&&p--,p%1!=0)throw Error(`Invalid base64 input, bad content length.`);for(var m=i.uint8array?new Uint8Array(p|0):Array(p|0);u<e.length;)o=a.indexOf(e.charAt(u++)),s=a.indexOf(e.charAt(u++)),c=a.indexOf(e.charAt(u++)),l=a.indexOf(e.charAt(u++)),t=o<<2|s>>4,n=(s&15)<<4|c>>2,r=(c&3)<<6|l,m[d++]=t,c!==64&&(m[d++]=n),l!==64&&(m[d++]=r);return m}},{"./support":30,"./utils":32}],2:[function(e,t,n){var r=e(`./external`),i=e(`./stream/DataWorker`),a=e(`./stream/Crc32Probe`),o=e(`./stream/DataLengthProbe`);function s(e,t,n,r,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=r,this.compressedContent=i}s.prototype={getContentWorker:function(){var e=new i(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o(`data_length`)),t=this;return e.on(`end`,function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw Error(`Bug : uncompressed data size mismatch`)}),e},getCompressedWorker:function(){return new i(r.Promise.resolve(this.compressedContent)).withStreamInfo(`compressedSize`,this.compressedSize).withStreamInfo(`uncompressedSize`,this.uncompressedSize).withStreamInfo(`crc32`,this.crc32).withStreamInfo(`compression`,this.compression)}},s.createWorkerFrom=function(e,t,n){return e.pipe(new a).pipe(new o(`uncompressedSize`)).pipe(t.compressWorker(n)).pipe(new o(`compressedSize`)).withStreamInfo(`compression`,t)},t.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){var r=e(`./stream/GenericWorker`);n.STORE={magic:`\0\0`,compressWorker:function(){return new r(`STORE compression`)},uncompressWorker:function(){return new r(`STORE decompression`)}},n.DEFLATE=e(`./flate`)},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){var r=e(`./utils`);function i(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}var a=i();function o(e,t,n,r){var i=a,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^i[(e^t[s])&255];return e^-1}function s(e,t,n,r){var i=a,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^i[(e^t.charCodeAt(s))&255];return e^-1}t.exports=function(e,t){return e===void 0||!e.length?0:r.getTypeOf(e)===`string`?s(t|0,e,e.length,0):o(t|0,e,e.length,0)}},{"./utils":32}],5:[function(e,t,n){n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){var r=null;r=typeof Promise<`u`?Promise:e(`lie`),t.exports={Promise:r}},{lie:37}],7:[function(e,t,n){var r=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Uint32Array<`u`,i=e(`pako`),a=e(`./utils`),o=e(`./stream/GenericWorker`),s=r?`uint8array`:`array`;n.magic=`\b\0`;function c(e,t){o.call(this,`FlateWorker/`+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}a.inherits(c,o),c.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(s,e.data),!1)},c.prototype.flush=function(){o.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new c(`Deflate`,e)},n.uncompressWorker=function(){return new c(`Inflate`,{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,n){var r=e(`../utils`),i=e(`../stream/GenericWorker`),a=e(`../utf8`),o=e(`../crc32`),s=e(`../signature`),c=function(e,t){var n=``,r;for(r=0;r<t;r++)n+=String.fromCharCode(e&255),e>>>=8;return n},l=function(e,t){var n=e;return e||(n=t?16893:33204),(n&65535)<<16},u=function(e){return(e||0)&63},d=function(e,t,n,i,d,f){var p=e.file,m=e.compression,h=f!==a.utf8encode,g=r.transformTo(`string`,f(p.name)),_=r.transformTo(`string`,a.utf8encode(p.name)),v=p.comment,y=r.transformTo(`string`,f(v)),b=r.transformTo(`string`,a.utf8encode(v)),x=_.length!==p.name.length,S=b.length!==v.length,C,w,T=``,E=``,D=``,O=p.dir,k=p.date,A={crc32:0,compressedSize:0,uncompressedSize:0};(!t||n)&&(A.crc32=e.crc32,A.compressedSize=e.compressedSize,A.uncompressedSize=e.uncompressedSize);var j=0;t&&(j|=8),!h&&(x||S)&&(j|=2048);var M=0,N=0;O&&(M|=16),d===`UNIX`?(N=798,M|=l(p.unixPermissions,O)):(N=20,M|=u(p.dosPermissions,O)),C=k.getUTCHours(),C<<=6,C|=k.getUTCMinutes(),C<<=5,C|=k.getUTCSeconds()/2,w=k.getUTCFullYear()-1980,w<<=4,w|=k.getUTCMonth()+1,w<<=5,w|=k.getUTCDate(),x&&(E=c(1,1)+c(o(g),4)+_,T+=`up`+c(E.length,2)+E),S&&(D=c(1,1)+c(o(y),4)+b,T+=`uc`+c(D.length,2)+D);var P=``;P+=`
\0`,P+=c(j,2),P+=m.magic,P+=c(C,2),P+=c(w,2),P+=c(A.crc32,4),P+=c(A.compressedSize,4),P+=c(A.uncompressedSize,4),P+=c(g.length,2),P+=c(T.length,2);var F=s.LOCAL_FILE_HEADER+P+g+T,I=s.CENTRAL_FILE_HEADER+c(N,2)+P+c(y.length,2)+`\0\0\0\0`+c(M,4)+c(i,4)+g+T+y;return{fileRecord:F,dirRecord:I}},f=function(e,t,n,i,a){var o=``,l=r.transformTo(`string`,a(i));return o=s.CENTRAL_DIRECTORY_END+`\0\0\0\0`+c(e,2)+c(e,2)+c(t,4)+c(n,4)+c(l.length,2)+l,o},p=function(e){var t=``;return t=s.DATA_DESCRIPTOR+c(e.crc32,4)+c(e.compressedSize,4)+c(e.uncompressedSize,4),t};function m(e,t,n,r){i.call(this,`ZipFileWorker`),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=r,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(m,i),m.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,r=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-r-1))/n:100}}))},m.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=d(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},m.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=d(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:p(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},m.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=this.bytesWritten-e,r=f(this.dirRecords.length,n,e,this.zipComment,this.encodeFileName);this.push({data:r,meta:{percent:100}})},m.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},m.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on(`data`,function(e){t.processChunk(e)}),e.on(`end`,function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on(`error`,function(e){t.error(e)}),this},m.prototype.resume=function(){if(!i.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},m.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch{}return!0},m.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=m},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){var r=e(`../compressions`),i=e(`./ZipFileWorker`),a=function(e,t){var n=e||t,i=r[n];if(!i)throw Error(n+` is not a valid compression method !`);return i};n.generateWorker=function(e,t,n){var r=new i(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var i=a(n.options.compression,t.compression),s=n.options.compressionOptions||t.compressionOptions||{},c=n.dir,l=n.date;n._compressWorker(i,s).withStreamInfo(`file`,{name:e,dir:c,date:l,comment:n.comment||``,unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(r)}),r.entriesCount=o}catch(e){r.error(e)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){function r(){if(!(this instanceof r))return new r;if(arguments.length)throw Error(`The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.`);this.files=Object.create(null),this.comment=null,this.root=``,this.clone=function(){var e=new r;for(var t in this)typeof this[t]!=`function`&&(e[t]=this[t]);return e}}r.prototype=e(`./object`),r.prototype.loadAsync=e(`./load`),r.support=e(`./support`),r.defaults=e(`./defaults`),r.version=`3.10.1`,r.loadAsync=function(e,t){return new r().loadAsync(e,t)},r.external=e(`./external`),t.exports=r},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){var r=e(`./utils`),i=e(`./external`),a=e(`./utf8`),o=e(`./zipEntries`),s=e(`./stream/Crc32Probe`),c=e(`./nodejsUtils`);function l(e){return new i.Promise(function(t,n){var r=e.decompressed.getContentWorker().pipe(new s);r.on(`error`,function(e){n(e)}).on(`end`,function(){r.streamInfo.crc32===e.decompressed.crc32?t():n(Error(`Corrupted zip : CRC32 mismatch`))}).resume()})}t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(e)?i.Promise.reject(Error(`JSZip can't accept a stream when loading a zip file.`)):r.prepareContent(`the loaded zip file`,e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new o(t);return n.load(e),n}).then(function(e){var n=[i.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var a=0;a<r.length;a++)n.push(l(r[a]));return i.Promise.all(n)}).then(function(e){for(var i=e.shift(),a=i.files,o=0;o<a.length;o++){var s=a[o],c=s.fileNameStr,l=r.resolve(s.fileNameStr);n.file(l,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileCommentStr.length?s.fileCommentStr:null,unixPermissions:s.unixPermissions,dosPermissions:s.dosPermissions,createFolders:t.createFolders}),s.dir||(n.file(l).unsafeOriginalName=c)}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){var r=e(`../utils`),i=e(`../stream/GenericWorker`);function a(e,t){i.call(this,`Nodejs stream input adapter for `+e),this._upstreamEnded=!1,this._bindStream(t)}r.inherits(a,i),a.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on(`data`,function(e){t.push({data:e,meta:{percent:0}})}).on(`error`,function(e){t.isPaused?this.generatedError=e:t.error(e)}).on(`end`,function(){t.isPaused?t._upstreamEnded=!0:t.end()})},a.prototype.pause=function(){return i.prototype.pause.call(this)?(this._stream.pause(),!0):!1},a.prototype.resume=function(){return i.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1},t.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){var r=e(`readable-stream`).Readable;e(`../utils`).inherits(i,r);function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on(`data`,function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on(`error`,function(e){i.emit(`error`,e)}).on(`end`,function(){i.push(null)})}i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){t.exports={isNode:typeof Buffer<`u`,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if(typeof e==`number`)throw Error(`The "data" argument must not be a number`);return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on==`function`&&typeof e.pause==`function`&&typeof e.resume==`function`}}},{}],15:[function(e,t,n){var r=e(`./utf8`),i=e(`./utils`),a=e(`./stream/GenericWorker`),o=e(`./stream/StreamHelper`),s=e(`./defaults`),c=e(`./compressedObject`),l=e(`./zipObject`),u=e(`./generate`),d=e(`./nodejsUtils`),f=e(`./nodejs/NodejsStreamInputAdapter`),p=function(e,t,n){var r=i.getTypeOf(t),o,u=i.extend(n||{},s);u.date=u.date||new Date,u.compression!==null&&(u.compression=u.compression.toUpperCase()),typeof u.unixPermissions==`string`&&(u.unixPermissions=parseInt(u.unixPermissions,8)),u.unixPermissions&&u.unixPermissions&16384&&(u.dir=!0),u.dosPermissions&&u.dosPermissions&16&&(u.dir=!0),u.dir&&(e=h(e)),u.createFolders&&(o=m(e))&&g.call(this,o,!0);var p=r===`string`&&u.binary===!1&&u.base64===!1;(!n||n.binary===void 0)&&(u.binary=!p),(t instanceof c&&t.uncompressedSize===0||u.dir||!t||t.length===0)&&(u.base64=!1,u.binary=!0,t=``,u.compression=`STORE`,r=`string`);var _=null;_=t instanceof c||t instanceof a?t:d.isNode&&d.isStream(t)?new f(e,t):i.prepareContent(e,t,u.binary,u.optimizedBinaryString,u.base64);var v=new l(e,_,u);this.files[e]=v},m=function(e){e.slice(-1)===`/`&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf(`/`);return t>0?e.substring(0,t):``},h=function(e){return e.slice(-1)!==`/`&&(e+=`/`),e},g=function(e,t){return t=t===void 0?s.createFolders:t,e=h(e),this.files[e]||p.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function _(e){return Object.prototype.toString.call(e)===`[object RegExp]`}t.exports={load:function(){throw Error(`This method has been removed in JSZip 3.0, please check the upgrade guide.`)},forEach:function(e){var t,n,r;for(t in this.files)r=this.files[t],n=t.slice(this.root.length,t.length),n&&t.slice(0,this.root.length)===this.root&&e(n,r)},filter:function(e){var t=[];return this.forEach(function(n,r){e(n,r)&&t.push(r)}),t},file:function(e,t,n){if(arguments.length===1)if(_(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}else{var i=this.files[this.root+e];return i&&!i.dir?i:null}else e=this.root+e,p.call(this,e,t,n);return this},folder:function(e){if(!e)return this;if(_(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=this.root+e,n=g.call(this,t),r=this.clone();return r.root=n.name,r},remove:function(e){e=this.root+e;var t=this.files[e];if(t||=(e.slice(-1)!==`/`&&(e+=`/`),this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),r=0;r<n.length;r++)delete this.files[n[r].name];return this},generate:function(){throw Error(`This method has been removed in JSZip 3.0, please check the upgrade guide.`)},generateInternalStream:function(e){var t,n={};try{if(n=i.extend(e||{},{streamFiles:!1,compression:`STORE`,compressionOptions:null,type:``,platform:`DOS`,comment:null,mimeType:`application/zip`,encodeFileName:r.utf8encode}),n.type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),n.type===`binarystring`&&(n.type=`string`),!n.type)throw Error(`No output type specified.`);i.checkSupport(n.type),(n.platform===`darwin`||n.platform===`freebsd`||n.platform===`linux`||n.platform===`sunos`)&&(n.platform=`UNIX`),n.platform===`win32`&&(n.platform=`DOS`);var s=n.comment||this.comment||``;t=u.generateWorker(this,n,s)}catch(e){t=new a(`error`),t.error(e)}return new o(t,n.type||`string`,n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return e||={},e.type||=`nodebuffer`,this.generateInternalStream(e).toNodejsStream(t)}}},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e(`stream`)},{stream:void 0}],17:[function(e,t,n){var r=e(`./DataReader`),i=e(`../utils`);function a(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=e[t]&255}i.inherits(a,r),a.prototype.byteAt=function(e){return this.data[this.zero+e]},a.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===r&&this.data[a+3]===i)return a-this.zero;return-1},a.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),r=e.charCodeAt(2),i=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&r===a[2]&&i===a[3]},a.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){var r=e(`../utils`);function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw Error(`End of data reached (data length = `+this.length+`, asked index = `+e+`). Corrupted zip ?`)},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t=0,n;for(this.checkOffset(e),n=this.index+e-1;n>=this.index;n--)t=(t<<8)+this.byteAt(n);return this.index+=e,t},readString:function(e){return r.transformTo(`string`,this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){var r=e(`./Uint8ArrayReader`),i=e(`../utils`);function a(e){r.call(this,e)}i.inherits(a,r),a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){var r=e(`./DataReader`),i=e(`../utils`);function a(e){r.call(this,e)}i.inherits(a,r),a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},a.prototype.readAndCheckSignature=function(e){var t=this.readData(4);return e===t},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){var r=e(`./ArrayReader`),i=e(`../utils`);function a(e){r.call(this,e)}i.inherits(a,r),a.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array;var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){var r=e(`../utils`),i=e(`../support`),a=e(`./ArrayReader`),o=e(`./StringReader`),s=e(`./NodeBufferReader`),c=e(`./Uint8ArrayReader`);t.exports=function(e){var t=r.getTypeOf(e);return r.checkSupport(t),t===`string`&&!i.uint8array?new o(e):t===`nodebuffer`?new s(e):i.uint8array?new c(r.transformTo(`uint8array`,e)):new a(r.transformTo(`array`,e))}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){n.LOCAL_FILE_HEADER=`PK`,n.CENTRAL_FILE_HEADER=`PK`,n.CENTRAL_DIRECTORY_END=`PK`,n.ZIP64_CENTRAL_DIRECTORY_LOCATOR=`PK\x07`,n.ZIP64_CENTRAL_DIRECTORY_END=`PK`,n.DATA_DESCRIPTOR=`PK\x07\b`},{}],24:[function(e,t,n){var r=e(`./GenericWorker`),i=e(`../utils`);function a(e){r.call(this,`ConvertWorker to `+e),this.destType=e}i.inherits(a,r),a.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){var r=e(`./GenericWorker`),i=e(`../crc32`),a=e(`../utils`);function o(){r.call(this,`Crc32Probe`),this.withStreamInfo(`crc32`,0)}a.inherits(o,r),o.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){var r=e(`../utils`),i=e(`./GenericWorker`);function a(e){i.call(this,`DataLengthProbe for `+e),this.propName=e,this.withStreamInfo(e,0)}r.inherits(a,i),a.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){var r=e(`../utils`),i=e(`./GenericWorker`),a=16*1024;function o(e){i.call(this,`DataWorker`);var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type=``,this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}r.inherits(o,i),o.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return i.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0):!1},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=a,t=null,n=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case`string`:t=this.data.substring(this.index,n);break;case`uint8array`:t=this.data.subarray(this.index,n);break;case`array`:case`nodebuffer`:t=this.data.slice(this.index,n);break}return this.index=n,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){function r(e){this.name=e||`default`,this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}r.prototype={push:function(e){this.emit(`data`,e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit(`end`),this.cleanUp(),this.isFinished=!0}catch(e){this.emit(`error`,e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit(`error`,e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw Error(`The stream '`+this+`' has already been used.`);this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on(`data`,function(e){t.processChunk(e)}),e.on(`end`,function(){t.end()}),e.on(`error`,function(e){t.error(e)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw Error(`The stream '`+this+`' has already been used.`);this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e=`Worker `+this.name;return this.previous?this.previous+` -> `+e:e}},t.exports=r},{}],29:[function(e,t,n){var r=e(`../utils`),i=e(`./ConvertWorker`),a=e(`./GenericWorker`),o=e(`../base64`),s=e(`../support`),c=e(`../external`),l=null;if(s.nodestream)try{l=e(`../nodejs/NodejsStreamOutputAdapter`)}catch{}function u(e,t,n){switch(e){case`blob`:return r.newBlob(r.transformTo(`arraybuffer`,t),n);case`base64`:return o.encode(t);default:return r.transformTo(e,t)}}function d(e,t){var n,r=0,i=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case`string`:return t.join(``);case`array`:return Array.prototype.concat.apply([],t);case`uint8array`:for(i=new Uint8Array(a),n=0;n<t.length;n++)i.set(t[n],r),r+=t[n].length;return i;case`nodebuffer`:return Buffer.concat(t);default:throw Error(`concat : unsupported type '`+e+`'`)}}function f(e,t){return new c.Promise(function(n,r){var i=[],a=e._internalType,o=e._outputType,s=e._mimeType;e.on(`data`,function(e,n){i.push(e),t&&t(n)}).on(`error`,function(e){i=[],r(e)}).on(`end`,function(){try{var e=u(o,d(a,i),s);n(e)}catch(e){r(e)}i=[]}).resume()})}function p(e,t,n){var o=t;switch(t){case`blob`:case`arraybuffer`:o=`uint8array`;break;case`base64`:o=`string`;break}try{this._internalType=o,this._outputType=t,this._mimeType=n,r.checkSupport(o),this._worker=e.pipe(new i(o)),e.lock()}catch(e){this._worker=new a(`error`),this._worker.error(e)}}p.prototype={accumulate:function(e){return f(this,e)},on:function(e,t){var n=this;return e===`data`?this._worker.on(e,function(e){t.call(n,e.data,e.meta)}):this._worker.on(e,function(){r.delay(t,arguments,n)}),this},resume:function(){return r.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(r.checkSupport(`nodestream`),this._outputType!==`nodebuffer`)throw Error(this._outputType+` is not supported by this method`);return new l(this,{objectMode:this._outputType!==`nodebuffer`},e)}},t.exports=p},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer=typeof ArrayBuffer<`u`&&typeof Uint8Array<`u`,n.nodebuffer=typeof Buffer<`u`,n.uint8array=typeof Uint8Array<`u`,typeof ArrayBuffer>`u`)n.blob=!1;else{var r=new ArrayBuffer(0);try{n.blob=new Blob([r],{type:`application/zip`}).size===0}catch{try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(r),n.blob=i.getBlob(`application/zip`).size===0}catch{n.blob=!1}}}try{n.nodestream=!!e(`readable-stream`).Readable}catch{n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){for(var r=e(`./utils`),i=e(`./support`),a=e(`./nodejsUtils`),o=e(`./stream/GenericWorker`),s=Array(256),c=0;c<256;c++)s[c]=c>=252?6:c>=248?5:c>=240?4:c>=224?3:c>=192?2:1;s[254]=s[254]=1;var l=function(e){var t,n,r,a,o,s=e.length,c=0;for(a=0;a<s;a++)n=e.charCodeAt(a),(n&64512)==55296&&a+1<s&&(r=e.charCodeAt(a+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=i.uint8array?new Uint8Array(c):Array(c),o=0,a=0;o<c;a++)n=e.charCodeAt(a),(n&64512)==55296&&a+1<s&&(r=e.charCodeAt(a+1),(r&64512)==56320&&(n=65536+(n-55296<<10)+(r-56320),a++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|n&63):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|n&63):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|n&63);return t},u=function(e,t){var n;for(t||=e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&(e[n]&192)==128;)n--;return n<0||n===0?t:n+s[e[n]]>t?n:t},d=function(e){var t,n,i,a,o=e.length,c=Array(o*2);for(n=0,t=0;t<o;){if(i=e[t++],i<128){c[n++]=i;continue}if(a=s[i],a>4){c[n++]=65533,t+=a-1;continue}for(i&=a===2?31:a===3?15:7;a>1&&t<o;)i=i<<6|e[t++]&63,a--;if(a>1){c[n++]=65533;continue}i<65536?c[n++]=i:(i-=65536,c[n++]=55296|i>>10&1023,c[n++]=56320|i&1023)}return c.length!==n&&(c.subarray?c=c.subarray(0,n):c.length=n),r.applyFromCharCode(c)};n.utf8encode=function(e){return i.nodebuffer?a.newBufferFrom(e,`utf-8`):l(e)},n.utf8decode=function(e){return i.nodebuffer?r.transformTo(`nodebuffer`,e).toString(`utf-8`):(e=r.transformTo(i.uint8array?`uint8array`:`array`,e),d(e))};function f(){o.call(this,`utf-8 decode`),this.leftOver=null}r.inherits(f,o),f.prototype.processChunk=function(e){var t=r.transformTo(i.uint8array?`uint8array`:`array`,e.data);if(this.leftOver&&this.leftOver.length){if(i.uint8array){var a=t;t=new Uint8Array(a.length+this.leftOver.length),t.set(this.leftOver,0),t.set(a,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=u(t),s=t;o!==t.length&&(i.uint8array?(s=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(s=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:n.utf8decode(s),meta:e.meta})},f.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=f;function p(){o.call(this,`utf-8 encode`)}r.inherits(p,o),p.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=p},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){var r=e(`./support`),i=e(`./base64`),a=e(`./nodejsUtils`),o=e(`./external`);e(`setimmediate`);function s(e){var t=null;return t=r.uint8array?new Uint8Array(e.length):Array(e.length),l(e,t)}n.newBlob=function(e,t){n.checkSupport(`blob`);try{return new Blob([e],{type:t})}catch{try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch{throw Error(`Bug : can't construct the Blob.`)}}};function c(e){return e}function l(e,t){for(var n=0;n<e.length;++n)t[n]=e.charCodeAt(n)&255;return t}var u={stringifyByChunk:function(e,t,n){var r=[],i=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;i<a;)t===`array`||t===`nodebuffer`?r.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+n,a)))):r.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+n,a)))),i+=n;return r.join(``)},stringifyByChar:function(e){for(var t=``,n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:(function(){try{return r.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return r.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}})()}};function d(e){var t=65536,r=n.getTypeOf(e),i=!0;if(r===`uint8array`?i=u.applyCanBeUsed.uint8array:r===`nodebuffer`&&(i=u.applyCanBeUsed.nodebuffer),i)for(;t>1;)try{return u.stringifyByChunk(e,r,t)}catch{t=Math.floor(t/2)}return u.stringifyByChar(e)}n.applyFromCharCode=d;function f(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var p={};p.string={string:c,array:function(e){return l(e,Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,a.allocBuffer(e.length))}},p.array={string:d,array:c,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(e)}},p.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return f(new Uint8Array(e),Array(e.byteLength))},arraybuffer:c,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return a.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:d,array:function(e){return f(e,Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:c,nodebuffer:function(e){return a.newBufferFrom(e)}},p.nodebuffer={string:d,array:function(e){return f(e,Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:c},n.transformTo=function(e,t){if(t||=``,!e)return t;n.checkSupport(e);var r=n.getTypeOf(t);return p[r][e](t)},n.resolve=function(e){for(var t=e.split(`/`),n=[],r=0;r<t.length;r++){var i=t[r];i===`.`||i===``&&r!==0&&r!==t.length-1||(i===`..`?n.pop():n.push(i))}return n.join(`/`)},n.getTypeOf=function(e){if(typeof e==`string`)return`string`;if(Object.prototype.toString.call(e)===`[object Array]`)return`array`;if(r.nodebuffer&&a.isBuffer(e))return`nodebuffer`;if(r.uint8array&&e instanceof Uint8Array)return`uint8array`;if(r.arraybuffer&&e instanceof ArrayBuffer)return`arraybuffer`},n.checkSupport=function(e){if(!r[e.toLowerCase()])throw Error(e+` is not supported by this platform`)},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t=``,n,r;for(r=0;r<(e||``).length;r++)n=e.charCodeAt(r),t+=`\\x`+(n<16?`0`:``)+n.toString(16).toUpperCase();return t},n.delay=function(e,t,n){setImmediate(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e={},t,n;for(t=0;t<arguments.length;t++)for(n in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],n)&&e[n]===void 0&&(e[n]=arguments[t][n]);return e},n.prepareContent=function(e,t,a,c,l){return o.Promise.resolve(t).then(function(e){return r.blob&&(e instanceof Blob||[`[object File]`,`[object Blob]`].indexOf(Object.prototype.toString.call(e))!==-1)&&typeof FileReader<`u`?new o.Promise(function(t,n){var r=new FileReader;r.onload=function(e){t(e.target.result)},r.onerror=function(e){n(e.target.error)},r.readAsArrayBuffer(e)}):e}).then(function(t){var r=n.getTypeOf(t);return r?(r===`arraybuffer`?t=n.transformTo(`uint8array`,t):r===`string`&&(l?t=i.decode(t):a&&c!==!0&&(t=s(t))),t):o.Promise.reject(Error(`Can't read the data of '`+e+`'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?`))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,n){var r=e(`./reader/readerFor`),i=e(`./utils`),a=e(`./signature`),o=e(`./zipEntry`),s=e(`./support`);function c(e){this.files=[],this.loadOptions=e}c.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw Error(`Corrupted zip or bug: unexpected signature (`+i.pretty(t)+`, expected `+i.pretty(e)+`)`)}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var r=this.reader.readString(4)===t;return this.reader.setIndex(n),r},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=s.uint8array?`uint8array`:`array`,n=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,t=0,n,r,i;t<e;)n=this.reader.readInt(2),r=this.reader.readInt(4),i=this.reader.readData(r),this.zip64ExtensibleData[n]={id:n,length:r,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw Error(`Multi-volumes zip are not supported`)},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)e=new o({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw Error(`Corrupted zip or bug: expected `+this.centralDirRecords+` records in central dir, got `+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?Error(`Corrupted zip: can't find end of central directory`):Error(`Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html`);this.reader.setIndex(e);var t=e;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw Error(`Corrupted zip: can't find the ZIP64 end of central directory locator`);if(this.reader.setIndex(e),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw Error(`Corrupted zip: can't find the ZIP64 end of central directory`);this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var r=t-n;if(r>0)this.isSignature(t,a.CENTRAL_FILE_HEADER)||(this.reader.zero=r);else if(r<0)throw Error(`Corrupted zip: missing `+Math.abs(r)+` bytes.`)},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){var r=e(`./reader/readerFor`),i=e(`./utils`),a=e(`./compressedObject`),o=e(`./crc32`),s=e(`./utf8`),c=e(`./compressions`),l=e(`./support`),u=0,d=3,f=function(e){for(var t in c)if(Object.prototype.hasOwnProperty.call(c,t)&&c[t].magic===e)return c[t];return null};function p(e,t){this.options=e,this.loadOptions=t}p.prototype={isEncrypted:function(){return(this.bitFlag&1)==1},useUTF8:function(){return(this.bitFlag&2048)==2048},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),this.compressedSize===-1||this.uncompressedSize===-1)throw Error(`Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)`);if(t=f(this.compressionMethod),t===null)throw Error(`Corrupted zip : compression `+i.pretty(this.compressionMethod)+` unknown (inner file : `+i.transformTo(`string`,this.fileName)+`)`);this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw Error(`Encrypted zip are not supported`);e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===u&&(this.dosPermissions=this.externalFileAttributes&63),e===d&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)===`/`&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=r(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t=e.index+this.extraFieldsLength,n,r,i;for(this.extraFields||={};e.index+4<t;)n=e.readInt(2),r=e.readInt(2),i=e.readData(r),this.extraFields[n]={id:n,length:r,value:i};e.setIndex(t)},handleUTF8:function(){var e=l.uint8array?`uint8array`:`array`;if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(t!==null)this.fileNameStr=t;else{var n=i.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var r=this.findExtraFieldUnicodeComment();if(r!==null)this.fileCommentStr=r;else{var a=i.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(a)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return t.readInt(1)!==1||o(this.fileName)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return t.readInt(1)!==1||o(this.fileComment)!==t.readInt(4)?null:s.utf8decode(t.readData(e.length-5))}return null}},t.exports=p},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){var r=e(`./stream/StreamHelper`),i=e(`./stream/DataWorker`),a=e(`./utf8`),o=e(`./compressedObject`),s=e(`./stream/GenericWorker`),c=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};c.prototype={internalStream:function(e){var t=null,n=`string`;try{if(!e)throw Error(`No output type specified.`);n=e.toLowerCase();var i=n===`string`||n===`text`;(n===`binarystring`||n===`text`)&&(n=`string`),t=this._decompressWorker();var o=!this._dataBinary;o&&!i&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&i&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){t=new s(`error`),t.error(e)}return new r(t,n,``)},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||`nodebuffer`).toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof s?this._data:new i(this._data)}};for(var l=[`asText`,`asBinary`,`asNodeBuffer`,`asUint8Array`,`asArrayBuffer`],u=function(){throw Error(`This method has been removed in JSZip 3.0, please check the upgrade guide.`)},d=0;d<l.length;d++)c.prototype[l[d]]=u;t.exports=c},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var n=e.MutationObserver||e.WebKitMutationObserver,r;if(n){var i=0,a=new n(u),o=e.document.createTextNode(``);a.observe(o,{characterData:!0}),r=function(){o.data=i=++i%2}}else if(!e.setImmediate&&e.MessageChannel!==void 0){var s=new e.MessageChannel;s.port1.onmessage=u,r=function(){s.port2.postMessage(0)}}else r=`document`in e&&`onreadystatechange`in e.document.createElement(`script`)?function(){var t=e.document.createElement(`script`);t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};var c,l=[];function u(){c=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}c=!1}t.exports=d;function d(e){l.push(e)===1&&!c&&r()}}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],37:[function(e,t,n){var r=e(`immediate`);function i(){}var a={},o=[`REJECTED`],s=[`FULFILLED`],c=[`PENDING`];t.exports=l;function l(e){if(typeof e!=`function`)throw TypeError(`resolver must be a function`);this.state=c,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}l.prototype.finally=function(e){if(typeof e!=`function`)return this;var t=this.constructor;return this.then(n,r);function n(n){function r(){return n}return t.resolve(e()).then(r)}function r(n){function r(){throw n}return t.resolve(e()).then(r)}},l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if(typeof e!=`function`&&this.state===s||typeof t!=`function`&&this.state===o)return this;var n=new this.constructor(i);if(this.state!==c){var r=this.state===s?e:t;d(n,r,this.outcome)}else this.queue.push(new u(n,e,t));return n};function u(e,t,n){this.promise=e,typeof t==`function`&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),typeof n==`function`&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)};function d(e,t,n){r(function(){var r;try{r=t(n)}catch(t){return a.reject(e,t)}r===e?a.reject(e,TypeError(`Cannot resolve promise with itself`)):a.resolve(e,r)})}a.resolve=function(e,t){var n=m(f,t);if(n.status===`error`)return a.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e};function f(e){var t=e&&e.then;if(e&&(typeof e==`object`||typeof e==`function`)&&typeof t==`function`)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}function o(){t(i,r)}var s=m(o);s.status===`error`&&r(s.value)}function m(e,t){var n={};try{n.value=e(t),n.status=`success`}catch(e){n.status=`error`,n.value=e}return n}l.resolve=h;function h(e){return e instanceof this?e:a.resolve(new this(i),e)}l.reject=g;function g(e){var t=new this(i);return a.reject(t,e)}l.all=_;function _(e){var t=this;if(Object.prototype.toString.call(e)!==`[object Array]`)return this.reject(TypeError(`must be an array`));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=Array(n),s=0,c=-1,l=new this(i);++c<n;)u(e[c],c);return l;function u(e,i){t.resolve(e).then(c,function(e){r||(r=!0,a.reject(l,e))});function c(e){o[i]=e,++s===n&&!r&&(r=!0,a.resolve(l,o))}}}l.race=v;function v(e){var t=this;if(Object.prototype.toString.call(e)!==`[object Array]`)return this.reject(TypeError(`must be an array`));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=-1,s=new this(i);++o<n;)c(e[o]);return s;function c(e){t.resolve(e).then(function(e){r||(r=!0,a.resolve(s,e))},function(e){r||(r=!0,a.reject(s,e))})}}},{immediate:36}],38:[function(e,t,n){var r=e(`./lib/utils/common`).assign,i=e(`./lib/deflate`),a=e(`./lib/inflate`),o=e(`./lib/zlib/constants`),s={};r(s,i,a,o),t.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,n){var r=e(`./zlib/deflate`),i=e(`./utils/common`),a=e(`./utils/strings`),o=e(`./zlib/messages`),s=e(`./zlib/zstream`),c=Object.prototype.toString,l=0,u=4,d=0,f=1,p=2,m=-1,h=0,g=8;function _(e){if(!(this instanceof _))return new _(e);this.options=i.assign({level:m,method:g,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:``},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=r.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==d)throw Error(o[n]);if(t.header&&r.deflateSetHeader(this.strm,t.header),t.dictionary){var l=typeof t.dictionary==`string`?a.string2buf(t.dictionary):c.call(t.dictionary)===`[object ArrayBuffer]`?new Uint8Array(t.dictionary):t.dictionary;if(n=r.deflateSetDictionary(this.strm,l),n!==d)throw Error(o[n]);this._dict_set=!0}}_.prototype.push=function(e,t){var n=this.strm,o=this.options.chunkSize,s,m;if(this.ended)return!1;m=t===~~t?t:t===!0?u:l,typeof e==`string`?n.input=a.string2buf(e):c.call(e)===`[object ArrayBuffer]`?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new i.Buf8(o),n.next_out=0,n.avail_out=o),s=r.deflate(n,m),s!==f&&s!==d)return this.onEnd(s),this.ended=!0,!1;(n.avail_out===0||n.avail_in===0&&(m===u||m===p))&&(this.options.to===`string`?this.onData(a.buf2binstring(i.shrinkBuf(n.output,n.next_out))):this.onData(i.shrinkBuf(n.output,n.next_out)))}while((n.avail_in>0||n.avail_out===0)&&s!==f);return m===u?(s=r.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===d):m===p?(this.onEnd(d),n.avail_out=0,!0):!0},_.prototype.onData=function(e){this.chunks.push(e)},_.prototype.onEnd=function(e){e===d&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function v(e,t){var n=new _(t);if(n.push(e,!0),n.err)throw n.msg||o[n.err];return n.result}function y(e,t){return t||={},t.raw=!0,v(e,t)}function b(e,t){return t||={},t.gzip=!0,v(e,t)}n.Deflate=_,n.deflate=v,n.deflateRaw=y,n.gzip=b},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,n){var r=e(`./zlib/inflate`),i=e(`./utils/common`),a=e(`./utils/strings`),o=e(`./zlib/constants`),s=e(`./zlib/messages`),c=e(`./zlib/zstream`),l=e(`./zlib/gzheader`),u=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=i.assign({chunkSize:16384,windowBits:0,to:``},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg=``,this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=r.inflateInit2(this.strm,t.windowBits);if(n!==o.Z_OK)throw Error(s[n]);this.header=new l,r.inflateGetHeader(this.strm,this.header)}d.prototype.push=function(e,t){var n=this.strm,s=this.options.chunkSize,c=this.options.dictionary,l,d,f,p,m,h,g=!1;if(this.ended)return!1;d=t===~~t?t:t===!0?o.Z_FINISH:o.Z_NO_FLUSH,typeof e==`string`?n.input=a.binstring2buf(e):u.call(e)===`[object ArrayBuffer]`?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;do{if(n.avail_out===0&&(n.output=new i.Buf8(s),n.next_out=0,n.avail_out=s),l=r.inflate(n,o.Z_NO_FLUSH),l===o.Z_NEED_DICT&&c&&(h=typeof c==`string`?a.string2buf(c):u.call(c)===`[object ArrayBuffer]`?new Uint8Array(c):c,l=r.inflateSetDictionary(this.strm,h)),l===o.Z_BUF_ERROR&&g===!0&&(l=o.Z_OK,g=!1),l!==o.Z_STREAM_END&&l!==o.Z_OK)return this.onEnd(l),this.ended=!0,!1;n.next_out&&(n.avail_out===0||l===o.Z_STREAM_END||n.avail_in===0&&(d===o.Z_FINISH||d===o.Z_SYNC_FLUSH))&&(this.options.to===`string`?(f=a.utf8border(n.output,n.next_out),p=n.next_out-f,m=a.buf2string(n.output,f),n.next_out=p,n.avail_out=s-p,p&&i.arraySet(n.output,n.output,f,p,0),this.onData(m)):this.onData(i.shrinkBuf(n.output,n.next_out))),n.avail_in===0&&n.avail_out===0&&(g=!0)}while((n.avail_in>0||n.avail_out===0)&&l!==o.Z_STREAM_END);return l===o.Z_STREAM_END&&(d=o.Z_FINISH),d===o.Z_FINISH?(l=r.inflateEnd(this.strm),this.onEnd(l),this.ended=!0,l===o.Z_OK):d===o.Z_SYNC_FLUSH?(this.onEnd(o.Z_OK),n.avail_out=0,!0):!0},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&(this.options.to===`string`?this.result=this.chunks.join(``):this.result=i.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function f(e,t){var n=new d(t);if(n.push(e,!0),n.err)throw n.msg||s[n.err];return n.result}function p(e,t){return t||={},t.raw=!0,f(e,t)}n.Inflate=d,n.inflate=f,n.inflateRaw=p,n.ungzip=f},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,n){var r=typeof Uint8Array<`u`&&typeof Uint16Array<`u`&&typeof Int32Array<`u`;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if(typeof n!=`object`)throw TypeError(n+`must be non-object`);for(var r in n)n.hasOwnProperty(r)&&(e[r]=n[r])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,n,r,i){if(t.subarray&&e.subarray){e.set(t.subarray(n,n+r),i);return}for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){var t,n,r=0,i,a,o;for(t=0,n=e.length;t<n;t++)r+=e[t].length;for(o=new Uint8Array(r),i=0,t=0,n=e.length;t<n;t++)a=e[t],o.set(a,i),i+=a.length;return o}},a={arraySet:function(e,t,n,r,i){for(var a=0;a<r;a++)e[i+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,i)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(r)},{}],42:[function(e,t,n){var r=e(`./common`),i=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var o=new r.Buf8(256),s=0;s<256;s++)o[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;o[254]=o[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,c=0;for(a=0;a<s;a++)n=e.charCodeAt(a),(n&64512)==55296&&a+1<s&&(i=e.charCodeAt(a+1),(i&64512)==56320&&(n=65536+(n-55296<<10)+(i-56320),a++)),c+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(c),o=0,a=0;o<c;a++)n=e.charCodeAt(a),(n&64512)==55296&&a+1<s&&(i=e.charCodeAt(a+1),(i&64512)==56320&&(n=65536+(n-55296<<10)+(i-56320),a++)),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|n&63):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|n&63):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|n&63);return t};function c(e,t){if(t<65537&&(e.subarray&&a||!e.subarray&&i))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n=``,o=0;o<t;o++)n+=String.fromCharCode(e[o]);return n}n.buf2binstring=function(e){return c(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,i,a,s=t||e.length,l=Array(s*2);for(r=0,n=0;n<s;){if(i=e[n++],i<128){l[r++]=i;continue}if(a=o[i],a>4){l[r++]=65533,n+=a-1;continue}for(i&=a===2?31:a===3?15:7;a>1&&n<s;)i=i<<6|e[n++]&63,a--;if(a>1){l[r++]=65533;continue}i<65536?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|i&1023)}return c(l,r)},n.utf8border=function(e,t){var n;for(t||=e.length,t>e.length&&(t=e.length),n=t-1;n>=0&&(e[n]&192)==128;)n--;return n<0||n===0?t:n+o[e[n]]>t?n:t}},{"./common":41}],43:[function(e,t,n){function r(e,t,n,r){for(var i=e&65535|0,a=e>>>16&65535|0,o=0;n!==0;){o=n>2e3?2e3:n,n-=o;do i=i+t[r++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}t.exports=r},{}],44:[function(e,t,n){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,n){function r(){for(var e,t=[],n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}var i=r();function a(e,t,n,r){var a=i,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[(e^t[s])&255];return e^-1}t.exports=a},{}],46:[function(e,t,n){var r=e(`../utils/common`),i=e(`./trees`),a=e(`./adler32`),o=e(`./crc32`),s=e(`./messages`),c=0,l=1,u=3,d=4,f=5,p=0,m=1,h=-2,g=-3,_=-5,v=-1,y=1,b=2,x=3,S=4,C=0,w=2,T=8,E=9,D=15,O=8,k=286,A=30,j=19,M=2*k+1,N=15,P=3,F=258,I=F+P+1,L=32,R=42,ee=69,te=73,ne=91,re=103,ie=113,ae=666,oe=1,z=2,se=3,ce=4,B=3;function le(e,t){return e.msg=s[t],t}function ue(e){return(e<<1)-(e>4?9:0)}function de(e){for(var t=e.length;--t>=0;)e[t]=0}function fe(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),n!==0&&(r.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,t.pending===0&&(t.pending_out=0))}function V(e,t){i._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,fe(e.strm)}function H(e,t){e.pending_buf[e.pending++]=t}function U(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255}function pe(e,t,n,i){var s=e.avail_in;return s>i&&(s=i),s===0?0:(e.avail_in-=s,r.arraySet(t,e.input,e.next_in,s,n),e.state.wrap===1?e.adler=a(e.adler,t,s,n):e.state.wrap===2&&(e.adler=o(e.adler,t,s,n)),e.next_in+=s,e.total_in+=s,s)}function me(e,t){var n=e.max_chain_length,r=e.strstart,i,a,o=e.prev_length,s=e.nice_match,c=e.strstart>e.w_size-I?e.strstart-(e.w_size-I):0,l=e.window,u=e.w_mask,d=e.prev,f=e.strstart+F,p=l[r+o-1],m=l[r+o];e.prev_length>=e.good_match&&(n>>=2),s>e.lookahead&&(s=e.lookahead);do{if(i=t,l[i+o]!==m||l[i+o-1]!==p||l[i]!==l[r]||l[++i]!==l[r+1])continue;r+=2,i++;do;while(l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&r<f);if(a=F-(f-r),r=f-F,a>o){if(e.match_start=t,o=a,a>=s)break;p=l[r+o-1],m=l[r+o]}}while((t=d[t&u])>c&&--n!==0);return o<=e.lookahead?o:e.lookahead}function W(e){var t=e.w_size,n,i,a,o,s;do{if(o=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-I)){r.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,n=i;do a=e.head[--n],e.head[n]=a>=t?a-t:0;while(--i);i=t,n=i;do a=e.prev[--n],e.prev[n]=a>=t?a-t:0;while(--i);o+=t}if(e.strm.avail_in===0)break;if(i=pe(e.strm,e.window,e.strstart+e.lookahead,o),e.lookahead+=i,e.lookahead+e.insert>=P)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+P-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<P)););}while(e.lookahead<I&&e.strm.avail_in!==0)}function he(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(W(e),e.lookahead===0&&t===c)return oe;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var r=e.block_start+n;if((e.strstart===0||e.strstart>=r)&&(e.lookahead=e.strstart-r,e.strstart=r,V(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-I&&(V(e,!1),e.strm.avail_out===0))return oe}return e.insert=0,t===d?(V(e,!0),e.strm.avail_out===0?se:ce):(e.strstart>e.block_start&&(V(e,!1),e.strm.avail_out),oe)}function G(e,t){for(var n,r;;){if(e.lookahead<I){if(W(e),e.lookahead<I&&t===c)return oe;if(e.lookahead===0)break}if(n=0,e.lookahead>=P&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),n!==0&&e.strstart-n<=e.w_size-I&&(e.match_length=me(e,n)),e.match_length>=P)if(r=i._tr_tally(e,e.strstart-e.match_start,e.match_length-P),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=P){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else r=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(V(e,!1),e.strm.avail_out===0))return oe}return e.insert=e.strstart<P-1?e.strstart:P-1,t===d?(V(e,!0),e.strm.avail_out===0?se:ce):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?oe:z}function K(e,t){for(var n,r,a;;){if(e.lookahead<I){if(W(e),e.lookahead<I&&t===c)return oe;if(e.lookahead===0)break}if(n=0,e.lookahead>=P&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=P-1,n!==0&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-I&&(e.match_length=me(e,n),e.match_length<=5&&(e.strategy===y||e.match_length===P&&e.strstart-e.match_start>4096)&&(e.match_length=P-1)),e.prev_length>=P&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-P,r=i._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-P),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+P-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=P-1,e.strstart++,r&&(V(e,!1),e.strm.avail_out===0))return oe}else if(e.match_available){if(r=i._tr_tally(e,0,e.window[e.strstart-1]),r&&V(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return oe}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&=(r=i._tr_tally(e,0,e.window[e.strstart-1]),0),e.insert=e.strstart<P-1?e.strstart:P-1,t===d?(V(e,!0),e.strm.avail_out===0?se:ce):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?oe:z}function ge(e,t){for(var n,r,a,o,s=e.window;;){if(e.lookahead<=F){if(W(e),e.lookahead<=F&&t===c)return oe;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=P&&e.strstart>0&&(a=e.strstart-1,r=s[a],r===s[++a]&&r===s[++a]&&r===s[++a])){o=e.strstart+F;do;while(r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&r===s[++a]&&a<o);e.match_length=F-(o-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=P?(n=i._tr_tally(e,1,e.match_length-P),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(V(e,!1),e.strm.avail_out===0))return oe}return e.insert=0,t===d?(V(e,!0),e.strm.avail_out===0?se:ce):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?oe:z}function _e(e,t){for(var n;;){if(e.lookahead===0&&(W(e),e.lookahead===0)){if(t===c)return oe;break}if(e.match_length=0,n=i._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(V(e,!1),e.strm.avail_out===0))return oe}return e.insert=0,t===d?(V(e,!0),e.strm.avail_out===0?se:ce):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?oe:z}function q(e,t,n,r,i){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=r,this.func=i}var ve=[new q(0,0,0,0,he),new q(4,4,8,4,G),new q(4,5,16,8,G),new q(4,6,32,32,G),new q(4,4,16,16,K),new q(8,16,32,32,K),new q(8,16,128,128,K),new q(8,32,128,256,K),new q(32,128,258,1024,K),new q(32,258,258,4096,K)];function ye(e){e.window_size=2*e.w_size,de(e.head),e.max_lazy_match=ve[e.level].max_lazy,e.good_match=ve[e.level].good_length,e.nice_match=ve[e.level].nice_length,e.max_chain_length=ve[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=P-1,e.match_available=0,e.ins_h=0}function be(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new r.Buf16(M*2),this.dyn_dtree=new r.Buf16((2*A+1)*2),this.bl_tree=new r.Buf16((2*j+1)*2),de(this.dyn_ltree),de(this.dyn_dtree),de(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new r.Buf16(N+1),this.heap=new r.Buf16(2*k+1),de(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new r.Buf16(2*k+1),de(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function xe(e){var t;return!e||!e.state?le(e,h):(e.total_in=e.total_out=0,e.data_type=w,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?R:ie,e.adler=t.wrap===2?0:1,t.last_flush=c,i._tr_init(t),p)}function Se(e){var t=xe(e);return t===p&&ye(e.state),t}function J(e,t){return!e||!e.state||e.state.wrap!==2?h:(e.state.gzhead=t,p)}function Ce(e,t,n,i,a,o){if(!e)return h;var s=1;if(t===v&&(t=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),a<1||a>E||n!==T||i<8||i>15||t<0||t>9||o<0||o>S)return le(e,h);i===8&&(i=9);var c=new be;return e.state=c,c.strm=e,c.wrap=s,c.gzhead=null,c.w_bits=i,c.w_size=1<<c.w_bits,c.w_mask=c.w_size-1,c.hash_bits=a+7,c.hash_size=1<<c.hash_bits,c.hash_mask=c.hash_size-1,c.hash_shift=~~((c.hash_bits+P-1)/P),c.window=new r.Buf8(c.w_size*2),c.head=new r.Buf16(c.hash_size),c.prev=new r.Buf16(c.w_size),c.lit_bufsize=1<<a+6,c.pending_buf_size=c.lit_bufsize*4,c.pending_buf=new r.Buf8(c.pending_buf_size),c.d_buf=1*c.lit_bufsize,c.l_buf=3*c.lit_bufsize,c.level=t,c.strategy=o,c.method=n,Se(e)}function we(e,t){return Ce(e,t,T,D,O,C)}function Te(e,t){var n,r,a,s;if(!e||!e.state||t>f||t<0)return e?le(e,h):h;if(r=e.state,!e.output||!e.input&&e.avail_in!==0||r.status===ae&&t!==d)return le(e,e.avail_out===0?_:h);if(r.strm=e,n=r.last_flush,r.last_flush=t,r.status===R)if(r.wrap===2)e.adler=0,H(r,31),H(r,139),H(r,8),r.gzhead?(H(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),H(r,r.gzhead.time&255),H(r,r.gzhead.time>>8&255),H(r,r.gzhead.time>>16&255),H(r,r.gzhead.time>>24&255),H(r,r.level===9?2:r.strategy>=b||r.level<2?4:0),H(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(H(r,r.gzhead.extra.length&255),H(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=o(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=ee):(H(r,0),H(r,0),H(r,0),H(r,0),H(r,0),H(r,r.level===9?2:r.strategy>=b||r.level<2?4:0),H(r,B),r.status=ie);else{var g=T+(r.w_bits-8<<4)<<8,v=-1;v=r.strategy>=b||r.level<2?0:r.level<6?1:r.level===6?2:3,g|=v<<6,r.strstart!==0&&(g|=L),g+=31-g%31,r.status=ie,U(r,g),r.strstart!==0&&(U(r,e.adler>>>16),U(r,e.adler&65535)),e.adler=1}if(r.status===ee)if(r.gzhead.extra){for(a=r.pending;r.gzindex<(r.gzhead.extra.length&65535)&&!(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),fe(e),a=r.pending,r.pending===r.pending_buf_size));)H(r,r.gzhead.extra[r.gzindex]&255),r.gzindex++;r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=te)}else r.status=te;if(r.status===te)if(r.gzhead.name){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),fe(e),a=r.pending,r.pending===r.pending_buf_size)){s=1;break}s=r.gzindex<r.gzhead.name.length?r.gzhead.name.charCodeAt(r.gzindex++)&255:0,H(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),s===0&&(r.gzindex=0,r.status=ne)}else r.status=ne;if(r.status===ne)if(r.gzhead.comment){a=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),fe(e),a=r.pending,r.pending===r.pending_buf_size)){s=1;break}s=r.gzindex<r.gzhead.comment.length?r.gzhead.comment.charCodeAt(r.gzindex++)&255:0,H(r,s)}while(s!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=o(e.adler,r.pending_buf,r.pending-a,a)),s===0&&(r.status=re)}else r.status=re;if(r.status===re&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&fe(e),r.pending+2<=r.pending_buf_size&&(H(r,e.adler&255),H(r,e.adler>>8&255),e.adler=0,r.status=ie)):r.status=ie),r.pending!==0){if(fe(e),e.avail_out===0)return r.last_flush=-1,p}else if(e.avail_in===0&&ue(t)<=ue(n)&&t!==d)return le(e,_);if(r.status===ae&&e.avail_in!==0)return le(e,_);if(e.avail_in!==0||r.lookahead!==0||t!==c&&r.status!==ae){var y=r.strategy===b?_e(r,t):r.strategy===x?ge(r,t):ve[r.level].func(r,t);if((y===se||y===ce)&&(r.status=ae),y===oe||y===se)return e.avail_out===0&&(r.last_flush=-1),p;if(y===z&&(t===l?i._tr_align(r):t!==f&&(i._tr_stored_block(r,0,0,!1),t===u&&(de(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),fe(e),e.avail_out===0))return r.last_flush=-1,p}return t===d?r.wrap<=0?m:(r.wrap===2?(H(r,e.adler&255),H(r,e.adler>>8&255),H(r,e.adler>>16&255),H(r,e.adler>>24&255),H(r,e.total_in&255),H(r,e.total_in>>8&255),H(r,e.total_in>>16&255),H(r,e.total_in>>24&255)):(U(r,e.adler>>>16),U(r,e.adler&65535)),fe(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending===0?m:p):p}function Y(e){var t;return!e||!e.state?h:(t=e.state.status,t!==R&&t!==ee&&t!==te&&t!==ne&&t!==re&&t!==ie&&t!==ae?le(e,h):(e.state=null,t===ie?le(e,g):p))}function Ee(e,t){var n=t.length,i,o,s,c,l,u,d,f;if(!e||!e.state||(i=e.state,c=i.wrap,c===2||c===1&&i.status!==R||i.lookahead))return h;for(c===1&&(e.adler=a(e.adler,t,n,0)),i.wrap=0,n>=i.w_size&&(c===0&&(de(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new r.Buf8(i.w_size),r.arraySet(f,t,n-i.w_size,i.w_size,0),t=f,n=i.w_size),l=e.avail_in,u=e.next_in,d=e.input,e.avail_in=n,e.next_in=0,e.input=t,W(i);i.lookahead>=P;){o=i.strstart,s=i.lookahead-(P-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[o+P-1])&i.hash_mask,i.prev[o&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=o,o++;while(--s);i.strstart=o,i.lookahead=P-1,W(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=P-1,i.match_available=0,e.next_in=u,e.input=d,e.avail_in=l,i.wrap=c,p}n.deflateInit=we,n.deflateInit2=Ce,n.deflateReset=Se,n.deflateResetKeep=xe,n.deflateSetHeader=J,n.deflate=Te,n.deflateEnd=Y,n.deflateSetDictionary=Ee,n.deflateInfo=`pako deflate (from Nodeca project)`},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,n){function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name=``,this.comment=``,this.hcrc=0,this.done=!1}t.exports=r},{}],48:[function(e,t,n){var r=30,i=12;t.exports=function(e,t){var n=e.state,a=e.next_in,o,s,c,l,u,d,f,p,m,h,g,_,v,y,b,x,S,C,w,T,E,D=e.input,O;o=a+(e.avail_in-5),s=e.next_out,O=e.output,c=s-(t-e.avail_out),l=s+(e.avail_out-257),u=n.dmax,d=n.wsize,f=n.whave,p=n.wnext,m=n.window,h=n.hold,g=n.bits,_=n.lencode,v=n.distcode,y=(1<<n.lenbits)-1,b=(1<<n.distbits)-1;top:do{g<15&&(h+=D[a++]<<g,g+=8,h+=D[a++]<<g,g+=8),x=_[h&y];dolen:for(;;){if(S=x>>>24,h>>>=S,g-=S,S=x>>>16&255,S===0)O[s++]=x&65535;else if(S&16){C=x&65535,S&=15,S&&(g<S&&(h+=D[a++]<<g,g+=8),C+=h&(1<<S)-1,h>>>=S,g-=S),g<15&&(h+=D[a++]<<g,g+=8,h+=D[a++]<<g,g+=8),x=v[h&b];dodist:for(;;){if(S=x>>>24,h>>>=S,g-=S,S=x>>>16&255,S&16){if(w=x&65535,S&=15,g<S&&(h+=D[a++]<<g,g+=8,g<S&&(h+=D[a++]<<g,g+=8)),w+=h&(1<<S)-1,w>u){e.msg=`invalid distance too far back`,n.mode=r;break top}if(h>>>=S,g-=S,S=s-c,w>S){if(S=w-S,S>f&&n.sane){e.msg=`invalid distance too far back`,n.mode=r;break top}if(T=0,E=m,p===0){if(T+=d-S,S<C){C-=S;do O[s++]=m[T++];while(--S);T=s-w,E=O}}else if(p<S){if(T+=d+p-S,S-=p,S<C){C-=S;do O[s++]=m[T++];while(--S);if(T=0,p<C){S=p,C-=S;do O[s++]=m[T++];while(--S);T=s-w,E=O}}}else if(T+=p-S,S<C){C-=S;do O[s++]=m[T++];while(--S);T=s-w,E=O}for(;C>2;)O[s++]=E[T++],O[s++]=E[T++],O[s++]=E[T++],C-=3;C&&(O[s++]=E[T++],C>1&&(O[s++]=E[T++]))}else{T=s-w;do O[s++]=O[T++],O[s++]=O[T++],O[s++]=O[T++],C-=3;while(C>2);C&&(O[s++]=O[T++],C>1&&(O[s++]=O[T++]))}}else if(S&64){e.msg=`invalid distance code`,n.mode=r;break top}else{x=v[(x&65535)+(h&(1<<S)-1)];continue dodist}break}}else if(S&64)if(S&32){n.mode=i;break top}else{e.msg=`invalid literal/length code`,n.mode=r;break top}else{x=_[(x&65535)+(h&(1<<S)-1)];continue dolen}break}}while(a<o&&s<l);C=g>>3,a-=C,g-=C<<3,h&=(1<<g)-1,e.next_in=a,e.next_out=s,e.avail_in=a<o?5+(o-a):5-(a-o),e.avail_out=s<l?257+(l-s):257-(s-l),n.hold=h,n.bits=g}},{}],49:[function(e,t,n){var r=e(`../utils/common`),i=e(`./adler32`),a=e(`./crc32`),o=e(`./inffast`),s=e(`./inftrees`),c=0,l=1,u=2,d=4,f=5,p=6,m=0,h=1,g=2,_=-2,v=-3,y=-4,b=-5,x=8,S=1,C=2,w=3,T=4,E=5,D=6,O=7,k=8,A=9,j=10,M=11,N=12,P=13,F=14,I=15,L=16,R=17,ee=18,te=19,ne=20,re=21,ie=22,ae=23,oe=24,z=25,se=26,ce=27,B=28,le=29,ue=30,de=31,fe=32,V=852,H=592,U=15;function pe(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function me(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new r.Buf16(320),this.work=new r.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function W(e){var t;return!e||!e.state?_:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg=``,t.wrap&&(e.adler=t.wrap&1),t.mode=S,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new r.Buf32(V),t.distcode=t.distdyn=new r.Buf32(H),t.sane=1,t.back=-1,m)}function he(e){var t;return!e||!e.state?_:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,W(e))}function G(e,t){var n,r;return!e||!e.state||(r=e.state,t<0?(n=0,t=-t):(n=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15))?_:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,he(e))}function K(e,t){var n,r;return e?(r=new me,e.state=r,r.window=null,n=G(e,t),n!==m&&(e.state=null),n):_}function ge(e){return K(e,U)}var _e=!0,q,ve;function ye(e){if(_e){var t;for(q=new r.Buf32(512),ve=new r.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(s(l,e.lens,0,288,q,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;s(u,e.lens,0,32,ve,0,e.work,{bits:5}),_e=!1}e.lencode=q,e.lenbits=9,e.distcode=ve,e.distbits=5}function be(e,t,n,i){var a,o=e.state;return o.window===null&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new r.Buf8(o.wsize)),i>=o.wsize?(r.arraySet(o.window,t,n-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(a=o.wsize-o.wnext,a>i&&(a=i),r.arraySet(o.window,t,n-i,a,o.wnext),i-=a,i?(r.arraySet(o.window,t,n-i,i,0),o.wnext=i,o.whave=o.wsize):(o.wnext+=a,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=a))),0}function xe(e,t){var n,V,H,U,me,W,he,G,K,ge,_e,q,ve,xe,Se=0,J,Ce,we,Te,Y,Ee,De,Oe,ke=new r.Buf8(4),Ae,je,Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return _;n=e.state,n.mode===N&&(n.mode=P),me=e.next_out,H=e.output,he=e.avail_out,U=e.next_in,V=e.input,W=e.avail_in,G=n.hold,K=n.bits,ge=W,_e=he,Oe=m;inf_leave:for(;;)switch(n.mode){case S:if(n.wrap===0){n.mode=P;break}for(;K<16;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(n.wrap&2&&G===35615){n.check=0,ke[0]=G&255,ke[1]=G>>>8&255,n.check=a(n.check,ke,2,0),G=0,K=0,n.mode=C;break}if(n.flags=0,n.head&&(n.head.done=!1),!(n.wrap&1)||(((G&255)<<8)+(G>>8))%31){e.msg=`incorrect header check`,n.mode=ue;break}if((G&15)!==x){e.msg=`unknown compression method`,n.mode=ue;break}if(G>>>=4,K-=4,De=(G&15)+8,n.wbits===0)n.wbits=De;else if(De>n.wbits){e.msg=`invalid window size`,n.mode=ue;break}n.dmax=1<<De,e.adler=n.check=1,n.mode=G&512?j:N,G=0,K=0;break;case C:for(;K<16;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(n.flags=G,(n.flags&255)!==x){e.msg=`unknown compression method`,n.mode=ue;break}if(n.flags&57344){e.msg=`unknown header flags set`,n.mode=ue;break}n.head&&(n.head.text=G>>8&1),n.flags&512&&(ke[0]=G&255,ke[1]=G>>>8&255,n.check=a(n.check,ke,2,0)),G=0,K=0,n.mode=w;case w:for(;K<32;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.head&&(n.head.time=G),n.flags&512&&(ke[0]=G&255,ke[1]=G>>>8&255,ke[2]=G>>>16&255,ke[3]=G>>>24&255,n.check=a(n.check,ke,4,0)),G=0,K=0,n.mode=T;case T:for(;K<16;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.head&&(n.head.xflags=G&255,n.head.os=G>>8),n.flags&512&&(ke[0]=G&255,ke[1]=G>>>8&255,n.check=a(n.check,ke,2,0)),G=0,K=0,n.mode=E;case E:if(n.flags&1024){for(;K<16;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.length=G,n.head&&(n.head.extra_len=G),n.flags&512&&(ke[0]=G&255,ke[1]=G>>>8&255,n.check=a(n.check,ke,2,0)),G=0,K=0}else n.head&&(n.head.extra=null);n.mode=D;case D:if(n.flags&1024&&(q=n.length,q>W&&(q=W),q&&(n.head&&(De=n.head.extra_len-n.length,n.head.extra||(n.head.extra=Array(n.head.extra_len)),r.arraySet(n.head.extra,V,U,q,De)),n.flags&512&&(n.check=a(n.check,V,q,U)),W-=q,U+=q,n.length-=q),n.length))break inf_leave;n.length=0,n.mode=O;case O:if(n.flags&2048){if(W===0)break inf_leave;q=0;do De=V[U+ q++],n.head&&De&&n.length<65536&&(n.head.name+=String.fromCharCode(De));while(De&&q<W);if(n.flags&512&&(n.check=a(n.check,V,q,U)),W-=q,U+=q,De)break inf_leave}else n.head&&(n.head.name=null);n.length=0,n.mode=k;case k:if(n.flags&4096){if(W===0)break inf_leave;q=0;do De=V[U+ q++],n.head&&De&&n.length<65536&&(n.head.comment+=String.fromCharCode(De));while(De&&q<W);if(n.flags&512&&(n.check=a(n.check,V,q,U)),W-=q,U+=q,De)break inf_leave}else n.head&&(n.head.comment=null);n.mode=A;case A:if(n.flags&512){for(;K<16;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(G!==(n.check&65535)){e.msg=`header crc mismatch`,n.mode=ue;break}G=0,K=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=N;break;case j:for(;K<32;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}e.adler=n.check=pe(G),G=0,K=0,n.mode=M;case M:if(n.havedict===0)return e.next_out=me,e.avail_out=he,e.next_in=U,e.avail_in=W,n.hold=G,n.bits=K,g;e.adler=n.check=1,n.mode=N;case N:if(t===f||t===p)break inf_leave;case P:if(n.last){G>>>=K&7,K-=K&7,n.mode=ce;break}for(;K<3;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}switch(n.last=G&1,G>>>=1,--K,G&3){case 0:n.mode=F;break;case 1:if(ye(n),n.mode=ne,t===p){G>>>=2,K-=2;break inf_leave}break;case 2:n.mode=R;break;case 3:e.msg=`invalid block type`,n.mode=ue}G>>>=2,K-=2;break;case F:for(G>>>=K&7,K-=K&7;K<32;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if((G&65535)!=(G>>>16^65535)){e.msg=`invalid stored block lengths`,n.mode=ue;break}if(n.length=G&65535,G=0,K=0,n.mode=I,t===p)break inf_leave;case I:n.mode=L;case L:if(q=n.length,q){if(q>W&&(q=W),q>he&&(q=he),q===0)break inf_leave;r.arraySet(H,V,U,q,me),W-=q,U+=q,he-=q,me+=q,n.length-=q;break}n.mode=N;break;case R:for(;K<14;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(n.nlen=(G&31)+257,G>>>=5,K-=5,n.ndist=(G&31)+1,G>>>=5,K-=5,n.ncode=(G&15)+4,G>>>=4,K-=4,n.nlen>286||n.ndist>30){e.msg=`too many length or distance symbols`,n.mode=ue;break}n.have=0,n.mode=ee;case ee:for(;n.have<n.ncode;){for(;K<3;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.lens[Me[n.have++]]=G&7,G>>>=3,K-=3}for(;n.have<19;)n.lens[Me[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,Ae={bits:n.lenbits},Oe=s(c,n.lens,0,19,n.lencode,0,n.work,Ae),n.lenbits=Ae.bits,Oe){e.msg=`invalid code lengths set`,n.mode=ue;break}n.have=0,n.mode=te;case te:for(;n.have<n.nlen+n.ndist;){for(;Se=n.lencode[G&(1<<n.lenbits)-1],J=Se>>>24,Ce=Se>>>16&255,we=Se&65535,!(J<=K);){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(we<16)G>>>=J,K-=J,n.lens[n.have++]=we;else{if(we===16){for(je=J+2;K<je;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(G>>>=J,K-=J,n.have===0){e.msg=`invalid bit length repeat`,n.mode=ue;break}De=n.lens[n.have-1],q=3+(G&3),G>>>=2,K-=2}else if(we===17){for(je=J+3;K<je;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}G>>>=J,K-=J,De=0,q=3+(G&7),G>>>=3,K-=3}else{for(je=J+7;K<je;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}G>>>=J,K-=J,De=0,q=11+(G&127),G>>>=7,K-=7}if(n.have+q>n.nlen+n.ndist){e.msg=`invalid bit length repeat`,n.mode=ue;break}for(;q--;)n.lens[n.have++]=De}}if(n.mode===ue)break;if(n.lens[256]===0){e.msg=`invalid code -- missing end-of-block`,n.mode=ue;break}if(n.lenbits=9,Ae={bits:n.lenbits},Oe=s(l,n.lens,0,n.nlen,n.lencode,0,n.work,Ae),n.lenbits=Ae.bits,Oe){e.msg=`invalid literal/lengths set`,n.mode=ue;break}if(n.distbits=6,n.distcode=n.distdyn,Ae={bits:n.distbits},Oe=s(u,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,Ae),n.distbits=Ae.bits,Oe){e.msg=`invalid distances set`,n.mode=ue;break}if(n.mode=ne,t===p)break inf_leave;case ne:n.mode=re;case re:if(W>=6&&he>=258){e.next_out=me,e.avail_out=he,e.next_in=U,e.avail_in=W,n.hold=G,n.bits=K,o(e,_e),me=e.next_out,H=e.output,he=e.avail_out,U=e.next_in,V=e.input,W=e.avail_in,G=n.hold,K=n.bits,n.mode===N&&(n.back=-1);break}for(n.back=0;Se=n.lencode[G&(1<<n.lenbits)-1],J=Se>>>24,Ce=Se>>>16&255,we=Se&65535,!(J<=K);){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(Ce&&!(Ce&240)){for(Te=J,Y=Ce,Ee=we;Se=n.lencode[Ee+((G&(1<<Te+Y)-1)>>Te)],J=Se>>>24,Ce=Se>>>16&255,we=Se&65535,!(Te+J<=K);){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}G>>>=Te,K-=Te,n.back+=Te}if(G>>>=J,K-=J,n.back+=J,n.length=we,Ce===0){n.mode=se;break}if(Ce&32){n.back=-1,n.mode=N;break}if(Ce&64){e.msg=`invalid literal/length code`,n.mode=ue;break}n.extra=Ce&15,n.mode=ie;case ie:if(n.extra){for(je=n.extra;K<je;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.length+=G&(1<<n.extra)-1,G>>>=n.extra,K-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=ae;case ae:for(;Se=n.distcode[G&(1<<n.distbits)-1],J=Se>>>24,Ce=Se>>>16&255,we=Se&65535,!(J<=K);){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(!(Ce&240)){for(Te=J,Y=Ce,Ee=we;Se=n.distcode[Ee+((G&(1<<Te+Y)-1)>>Te)],J=Se>>>24,Ce=Se>>>16&255,we=Se&65535,!(Te+J<=K);){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}G>>>=Te,K-=Te,n.back+=Te}if(G>>>=J,K-=J,n.back+=J,Ce&64){e.msg=`invalid distance code`,n.mode=ue;break}n.offset=we,n.extra=Ce&15,n.mode=oe;case oe:if(n.extra){for(je=n.extra;K<je;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}n.offset+=G&(1<<n.extra)-1,G>>>=n.extra,K-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg=`invalid distance too far back`,n.mode=ue;break}n.mode=z;case z:if(he===0)break inf_leave;if(q=_e-he,n.offset>q){if(q=n.offset-q,q>n.whave&&n.sane){e.msg=`invalid distance too far back`,n.mode=ue;break}q>n.wnext?(q-=n.wnext,ve=n.wsize-q):ve=n.wnext-q,q>n.length&&(q=n.length),xe=n.window}else xe=H,ve=me-n.offset,q=n.length;q>he&&(q=he),he-=q,n.length-=q;do H[me++]=xe[ve++];while(--q);n.length===0&&(n.mode=re);break;case se:if(he===0)break inf_leave;H[me++]=n.length,he--,n.mode=re;break;case ce:if(n.wrap){for(;K<32;){if(W===0)break inf_leave;W--,G|=V[U++]<<K,K+=8}if(_e-=he,e.total_out+=_e,n.total+=_e,_e&&(e.adler=n.check=n.flags?a(n.check,H,_e,me-_e):i(n.check,H,_e,me-_e)),_e=he,(n.flags?G:pe(G))!==n.check){e.msg=`incorrect data check`,n.mode=ue;break}G=0,K=0}n.mode=B;case B:if(n.wrap&&n.flags){for(;K<32;){if(W===0)break inf_leave;W--,G+=V[U++]<<K,K+=8}if(G!==(n.total&4294967295)){e.msg=`incorrect length check`,n.mode=ue;break}G=0,K=0}n.mode=le;case le:Oe=h;break inf_leave;case ue:Oe=v;break inf_leave;case de:return y;case fe:default:return _}return e.next_out=me,e.avail_out=he,e.next_in=U,e.avail_in=W,n.hold=G,n.bits=K,(n.wsize||_e!==e.avail_out&&n.mode<ue&&(n.mode<ce||t!==d))&&be(e,e.output,e.next_out,_e-e.avail_out)?(n.mode=de,y):(ge-=e.avail_in,_e-=e.avail_out,e.total_in+=ge,e.total_out+=_e,n.total+=_e,n.wrap&&_e&&(e.adler=n.check=n.flags?a(n.check,H,_e,e.next_out-_e):i(n.check,H,_e,e.next_out-_e)),e.data_type=n.bits+(n.last?64:0)+(n.mode===N?128:0)+(n.mode===ne||n.mode===I?256:0),(ge===0&&_e===0||t===d)&&Oe===m&&(Oe=b),Oe)}function Se(e){if(!e||!e.state)return _;var t=e.state;return t.window&&=null,e.state=null,m}function J(e,t){var n;return!e||!e.state||(n=e.state,!(n.wrap&2))?_:(n.head=t,t.done=!1,m)}function Ce(e,t){var n=t.length,r,a,o;return!e||!e.state||(r=e.state,r.wrap!==0&&r.mode!==M)?_:r.mode===M&&(a=1,a=i(a,t,n,0),a!==r.check)?v:(o=be(e,t,n,n),o?(r.mode=de,y):(r.havedict=1,m))}n.inflateReset=he,n.inflateReset2=G,n.inflateResetKeep=W,n.inflateInit=ge,n.inflateInit2=K,n.inflate=xe,n.inflateEnd=Se,n.inflateGetHeader=J,n.inflateSetDictionary=Ce,n.inflateInfo=`pako inflate (from Nodeca project)`},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,n){var r=e(`../utils/common`),i=15,a=852,o=592,s=0,c=1,l=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],d=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],f=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],p=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,m,h,g,_,v){var y=v.bits,b=0,x=0,S=0,C=0,w=0,T=0,E=0,D=0,O=0,k=0,A,j,M,N,P,F=null,I=0,L,R=new r.Buf16(i+1),ee=new r.Buf16(i+1),te=null,ne=0,re,ie,ae;for(b=0;b<=i;b++)R[b]=0;for(x=0;x<m;x++)R[t[n+x]]++;for(w=y,C=i;C>=1&&R[C]===0;C--);if(w>C&&(w=C),C===0)return h[g++]=20971520,h[g++]=20971520,v.bits=1,0;for(S=1;S<C&&R[S]===0;S++);for(w<S&&(w=S),D=1,b=1;b<=i;b++)if(D<<=1,D-=R[b],D<0)return-1;if(D>0&&(e===s||C!==1))return-1;for(ee[1]=0,b=1;b<i;b++)ee[b+1]=ee[b]+R[b];for(x=0;x<m;x++)t[n+x]!==0&&(_[ee[t[n+x]]++]=x);if(e===s?(F=te=_,L=19):e===c?(F=u,I-=257,te=d,ne-=257,L=256):(F=f,te=p,L=-1),k=0,x=0,b=S,P=g,T=w,E=0,M=-1,O=1<<w,N=O-1,e===c&&O>a||e===l&&O>o)return 1;for(;;){re=b-E,_[x]<L?(ie=0,ae=_[x]):_[x]>L?(ie=te[ne+_[x]],ae=F[I+_[x]]):(ie=96,ae=0),A=1<<b-E,j=1<<T,S=j;do j-=A,h[P+(k>>E)+j]=re<<24|ie<<16|ae|0;while(j!==0);for(A=1<<b-1;k&A;)A>>=1;if(A===0?k=0:(k&=A-1,k+=A),x++,--R[b]===0){if(b===C)break;b=t[n+_[x]]}if(b>w&&(k&N)!==M){for(E===0&&(E=w),P+=S,T=b-E,D=1<<T;T+E<C&&(D-=R[T+E],!(D<=0));)T++,D<<=1;if(O+=1<<T,e===c&&O>a||e===l&&O>o)return 1;M=k&N,h[M]=w<<24|T<<16|P-g|0}}return k!==0&&(h[P+k]=b-E<<24|4194304),v.bits=w,0}},{"../utils/common":41}],51:[function(e,t,n){t.exports={2:`need dictionary`,1:`stream end`,0:``,"-1":`file error`,"-2":`stream error`,"-3":`data error`,"-4":`insufficient memory`,"-5":`buffer error`,"-6":`incompatible version`}},{}],52:[function(e,t,n){var r=e(`../utils/common`),i=4,a=0,o=1,s=2;function c(e){for(var t=e.length;--t>=0;)e[t]=0}var l=0,u=1,d=2,f=3,p=258,m=29,h=256,g=h+1+m,_=30,v=19,y=2*g+1,b=15,x=16,S=7,C=256,w=16,T=17,E=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=512,M=Array((g+2)*2);c(M);var N=Array(_*2);c(N);var P=Array(j);c(P);var F=Array(p-f+1);c(F);var I=Array(m);c(I);var L=Array(_);c(L);function R(e,t,n,r,i){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=r,this.max_length=i,this.has_stree=e&&e.length}var ee,te,ne;function re(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function ie(e){return e<256?P[e]:P[256+(e>>>7)]}function ae(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}function oe(e,t,n){e.bi_valid>x-n?(e.bi_buf|=t<<e.bi_valid&65535,ae(e,e.bi_buf),e.bi_buf=t>>x-e.bi_valid,e.bi_valid+=n-x):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function z(e,t,n){oe(e,n[t*2],n[t*2+1])}function se(e,t){var n=0;do n|=e&1,e>>>=1,n<<=1;while(--t>0);return n>>>1}function ce(e){e.bi_valid===16?(ae(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function B(e,t){var n=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,s=t.stat_desc.extra_base,c=t.stat_desc.max_length,l,u,d,f,p,m,h=0;for(f=0;f<=b;f++)e.bl_count[f]=0;for(n[e.heap[e.heap_max]*2+1]=0,l=e.heap_max+1;l<y;l++)u=e.heap[l],f=n[n[u*2+1]*2+1]+1,f>c&&(f=c,h++),n[u*2+1]=f,!(u>r)&&(e.bl_count[f]++,p=0,u>=s&&(p=o[u-s]),m=n[u*2],e.opt_len+=m*(f+p),a&&(e.static_len+=m*(i[u*2+1]+p)));if(h!==0){do{for(f=c-1;e.bl_count[f]===0;)f--;e.bl_count[f]--,e.bl_count[f+1]+=2,e.bl_count[c]--,h-=2}while(h>0);for(f=c;f!==0;f--)for(u=e.bl_count[f];u!==0;)d=e.heap[--l],!(d>r)&&(n[d*2+1]!==f&&(e.opt_len+=(f-n[d*2+1])*n[d*2],n[d*2+1]=f),u--)}}function le(e,t,n){var r=Array(b+1),i=0,a,o;for(a=1;a<=b;a++)r[a]=i=i+n[a-1]<<1;for(o=0;o<=t;o++){var s=e[o*2+1];s!==0&&(e[o*2]=se(r[s]++,s))}}function ue(){var e,t,n,r,i,a=Array(b+1);for(n=0,r=0;r<m-1;r++)for(I[r]=n,e=0;e<1<<D[r];e++)F[n++]=r;for(F[n-1]=r,i=0,r=0;r<16;r++)for(L[r]=i,e=0;e<1<<O[r];e++)P[i++]=r;for(i>>=7;r<_;r++)for(L[r]=i<<7,e=0;e<1<<O[r]-7;e++)P[256+ i++]=r;for(t=0;t<=b;t++)a[t]=0;for(e=0;e<=143;)M[e*2+1]=8,e++,a[8]++;for(;e<=255;)M[e*2+1]=9,e++,a[9]++;for(;e<=279;)M[e*2+1]=7,e++,a[7]++;for(;e<=287;)M[e*2+1]=8,e++,a[8]++;for(le(M,g+1,a),e=0;e<_;e++)N[e*2+1]=5,N[e*2]=se(e,5);ee=new R(M,D,h+1,g,b),te=new R(N,O,0,_,b),ne=new R([],k,0,v,S)}function de(e){var t;for(t=0;t<g;t++)e.dyn_ltree[t*2]=0;for(t=0;t<_;t++)e.dyn_dtree[t*2]=0;for(t=0;t<v;t++)e.bl_tree[t*2]=0;e.dyn_ltree[C*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function fe(e){e.bi_valid>8?ae(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function V(e,t,n,i){fe(e),i&&(ae(e,n),ae(e,~n)),r.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}function H(e,t,n,r){var i=t*2,a=n*2;return e[i]<e[a]||e[i]===e[a]&&r[t]<=r[n]}function U(e,t,n){for(var r=e.heap[n],i=n<<1;i<=e.heap_len&&(i<e.heap_len&&H(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!H(t,r,e.heap[i],e.depth));)e.heap[n]=e.heap[i],n=i,i<<=1;e.heap[n]=r}function pe(e,t,n){var r,i,a=0,o,s;if(e.last_lit!==0)do r=e.pending_buf[e.d_buf+a*2]<<8|e.pending_buf[e.d_buf+a*2+1],i=e.pending_buf[e.l_buf+a],a++,r===0?z(e,i,t):(o=F[i],z(e,o+h+1,t),s=D[o],s!==0&&(i-=I[o],oe(e,i,s)),r--,o=ie(r),z(e,o,n),s=O[o],s!==0&&(r-=L[o],oe(e,r,s)));while(a<e.last_lit);z(e,C,t)}function me(e,t){var n=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems,o,s,c=-1,l;for(e.heap_len=0,e.heap_max=y,o=0;o<a;o++)n[o*2]===0?n[o*2+1]=0:(e.heap[++e.heap_len]=c=o,e.depth[o]=0);for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,n[l*2]=1,e.depth[l]=0,e.opt_len--,i&&(e.static_len-=r[l*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)U(e,n,o);l=a;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],U(e,n,1),s=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=s,n[l*2]=n[o*2]+n[s*2],e.depth[l]=(e.depth[o]>=e.depth[s]?e.depth[o]:e.depth[s])+1,n[o*2+1]=n[s*2+1]=l,e.heap[1]=l++,U(e,n,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],B(e,t),le(n,c,e.bl_count)}function W(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3),t[(n+1)*2+1]=65535,r=0;r<=n;r++)a=o,o=t[(r+1)*2+1],!(++s<c&&a===o)&&(s<l?e.bl_tree[a*2]+=s:a===0?s<=10?e.bl_tree[T*2]++:e.bl_tree[E*2]++:(a!==i&&e.bl_tree[a*2]++,e.bl_tree[w*2]++),s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4))}function he(e,t,n){var r,i=-1,a,o=t[1],s=0,c=7,l=4;for(o===0&&(c=138,l=3),r=0;r<=n;r++)if(a=o,o=t[(r+1)*2+1],!(++s<c&&a===o)){if(s<l)do z(e,a,e.bl_tree);while(--s!==0);else a===0?s<=10?(z(e,T,e.bl_tree),oe(e,s-3,3)):(z(e,E,e.bl_tree),oe(e,s-11,7)):(a!==i&&(z(e,a,e.bl_tree),s--),z(e,w,e.bl_tree),oe(e,s-3,2));s=0,i=a,o===0?(c=138,l=3):a===o?(c=6,l=3):(c=7,l=4)}}function G(e){var t;for(W(e,e.dyn_ltree,e.l_desc.max_code),W(e,e.dyn_dtree,e.d_desc.max_code),me(e,e.bl_desc),t=v-1;t>=3&&e.bl_tree[A[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t}function K(e,t,n,r){var i;for(oe(e,t-257,5),oe(e,n-1,5),oe(e,r-4,4),i=0;i<r;i++)oe(e,e.bl_tree[A[i]*2+1],3);he(e,e.dyn_ltree,t-1),he(e,e.dyn_dtree,n-1)}function ge(e){var t=4093624447,n;for(n=0;n<=31;n++,t>>>=1)if(t&1&&e.dyn_ltree[n*2]!==0)return a;if(e.dyn_ltree[18]!==0||e.dyn_ltree[20]!==0||e.dyn_ltree[26]!==0)return o;for(n=32;n<h;n++)if(e.dyn_ltree[n*2]!==0)return o;return a}var _e=!1;function q(e){_e||=(ue(),!0),e.l_desc=new re(e.dyn_ltree,ee),e.d_desc=new re(e.dyn_dtree,te),e.bl_desc=new re(e.bl_tree,ne),e.bi_buf=0,e.bi_valid=0,de(e)}function ve(e,t,n,r){oe(e,(l<<1)+(r?1:0),3),V(e,t,n,!0)}function ye(e){oe(e,u<<1,3),z(e,C,M),ce(e)}function be(e,t,n,r){var a,o,c=0;e.level>0?(e.strm.data_type===s&&(e.strm.data_type=ge(e)),me(e,e.l_desc),me(e,e.d_desc),c=G(e),a=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,o<=a&&(a=o)):a=o=n+5,n+4<=a&&t!==-1?ve(e,t,n,r):e.strategy===i||o===a?(oe(e,(u<<1)+(r?1:0),3),pe(e,M,N)):(oe(e,(d<<1)+(r?1:0),3),K(e,e.l_desc.max_code+1,e.d_desc.max_code+1,c+1),pe(e,e.dyn_ltree,e.dyn_dtree)),de(e),r&&fe(e)}function xe(e,t,n){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=n&255,e.last_lit++,t===0?e.dyn_ltree[n*2]++:(e.matches++,t--,e.dyn_ltree[(F[n]+h+1)*2]++,e.dyn_dtree[ie(t)*2]++),e.last_lit===e.lit_bufsize-1}n._tr_init=q,n._tr_stored_block=ve,n._tr_flush_block=be,n._tr_tally=xe,n._tr_align=ye},{"../utils/common":41}],53:[function(e,t,n){function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg=``,this.state=null,this.data_type=2,this.adler=0}t.exports=r},{}],54:[function(e,t,n){(function(e){(function(e,t){if(e.setImmediate)return;var n=1,r={},i=!1,a=e.document,o;function s(e){typeof e!=`function`&&(e=Function(``+e));for(var t=Array(arguments.length-1),i=0;i<t.length;i++)t[i]=arguments[i+1];return r[n]={callback:e,args:t},o(n),n++}function c(e){delete r[e]}function l(e){var n=e.callback,r=e.args;switch(r.length){case 0:n();break;case 1:n(r[0]);break;case 2:n(r[0],r[1]);break;case 3:n(r[0],r[1],r[2]);break;default:n.apply(t,r);break}}function u(e){if(i)setTimeout(u,0,e);else{var t=r[e];if(t){i=!0;try{l(t)}finally{c(e),i=!1}}}}function d(){o=function(e){process.nextTick(function(){u(e)})}}function f(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage(``,`*`),e.onmessage=n,t}}function p(){var t=`setImmediate$`+Math.random()+`$`,n=function(n){n.source===e&&typeof n.data==`string`&&n.data.indexOf(t)===0&&u(+n.data.slice(t.length))};e.addEventListener?e.addEventListener(`message`,n,!1):e.attachEvent(`onmessage`,n),o=function(n){e.postMessage(t+n,`*`)}}function m(){var e=new MessageChannel;e.port1.onmessage=function(e){var t=e.data;u(t)},o=function(t){e.port2.postMessage(t)}}function h(){var e=a.documentElement;o=function(t){var n=a.createElement(`script`);n.onreadystatechange=function(){u(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}function g(){o=function(e){setTimeout(u,0,e)}}var _=Object.getPrototypeOf&&Object.getPrototypeOf(e);_=_&&_.setTimeout?_:e,{}.toString.call(e.process)===`[object process]`?d():f()?p():e.MessageChannel?m():a&&`onreadystatechange`in a.createElement(`script`)?h():g(),_.setImmediate=s,_.clearImmediate=c})(typeof self>`u`?e===void 0?this:e:self)}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}]},{},[10])(10)})}))()),Ad=class{constructor(){this.zip=void 0,this.urlCache={},this.checkRequirements()}checkRequirements(){try{this.zip=new kd.default}catch{throw Error(`JSZip lib not loaded`)}}open(e,t){return this.zip.loadAsync(e,{base64:t})}openUrl(e,t){return cu(e,`binary`).then(function(e){return this.zip.loadAsync(e,{base64:t})}.bind(this))}request(e,t){var n=new zl,r,i=new Jl(e);return t||=i.extension,r=t==`blob`?this.getBlob(e):this.getText(e),r?r.then(function(e){let r=this.handleResponse(e,t);n.resolve(r)}.bind(this)):n.reject({message:`File not found in the epub: `+e,stack:Error().stack}),n.promise}handleResponse(e,t){return t==`json`?JSON.parse(e):Tl(t)?jl(e,`text/xml`):t==`xhtml`?jl(e,`application/xhtml+xml`):t==`html`||t==`htm`?jl(e,`text/html`):e}getBlob(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return t||=wu.lookup(r.name),r.async(`uint8array`).then(function(e){return new Blob([e],{type:t})})}getText(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return r.async(`string`).then(function(e){return e})}getBase64(e,t){var n=window.decodeURIComponent(e.substr(1)),r=this.zip.file(n);if(r)return t||=wu.lookup(r.name),r.async(`base64`).then(function(e){return`data:`+t+`;base64,`+e})}createUrl(e,t){var n=new zl,r=window.URL||window.webkitURL||window.mozURL,i,a,o=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(o?(a=this.getBase64(e),a&&a.then(function(t){this.urlCache[e]=t,n.resolve(t)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(t){i=r.createObjectURL(t),this.urlCache[e]=i,n.resolve(i)}.bind(this))),a||n.reject({message:`File not found in the epub: `+e,stack:Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.zip=void 0,this.urlCache={}}},jd=o(((e,t)=>{
/*!
localForage -- Offline Storage, Improved
Version 1.10.0
https://localforage.github.io/localForage
(c) 2013-2017 Mozilla, Apache License 2.0
*/
(function(n){if(typeof e==`object`&&t!==void 0)t.exports=n();else if(typeof define==`function`&&define.amd)define([],n);else{var r=typeof window<`u`?window:typeof global<`u`?global:typeof self<`u`?self:this;r.localforage=n()}})(function(){return(function e(t,n,r){function i(o,s){if(!n[o]){if(!t[o]){var c=typeof u==`function`&&u;if(!s&&c)return c(o,!0);if(a)return a(o,!0);var l=Error(`Cannot find module '`+o+`'`);throw l.code=`MODULE_NOT_FOUND`,l}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return i(n||e)},d,d.exports,e,t,n,r)}return n[o].exports}for(var a=typeof u==`function`&&u,o=0;o<r.length;o++)i(r[o]);return i})({1:[function(e,t,n){(function(e){var n=e.MutationObserver||e.WebKitMutationObserver,r;if(n){var i=0,a=new n(u),o=e.document.createTextNode(``);a.observe(o,{characterData:!0}),r=function(){o.data=i=++i%2}}else if(!e.setImmediate&&e.MessageChannel!==void 0){var s=new e.MessageChannel;s.port1.onmessage=u,r=function(){s.port2.postMessage(0)}}else r=`document`in e&&`onreadystatechange`in e.document.createElement(`script`)?function(){var t=e.document.createElement(`script`);t.onreadystatechange=function(){u(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(u,0)};var c,l=[];function u(){c=!0;for(var e,t,n=l.length;n;){for(t=l,l=[],e=-1;++e<n;)t[e]();n=l.length}c=!1}t.exports=d;function d(e){l.push(e)===1&&!c&&r()}}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{}],2:[function(e,t,n){var r=e(1);function i(){}var a={},o=[`REJECTED`],s=[`FULFILLED`],c=[`PENDING`];t.exports=l;function l(e){if(typeof e!=`function`)throw TypeError(`resolver must be a function`);this.state=c,this.queue=[],this.outcome=void 0,e!==i&&p(this,e)}l.prototype.catch=function(e){return this.then(null,e)},l.prototype.then=function(e,t){if(typeof e!=`function`&&this.state===s||typeof t!=`function`&&this.state===o)return this;var n=new this.constructor(i);if(this.state!==c){var r=this.state===s?e:t;d(n,r,this.outcome)}else this.queue.push(new u(n,e,t));return n};function u(e,t,n){this.promise=e,typeof t==`function`&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),typeof n==`function`&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}u.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},u.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},u.prototype.callRejected=function(e){a.reject(this.promise,e)},u.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)};function d(e,t,n){r(function(){var r;try{r=t(n)}catch(t){return a.reject(e,t)}r===e?a.reject(e,TypeError(`Cannot resolve promise with itself`)):a.resolve(e,r)})}a.resolve=function(e,t){var n=m(f,t);if(n.status===`error`)return a.reject(e,n.value);var r=n.value;if(r)p(e,r);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var n=-1,r=e.queue.length;++n<r;)e.queue[n].callRejected(t);return e};function f(e){var t=e&&e.then;if(e&&(typeof e==`object`||typeof e==`function`)&&typeof t==`function`)return function(){t.apply(e,arguments)}}function p(e,t){var n=!1;function r(t){n||(n=!0,a.reject(e,t))}function i(t){n||(n=!0,a.resolve(e,t))}function o(){t(i,r)}var s=m(o);s.status===`error`&&r(s.value)}function m(e,t){var n={};try{n.value=e(t),n.status=`success`}catch(e){n.status=`error`,n.value=e}return n}l.resolve=h;function h(e){return e instanceof this?e:a.resolve(new this(i),e)}l.reject=g;function g(e){var t=new this(i);return a.reject(t,e)}l.all=_;function _(e){var t=this;if(Object.prototype.toString.call(e)!==`[object Array]`)return this.reject(TypeError(`must be an array`));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=Array(n),s=0,c=-1,l=new this(i);++c<n;)u(e[c],c);return l;function u(e,i){t.resolve(e).then(c,function(e){r||(r=!0,a.reject(l,e))});function c(e){o[i]=e,++s===n&&!r&&(r=!0,a.resolve(l,o))}}}l.race=v;function v(e){var t=this;if(Object.prototype.toString.call(e)!==`[object Array]`)return this.reject(TypeError(`must be an array`));var n=e.length,r=!1;if(!n)return this.resolve([]);for(var o=-1,s=new this(i);++o<n;)c(e[o]);return s;function c(e){t.resolve(e).then(function(e){r||(r=!0,a.resolve(s,e))},function(e){r||(r=!0,a.reject(s,e))})}}},{1:1}],3:[function(e,t,n){(function(t){typeof t.Promise!=`function`&&(t.Promise=e(2))}).call(this,typeof global<`u`?global:typeof self<`u`?self:typeof window<`u`?window:{})},{2:2}],4:[function(e,t,n){var r=typeof Symbol==`function`&&typeof Symbol.iterator==`symbol`?function(e){return typeof e}:function(e){return e&&typeof Symbol==`function`&&e.constructor===Symbol&&e!==Symbol.prototype?`symbol`:typeof e};function i(e,t){if(!(e instanceof t))throw TypeError(`Cannot call a class as a function`)}function a(){try{if(typeof indexedDB<`u`)return indexedDB;if(typeof webkitIndexedDB<`u`)return webkitIndexedDB;if(typeof mozIndexedDB<`u`)return mozIndexedDB;if(typeof OIndexedDB<`u`)return OIndexedDB;if(typeof msIndexedDB<`u`)return msIndexedDB}catch{return}}var o=a();function s(){try{if(!o||!o.open)return!1;var e=typeof openDatabase<`u`&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),t=typeof fetch==`function`&&fetch.toString().indexOf(`[native code`)!==-1;return(!e||t)&&typeof indexedDB<`u`&&typeof IDBKeyRange<`u`}catch{return!1}}function c(e,t){e||=[],t||={};try{return new Blob(e,t)}catch(i){if(i.name!==`TypeError`)throw i;for(var n=new(typeof BlobBuilder<`u`?BlobBuilder:typeof MSBlobBuilder<`u`?MSBlobBuilder:typeof MozBlobBuilder<`u`?MozBlobBuilder:WebKitBlobBuilder),r=0;r<e.length;r+=1)n.append(e[r]);return n.getBlob(t.type)}}typeof Promise>`u`&&e(3);var l=Promise;function u(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}function d(e,t,n){typeof t==`function`&&e.then(t),typeof n==`function`&&e.catch(n)}function f(e){return typeof e!=`string`&&(console.warn(e+` used as a key, but it is not a string.`),e=String(e)),e}function p(){if(arguments.length&&typeof arguments[arguments.length-1]==`function`)return arguments[arguments.length-1]}var m=`local-forage-detect-blob-support`,h=void 0,g={},_=Object.prototype.toString,v=`readonly`,y=`readwrite`;function b(e){for(var t=e.length,n=new ArrayBuffer(t),r=new Uint8Array(n),i=0;i<t;i++)r[i]=e.charCodeAt(i);return n}function x(e){return new l(function(t){var n=e.transaction(m,y),r=c([``]);n.objectStore(m).put(r,`key`),n.onabort=function(e){e.preventDefault(),e.stopPropagation(),t(!1)},n.oncomplete=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);t(n||!e||parseInt(e[1],10)>=43)}}).catch(function(){return!1})}function S(e){return typeof h==`boolean`?l.resolve(h):x(e).then(function(e){return h=e,h})}function C(e){var t=g[e.name],n={};n.promise=new l(function(e,t){n.resolve=e,n.reject=t}),t.deferredOperations.push(n),t.dbReady?t.dbReady=t.dbReady.then(function(){return n.promise}):t.dbReady=n.promise}function w(e){var t=g[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function T(e,t){var n=g[e.name].deferredOperations.pop();if(n)return n.reject(t),n.promise}function E(e,t){return new l(function(n,r){if(g[e.name]=g[e.name]||I(),e.db)if(t)C(e),e.db.close();else return n(e.db);var i=[e.name];t&&i.push(e.version);var a=o.open.apply(o,i);t&&(a.onupgradeneeded=function(t){var n=a.result;try{n.createObjectStore(e.storeName),t.oldVersion<=1&&n.createObjectStore(m)}catch(n){if(n.name===`ConstraintError`)console.warn(`The database "`+e.name+`" has been upgraded from version `+t.oldVersion+` to version `+t.newVersion+`, but the storage "`+e.storeName+`" already exists.`);else throw n}}),a.onerror=function(e){e.preventDefault(),r(a.error)},a.onsuccess=function(){var t=a.result;t.onversionchange=function(e){e.target.close()},n(t),w(e)}})}function D(e){return E(e,!1)}function O(e){return E(e,!0)}function k(e,t){if(!e.db)return!0;var n=!e.db.objectStoreNames.contains(e.storeName),r=e.version<e.db.version,i=e.version>e.db.version;if(r&&(e.version!==t&&console.warn(`The database "`+e.name+`" can't be downgraded from version `+e.db.version+` to version `+e.version+`.`),e.version=e.db.version),i||n){if(n){var a=e.db.version+1;a>e.version&&(e.version=a)}return!0}return!1}function A(e){return new l(function(t,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||``);t({__local_forage_encoded_blob:!0,data:r,type:e.type})},r.readAsBinaryString(e)})}function j(e){var t=b(atob(e.data));return c([t],{type:e.type})}function M(e){return e&&e.__local_forage_encoded_blob}function N(e){var t=this,n=t._initReady().then(function(){var e=g[t._dbInfo.name];if(e&&e.dbReady)return e.dbReady});return d(n,e,e),n}function P(e){C(e);for(var t=g[e.name],n=t.forages,r=0;r<n.length;r++){var i=n[r];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,D(e).then(function(t){return e.db=t,k(e)?O(e):t}).then(function(r){e.db=t.db=r;for(var i=0;i<n.length;i++)n[i]._dbInfo.db=r}).catch(function(t){throw T(e,t),t})}function F(e,t,n,r){r===void 0&&(r=1);try{var i=e.db.transaction(e.storeName,t);n(null,i)}catch(i){if(r>0&&(!e.db||i.name===`InvalidStateError`||i.name===`NotFoundError`))return l.resolve().then(function(){if(!e.db||i.name===`NotFoundError`&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),O(e)}).then(function(){return P(e).then(function(){F(e,t,n,r-1)})}).catch(n);n(i)}}function I(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function L(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=e[r];var i=g[n.name];i||(i=I(),g[n.name]=i),i.forages.push(t),t._initReady||(t._initReady=t.ready,t.ready=N);var a=[];function o(){return l.resolve()}for(var s=0;s<i.forages.length;s++){var c=i.forages[s];c!==t&&a.push(c._initReady().catch(o))}var u=i.forages.slice(0);return l.all(a).then(function(){return n.db=i.db,D(n)}).then(function(e){return n.db=e,k(n,t._defaultConfig.version)?O(n):e}).then(function(e){n.db=i.db=e,t._dbInfo=n;for(var r=0;r<u.length;r++){var a=u[r];a!==t&&(a._dbInfo.db=n.db,a._dbInfo.version=n.version)}})}function R(e,t){var n=this;e=f(e);var r=new l(function(t,r){n.ready().then(function(){F(n._dbInfo,v,function(i,a){if(i)return r(i);try{var o=a.objectStore(n._dbInfo.storeName).get(e);o.onsuccess=function(){var e=o.result;e===void 0&&(e=null),M(e)&&(e=j(e)),t(e)},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function ee(e,t){var n=this,r=new l(function(t,r){n.ready().then(function(){F(n._dbInfo,v,function(i,a){if(i)return r(i);try{var o=a.objectStore(n._dbInfo.storeName).openCursor(),s=1;o.onsuccess=function(){var n=o.result;if(n){var r=n.value;M(r)&&(r=j(r));var i=e(r,n.key,s++);i===void 0?n.continue():t(i)}else t()},o.onerror=function(){r(o.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function te(e,t,n){var r=this;e=f(e);var i=new l(function(n,i){var a;r.ready().then(function(){return a=r._dbInfo,_.call(t)===`[object Blob]`?S(a.db).then(function(e){return e?t:A(t)}):t}).then(function(t){F(r._dbInfo,y,function(a,o){if(a)return i(a);try{var s=o.objectStore(r._dbInfo.storeName);t===null&&(t=void 0);var c=s.put(t,e);o.oncomplete=function(){t===void 0&&(t=null),n(t)},o.onabort=o.onerror=function(){var e=c.error?c.error:c.transaction.error;i(e)}}catch(e){i(e)}})}).catch(i)});return u(i,n),i}function ne(e,t){var n=this;e=f(e);var r=new l(function(t,r){n.ready().then(function(){F(n._dbInfo,y,function(i,a){if(i)return r(i);try{var o=a.objectStore(n._dbInfo.storeName).delete(e);a.oncomplete=function(){t()},a.onerror=function(){r(o.error)},a.onabort=function(){var e=o.error?o.error:o.transaction.error;r(e)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function re(e){var t=this,n=new l(function(e,n){t.ready().then(function(){F(t._dbInfo,y,function(r,i){if(r)return n(r);try{var a=i.objectStore(t._dbInfo.storeName).clear();i.oncomplete=function(){e()},i.onabort=i.onerror=function(){var e=a.error?a.error:a.transaction.error;n(e)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function ie(e){var t=this,n=new l(function(e,n){t.ready().then(function(){F(t._dbInfo,v,function(r,i){if(r)return n(r);try{var a=i.objectStore(t._dbInfo.storeName).count();a.onsuccess=function(){e(a.result)},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function ae(e,t){var n=this,r=new l(function(t,r){if(e<0){t(null);return}n.ready().then(function(){F(n._dbInfo,v,function(i,a){if(i)return r(i);try{var o=a.objectStore(n._dbInfo.storeName),s=!1,c=o.openKeyCursor();c.onsuccess=function(){var n=c.result;if(!n){t(null);return}e===0||s?t(n.key):(s=!0,n.advance(e))},c.onerror=function(){r(c.error)}}catch(e){r(e)}})}).catch(r)});return u(r,t),r}function oe(e){var t=this,n=new l(function(e,n){t.ready().then(function(){F(t._dbInfo,v,function(r,i){if(r)return n(r);try{var a=i.objectStore(t._dbInfo.storeName).openKeyCursor(),o=[];a.onsuccess=function(){var t=a.result;if(!t){e(o);return}o.push(t.key),t.continue()},a.onerror=function(){n(a.error)}}catch(e){n(e)}})}).catch(n)});return u(n,e),n}function z(e,t){t=p.apply(this,arguments);var n=this.config();e=typeof e!=`function`&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r=this,i;if(!e.name)i=l.reject(`Invalid arguments`);else{var a=e.name===n.name&&r._dbInfo.db?l.resolve(r._dbInfo.db):D(e).then(function(t){var n=g[e.name],r=n.forages;n.db=t;for(var i=0;i<r.length;i++)r[i]._dbInfo.db=t;return t});i=e.storeName?a.then(function(t){if(t.objectStoreNames.contains(e.storeName)){var n=t.version+1;C(e);var r=g[e.name],i=r.forages;t.close();for(var a=0;a<i.length;a++){var s=i[a];s._dbInfo.db=null,s._dbInfo.version=n}return new l(function(t,r){var i=o.open(e.name,n);i.onerror=function(e){i.result.close(),r(e)},i.onupgradeneeded=function(){i.result.deleteObjectStore(e.storeName)},i.onsuccess=function(){var e=i.result;e.close(),t(e)}}).then(function(e){r.db=e;for(var t=0;t<i.length;t++){var n=i[t];n._dbInfo.db=e,w(n._dbInfo)}}).catch(function(t){throw(T(e,t)||l.resolve()).catch(function(){}),t})}}):a.then(function(t){C(e);var n=g[e.name],r=n.forages;t.close();for(var i=0;i<r.length;i++){var a=r[i];a._dbInfo.db=null}return new l(function(t,n){var r=o.deleteDatabase(e.name);r.onerror=function(){var e=r.result;e&&e.close(),n(r.error)},r.onblocked=function(){console.warn(`dropInstance blocked for database "`+e.name+`" until all open connections are closed`)},r.onsuccess=function(){var e=r.result;e&&e.close(),t(e)}}).then(function(e){n.db=e;for(var t=0;t<r.length;t++){var i=r[t];w(i._dbInfo)}}).catch(function(t){throw(T(e,t)||l.resolve()).catch(function(){}),t})})}return u(i,t),i}var se={_driver:`asyncStorage`,_initStorage:L,_support:s(),iterate:ee,getItem:R,setItem:te,removeItem:ne,clear:re,length:ie,key:ae,keys:oe,dropInstance:z};function ce(){return typeof openDatabase==`function`}var B=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/`,le=`~~local_forage_type~`,ue=/^~~local_forage_type~([^~]+)~/,de=`__lfsc__:`,fe=de.length,V=`arbf`,H=`blob`,U=`si08`,pe=`ui08`,me=`uic8`,W=`si16`,he=`si32`,G=`ur16`,K=`ui32`,ge=`fl32`,_e=`fl64`,q=fe+V.length,ve=Object.prototype.toString;function ye(e){var t=e.length*.75,n=e.length,r,i=0,a,o,s,c;e[e.length-1]===`=`&&(t--,e[e.length-2]===`=`&&t--);var l=new ArrayBuffer(t),u=new Uint8Array(l);for(r=0;r<n;r+=4)a=B.indexOf(e[r]),o=B.indexOf(e[r+1]),s=B.indexOf(e[r+2]),c=B.indexOf(e[r+3]),u[i++]=a<<2|o>>4,u[i++]=(o&15)<<4|s>>2,u[i++]=(s&3)<<6|c&63;return l}function be(e){var t=new Uint8Array(e),n=``,r;for(r=0;r<t.length;r+=3)n+=B[t[r]>>2],n+=B[(t[r]&3)<<4|t[r+1]>>4],n+=B[(t[r+1]&15)<<2|t[r+2]>>6],n+=B[t[r+2]&63];return t.length%3==2?n=n.substring(0,n.length-1)+`=`:t.length%3==1&&(n=n.substring(0,n.length-2)+`==`),n}function xe(e,t){var n=``;if(e&&(n=ve.call(e)),e&&(n===`[object ArrayBuffer]`||e.buffer&&ve.call(e.buffer)===`[object ArrayBuffer]`)){var r,i=de;e instanceof ArrayBuffer?(r=e,i+=V):(r=e.buffer,n===`[object Int8Array]`?i+=U:n===`[object Uint8Array]`?i+=pe:n===`[object Uint8ClampedArray]`?i+=me:n===`[object Int16Array]`?i+=W:n===`[object Uint16Array]`?i+=G:n===`[object Int32Array]`?i+=he:n===`[object Uint32Array]`?i+=K:n===`[object Float32Array]`?i+=ge:n===`[object Float64Array]`?i+=_e:t(Error(`Failed to get type for BinaryArray`))),t(i+be(r))}else if(n===`[object Blob]`){var a=new FileReader;a.onload=function(){var n=le+e.type+`~`+be(this.result);t(de+H+n)},a.readAsArrayBuffer(e)}else try{t(JSON.stringify(e))}catch(n){console.error(`Couldn't convert value into a JSON string: `,e),t(null,n)}}function Se(e){if(e.substring(0,fe)!==de)return JSON.parse(e);var t=e.substring(q),n=e.substring(fe,q),r;if(n===H&&ue.test(t)){var i=t.match(ue);r=i[1],t=t.substring(i[0].length)}var a=ye(t);switch(n){case V:return a;case H:return c([a],{type:r});case U:return new Int8Array(a);case pe:return new Uint8Array(a);case me:return new Uint8ClampedArray(a);case W:return new Int16Array(a);case G:return new Uint16Array(a);case he:return new Int32Array(a);case K:return new Uint32Array(a);case ge:return new Float32Array(a);case _e:return new Float64Array(a);default:throw Error(`Unkown type: `+n)}}var J={serialize:xe,deserialize:Se,stringToBuffer:ye,bufferToString:be};function Ce(e,t,n,r){e.executeSql(`CREATE TABLE IF NOT EXISTS `+t.storeName+` (id INTEGER PRIMARY KEY, key unique, value)`,[],n,r)}function we(e){var t=this,n={db:null};if(e)for(var r in e)n[r]=typeof e[r]==`string`?e[r]:e[r].toString();var i=new l(function(e,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(e){return r(e)}n.db.transaction(function(i){Ce(i,n,function(){t._dbInfo=n,e()},function(e,t){r(t)})},r)});return n.serializer=J,i}function Te(e,t,n,r,i,a){e.executeSql(n,r,i,function(e,o){o.code===o.SYNTAX_ERR?e.executeSql(`SELECT name FROM sqlite_master WHERE type='table' AND name = ?`,[t.storeName],function(e,s){s.rows.length?a(e,o):Ce(e,t,function(){e.executeSql(n,r,i,a)},a)},a):a(e,o)},a)}function Y(e,t){var n=this;e=f(e);var r=new l(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){Te(n,i,`SELECT * FROM `+i.storeName+` WHERE key = ? LIMIT 1`,[e],function(e,n){var r=n.rows.length?n.rows.item(0).value:null;r&&=i.serializer.deserialize(r),t(r)},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function Ee(e,t){var n=this,r=new l(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){Te(n,i,`SELECT * FROM `+i.storeName,[],function(n,r){for(var a=r.rows,o=a.length,s=0;s<o;s++){var c=a.item(s),l=c.value;if(l&&=i.serializer.deserialize(l),l=e(l,c.key,s+1),l!==void 0){t(l);return}}t()},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function De(e,t,n,r){var i=this;e=f(e);var a=new l(function(a,o){i.ready().then(function(){t===void 0&&(t=null);var s=t,c=i._dbInfo;c.serializer.serialize(t,function(t,l){l?o(l):c.db.transaction(function(n){Te(n,c,`INSERT OR REPLACE INTO `+c.storeName+` (key, value) VALUES (?, ?)`,[e,t],function(){a(s)},function(e,t){o(t)})},function(t){if(t.code===t.QUOTA_ERR){if(r>0){a(De.apply(i,[e,s,n,r-1]));return}o(t)}})})}).catch(o)});return u(a,n),a}function Oe(e,t,n){return De.apply(this,[e,t,n,1])}function ke(e,t){var n=this;e=f(e);var r=new l(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){Te(n,i,`DELETE FROM `+i.storeName+` WHERE key = ?`,[e],function(){t()},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function Ae(e){var t=this,n=new l(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){Te(t,r,`DELETE FROM `+r.storeName,[],function(){e()},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function je(e){var t=this,n=new l(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){Te(t,r,`SELECT COUNT(key) as c FROM `+r.storeName,[],function(t,n){var r=n.rows.item(0).c;e(r)},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function Me(e,t){var n=this,r=new l(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){Te(n,i,`SELECT key FROM `+i.storeName+` WHERE id = ? LIMIT 1`,[e+1],function(e,n){var r=n.rows.length?n.rows.item(0).key:null;t(r)},function(e,t){r(t)})})}).catch(r)});return u(r,t),r}function Ne(e){var t=this,n=new l(function(e,n){t.ready().then(function(){var r=t._dbInfo;r.db.transaction(function(t){Te(t,r,`SELECT key FROM `+r.storeName,[],function(t,n){for(var r=[],i=0;i<n.rows.length;i++)r.push(n.rows.item(i).key);e(r)},function(e,t){n(t)})})}).catch(n)});return u(n,e),n}function Pe(e){return new l(function(t,n){e.transaction(function(r){r.executeSql(`SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'`,[],function(n,r){for(var i=[],a=0;a<r.rows.length;a++)i.push(r.rows.item(a).name);t({db:e,storeNames:i})},function(e,t){n(t)})},function(e){n(e)})})}function Fe(e,t){t=p.apply(this,arguments);var n=this.config();e=typeof e!=`function`&&e||{},e.name||(e.name=e.name||n.name,e.storeName=e.storeName||n.storeName);var r=this,i=e.name?new l(function(t){var i=e.name===n.name?r._dbInfo.db:openDatabase(e.name,``,``,0);e.storeName?t({db:i,storeNames:[e.storeName]}):t(Pe(i))}).then(function(e){return new l(function(t,n){e.db.transaction(function(r){function i(e){return new l(function(t,n){r.executeSql(`DROP TABLE IF EXISTS `+e,[],function(){t()},function(e,t){n(t)})})}for(var a=[],o=0,s=e.storeNames.length;o<s;o++)a.push(i(e.storeNames[o]));l.all(a).then(function(){t()}).catch(function(e){n(e)})},function(e){n(e)})})}):l.reject(`Invalid arguments`);return u(i,t),i}var Ie={_driver:`webSQLStorage`,_initStorage:we,_support:ce(),iterate:Ee,getItem:Y,setItem:Oe,removeItem:ke,clear:Ae,length:je,key:Me,keys:Ne,dropInstance:Fe};function Le(){try{return typeof localStorage<`u`&&`setItem`in localStorage&&!!localStorage.setItem}catch{return!1}}function Re(e,t){var n=e.name+`/`;return e.storeName!==t.storeName&&(n+=e.storeName+`/`),n}function ze(){var e=`_localforage_support_test`;try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}function Be(){return!ze()||localStorage.length>0}function Ve(e){var t=this,n={};if(e)for(var r in e)n[r]=e[r];return n.keyPrefix=Re(e,t._defaultConfig),Be()?(t._dbInfo=n,n.serializer=J,l.resolve()):l.reject()}function He(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);r.indexOf(e)===0&&localStorage.removeItem(r)}});return u(n,e),n}function Ue(e,t){var n=this;e=f(e);var r=n.ready().then(function(){var t=n._dbInfo,r=localStorage.getItem(t.keyPrefix+e);return r&&=t.serializer.deserialize(r),r});return u(r,t),r}function We(e,t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=t.keyPrefix,i=r.length,a=localStorage.length,o=1,s=0;s<a;s++){var c=localStorage.key(s);if(c.indexOf(r)===0){var l=localStorage.getItem(c);if(l&&=t.serializer.deserialize(l),l=e(l,c.substring(i),o++),l!==void 0)return l}}});return u(r,t),r}function Ge(e,t){var n=this,r=n.ready().then(function(){var t=n._dbInfo,r;try{r=localStorage.key(e)}catch{r=null}return r&&=r.substring(t.keyPrefix.length),r});return u(r,t),r}function Ke(e){var t=this,n=t.ready().then(function(){for(var e=t._dbInfo,n=localStorage.length,r=[],i=0;i<n;i++){var a=localStorage.key(i);a.indexOf(e.keyPrefix)===0&&r.push(a.substring(e.keyPrefix.length))}return r});return u(n,e),n}function qe(e){var t=this.keys().then(function(e){return e.length});return u(t,e),t}function Je(e,t){var n=this;e=f(e);var r=n.ready().then(function(){var t=n._dbInfo;localStorage.removeItem(t.keyPrefix+e)});return u(r,t),r}function Ye(e,t,n){var r=this;e=f(e);var i=r.ready().then(function(){t===void 0&&(t=null);var n=t;return new l(function(i,a){var o=r._dbInfo;o.serializer.serialize(t,function(t,r){if(r)a(r);else try{localStorage.setItem(o.keyPrefix+e,t),i(n)}catch(e){(e.name===`QuotaExceededError`||e.name===`NS_ERROR_DOM_QUOTA_REACHED`)&&a(e),a(e)}})})});return u(i,n),i}function Xe(e,t){if(t=p.apply(this,arguments),e=typeof e!=`function`&&e||{},!e.name){var n=this.config();e.name=e.name||n.name,e.storeName=e.storeName||n.storeName}var r=this,i=e.name?new l(function(t){e.storeName?t(Re(e,r._defaultConfig)):t(e.name+`/`)}).then(function(e){for(var t=localStorage.length-1;t>=0;t--){var n=localStorage.key(t);n.indexOf(e)===0&&localStorage.removeItem(n)}}):l.reject(`Invalid arguments`);return u(i,t),i}var Ze={_driver:`localStorageWrapper`,_initStorage:Ve,_support:Le(),iterate:We,getItem:Ue,setItem:Ye,removeItem:Je,clear:He,length:qe,key:Ge,keys:Ke,dropInstance:Xe},Qe=function(e,t){return e===t||typeof e==`number`&&typeof t==`number`&&isNaN(e)&&isNaN(t)},$e=function(e,t){for(var n=e.length,r=0;r<n;){if(Qe(e[r],t))return!0;r++}return!1},et=Array.isArray||function(e){return Object.prototype.toString.call(e)===`[object Array]`},tt={},nt={},rt={INDEXEDDB:se,WEBSQL:Ie,LOCALSTORAGE:Ze},it=[rt.INDEXEDDB._driver,rt.WEBSQL._driver,rt.LOCALSTORAGE._driver],at=[`dropInstance`],ot=[`clear`,`getItem`,`iterate`,`key`,`keys`,`length`,`removeItem`,`setItem`].concat(at),st={description:``,driver:it.slice(),name:`localforage`,size:4980736,storeName:`keyvaluepairs`,version:1};function ct(e,t){e[t]=function(){var n=arguments;return e.ready().then(function(){return e[t].apply(e,n)})}}function lt(){for(var e=1;e<arguments.length;e++){var t=arguments[e];if(t)for(var n in t)t.hasOwnProperty(n)&&(et(t[n])?arguments[0][n]=t[n].slice():arguments[0][n]=t[n])}return arguments[0]}t.exports=new(function(){function e(t){for(var n in i(this,e),rt)if(rt.hasOwnProperty(n)){var r=rt[n],a=r._driver;this[n]=a,tt[a]||this.defineDriver(r)}this._defaultConfig=lt({},st),this._config=lt({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(e){if((e===void 0?`undefined`:r(e))===`object`){if(this._ready)return Error(`Can't call config() after localforage has been used.`);for(var t in e){if(t===`storeName`&&(e[t]=e[t].replace(/\W/g,`_`)),t===`version`&&typeof e[t]!=`number`)return Error(`Database version must be a number.`);this._config[t]=e[t]}return`driver`in e&&e.driver?this.setDriver(this._config.driver):!0}else if(typeof e==`string`)return this._config[e];else return this._config},e.prototype.defineDriver=function(e,t,n){var r=new l(function(t,n){try{var r=e._driver,i=Error(`Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver`);if(!e._driver){n(i);return}for(var a=ot.concat(`_initStorage`),o=0,s=a.length;o<s;o++){var c=a[o];if((!$e(at,c)||e[c])&&typeof e[c]!=`function`){n(i);return}}(function(){for(var t=function(e){return function(){var t=Error(`Method `+e+` is not implemented by the current driver`),n=l.reject(t);return u(n,arguments[arguments.length-1]),n}},n=0,r=at.length;n<r;n++){var i=at[n];e[i]||(e[i]=t(i))}})();var d=function(n){tt[r]&&console.info(`Redefining LocalForage driver: `+r),tt[r]=e,nt[r]=n,t()};`_support`in e?e._support&&typeof e._support==`function`?e._support().then(d,n):d(!!e._support):d(!0)}catch(e){n(e)}});return d(r,t,n),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(e,t,n){var r=tt[e]?l.resolve(tt[e]):l.reject(Error(`Driver not found.`));return d(r,t,n),r},e.prototype.getSerializer=function(e){var t=l.resolve(J);return d(t,e),t},e.prototype.ready=function(e){var t=this,n=t._driverSet.then(function(){return t._ready===null&&(t._ready=t._initDriver()),t._ready});return d(n,e,e),n},e.prototype.setDriver=function(e,t,n){var r=this;et(e)||(e=[e]);var i=this._getSupportedDrivers(e);function a(){r._config.driver=r.driver()}function o(e){return r._extend(e),a(),r._ready=r._initStorage(r._config),r._ready}function s(e){return function(){var t=0;function n(){for(;t<e.length;){var i=e[t];return t++,r._dbInfo=null,r._ready=null,r.getDriver(i).then(o).catch(n)}a();var s=Error(`No available storage method found.`);return r._driverSet=l.reject(s),r._driverSet}return n()}}return this._driverSet=(this._driverSet===null?l.resolve():this._driverSet.catch(function(){return l.resolve()})).then(function(){var e=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(e).then(function(e){r._driver=e._driver,a(),r._wrapLibraryMethodsWithReady(),r._initDriver=s(i)})}).catch(function(){a();var e=Error(`No available storage method found.`);return r._driverSet=l.reject(e),r._driverSet}),d(this._driverSet,t,n),this._driverSet},e.prototype.supports=function(e){return!!nt[e]},e.prototype._extend=function(e){lt(this,e)},e.prototype._getSupportedDrivers=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];this.supports(i)&&t.push(i)}return t},e.prototype._wrapLibraryMethodsWithReady=function(){for(var e=0,t=ot.length;e<t;e++)ct(this,ot[e])},e.prototype.createInstance=function(t){return new e(t)},e}())},{3:3}]},{},[4])(4)})})),Md=l(qc()),Nd=l(jd()),Pd=class{constructor(e,t,n){this.urlCache={},this.storage=void 0,this.name=e,this.requester=t||cu,this.resolver=n,this.online=!0,this.checkRequirements(),this.addListeners()}checkRequirements(){try{let e;Nd.default===void 0&&(e=Nd.default),this.storage=e.createInstance({name:this.name})}catch{throw Error(`localForage lib not loaded`)}}addListeners(){this._status=this.status.bind(this),window.addEventListener(`online`,this._status),window.addEventListener(`offline`,this._status)}removeListeners(){window.removeEventListener(`online`,this._status),window.removeEventListener(`offline`,this._status),this._status=void 0}status(e){let t=navigator.onLine;this.online=t,t?this.emit(`online`,this):this.emit(`offline`,this)}add(e,t){let n=e.resources.map(e=>{let{href:n}=e,r=this.resolver(n),i=window.encodeURIComponent(r);return this.storage.getItem(i).then(e=>!e||t?this.requester(r,`binary`).then(e=>this.storage.setItem(i,e)):e)});return Promise.all(n)}put(e,t,n){let r=window.encodeURIComponent(e);return this.storage.getItem(r).then(i=>i||this.requester(e,`binary`,t,n).then(e=>this.storage.setItem(r,e)))}request(e,t,n,r){return this.online?this.requester(e,t,n,r).then(t=>(this.put(e),t)):this.retrieve(e,t)}retrieve(e,t){new zl;var n,r=new Jl(e);return t||=r.extension,n=t==`blob`?this.getBlob(e):this.getText(e),n.then(n=>{var r=new zl,i;return n?(i=this.handleResponse(n,t),r.resolve(i)):r.reject({message:`File not found in storage: `+e,stack:Error().stack}),r.promise})}handleResponse(e,t){return t==`json`?JSON.parse(e):Tl(t)?jl(e,`text/xml`):t==`xhtml`?jl(e,`application/xhtml+xml`):t==`html`||t==`htm`?jl(e,`text/html`):e}getBlob(e,t){let n=window.encodeURIComponent(e);return this.storage.getItem(n).then(function(n){if(n)return t||=wu.lookup(e),new Blob([n],{type:t})})}getText(e,t){let n=window.encodeURIComponent(e);return t||=wu.lookup(e),this.storage.getItem(n).then(function(e){var n=new zl,r=new FileReader,i;if(e)return i=new Blob([e],{type:t}),r.addEventListener(`loadend`,()=>{n.resolve(r.result)}),r.readAsText(i,t),n.promise})}getBase64(e,t){let n=window.encodeURIComponent(e);return t||=wu.lookup(e),this.storage.getItem(n).then(e=>{var n=new zl,r=new FileReader,i;if(e)return i=new Blob([e],{type:t}),r.addEventListener(`loadend`,()=>{n.resolve(r.result)}),r.readAsDataURL(i,t),n.promise})}createUrl(e,t){var n=new zl,r=window.URL||window.webkitURL||window.mozURL,i,a,o=t&&t.base64;return e in this.urlCache?(n.resolve(this.urlCache[e]),n.promise):(o?(a=this.getBase64(e),a&&a.then(function(t){this.urlCache[e]=t,n.resolve(t)}.bind(this))):(a=this.getBlob(e),a&&a.then(function(t){i=r.createObjectURL(t),this.urlCache[e]=i,n.resolve(i)}.bind(this))),a||n.reject({message:`File not found in storage: `+e,stack:Error().stack}),n.promise)}revokeUrl(e){var t=window.URL||window.webkitURL||window.mozURL,n=this.urlCache[e];n&&t.revokeObjectURL(n)}destroy(){var e=window.URL||window.webkitURL||window.mozURL;for(let t in this.urlCache)e.revokeObjectURL(t);this.urlCache={},this.removeListeners()}};(0,Md.default)(Pd.prototype);var Fd=Pd,Id=class{constructor(e){this.interactive=``,this.fixedLayout=``,this.openToSpread=``,this.orientationLock=``,e&&this.parse(e)}parse(e){if(!e)return this;let t=Ml(e,`display_options`);return t&&Nl(t,`option`).forEach(e=>{let t=``;switch(e.childNodes.length&&(t=e.childNodes[0].nodeValue),e.attributes.name.value){case`interactive`:this.interactive=t;break;case`fixed-layout`:this.fixedLayout=t;break;case`open-to-spread`:this.openToSpread=t;break;case`orientation-lock`:this.orientationLock=t;break}}),this}destroy(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}},Ld=l(qc()),Rd=`META-INF/container.xml`,zd=`META-INF/com.apple.ibooks.display-options.xml`,Bd={BINARY:`binary`,BASE64:`base64`,EPUB:`epub`,OPF:`opf`,MANIFEST:`json`,DIRECTORY:`directory`},Vd=class{constructor(e,t){t===void 0&&typeof e!=`string`&&!(e instanceof Blob)&&!(e instanceof ArrayBuffer)&&(t=e,e=void 0),this.settings=ml(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),ml(this.settings,t),this.opening=new zl,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new zl,spine:new zl,metadata:new zl,cover:new zl,navigation:new zl,pageList:new zl,resources:new zl,displayOptions:new zl},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||cu,this.spine=new du,this.locations=new hu(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),e&&this.open(e,this.settings.openAs).catch(t=>{var n=Error(`Cannot load book at `+e);this.emit($.BOOK.OPEN_FAILED,n)})}open(e,t){var n,r=t||this.determineType(e);return r===Bd.BINARY?(this.archived=!0,this.url=new Xl(`/`,``),n=this.openEpub(e)):r===Bd.BASE64?(this.archived=!0,this.url=new Xl(`/`,``),n=this.openEpub(e,r)):r===Bd.EPUB?(this.archived=!0,this.url=new Xl(`/`,``),n=this.request(e,`binary`,this.settings.requestCredentials,this.settings.requestHeaders).then(this.openEpub.bind(this))):r==Bd.OPF?(this.url=new Xl(e),n=this.openPackaging(this.url.Path.toString())):r==Bd.MANIFEST?(this.url=new Xl(e),n=this.openManifest(this.url.Path.toString())):(this.url=new Xl(e),n=this.openContainer(Rd).then(this.openPackaging.bind(this))),n}openEpub(e,t){return this.unarchive(e,t||this.settings.encoding).then(()=>this.openContainer(Rd)).then(e=>this.openPackaging(e))}openContainer(e){return this.load(e).then(e=>(this.container=new _u(e),this.resolve(this.container.packagePath)))}openPackaging(e){return this.path=new Jl(e),this.load(e).then(e=>(this.packaging=new vu(e),this.unpack(this.packaging)))}openManifest(e){return this.path=new Jl(e),this.load(e).then(e=>(this.packaging=new vu,this.packaging.load(e),this.unpack(this.packaging)))}load(e){var t=this.resolve(e);return this.archived?this.archive.request(t):this.request(t,null,this.settings.requestCredentials,this.settings.requestHeaders)}resolve(e,t){if(e){var n=e;return e.indexOf(`://`)>-1?e:(this.path&&(n=this.path.resolve(e)),t!=0&&this.url&&(n=this.url.resolve(n)),n)}}canonical(e){var t=e;return e?(t=this.settings.canonical?this.settings.canonical(e):this.resolve(e,!0),t):``}determineType(e){var t,n,r;if(this.settings.encoding===`base64`)return Bd.BASE64;if(typeof e!=`string`)return Bd.BINARY;if(t=new Xl(e),n=t.path(),r=n.extension,r&&=r.replace(/\?.*$/,``),!r)return Bd.DIRECTORY;if(r===`epub`)return Bd.EPUB;if(r===`opf`)return Bd.OPF;if(r===`json`)return Bd.MANIFEST}unpack(e){this.package=e,this.packaging.metadata.layout===``?this.load(this.url.resolve(zd)).then(e=>{this.displayOptions=new Id(e),this.loading.displayOptions.resolve(this.displayOptions)}).catch(e=>{this.displayOptions=new Id,this.loading.displayOptions.resolve(this.displayOptions)}):(this.displayOptions=new Id,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new Eu(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?`blobUrl`:`base64`)}),this.loadNavigation(this.packaging).then(()=>{this.loading.navigation.resolve(this.navigation)}),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&this.settings.replacements!=`none`?this.replacements().then(()=>{this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}).catch(e=>{console.error(e)}):this.loaded.displayOptions.then(()=>{this.opening.resolve(this)})}loadNavigation(e){let t=e.navPath||e.ncxPath,n=e.toc;return n?new Promise((t,r)=>{this.navigation=new yu(n),e.pageList&&(this.pageList=new Du(e.pageList)),t(this.navigation)}):t?this.load(t,`xml`).then(e=>(this.navigation=new yu(e),this.pageList=new Du(e),this.navigation)):new Promise((e,t)=>{this.navigation=new yu,this.pageList=new Du,e(this.navigation)})}section(e){return this.spine.get(e)}renderTo(e,t){return this.rendition=new Od(this,t),this.rendition.attachTo(e),this.rendition}setRequestCredentials(e){this.settings.requestCredentials=e}setRequestHeaders(e){this.settings.requestHeaders=e}unarchive(e,t){return this.archive=new Ad,this.archive.open(e,t)}store(e){let t=this.settings.replacements&&this.settings.replacements!==`none`,n=this.url,r=this.settings.requestMethod||cu.bind(this);return this.storage=new Fd(e,r,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then(()=>{this.archived&&(this.storage.requester=this.archive.request.bind(this.archive));let e=(e,t)=>{t.output=this.resources.substitute(e,t.url)};this.resources.settings.replacements=t||`blobUrl`,this.resources.replacements().then(()=>this.resources.replaceCss()),this.storage.on(`offline`,()=>{this.url=new Xl(`/`,``),this.spine.hooks.serialize.register(e)}),this.storage.on(`online`,()=>{this.url=n,this.spine.hooks.serialize.deregister(e)})}),this.storage}coverUrl(){return this.loaded.cover.then(()=>this.cover?this.archived?this.archive.createUrl(this.cover):this.cover:null)}replacements(){return this.spine.hooks.serialize.register((e,t)=>{t.output=this.resources.substitute(e,t.url)}),this.resources.replacements().then(()=>this.resources.replaceCss())}getRange(e){var t=new eu(e),n=this.spine.get(t.spinePos),r=this.load.bind(this);return n?n.load(r).then(function(e){return t.toRange(n.document)}):new Promise((e,t)=>{t(`CFI could not be found`)})}key(e){return`epubjs:0.3:${e||this.packaging.metadata.identifier||this.url.filename}`}destroy(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}};(0,Ld.default)(Vd.prototype);var Hd=Vd;function Ud(e,t){return new Hd(e,t)}Ud.VERSION=`0.3`,typeof global<`u`&&(global.EPUBJS_VERSION=`0.3`),Ud.Book=Hd,Ud.Rendition=Od,Ud.Contents=zu,Ud.CFI=eu,Ud.utils=tl;var Wd=Ud;bo.workerSrc=new URL(`/ahir-book/assets/pdf.worker.min-qwK7q_zL.mjs`,``+import.meta.url).toString();const Gd=async e=>{let t=e.size/(1024*1024),n=await Pn();return t>200?{valid:!1,warning:`Dosya çok büyük (${t.toFixed(2)}MB). Maksimum 200MB destekleniyor.`}:t>50?{valid:!0,warning:`Uyarı: Dosya boyutu ${t.toFixed(2)}MB. Sıkıştırma önerilir.`}:n&&n.percentUsed>80?{valid:!0,warning:`Depolama alanınızın %${n.percentUsed.toFixed(0)}'i dolu. Yer açmayı düşünün.`}:{valid:!0}},Kd=async e=>{try{let t=await e.arrayBuffer(),n=await os({data:t}).promise,r=(await n.getMetadata()).info,i=r?.Title||e.name.replace(`.pdf`,``),a=r?.Author||null,o=[];for(let e=1;e<=n.numPages;e++){let t=await(await n.getPage(e)).getTextContent(),r=[],i=null;for(let e of t.items){if(!(`str`in e)||!(`transform`in e))continue;let t=e.transform[4],n=e.transform[5],a=e.str.trim();a&&(i&&Math.abs(n-i.y)<5?i.items.push({x:t,str:a}):(i&&r.push(i),i={y:n,items:[{x:t,str:a}]}))}i&&r.push(i),r.sort((e,t)=>t.y-e.y);let a=-1,s=[];for(let e of r){e.items.sort((e,t)=>e.x-t.x);let t=e.items.map(e=>e.str).join(` `);a!==-1&&Math.abs(e.y-a)>15?s.push(`
`+t):s.push(t),a=e.y}o.push({pageNumber:e,text:s.join(`
`).trim()})}let s=null;try{let e=await n.getPage(1),t=e.getViewport({scale:.5}),r=document.createElement(`canvas`);r.width=t.width,r.height=t.height;let i=r.getContext(`2d`);await e.render({canvasContext:i,viewport:t,canvas:r}).promise,s=await new Promise(e=>{r.toBlob(t=>e(t),`image/jpeg`,.8)})}catch(e){console.warn(`Could not extract PDF cover:`,e)}return{title:i,author:a,coverBlob:s,fileBlob:e,format:`pdf`,pages:o}}catch(e){throw console.error(`PDF processing error:`,e),Error(`PDF dosyası işlenirken hata oluştu`)}},qd=async e=>{try{let t=await e.arrayBuffer(),n=Wd(t);await n.ready;let r=await n.loaded.metadata,i=r.title||e.name.replace(`.epub`,``),a=r.creator||null,o=null;try{let e=await n.coverUrl();e&&(o=await(await fetch(e)).blob())}catch(e){console.warn(`Could not extract EPUB cover:`,e)}let s=await n.loaded.spine,c=[],l=1;for(let e of s.items||[])try{let t=n.spine.get(e.href);await t.load(n.load.bind(n));let r=t.document?.textContent||``;c.push({pageNumber:l,text:r}),l++}catch(t){console.warn(`Could not load chapter ${e.href}:`,t)}return{title:i,author:a,coverBlob:o,fileBlob:e,format:`epub`,pages:c}}catch(e){throw console.error(`EPUB processing error:`,e),Error(`EPUB dosyası işlenirken hata oluştu`)}},Jd=async e=>{let t=e.name.split(`.`).pop()?.toLowerCase();if(![`pdf`,`epub`].includes(t||``))throw Error(`Desteklenmeyen dosya formatı. Sadece PDF ve EPUB destekleniyor.`);let n=await Gd(e);if(!n.valid)throw Error(n.warning||`Dosya çok büyük`);let r;r=t===`pdf`?await Kd(e):await qd(e);let i=await En({title:r.title,author:r.author,coverBlob:r.coverBlob,fileBlob:r.fileBlob,format:r.format,createdAt:new Date});return await Nn(i,r.pages),i};function Yd(){let e=Ae(),[t,n]=(0,y.useState)(!1),[r,i]=(0,y.useState)(null),[a,o]=(0,y.useState)(null),[s,c]=(0,y.useState)(!1),l=(0,y.useRef)(null),u=async t=>{i(null),o(null),n(!0);try{await Jd(t),e(`/library`)}catch(e){i(e.message||`Dosya yüklenirken bir hata oluştu`)}finally{n(!1)}},d=e=>{e.preventDefault(),e.stopPropagation(),e.type===`dragenter`||e.type===`dragover`?c(!0):e.type===`dragleave`&&c(!1)};return(0,X.jsx)(`div`,{className:`min-h-screen bg-background p-4`,children:(0,X.jsxs)(`div`,{className:`max-w-4xl mx-auto`,children:[(0,X.jsxs)(`header`,{className:`flex items-center justify-between mb-8`,children:[(0,X.jsx)(Wt,{to:`/library`,className:`p-2 hover:bg-gray-200 rounded-lg`,children:(0,X.jsx)(`svg`,{className:`w-6 h-6`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M15 19l-7-7 7-7`})})}),(0,X.jsx)(`h1`,{className:`text-2xl font-bold text-primary`,children:`Kitap İçe Aktar`}),(0,X.jsx)(`div`,{className:`w-8`})]}),(0,X.jsxs)(`div`,{className:`border-4 border-dashed rounded-lg p-12 text-center transition cursor-pointer ${s?`border-accent bg-blue-50`:`border-gray-300 hover:border-accent`}`,onDragEnter:d,onDragLeave:d,onDragOver:d,onDrop:e=>{e.preventDefault(),e.stopPropagation(),c(!1),e.dataTransfer.files&&e.dataTransfer.files[0]&&u(e.dataTransfer.files[0])},onClick:()=>{l.current?.click()},children:[t?(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(`div`,{className:`w-16 h-16 mx-auto mb-4 border-4 border-accent border-t-transparent rounded-full animate-spin`}),(0,X.jsx)(`p`,{className:`text-lg text-gray-600`,children:`Yükleniyor...`})]}):(0,X.jsxs)(X.Fragment,{children:[(0,X.jsx)(`svg`,{className:`w-16 h-16 mx-auto mb-4 text-gray-400`,fill:`none`,stroke:`currentColor`,viewBox:`0 0 24 24`,children:(0,X.jsx)(`path`,{strokeLinecap:`round`,strokeLinejoin:`round`,strokeWidth:2,d:`M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12`})}),(0,X.jsx)(`p`,{className:`text-lg text-gray-600 mb-2`,children:`PDF veya EPUB dosyalarını sürükleyin`}),(0,X.jsx)(`p`,{className:`text-sm text-gray-500 mb-4`,children:`ya da`}),(0,X.jsx)(`button`,{className:`bg-accent text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition`,children:`Dosya Seç`})]}),(0,X.jsx)(`input`,{ref:l,type:`file`,accept:`.pdf,.epub`,onChange:e=>{e.target.files&&e.target.files[0]&&u(e.target.files[0])},className:`hidden`})]}),r&&(0,X.jsx)(`div`,{className:`mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg`,children:r}),a&&(0,X.jsx)(`div`,{className:`mt-4 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg`,children:a}),(0,X.jsxs)(`div`,{className:`mt-8`,children:[(0,X.jsx)(`p`,{className:`text-sm text-gray-500`,children:`Desteklenen formatlar: PDF, EPUB`}),(0,X.jsx)(`p`,{className:`text-sm text-gray-500 mt-2`,children:`Maksimum dosya boyutu: 200MB`})]})]})})}function Xd(){return(0,X.jsx)(Vt,{children:(0,X.jsxs)(nt,{children:[(0,X.jsx)(et,{path:`/`,element:(0,X.jsx)(Wn,{})}),(0,X.jsx)(et,{path:`/library`,element:(0,X.jsx)(Gn,{})}),(0,X.jsx)(et,{path:`/bookmarks`,element:(0,X.jsx)(Kn,{})}),(0,X.jsx)(et,{path:`/settings`,element:(0,X.jsx)(qn,{})}),(0,X.jsx)(et,{path:`/search-results`,element:(0,X.jsx)(Jn,{})}),(0,X.jsx)(et,{path:`/reader/:bookId/:pageId`,element:(0,X.jsx)(Yn,{})}),(0,X.jsx)(et,{path:`/import`,element:(0,X.jsx)(Yd,{})})]})})}var Zd=Xd;(0,v.createRoot)(document.getElementById(`root`)).render((0,X.jsx)(y.StrictMode,{children:(0,X.jsx)(Zd,{})}));